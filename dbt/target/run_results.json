{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-23T22:16:02.837042Z", "invocation_id": "a31792aa-347d-4022-af15-8c18c8174e28", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.754097Z", "completed_at": "2024-07-23T22:16:02.761614Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.762746Z", "completed_at": "2024-07-23T22:16:02.762765Z"}], "thread_id": "Thread-2", "execution_time": 0.01671433448791504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.crm_stg_products", "compiled": true, "compiled_code": "\n\nwith raw_products as (\n    select\n        substring(md5(product || series) for 16) as product_id,\n        product::text as product_name,\n        series::text as product_series,\n        sales_price::float as suggested_retail_price\n    from \n        \"company_dw\".\"crm_sales_data\".\"products\"\n)\n\nselect * from raw_products", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.749035Z", "completed_at": "2024-07-23T22:16:02.761983Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.763602Z", "completed_at": "2024-07-23T22:16:02.763609Z"}], "thread_id": "Thread-1", "execution_time": 0.017984390258789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.crm_stg_accounts", "compiled": true, "compiled_code": "\n\nwith raw_accounts as (\n    select\n        substring(md5(account || sector || year_established || office_location) for 16) as account_id,\n        account::text as account_name,\n        sector::text as industry,\n        year_established::int,\n        revenue::float as annual_revenue_mm,\n        employees::int as num_employees,\n        office_location::text as headquarters,\n        subsidiary_of::text as parent_company\n    from \n        \"company_dw\".\"crm_sales_data\".\"accounts\"\n)\n\nselect * from raw_accounts", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_accounts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.756103Z", "completed_at": "2024-07-23T22:16:02.762469Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.764122Z", "completed_at": "2024-07-23T22:16:02.764127Z"}], "thread_id": "Thread-3", "execution_time": 0.017563819885253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.crm_stg_sales_pipelines", "compiled": true, "compiled_code": "\n\nwith raw_sales_pipeline as (\n    select\n        opportunity_id::text,\n        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,\n        case when product = 'NaN' then 'Unknown' else product::text end as product_name,\n        case when account = 'NaN' then 'Unknown' else account::text end as company_name,\n        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,\n        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,\n        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,\n        case when engage_date = 'NaN' then null\n             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))\n                then age(current_date, engage_date::timestamp)\n                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,\n        case when close_value = 'NaN' then 0 else close_value::float end as revenue\n    from \n        \"company_dw\".\"crm_sales_data\".\"sales_pipeline\"\n)\n\nselect * from raw_sales_pipeline", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_pipelines\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.758061Z", "completed_at": "2024-07-23T22:16:02.763270Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.765014Z", "completed_at": "2024-07-23T22:16:02.765018Z"}], "thread_id": "Thread-4", "execution_time": 0.017969131469726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.crm_stg_sales_teams", "compiled": true, "compiled_code": "\n\nwith raw_sales_teams as (\n    select\n        sales_agent::text,\n        manager::text,\n        regional_office::text,\n        manager::text || cast(' | ' as text) || regional_office::text as team_name\n    from \n        \"company_dw\".\"crm_sales_data\".\"sales_teams\"\n)\n\nselect * from raw_sales_teams", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_teams\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.769182Z", "completed_at": "2024-07-23T22:16:02.790285Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.791798Z", "completed_at": "2024-07-23T22:16:02.791809Z"}], "thread_id": "Thread-2", "execution_time": 0.025545120239257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.dim_date", "compiled": true, "compiled_code": "\n\nSELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,\n       datum AS date_actual,\n       EXTRACT(EPOCH FROM datum) AS epoch,\n       TO_CHAR(datum, 'fmDDth') AS day_suffix,\n       TO_CHAR(datum, 'Day') AS day_name,\n       EXTRACT(ISODOW FROM datum) AS day_of_week,\n       EXTRACT(DAY FROM datum) AS day_of_month,\n       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,\n       EXTRACT(DOY FROM datum) AS day_of_year,\n       TO_CHAR(datum, 'W')::INT AS week_of_month,\n       EXTRACT(WEEK FROM datum) AS week_of_year,\n       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '\"-W\"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,\n       EXTRACT(MONTH FROM datum) AS month_actual,\n       TO_CHAR(datum, 'Month') AS month_name,\n       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,\n       EXTRACT(QUARTER FROM datum) AS quarter_actual,\n       CASE\n           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'\n           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'\n           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'\n           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'\n           END AS quarter_name,\n       EXTRACT(ISOYEAR FROM datum) AS year_actual,\n       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,\n       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,\n       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,\n       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,\n       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,\n       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,\n       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,\n       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,\n       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,\n       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,\n       CASE\n           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE\n           ELSE FALSE\n           END AS weekend_indr\nFROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum\n      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)\n      GROUP BY SEQUENCE.DAY) DQ\nORDER BY 1", "relation_name": "\"company_dw\".\"dev_global_dim\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.781913Z", "completed_at": "2024-07-23T22:16:02.791514Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.792766Z", "completed_at": "2024-07-23T22:16:02.792773Z"}], "thread_id": "Thread-3", "execution_time": 0.025331497192382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect opportunity_id\nfrom \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_pipelines\"\nwhere opportunity_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.786744Z", "completed_at": "2024-07-23T22:16:02.792299Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.793924Z", "completed_at": "2024-07-23T22:16:02.793928Z"}], "thread_id": "Thread-4", "execution_time": 0.025796175003051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    opportunity_id as unique_field,\n    count(*) as n_records\n\nfrom \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_pipelines\"\nwhere opportunity_id is not null\ngroup by opportunity_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.797719Z", "completed_at": "2024-07-23T22:16:02.807969Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.810862Z", "completed_at": "2024-07-23T22:16:02.810870Z"}], "thread_id": "Thread-2", "execution_time": 0.015864133834838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.crm_int_kpi", "compiled": true, "compiled_code": "\n\nwith \n    pipelines as (\n        select * \n        from \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_pipelines\"\n    ),\n    accounts as (\n        select \n            account_name,\n            industry, \n            num_employees, \n            annual_revenue_mm\n        from \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_accounts\"\n    ), \n    products as (\n        select \n             product_name,\n             suggested_retail_price\n        from \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_products\"\n    ),\n    teams as (\n        select \n            sales_agent,\n            manager,\n            team_name,\n            regional_office \n        from \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_teams\"\n    )\nselect \n    p.*,\n    industry,\n    num_employees,\n    annual_revenue_mm,\n    suggested_retail_price,\n    manager,\n    team_name,\n    regional_office\nfrom pipelines p\nleft join accounts a on p.company_name = a.account_name \nleft join products pr on p.product_name = pr.product_name \nleft join teams t on p.sales_agent = t.sales_agent", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"crm_int_kpi\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.805086Z", "completed_at": "2024-07-23T22:16:02.810610Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.811760Z", "completed_at": "2024-07-23T22:16:02.811766Z"}], "thread_id": "Thread-4", "execution_time": 0.015098810195922852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_agent\nfrom \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_teams\"\nwhere sales_agent is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.771812Z", "completed_at": "2024-07-23T22:16:02.812794Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.814132Z", "completed_at": "2024-07-23T22:16:02.814138Z"}], "thread_id": "Thread-1", "execution_time": 0.05223870277404785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471", "compiled": true, "compiled_code": "\n    \n    \n    \n\n    \n    \n\n    \n    \n        SELECT 1\n    \n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.816445Z", "completed_at": "2024-07-23T22:16:02.822603Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.823274Z", "completed_at": "2024-07-23T22:16:02.823280Z"}], "thread_id": "Thread-2", "execution_time": 0.009569644927978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sales_agent as unique_field,\n    count(*) as n_records\n\nfrom \"company_dw\".\"dev_crm_sales_dbt\".\"crm_stg_sales_teams\"\nwhere sales_agent is not null\ngroup by sales_agent\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.819816Z", "completed_at": "2024-07-23T22:16:02.823768Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.824879Z", "completed_at": "2024-07-23T22:16:02.824885Z"}], "thread_id": "Thread-4", "execution_time": 0.010458230972290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.kpi", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"company_dw\".\"dev_crm_sales_dbt\".\"crm_int_kpi\"", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"kpi\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.825347Z", "completed_at": "2024-07-23T22:16:02.830025Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.832295Z", "completed_at": "2024-07-23T22:16:02.832302Z"}], "thread_id": "Thread-1", "execution_time": 0.009473800659179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.product_win_rates", "compiled": true, "compiled_code": "\n\nWITH win_counts AS (\n    SELECT product_name AS product_name,\n        sum(case\n                when deal_stage = 'Won' then 1\n                else 0\n            end) AS won_deals,\n        sum(case\n                when (deal_stage != 'NaN'\n                        and deal_stage is not null) then 1\n                else 0\n            end) AS all_deals\n    FROM\n    (SELECT *\n    FROM \"company_dw\".\"dev_crm_sales_dbt\".\"crm_int_kpi\" a\n    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table\n    GROUP BY product_name\n    ORDER BY won_deals DESC )\nselect product_name,\n        sum(won_deals) as won_deals,\n        sum(all_deals) as all_deals,\n    sum(won_deals) / sum(all_deals) as product_win_rate\nfrom win_counts\ngroup by product_name", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"product_win_rates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.830249Z", "completed_at": "2024-07-23T22:16:02.833354Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.833825Z", "completed_at": "2024-07-23T22:16:02.833830Z"}], "thread_id": "Thread-2", "execution_time": 0.005118846893310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.matt_demo.qoq_kpi", "compiled": true, "compiled_code": "\n\n\nWITH quarterly_revenue AS (\n    SELECT\n        date_trunc('quarter', ts_close_date) AS quarter,\n        SUM(revenue) AS total_revenue\n    FROM\n        \"company_dw\".\"dev_crm_sales_dbt\".\"crm_int_kpi\"\n    GROUP BY\n        date_trunc('quarter', ts_close_date)\n    ORDER BY\n        quarter\n),\nquarterly_growth AS (\n    SELECT\n        quarter,\n        total_revenue,\n        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,\n        CASE\n            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL\n            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100\n        END AS quarter_over_quarter_growth\n    FROM\n        quarterly_revenue\n)\nSELECT\n    quarter,\n    total_revenue,\n    previous_quarter_revenue,\n    quarter_over_quarter_growth\nFROM\n    quarterly_growth", "relation_name": "\"company_dw\".\"dev_crm_sales_dbt\".\"qoq_kpi\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-23T22:16:02.800481Z", "completed_at": "2024-07-23T22:16:02.832015Z"}, {"name": "execute", "started_at": "2024-07-23T22:16:02.832923Z", "completed_at": "2024-07-23T22:16:02.832927Z"}], "thread_id": "Thread-3", "execution_time": 0.03902125358581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267", "compiled": true, "compiled_code": "\n    \n    \n    \n\n    \n    \n\n    \n    \n        SELECT 1\n    \n", "relation_name": null}], "elapsed_time": 0.16160225868225098, "args": {"select": [], "log_file_max_bytes": 10485760, "defer": false, "write_json": true, "exclude": [], "cache_selected_only": false, "require_resource_names_without_spaces": false, "macro_debugging": false, "enable_legacy_logger": false, "log_format_file": "debug", "project_dir": "/opt/airflow/dbt", "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "use_colors": true, "indirect_selection": "eager", "show_resource_report": false, "log_level": "info", "log_path": "/opt/airflow/dbt/logs", "partial_parse_file_diff": true, "print": true, "version_check": true, "use_colors_file": true, "profiles_dir": "/opt/airflow/dbt", "source_freshness_run_project_hooks": false, "partial_parse": true, "which": "generate", "introspect": true, "favor_state": false, "log_format": "default", "warn_error_options": {"include": [], "exclude": []}, "compile": true, "send_anonymous_usage_stats": true, "strict_mode": false, "vars": {}, "empty_catalog": false, "log_level_file": "debug", "static_parser": true, "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt", "populate_cache": true, "static": false}}