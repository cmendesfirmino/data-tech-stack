[0m23:25:16.068457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6475e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62d59610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62d59580>]}


============================== 23:25:16.071732 | 84f3a00f-0983-4c23-a8e2-0b65ad3f3671 ==============================
[0m23:25:16.071732 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:25:16.072156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m23:25:16.153542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f3a00f-0983-4c23-a8e2-0b65ad3f3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62de2100>]}
[0m23:25:16.179290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f3a00f-0983-4c23-a8e2-0b65ad3f3671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186e070>]}
[0m23:25:16.180008 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:25:16.184358 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m23:25:16.185481 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.14233021, "process_user_time": 1.906551, "process_kernel_time": 0.048834, "process_mem_max_rss": "113028", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:16.186160 [debug] [MainThread]: Command `dbt compile` failed at 23:25:16.186054 after 0.14 seconds
[0m23:25:16.186830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6475e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81702d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81702c40>]}
[0m23:25:16.187284 [debug] [MainThread]: Flushing usage events
[0m23:26:19.688053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a6a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800056a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80005640>]}


============================== 23:26:19.691330 | bffcea9c-ab91-4575-a125-4ea55304ef9e ==============================
[0m23:26:19.691330 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:26:19.691881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:19.744029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bffcea9c-ab91-4575-a125-4ea55304ef9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81823910>]}
[0m23:26:19.749747 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q75d3emu'
[0m23:26:19.750134 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:26:19.874806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:26:19.875530 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:26:19.939361 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:26:19.950636 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m23:26:19.952613 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ftl948pu'
[0m23:26:19.955497 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:26:20.472039 [info ] [MainThread]: Installed from version 0.8.6
[0m23:26:20.472480 [info ] [MainThread]: Updated version available: 1.2.0
[0m23:26:20.472908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bffcea9c-ab91-4575-a125-4ea55304ef9e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7a44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f77b370>]}
[0m23:26:20.473266 [info ] [MainThread]: 
[0m23:26:20.473625 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:26:20.474393 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.81103873, "process_user_time": 1.903224, "process_kernel_time": 0.070303, "process_mem_max_rss": "112600", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m23:26:20.474829 [debug] [MainThread]: Command `dbt deps` succeeded at 23:26:20.474756 after 0.81 seconds
[0m23:26:20.475140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a6a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7651f0>]}
[0m23:26:20.475407 [debug] [MainThread]: Flushing usage events
[0m23:28:14.321108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a523670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a523610>]}


============================== 23:28:14.324431 | b420c626-2904-4602-987b-7f6be1bcb2e3 ==============================
[0m23:28:14.324431 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:28:14.324984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:28:14.401621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b420c626-2904-4602-987b-7f6be1bcb2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a55e520>]}
[0m23:28:14.424859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b420c626-2904-4602-987b-7f6be1bcb2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5566a0>]}
[0m23:28:14.425506 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:28:14.436745 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:28:14.437733 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:28:14.438174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b420c626-2904-4602-987b-7f6be1bcb2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f61760>]}
[0m23:28:15.115887 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.matt_demo.crm_performance' (models/crm_sales_data/analysis/crm_performance.sql) depends on a node named 'stg_sales_pipeline' which was not found
[0m23:28:15.116774 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.8197196, "process_user_time": 2.538619, "process_kernel_time": 0.070238, "process_mem_max_rss": "121500", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:15.117232 [debug] [MainThread]: Command `dbt compile` failed at 23:28:15.117167 after 0.82 seconds
[0m23:28:15.117631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98554100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f6e9a0>]}
[0m23:28:15.117953 [debug] [MainThread]: Flushing usage events
[0m23:28:20.854129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fe106a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fe10640>]}


============================== 23:28:20.857369 | 674ef0ff-f4ed-418b-834c-62a19b8881dc ==============================
[0m23:28:20.857369 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:28:20.857894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:28:20.909748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '674ef0ff-f4ed-418b-834c-62a19b8881dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716828b0>]}
[0m23:28:20.969305 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xy79a2ci'
[0m23:28:20.970816 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:28:21.183467 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:28:21.185152 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:28:21.261963 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:28:21.268126 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:28:21.848434 [info ] [MainThread]: Installed from version 0.8.6
[0m23:28:21.849016 [info ] [MainThread]: Updated version available: 1.2.0
[0m23:28:21.849411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '674ef0ff-f4ed-418b-834c-62a19b8881dc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fe64940>]}
[0m23:28:21.849742 [info ] [MainThread]: 
[0m23:28:21.850088 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:28:21.850978 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0207803, "process_user_time": 1.932847, "process_kernel_time": 0.088038, "process_mem_max_rss": "108260", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m23:28:21.851441 [debug] [MainThread]: Command `dbt deps` succeeded at 23:28:21.851375 after 1.02 seconds
[0m23:28:21.851813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716828b0>]}
[0m23:28:21.852120 [debug] [MainThread]: Flushing usage events
[0m23:29:25.461502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61aec2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600e6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600e66d0>]}


============================== 23:29:25.464682 | 3a52a172-5f24-43b3-9c09-0a57d663cd43 ==============================
[0m23:29:25.464682 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:29:25.465260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:25.542279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a52a172-5f24-43b3-9c09-0a57d663cd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff619a96d0>]}
[0m23:29:25.565435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a52a172-5f24-43b3-9c09-0a57d663cd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6030aa90>]}
[0m23:29:25.566010 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:29:25.577565 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:29:25.578930 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:29:25.579704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a52a172-5f24-43b3-9c09-0a57d663cd43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6017a520>]}
[0m23:29:26.280166 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.matt_demo.crm_performance' (models/crm_sales_data/analysis/crm_performance.sql) depends on a node named 'crm_stg_sales_pipeline' which was not found
[0m23:29:26.281135 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.84452677, "process_user_time": 2.590818, "process_kernel_time": 0.067437, "process_mem_max_rss": "126176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:26.281681 [debug] [MainThread]: Command `dbt compile` failed at 23:29:26.281628 after 0.85 seconds
[0m23:29:26.282035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61aec2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb255e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb25580>]}
[0m23:29:26.282380 [debug] [MainThread]: Flushing usage events
[0m23:29:53.081770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927702e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d6b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d6b6d0>]}


============================== 23:29:53.085014 | 4786e527-803e-4170-924b-b50c7be9bf7b ==============================
[0m23:29:53.085014 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:29:53.085586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:53.160874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf85bee0>]}
[0m23:29:53.183829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918d4550>]}
[0m23:29:53.184384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:29:53.194103 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:29:53.195160 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:29:53.195617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf745c40>]}
[0m23:29:53.922397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5f2eb0>]}
[0m23:29:53.982572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed4e340>]}
[0m23:29:53.982975 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:29:53.983808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf51d4f0>]}
[0m23:29:53.984714 [info ] [MainThread]: 
[0m23:29:53.985208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:53.987795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:29:54.003363 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:29:54.003748 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:29:54.004056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:54.006228 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:29:54.006517 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:29:54.006808 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:29:54.008662 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:29:54.009360 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:29:54.009736 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:29:54.012557 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:54.012868 [debug] [MainThread]: On master: BEGIN
[0m23:29:54.013166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:54.014615 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:29:54.014891 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:54.015242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:54.018866 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:29:54.019488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4786e527-803e-4170-924b-b50c7be9bf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf48aa60>]}
[0m23:29:54.019823 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:54.020237 [debug] [MainThread]: On master: Close
[0m23:29:54.020587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:54.020959 [info ] [MainThread]: 
[0m23:29:54.025077 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:29:54.025350 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m23:29:54.025579 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:29:54.025815 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:29:54.026196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m23:29:54.026599 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m23:29:54.027033 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m23:29:54.027425 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m23:29:54.027754 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:29:54.028096 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:29:54.028459 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:29:54.028791 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:29:54.032949 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:29:54.035087 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:29:54.036693 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:29:54.038444 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:29:54.041039 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:29:54.041405 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:29:54.041886 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:29:54.042157 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:29:54.042363 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:29:54.042768 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:29:54.043093 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m23:29:54.043553 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:29:54.044003 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:29:54.044468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m23:29:54.045142 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_performance
[0m23:29:54.045417 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m23:29:54.045729 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.crm_performance)
[0m23:29:54.047386 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m23:29:54.047720 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_performance
[0m23:29:54.049951 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:29:54.050618 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m23:29:54.051165 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m23:29:54.051606 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_performance
[0m23:29:54.052149 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_performance
[0m23:29:54.053020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:54.053357 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m23:29:54.053629 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:29:54.053908 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:29:54.054186 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:29:54.054866 [debug] [MainThread]: Command end result
[0m23:29:54.082297 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0245774, "process_user_time": 2.706927, "process_kernel_time": 0.075164, "process_mem_max_rss": "126836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:54.082730 [debug] [MainThread]: Command `dbt compile` succeeded at 23:29:54.082664 after 1.03 seconds
[0m23:29:54.083042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927702e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8b3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918d4550>]}
[0m23:29:54.083313 [debug] [MainThread]: Flushing usage events
[0m23:30:11.321858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f9a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785936a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78593640>]}


============================== 23:30:11.325220 | 4a524e4c-662c-45c2-8428-3cb27e7ad626 ==============================
[0m23:30:11.325220 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:30:11.325816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:30:11.380128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a524e4c-662c-45c2-8428-3cb27e7ad626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e078b0>]}
[0m23:30:11.440952 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8pn_8pgu'
[0m23:30:11.441465 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:30:11.549948 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:30:11.550656 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:30:11.659466 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:30:11.665495 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:30:12.191926 [info ] [MainThread]: Installed from version 0.8.6
[0m23:30:12.192408 [info ] [MainThread]: Updated version available: 1.2.0
[0m23:30:12.192753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4a524e4c-662c-45c2-8428-3cb27e7ad626', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cb2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785e8940>]}
[0m23:30:12.193088 [info ] [MainThread]: 
[0m23:30:12.193401 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:30:12.194163 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8965153, "process_user_time": 1.933154, "process_kernel_time": 0.084443, "process_mem_max_rss": "110408", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m23:30:12.194643 [debug] [MainThread]: Command `dbt deps` succeeded at 23:30:12.194566 after 0.90 seconds
[0m23:30:12.194994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f9a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cb2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e078b0>]}
[0m23:30:12.195299 [debug] [MainThread]: Flushing usage events
[0m23:31:30.950277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5898e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7877a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7877a580>]}


============================== 23:31:30.955351 | fa3a7741-751b-4a50-ae21-0a5d584af035 ==============================
[0m23:31:30.955351 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:31:30.956031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:31.028135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa3a7741-751b-4a50-ae21-0a5d584af035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789a34f0>]}
[0m23:31:31.104223 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1sj1mu15'
[0m23:31:31.104863 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:31:31.217053 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:31:31.217692 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:31:31.279288 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:31:31.281903 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:31:31.940764 [info ] [MainThread]: Installed from version 0.8.6
[0m23:31:31.941601 [info ] [MainThread]: Updated version available: 1.2.0
[0m23:31:31.942134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa3a7741-751b-4a50-ae21-0a5d584af035', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ad4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ed7520>]}
[0m23:31:31.942675 [info ] [MainThread]: 
[0m23:31:31.943420 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:31:31.945540 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0389631, "process_user_time": 1.980231, "process_kernel_time": 0.120135, "process_mem_max_rss": "195804", "process_out_blocks": "1296", "process_in_blocks": "0"}
[0m23:31:31.946728 [debug] [MainThread]: Command `dbt deps` succeeded at 23:31:31.946594 after 1.04 seconds
[0m23:31:31.947467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5898e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b62040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e01f10>]}
[0m23:31:31.948202 [debug] [MainThread]: Flushing usage events
[0m23:31:35.279446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f35a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d954730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9546d0>]}


============================== 23:31:35.285223 | b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847 ==============================
[0m23:31:35.285223 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:31:35.286007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:35.389141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c444ee0>]}
[0m23:31:35.414308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4befd0>]}
[0m23:31:35.415020 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:31:35.426085 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:31:35.552581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:35.553033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:35.571434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c05b130>]}
[0m23:31:35.643683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0a6490>]}
[0m23:31:35.644231 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:31:35.644754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9e74ba0-53e2-4d89-8a4a-e9f4c04ef847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1f9160>]}
[0m23:31:35.645927 [info ] [MainThread]: 
[0m23:31:35.646369 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:31:35.649221 [debug] [MainThread]: Command end result
[0m23:31:35.691092 [info ] [MainThread]: 
[0m23:31:35.691631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:35.691982 [info ] [MainThread]: 
[0m23:31:35.692275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m23:31:35.692841 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.45816436, "process_user_time": 2.043939, "process_kernel_time": 0.140961, "process_mem_max_rss": "195828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:35.693325 [debug] [MainThread]: Command `dbt seed` succeeded at 23:31:35.693271 after 0.46 seconds
[0m23:31:35.693705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f35a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e4fcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f0764c0>]}
[0m23:31:35.694080 [debug] [MainThread]: Flushing usage events
[0m23:31:39.192277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6572b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63d27730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63d276d0>]}


============================== 23:31:39.195771 | cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d ==============================
[0m23:31:39.195771 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:31:39.196362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:31:39.274121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63d4fa90>]}
[0m23:31:39.298101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82748f40>]}
[0m23:31:39.298748 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:31:39.308710 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:31:39.383088 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:31:39.383578 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m23:31:39.383856 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:31:39.384238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6508d4c0>]}
[0m23:31:40.183211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826bc670>]}
[0m23:31:40.189948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff823b5a00>]}
[0m23:31:40.190436 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:31:40.190769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826bc4f0>]}
[0m23:31:40.191545 [info ] [MainThread]: 
[0m23:31:40.191960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:40.192633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:31:40.210223 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:31:40.210707 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:31:40.211028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:40.214810 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m23:31:40.215667 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:31:40.218469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dim)
[0m23:31:40.221966 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim"
[0m23:31:40.222322 [debug] [ThreadPool]: On list_company_dw_dim: BEGIN
[0m23:31:40.222605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:40.224285 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:31:40.224576 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim"
[0m23:31:40.224920 [debug] [ThreadPool]: On list_company_dw_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim'
  
[0m23:31:40.226474 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:31:40.227215 [debug] [ThreadPool]: On list_company_dw_dim: ROLLBACK
[0m23:31:40.227591 [debug] [ThreadPool]: On list_company_dw_dim: Close
[0m23:31:40.231035 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.231406 [debug] [MainThread]: On master: BEGIN
[0m23:31:40.231691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:40.233508 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:31:40.233803 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.234120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:40.238322 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:31:40.238993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aed1730>]}
[0m23:31:40.239356 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:40.239700 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.239998 [debug] [MainThread]: On master: BEGIN
[0m23:31:40.240510 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:31:40.240820 [debug] [MainThread]: On master: COMMIT
[0m23:31:40.241132 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.241414 [debug] [MainThread]: On master: COMMIT
[0m23:31:40.241761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:40.242036 [debug] [MainThread]: On master: Close
[0m23:31:40.242444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:40.242775 [info ] [MainThread]: 
[0m23:31:40.247104 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m23:31:40.247557 [info ] [Thread-1  ]: 1 of 1 START sql table model dim.dim_date ...................................... [RUN]
[0m23:31:40.248049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dim, now model.matt_demo.dim_date)
[0m23:31:40.248448 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m23:31:40.252726 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m23:31:40.253953 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m23:31:40.273469 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m23:31:40.275194 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.275526 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m23:31:40.275842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:31:40.277752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:31:40.278034 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.278386 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m23:31:40.429194 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.150 seconds
[0m23:31:40.433368 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.433730 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dim"."dim_date" rename to "dim_date__dbt_backup"
[0m23:31:40.434374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:31:40.436207 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.436529 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m23:31:40.436963 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:31:40.446108 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m23:31:40.446470 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.446789 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m23:31:40.454912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m23:31:40.458424 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dim"."dim_date__dbt_backup"
[0m23:31:40.460490 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m23:31:40.460827 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dim"."dim_date__dbt_backup" cascade
[0m23:31:40.462962 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m23:31:40.464212 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m23:31:40.465158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6a3c1a-7f98-4486-9e1a-0271b0ddf70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae68970>]}
[0m23:31:40.465635 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dim.dim_date ................................. [[32mSELECT 29220[0m in 0.22s]
[0m23:31:40.466150 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m23:31:40.466980 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.467272 [debug] [MainThread]: On master: BEGIN
[0m23:31:40.467507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:40.469141 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:31:40.469434 [debug] [MainThread]: On master: COMMIT
[0m23:31:40.469686 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:40.469920 [debug] [MainThread]: On master: COMMIT
[0m23:31:40.470234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:40.470490 [debug] [MainThread]: On master: Close
[0m23:31:40.470800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:40.471095 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m23:31:40.471399 [info ] [MainThread]: 
[0m23:31:40.471763 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:31:40.472230 [debug] [MainThread]: Command end result
[0m23:31:40.472497 [info ] [MainThread]: 
[0m23:31:40.472866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:40.473197 [info ] [MainThread]: 
[0m23:31:40.473551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:31:40.474220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3082997, "process_user_time": 2.930622, "process_kernel_time": 0.101743, "process_mem_max_rss": "130472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:40.474609 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:40.474568 after 1.31 seconds
[0m23:31:40.474934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6572b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d48e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82748f40>]}
[0m23:31:40.475264 [debug] [MainThread]: Flushing usage events
[0m23:31:43.172181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef6b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d566760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d566700>]}


============================== 23:31:43.175795 | 006bcd6c-94e5-48e4-8b67-e96c350ef4e4 ==============================
[0m23:31:43.175795 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:31:43.176330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:43.254365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '006bcd6c-94e5-48e4-8b67-e96c350ef4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac076430>]}
[0m23:31:43.278814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '006bcd6c-94e5-48e4-8b67-e96c350ef4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8daed640>]}
[0m23:31:43.279433 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:31:43.289478 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:31:43.400571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:43.401006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:43.419259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '006bcd6c-94e5-48e4-8b67-e96c350ef4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc32df0>]}
[0m23:31:43.430603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '006bcd6c-94e5-48e4-8b67-e96c350ef4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabad1a30>]}
[0m23:31:43.431006 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:31:43.431392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '006bcd6c-94e5-48e4-8b67-e96c350ef4e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdbf910>]}
[0m23:31:43.432118 [info ] [MainThread]: 
[0m23:31:43.432498 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:31:43.433629 [debug] [MainThread]: Command end result
[0m23:31:43.434227 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.28885692, "process_user_time": 2.169337, "process_kernel_time": 0.071011, "process_mem_max_rss": "116028", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:43.434675 [debug] [MainThread]: Command `dbt test` succeeded at 23:31:43.434613 after 0.29 seconds
[0m23:31:43.435040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef6b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabec9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdbfe80>]}
[0m23:31:43.435465 [debug] [MainThread]: Flushing usage events
[0m23:31:46.852082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d4e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8534b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8534b910>]}


============================== 23:31:46.855533 | 631d7326-c895-4f52-82b3-5b58ab301e00 ==============================
[0m23:31:46.855533 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:31:46.856034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:31:46.932387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e31d00>]}
[0m23:31:46.955636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e077c0>]}
[0m23:31:46.956210 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:31:46.966183 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:31:47.046875 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:31:47.048473 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m23:31:47.049199 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:31:47.050597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ed30a0>]}
[0m23:31:47.848443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d76040>]}
[0m23:31:47.855223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a24fd0>]}
[0m23:31:47.855675 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:31:47.856073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a24ac0>]}
[0m23:31:47.857065 [info ] [MainThread]: 
[0m23:31:47.857549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:47.859713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:31:47.874683 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:31:47.875125 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:31:47.875455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:47.877640 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:31:47.877957 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:31:47.878266 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:31:47.879606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:31:47.880276 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:31:47.880639 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:31:47.883399 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:47.883723 [debug] [MainThread]: On master: BEGIN
[0m23:31:47.884008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:47.885552 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:31:47.885841 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:47.886184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:47.889567 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:31:47.890308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631d7326-c895-4f52-82b3-5b58ab301e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e722e0>]}
[0m23:31:47.890641 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:47.890971 [debug] [MainThread]: On master: Close
[0m23:31:47.891395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:47.891722 [info ] [MainThread]: 
[0m23:31:47.895604 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:31:47.896213 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m23:31:47.896431 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:31:47.896649 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:31:47.896981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m23:31:47.897374 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m23:31:47.897747 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m23:31:47.898114 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m23:31:47.898462 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:31:47.898789 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:31:47.899112 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:31:47.899446 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:31:47.903530 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:31:47.905112 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:31:47.906688 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:31:47.908225 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:31:47.909744 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:31:47.909979 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:31:47.910406 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:31:47.910781 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:31:47.911010 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:31:47.911476 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:31:47.911937 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:31:47.912304 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m23:31:47.912773 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:31:47.913503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m23:31:47.913995 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_performance
[0m23:31:47.914215 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m23:31:47.914545 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.crm_performance)
[0m23:31:47.916325 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m23:31:47.916634 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_performance
[0m23:31:47.919198 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:31:47.919670 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m23:31:47.920207 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m23:31:47.920756 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_performance
[0m23:31:47.921322 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_performance
[0m23:31:47.922106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:47.922387 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m23:31:47.922613 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:31:47.922830 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:31:47.923044 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:31:47.923691 [debug] [MainThread]: Command end result
[0m23:31:47.984838 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:31:47.985162 [info ] [MainThread]: Building catalog
[0m23:31:47.990273 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:31:47.994288 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:31:47.994558 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:31:47.994790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:47.996565 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:31:47.996856 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:31:47.997191 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_performance')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_teams')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_products')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_pipeline')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_sales_pipelines')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_accounts')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_sales_teams')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('dim_date')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:31:47.998983 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.001 seconds
[0m23:31:48.001441 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:31:48.001796 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:31:48.040048 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:31:48.041070 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2146462, "process_user_time": 2.968737, "process_kernel_time": 0.074653, "process_mem_max_rss": "197764", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:31:48.041754 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:31:48.041688 after 1.22 seconds
[0m23:31:48.042554 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:31:48.043076 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:31:48.043883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d4e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e223d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3db0c70>]}
[0m23:31:48.044694 [debug] [MainThread]: Flushing usage events
[0m23:32:00.439821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f556760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f556700>]}


============================== 23:32:00.443808 | 62fa38ef-510e-4961-9deb-8dc8a965a2e2 ==============================
[0m23:32:00.443808 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:32:00.444371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:00.559599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0a8430>]}
[0m23:32:00.589464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fadb640>]}
[0m23:32:00.590232 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:32:00.600944 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:32:00.682036 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:32:00.682596 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m23:32:00.683008 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:32:00.683398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600deeb0>]}
[0m23:32:01.395972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc369a0>]}
[0m23:32:01.401848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd47940>]}
[0m23:32:01.402344 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:32:01.402731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfdca60>]}
[0m23:32:01.403535 [info ] [MainThread]: 
[0m23:32:01.403977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:01.404646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:32:01.420872 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:32:01.421288 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:32:01.421614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:01.424181 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m23:32:01.424920 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:32:01.425501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_analysis_crm_sales)
[0m23:32:01.425918 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "analysis_crm_sales"
"
[0m23:32:01.428883 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analysis_crm_sales"
[0m23:32:01.429187 [debug] [ThreadPool]: On create_company_dw_analysis_crm_sales: BEGIN
[0m23:32:01.429471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:01.431037 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:32:01.431330 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analysis_crm_sales"
[0m23:32:01.431596 [debug] [ThreadPool]: On create_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_analysis_crm_sales"} */
create schema if not exists "analysis_crm_sales"
[0m23:32:01.432107 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m23:32:01.432705 [debug] [ThreadPool]: On create_company_dw_analysis_crm_sales: COMMIT
[0m23:32:01.433007 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analysis_crm_sales"
[0m23:32:01.433311 [debug] [ThreadPool]: On create_company_dw_analysis_crm_sales: COMMIT
[0m23:32:01.434257 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:32:01.434556 [debug] [ThreadPool]: On create_company_dw_analysis_crm_sales: Close
[0m23:32:01.436909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_analysis_crm_sales, now list_company_dw_analysis_crm_sales)
[0m23:32:01.440341 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:01.440644 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:32:01.440910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:01.442472 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:32:01.442780 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:01.443102 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:32:01.444374 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:32:01.445005 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:32:01.445358 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:32:01.447895 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.448192 [debug] [MainThread]: On master: BEGIN
[0m23:32:01.448471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:01.449929 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:01.450206 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.450517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:01.453822 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:32:01.454511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0a8eb0>]}
[0m23:32:01.454864 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:01.455238 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.455509 [debug] [MainThread]: On master: BEGIN
[0m23:32:01.455938 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:32:01.456246 [debug] [MainThread]: On master: COMMIT
[0m23:32:01.456540 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.456834 [debug] [MainThread]: On master: COMMIT
[0m23:32:01.457192 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:01.457466 [debug] [MainThread]: On master: Close
[0m23:32:01.457816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:01.458187 [info ] [MainThread]: 
[0m23:32:01.461942 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:32:01.462401 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m23:32:01.462789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m23:32:01.463088 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:32:01.467220 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:32:01.468232 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:32:01.484849 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m23:32:01.486250 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:32:01.486610 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m23:32:01.486921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:01.488696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:32:01.488991 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:32:01.489283 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams;
  );
[0m23:32:01.489667 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: select * from raw_sales_teams;
                                      ^

[0m23:32:01.489944 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: ROLLBACK
[0m23:32:01.490321 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m23:32:01.491580 [debug] [Thread-1  ]: Database Error in model crm_stg_sales_teams (models/crm_sales_data/staging/crm_stg_sales_teams.sql)
  syntax error at or near ";"
  LINE 16: select * from raw_sales_teams;
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m23:32:01.492454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62fa38ef-510e-4961-9deb-8dc8a965a2e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76697580>]}
[0m23:32:01.492885 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analysis_crm_sales.crm_stg_sales_teams .... [[31mERROR[0m in 0.03s]
[0m23:32:01.493337 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:32:01.494195 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.494507 [debug] [MainThread]: On master: BEGIN
[0m23:32:01.494742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:01.496207 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:01.496515 [debug] [MainThread]: On master: COMMIT
[0m23:32:01.496799 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:01.497072 [debug] [MainThread]: On master: COMMIT
[0m23:32:01.497505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:01.497872 [debug] [MainThread]: On master: Close
[0m23:32:01.498276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:01.498591 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:32:01.498925 [info ] [MainThread]: 
[0m23:32:01.499281 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:32:01.499791 [debug] [MainThread]: Command end result
[0m23:32:01.500064 [info ] [MainThread]: 
[0m23:32:01.500438 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:01.500738 [info ] [MainThread]: 
[0m23:32:01.501080 [error] [MainThread]:   Database Error in model crm_stg_sales_teams (models/crm_sales_data/staging/crm_stg_sales_teams.sql)
  syntax error at or near ";"
  LINE 16: select * from raw_sales_teams;
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m23:32:01.501418 [info ] [MainThread]: 
[0m23:32:01.501788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:32:01.502466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0875542, "process_user_time": 2.763758, "process_kernel_time": 0.084211, "process_mem_max_rss": "126872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:01.502859 [debug] [MainThread]: Command `dbt run` failed at 23:32:01.502818 after 1.09 seconds
[0m23:32:01.503215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd47610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7defad60>]}
[0m23:32:01.503530 [debug] [MainThread]: Flushing usage events
[0m23:32:05.086637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971a5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971a5730>]}


============================== 23:32:05.089917 | 0c7405dc-113c-4d9b-9e6c-44db5fc86fcc ==============================
[0m23:32:05.089917 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:32:05.090513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:05.165641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97242dc0>]}
[0m23:32:05.189669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971cde50>]}
[0m23:32:05.190257 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:32:05.200219 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:32:05.310823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:05.311252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:05.329683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c4adc0>]}
[0m23:32:05.334891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c62fa0>]}
[0m23:32:05.335268 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:32:05.335646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b00b80>]}
[0m23:32:05.336400 [info ] [MainThread]: 
[0m23:32:05.336833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:05.337432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:32:05.354772 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:32:05.355185 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:32:05.355533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:05.357855 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:32:05.358589 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:32:05.361023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:32:05.364515 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:05.364823 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:32:05.365111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:05.366755 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:32:05.367048 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:05.367343 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:32:05.368559 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:32:05.369248 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:32:05.369635 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:32:05.372240 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.372534 [debug] [MainThread]: On master: BEGIN
[0m23:32:05.372835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:05.374363 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:32:05.374671 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.374997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:05.378303 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:32:05.378952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59c1f10>]}
[0m23:32:05.379309 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:05.379659 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.379945 [debug] [MainThread]: On master: BEGIN
[0m23:32:05.380361 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:32:05.380646 [debug] [MainThread]: On master: COMMIT
[0m23:32:05.380922 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.381203 [debug] [MainThread]: On master: COMMIT
[0m23:32:05.381533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:05.381800 [debug] [MainThread]: On master: Close
[0m23:32:05.382167 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:05.382572 [info ] [MainThread]: 
[0m23:32:05.386565 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m23:32:05.386967 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m23:32:05.387364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m23:32:05.387714 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:32:05.392292 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:32:05.394085 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:32:05.413430 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m23:32:05.414469 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:32:05.414787 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m23:32:05.415100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:05.416820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:32:05.417173 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:32:05.417509 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products;
  );
[0m23:32:05.417935 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: select * from raw_products;
                                   ^

[0m23:32:05.418269 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: ROLLBACK
[0m23:32:05.418693 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m23:32:05.419772 [debug] [Thread-1  ]: Database Error in model crm_stg_products (models/crm_sales_data/staging/crm_stg_products.sql)
  syntax error at or near ";"
  LINE 16: select * from raw_products;
                                     ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_products.sql
[0m23:32:05.420669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7405dc-113c-4d9b-9e6c-44db5fc86fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97eaeaf0>]}
[0m23:32:05.421102 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analysis_crm_sales.crm_stg_products ....... [[31mERROR[0m in 0.03s]
[0m23:32:05.421569 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:32:05.422438 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.422710 [debug] [MainThread]: On master: BEGIN
[0m23:32:05.422949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:05.424345 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:05.424634 [debug] [MainThread]: On master: COMMIT
[0m23:32:05.424877 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:05.425098 [debug] [MainThread]: On master: COMMIT
[0m23:32:05.425410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:05.425704 [debug] [MainThread]: On master: Close
[0m23:32:05.426069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:05.426405 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m23:32:05.426749 [info ] [MainThread]: 
[0m23:32:05.427081 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:32:05.427571 [debug] [MainThread]: Command end result
[0m23:32:05.427835 [info ] [MainThread]: 
[0m23:32:05.428196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:05.428487 [info ] [MainThread]: 
[0m23:32:05.428807 [error] [MainThread]:   Database Error in model crm_stg_products (models/crm_sales_data/staging/crm_stg_products.sql)
  syntax error at or near ";"
  LINE 16: select * from raw_products;
                                     ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_products.sql
[0m23:32:05.429181 [info ] [MainThread]: 
[0m23:32:05.429533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:32:05.430078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36833116, "process_user_time": 2.094399, "process_kernel_time": 0.063768, "process_mem_max_rss": "123512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:05.430492 [debug] [MainThread]: Command `dbt run` failed at 23:32:05.430448 after 0.37 seconds
[0m23:32:05.430821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971cde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5c62490>]}
[0m23:32:05.431143 [debug] [MainThread]: Flushing usage events
[0m23:32:09.119632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ec50700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ec506a0>]}


============================== 23:32:09.122864 | 92b46ff8-199c-475b-bcf6-7b863333af79 ==============================
[0m23:32:09.122864 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:32:09.123384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:32:09.199965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70650100>]}
[0m23:32:09.223819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee77af0>]}
[0m23:32:09.224414 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:32:09.234523 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:32:09.337240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:09.337650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:09.356080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d594130>]}
[0m23:32:09.361355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5ba7f0>]}
[0m23:32:09.361723 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:32:09.362140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44daf0>]}
[0m23:32:09.362914 [info ] [MainThread]: 
[0m23:32:09.363379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:09.363973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:32:09.381826 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:32:09.382227 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:32:09.382564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:09.385104 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:32:09.385820 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:32:09.388227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:32:09.391653 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:09.391988 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:32:09.392298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:09.393740 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:32:09.394026 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:09.394337 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:32:09.395570 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:32:09.396210 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:32:09.396567 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:32:09.399064 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.399386 [debug] [MainThread]: On master: BEGIN
[0m23:32:09.399658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:09.401008 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:09.401285 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.401601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:09.404915 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:32:09.405513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5fb280>]}
[0m23:32:09.405852 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:09.406186 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.406451 [debug] [MainThread]: On master: BEGIN
[0m23:32:09.406853 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:32:09.407133 [debug] [MainThread]: On master: COMMIT
[0m23:32:09.407431 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.407694 [debug] [MainThread]: On master: COMMIT
[0m23:32:09.408026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:09.408314 [debug] [MainThread]: On master: Close
[0m23:32:09.408668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:09.409031 [info ] [MainThread]: 
[0m23:32:09.412943 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:32:09.413352 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m23:32:09.413731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m23:32:09.414044 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:32:09.418202 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:32:09.419234 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:32:09.437036 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:32:09.438088 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:32:09.438437 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m23:32:09.438775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:09.440384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:32:09.440702 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:32:09.441015 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::int,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        engage_date::timestamp,
        close_date::timestamp,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline;
  );
[0m23:32:09.441545 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from raw_sales_pipeline;
                                         ^

[0m23:32:09.441862 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: ROLLBACK
[0m23:32:09.442276 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m23:32:09.443327 [debug] [Thread-1  ]: Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  syntax error at or near ";"
  LINE 21: select * from raw_sales_pipeline;
                                           ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:32:09.444176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92b46ff8-199c-475b-bcf6-7b863333af79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f79e8e0>]}
[0m23:32:09.444589 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analysis_crm_sales.crm_stg_sales_pipelines  [[31mERROR[0m in 0.03s]
[0m23:32:09.445025 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:32:09.445835 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.446123 [debug] [MainThread]: On master: BEGIN
[0m23:32:09.446382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:09.447722 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:09.447991 [debug] [MainThread]: On master: COMMIT
[0m23:32:09.448300 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:09.448571 [debug] [MainThread]: On master: COMMIT
[0m23:32:09.448943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:09.449283 [debug] [MainThread]: On master: Close
[0m23:32:09.449718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:09.450020 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:32:09.450394 [info ] [MainThread]: 
[0m23:32:09.450743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:32:09.451296 [debug] [MainThread]: Command end result
[0m23:32:09.451615 [info ] [MainThread]: 
[0m23:32:09.451972 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:09.452320 [info ] [MainThread]: 
[0m23:32:09.452669 [error] [MainThread]:   Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  syntax error at or near ";"
  LINE 21: select * from raw_sales_pipeline;
                                           ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:32:09.452986 [info ] [MainThread]: 
[0m23:32:09.453402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:32:09.454043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3593701, "process_user_time": 2.073038, "process_kernel_time": 0.069335, "process_mem_max_rss": "117692", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:09.454463 [debug] [MainThread]: Command `dbt run` failed at 23:32:09.454416 after 0.36 seconds
[0m23:32:09.454784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff707942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44deb0>]}
[0m23:32:09.455141 [debug] [MainThread]: Flushing usage events
[0m23:32:11.747023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ac22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f20760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f20700>]}


============================== 23:32:11.750216 | 3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c ==============================
[0m23:32:11.750216 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:32:11.750739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:32:11.826653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ab5ac0>]}
[0m23:32:11.850579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8535a3a0>]}
[0m23:32:11.851136 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:32:11.860909 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:32:11.970481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:11.970891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:11.991301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28b2130>]}
[0m23:32:11.997301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28d87f0>]}
[0m23:32:11.997733 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:32:11.998104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa276bb80>]}
[0m23:32:11.998962 [info ] [MainThread]: 
[0m23:32:11.999384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:11.999965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:32:12.017152 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:32:12.017530 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:32:12.017808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:12.019976 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:32:12.020727 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:32:12.023145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:32:12.026537 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:12.026857 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:32:12.027152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:12.028596 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m23:32:12.028914 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:32:12.029210 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:32:12.030409 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:32:12.031013 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:32:12.031360 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:32:12.033788 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.034083 [debug] [MainThread]: On master: BEGIN
[0m23:32:12.034359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:12.035772 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:12.036084 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.036390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:12.039663 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:32:12.040293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa294d700>]}
[0m23:32:12.040668 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:12.041046 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.041319 [debug] [MainThread]: On master: BEGIN
[0m23:32:12.041719 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:32:12.042003 [debug] [MainThread]: On master: COMMIT
[0m23:32:12.042266 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.042524 [debug] [MainThread]: On master: COMMIT
[0m23:32:12.042872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:12.043140 [debug] [MainThread]: On master: Close
[0m23:32:12.043514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:12.043828 [info ] [MainThread]: 
[0m23:32:12.047767 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:32:12.048191 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m23:32:12.048588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m23:32:12.048920 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:32:12.053257 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:32:12.054300 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:32:12.071741 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m23:32:12.072817 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:32:12.073125 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m23:32:12.073405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:32:12.074980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:32:12.075287 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:32:12.075567 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts;
  );
[0m23:32:12.075970 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from raw_accounts;
                                   ^

[0m23:32:12.076255 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: ROLLBACK
[0m23:32:12.076626 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m23:32:12.077692 [debug] [Thread-1  ]: Database Error in model crm_stg_accounts (models/crm_sales_data/staging/crm_stg_accounts.sql)
  syntax error at or near ";"
  LINE 20: select * from raw_accounts;
                                     ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_accounts.sql
[0m23:32:12.078590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e8ae1b8-bc1e-4e79-962e-ebe7a7ba092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84abecd0>]}
[0m23:32:12.079025 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model analysis_crm_sales.crm_stg_accounts ....... [[31mERROR[0m in 0.03s]
[0m23:32:12.079468 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:32:12.080292 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.080569 [debug] [MainThread]: On master: BEGIN
[0m23:32:12.080821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:12.082184 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:32:12.082463 [debug] [MainThread]: On master: COMMIT
[0m23:32:12.082728 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:12.083008 [debug] [MainThread]: On master: COMMIT
[0m23:32:12.083352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:12.083656 [debug] [MainThread]: On master: Close
[0m23:32:12.084055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:12.084682 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m23:32:12.085051 [info ] [MainThread]: 
[0m23:32:12.085389 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:32:12.085890 [debug] [MainThread]: Command end result
[0m23:32:12.086166 [info ] [MainThread]: 
[0m23:32:12.086523 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:12.086869 [info ] [MainThread]: 
[0m23:32:12.087260 [error] [MainThread]:   Database Error in model crm_stg_accounts (models/crm_sales_data/staging/crm_stg_accounts.sql)
  syntax error at or near ";"
  LINE 20: select * from raw_accounts;
                                     ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_accounts.sql
[0m23:32:12.087570 [info ] [MainThread]: 
[0m23:32:12.087983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:32:12.088573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36671263, "process_user_time": 2.059205, "process_kernel_time": 0.066811, "process_mem_max_rss": "123404", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:12.088984 [debug] [MainThread]: Command `dbt run` failed at 23:32:12.088940 after 0.37 seconds
[0m23:32:12.089306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ac22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa276bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa276beb0>]}
[0m23:32:12.089604 [debug] [MainThread]: Flushing usage events
[0m23:34:19.628318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f417790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f417730>]}


============================== 23:34:19.632299 | 08f17310-d15d-4741-88c3-c324290f1342 ==============================
[0m23:34:19.632299 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:19.632836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:34:19.714121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4b4dc0>]}
[0m23:34:19.737741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f43fe50>]}
[0m23:34:19.738394 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:19.749906 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:19.860134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:34:19.860675 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_products.sql
[0m23:34:19.861045 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_accounts.sql
[0m23:34:19.861335 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:34:19.861612 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m23:34:19.975300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad8df40>]}
[0m23:34:19.981774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada5790>]}
[0m23:34:19.982227 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:19.982569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dcb4b80>]}
[0m23:34:19.983428 [info ] [MainThread]: 
[0m23:34:19.983885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:19.984523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:34:20.008258 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:34:20.009328 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:20.010073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:20.013948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m23:34:20.014997 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:34:20.019850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:34:20.025015 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:20.025879 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:34:20.026722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:20.029427 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m23:34:20.029896 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:20.030318 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:34:20.032552 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:34:20.033965 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:34:20.034678 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:34:20.038714 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.039221 [debug] [MainThread]: On master: BEGIN
[0m23:34:20.040175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:20.043372 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:34:20.043875 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.044384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:20.050920 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:34:20.052376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada5d00>]}
[0m23:34:20.052927 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:20.053374 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.053971 [debug] [MainThread]: On master: BEGIN
[0m23:34:20.054574 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:20.054919 [debug] [MainThread]: On master: COMMIT
[0m23:34:20.055255 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.055630 [debug] [MainThread]: On master: COMMIT
[0m23:34:20.056061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:20.056387 [debug] [MainThread]: On master: Close
[0m23:34:20.057027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:20.057859 [info ] [MainThread]: 
[0m23:34:20.063107 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:34:20.063634 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m23:34:20.064122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m23:34:20.064465 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:34:20.069109 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.071272 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:34:20.098622 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.099803 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.100186 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m23:34:20.100494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:20.103409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m23:34:20.103878 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.104229 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m23:34:20.106196 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:34:20.111940 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.112597 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m23:34:20.113448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:34:20.122234 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:34:20.122834 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.123235 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:34:20.124055 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m23:34:20.129740 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup"
[0m23:34:20.132423 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:34:20.132905 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup" cascade
[0m23:34:20.133534 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:34:20.135005 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m23:34:20.135965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f17310-d15d-4741-88c3-c324290f1342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9652c3d0>]}
[0m23:34:20.136526 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_teams ........ [[32mCREATE VIEW[0m in 0.07s]
[0m23:34:20.137143 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:34:20.138349 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.138701 [debug] [MainThread]: On master: BEGIN
[0m23:34:20.138972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:20.141170 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:20.141542 [debug] [MainThread]: On master: COMMIT
[0m23:34:20.141844 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:20.142140 [debug] [MainThread]: On master: COMMIT
[0m23:34:20.142576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:20.143270 [debug] [MainThread]: On master: Close
[0m23:34:20.143745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:20.144078 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:34:20.144614 [info ] [MainThread]: 
[0m23:34:20.145239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:34:20.146376 [debug] [MainThread]: Command end result
[0m23:34:20.146708 [info ] [MainThread]: 
[0m23:34:20.147139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:20.147496 [info ] [MainThread]: 
[0m23:34:20.147892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:20.148778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.54685235, "process_user_time": 2.28113, "process_kernel_time": 0.10313, "process_mem_max_rss": "122908", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:20.149265 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:20.149208 after 0.55 seconds
[0m23:34:20.149638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f63f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada5fa0>]}
[0m23:34:20.150024 [debug] [MainThread]: Flushing usage events
[0m23:34:21.986403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f46b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d8c8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d8c8700>]}


============================== 23:34:21.989815 | bb68d964-6426-4e43-b903-ccb59fa1cc9f ==============================
[0m23:34:21.989815 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:21.990382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:22.066209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c45eac0>]}
[0m23:34:22.090261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed023a0>]}
[0m23:34:22.090838 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:22.101320 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:22.263256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:22.263700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:22.287621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c25a130>]}
[0m23:34:22.294763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c280820>]}
[0m23:34:22.295262 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:22.295673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c113b80>]}
[0m23:34:22.296592 [info ] [MainThread]: 
[0m23:34:22.297068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:22.297728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:34:22.319175 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:34:22.319703 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:22.320080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:22.322784 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:34:22.324551 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:34:22.327608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:34:22.331445 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:22.331841 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:34:22.332217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:22.334397 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:34:22.334846 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:22.335186 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:34:22.336556 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:34:22.337342 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:34:22.337720 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:34:22.340630 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.341000 [debug] [MainThread]: On master: BEGIN
[0m23:34:22.341347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:22.343265 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:22.343673 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.344074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:22.348014 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m23:34:22.348774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2f5700>]}
[0m23:34:22.349237 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:22.349692 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.350075 [debug] [MainThread]: On master: BEGIN
[0m23:34:22.350529 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:22.350819 [debug] [MainThread]: On master: COMMIT
[0m23:34:22.351105 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.351389 [debug] [MainThread]: On master: COMMIT
[0m23:34:22.351752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:22.352050 [debug] [MainThread]: On master: Close
[0m23:34:22.352475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:22.352851 [info ] [MainThread]: 
[0m23:34:22.356953 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m23:34:22.357398 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m23:34:22.357821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m23:34:22.358194 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:34:22.362671 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:34:22.363821 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:34:22.382094 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m23:34:22.383495 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:34:22.383885 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m23:34:22.384195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:22.386185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:34:22.386522 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:34:22.386831 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m23:34:22.387783 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:34:22.391098 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:34:22.391473 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m23:34:22.392014 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:34:22.399209 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:34:22.399629 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:34:22.400067 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:34:22.401114 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:34:22.404532 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup"
[0m23:34:22.406896 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:34:22.407218 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup" cascade
[0m23:34:22.407621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:34:22.409068 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m23:34:22.410151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb68d964-6426-4e43-b903-ccb59fa1cc9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd20a60>]}
[0m23:34:22.410695 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_products ........... [[32mCREATE VIEW[0m in 0.05s]
[0m23:34:22.411190 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:34:22.412083 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.412368 [debug] [MainThread]: On master: BEGIN
[0m23:34:22.412655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:22.414400 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:22.414721 [debug] [MainThread]: On master: COMMIT
[0m23:34:22.415023 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:22.415374 [debug] [MainThread]: On master: COMMIT
[0m23:34:22.416003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:22.416562 [debug] [MainThread]: On master: Close
[0m23:34:22.417057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:22.417368 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m23:34:22.417700 [info ] [MainThread]: 
[0m23:34:22.418062 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:34:22.418559 [debug] [MainThread]: Command end result
[0m23:34:22.418835 [info ] [MainThread]: 
[0m23:34:22.419191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:22.419516 [info ] [MainThread]: 
[0m23:34:22.419854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:22.420465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45821685, "process_user_time": 2.212896, "process_kernel_time": 0.071221, "process_mem_max_rss": "123612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:22.420850 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:22.420807 after 0.46 seconds
[0m23:34:22.421175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f46b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c113ee0>]}
[0m23:34:22.421491 [debug] [MainThread]: Flushing usage events
[0m23:34:25.725248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b4f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fac790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fac730>]}


============================== 23:34:25.728578 | ab535c77-8fc8-4c5d-b741-99778954469b ==============================
[0m23:34:25.728578 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:25.729217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'send_anonymous_usage_stats': 'True'}
[0m23:34:25.806361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91049dc0>]}
[0m23:34:25.832102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd4e50>]}
[0m23:34:25.832934 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:25.848723 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:25.975007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:25.975423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:25.994375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf945dc0>]}
[0m23:34:25.999844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf961a30>]}
[0m23:34:26.000251 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:26.000631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7fbb80>]}
[0m23:34:26.001447 [info ] [MainThread]: 
[0m23:34:26.001911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:26.002565 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:34:26.020301 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:34:26.020732 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:26.021050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:26.023482 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:34:26.024184 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:34:26.026557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:34:26.033572 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:26.034118 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:34:26.034714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:26.037369 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m23:34:26.037762 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:26.038137 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:34:26.039410 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:34:26.040173 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:34:26.040655 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:34:26.043916 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.044296 [debug] [MainThread]: On master: BEGIN
[0m23:34:26.044615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:26.046361 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:26.046672 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.047069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:26.051160 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m23:34:26.051905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9e0250>]}
[0m23:34:26.052290 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:26.052680 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.052979 [debug] [MainThread]: On master: BEGIN
[0m23:34:26.053427 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:26.053712 [debug] [MainThread]: On master: COMMIT
[0m23:34:26.053976 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.054248 [debug] [MainThread]: On master: COMMIT
[0m23:34:26.054609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:26.054904 [debug] [MainThread]: On master: Close
[0m23:34:26.055318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:26.055640 [info ] [MainThread]: 
[0m23:34:26.060039 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:34:26.060488 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m23:34:26.060909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m23:34:26.061255 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:34:26.065465 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:34:26.067533 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:34:26.087748 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m23:34:26.090341 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:34:26.091152 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m23:34:26.091955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:26.094225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:34:26.094698 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:34:26.095168 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m23:34:26.096487 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:34:26.101380 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:34:26.101867 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m23:34:26.102650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:34:26.111929 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:34:26.112506 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:34:26.112972 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:34:26.116605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m23:34:26.122295 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup"
[0m23:34:26.125852 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:34:26.126318 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup" cascade
[0m23:34:26.126877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:34:26.128480 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m23:34:26.129635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab535c77-8fc8-4c5d-b741-99778954469b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf35ea90>]}
[0m23:34:26.130285 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_accounts ........... [[32mCREATE VIEW[0m in 0.07s]
[0m23:34:26.130792 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:34:26.131794 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.132285 [debug] [MainThread]: On master: BEGIN
[0m23:34:26.132718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:26.134817 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:26.135262 [debug] [MainThread]: On master: COMMIT
[0m23:34:26.135636 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:26.136020 [debug] [MainThread]: On master: COMMIT
[0m23:34:26.136522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:26.136913 [debug] [MainThread]: On master: Close
[0m23:34:26.137373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:26.137736 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m23:34:26.138130 [info ] [MainThread]: 
[0m23:34:26.138669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m23:34:26.139346 [debug] [MainThread]: Command end result
[0m23:34:26.139762 [info ] [MainThread]: 
[0m23:34:26.140302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:26.141492 [info ] [MainThread]: 
[0m23:34:26.142533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:26.143440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44405162, "process_user_time": 2.279179, "process_kernel_time": 0.084525, "process_mem_max_rss": "119092", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:26.143874 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:26.143825 after 0.44 seconds
[0m23:34:26.144282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b4f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911d4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7fbf10>]}
[0m23:34:26.144651 [debug] [MainThread]: Flushing usage events
[0m23:34:29.525795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928c12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d7d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d7d700>]}


============================== 23:34:29.529787 | 6c514054-a329-4889-bf00-858cb1311e45 ==============================
[0m23:34:29.529787 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:29.530344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'send_anonymous_usage_stats': 'True'}
[0m23:34:29.610880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8c5ac0>]}
[0m23:34:29.636414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921b73a0>]}
[0m23:34:29.637215 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:29.648567 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:29.766375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:29.766833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:29.786466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6c2130>]}
[0m23:34:29.792580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6e9820>]}
[0m23:34:29.793029 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:29.793422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf57eb80>]}
[0m23:34:29.794270 [info ] [MainThread]: 
[0m23:34:29.794735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:29.795397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:34:29.814412 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:34:29.814916 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:29.815314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:29.818607 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:34:29.819450 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:34:29.822335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:34:29.826254 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:29.826667 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:34:29.826980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:29.828914 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:34:29.829208 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:29.829499 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:34:29.830764 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m23:34:29.831516 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:34:29.831905 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:34:29.834854 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.835222 [debug] [MainThread]: On master: BEGIN
[0m23:34:29.835528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:29.837214 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:29.837551 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.837896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:29.842440 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:34:29.843273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf45b9a0>]}
[0m23:34:29.843632 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:29.844031 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.844379 [debug] [MainThread]: On master: BEGIN
[0m23:34:29.844815 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:29.845101 [debug] [MainThread]: On master: COMMIT
[0m23:34:29.845374 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.845637 [debug] [MainThread]: On master: COMMIT
[0m23:34:29.845982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:29.846285 [debug] [MainThread]: On master: Close
[0m23:34:29.846658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:29.846998 [info ] [MainThread]: 
[0m23:34:29.851095 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:34:29.851546 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m23:34:29.851925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m23:34:29.852246 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:34:29.856568 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.857655 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:34:29.875628 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.876789 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.877109 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m23:34:29.877412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:29.879135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:34:29.879509 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.879825 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::int,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        engage_date::timestamp,
        close_date::timestamp,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m23:34:29.881234 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:34:29.884599 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.884903 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m23:34:29.885352 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:34:29.892472 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:34:29.892793 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.893106 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:34:29.894054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:34:29.897171 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup"
[0m23:34:29.899479 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:34:29.899784 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m23:34:29.900180 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:34:29.901355 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m23:34:29.902269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c514054-a329-4889-bf00-858cb1311e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0e2be0>]}
[0m23:34:29.902742 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_pipelines .... [[32mCREATE VIEW[0m in 0.05s]
[0m23:34:29.903208 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:34:29.904017 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.904313 [debug] [MainThread]: On master: BEGIN
[0m23:34:29.904579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:29.906149 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:34:29.906511 [debug] [MainThread]: On master: COMMIT
[0m23:34:29.906796 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:29.907074 [debug] [MainThread]: On master: COMMIT
[0m23:34:29.907420 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:29.907713 [debug] [MainThread]: On master: Close
[0m23:34:29.908085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:29.908691 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:34:29.908994 [info ] [MainThread]: 
[0m23:34:29.909343 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:34:29.909873 [debug] [MainThread]: Command end result
[0m23:34:29.910155 [info ] [MainThread]: 
[0m23:34:29.910505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:29.910821 [info ] [MainThread]: 
[0m23:34:29.911170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:29.911740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41221142, "process_user_time": 2.092332, "process_kernel_time": 0.090708, "process_mem_max_rss": "122124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:29.912123 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:29.912081 after 0.41 seconds
[0m23:34:29.912428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928c12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921b73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf57eee0>]}
[0m23:34:29.912728 [debug] [MainThread]: Flushing usage events
[0m23:34:31.888323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df2a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5257f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c525790>]}


============================== 23:34:31.891723 | 9cabd4ce-c74b-4453-8d90-45249f4e6eaf ==============================
[0m23:34:31.891723 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:31.892279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:34:31.966150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cabd4ce-c74b-4453-8d90-45249f4e6eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd968b0>]}
[0m23:34:31.988909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cabd4ce-c74b-4453-8d90-45249f4e6eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6da190>]}
[0m23:34:31.989479 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:31.999120 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:32.109075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:32.109489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:32.127980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cabd4ce-c74b-4453-8d90-45249f4e6eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c01130>]}
[0m23:34:32.137780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cabd4ce-c74b-4453-8d90-45249f4e6eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aa7c10>]}
[0m23:34:32.138180 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:32.138580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cabd4ce-c74b-4453-8d90-45249f4e6eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadbf7f0>]}
[0m23:34:32.139293 [info ] [MainThread]: 
[0m23:34:32.139650 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:34:32.140671 [debug] [MainThread]: Command end result
[0m23:34:32.141184 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.27721363, "process_user_time": 1.996468, "process_kernel_time": 0.054202, "process_mem_max_rss": "119812", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:32.141583 [debug] [MainThread]: Command `dbt test` succeeded at 23:34:32.141535 after 0.28 seconds
[0m23:34:32.141904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df2a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6da190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadbfee0>]}
[0m23:34:32.142226 [debug] [MainThread]: Flushing usage events
[0m23:34:35.527156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff628be760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff628be700>]}


============================== 23:34:35.530606 | a01b5ad7-fa97-4baf-a4bc-6da9402e705f ==============================
[0m23:34:35.530606 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:35.531161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:34:35.606076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01b5ad7-fa97-4baf-a4bc-6da9402e705f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81454ac0>]}
[0m23:34:35.629625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01b5ad7-fa97-4baf-a4bc-6da9402e705f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cfa3a0>]}
[0m23:34:35.630185 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:35.640136 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:35.753982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:35.754443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:35.773406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01b5ad7-fa97-4baf-a4bc-6da9402e705f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81252130>]}
[0m23:34:35.784366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a01b5ad7-fa97-4baf-a4bc-6da9402e705f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e9dd30>]}
[0m23:34:35.784882 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:35.785253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01b5ad7-fa97-4baf-a4bc-6da9402e705f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811087c0>]}
[0m23:34:35.786024 [info ] [MainThread]: 
[0m23:34:35.786440 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:34:35.787619 [debug] [MainThread]: Command end result
[0m23:34:35.788234 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.285297, "process_user_time": 1.971907, "process_kernel_time": 0.079197, "process_mem_max_rss": "115708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:35.788689 [debug] [MainThread]: Command `dbt test` succeeded at 23:34:35.788636 after 0.29 seconds
[0m23:34:35.789069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cfa3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81108eb0>]}
[0m23:34:35.789422 [debug] [MainThread]: Flushing usage events
[0m23:34:37.571537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b26730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b266d0>]}


============================== 23:34:37.575503 | b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb ==============================
[0m23:34:37.575503 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:37.576059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:37.658499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b4e5e0>]}
[0m23:34:37.684662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65d6f40>]}
[0m23:34:37.685381 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:37.696413 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:37.818670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:37.819126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:37.838781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64ba130>]}
[0m23:34:37.849807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6106700>]}
[0m23:34:37.850288 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:37.850765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b15a0ed8-4dfe-4205-be6f-d2a65fcb05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63708b0>]}
[0m23:34:37.851744 [info ] [MainThread]: 
[0m23:34:37.852146 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:34:37.853517 [debug] [MainThread]: Command end result
[0m23:34:37.854123 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.31216693, "process_user_time": 2.088029, "process_kernel_time": 0.062209, "process_mem_max_rss": "116452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:37.854550 [debug] [MainThread]: Command `dbt test` succeeded at 23:34:37.854497 after 0.31 seconds
[0m23:34:37.854901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b58130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6370ee0>]}
[0m23:34:37.855264 [debug] [MainThread]: Flushing usage events
[0m23:34:39.489787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff668f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d4f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d4f6a0>]}


============================== 23:34:39.493024 | 464f1222-825a-435f-ae5c-1a7c23717d8b ==============================
[0m23:34:39.493024 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:39.493610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'send_anonymous_usage_stats': 'True'}
[0m23:34:39.575000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6674f100>]}
[0m23:34:39.598345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f76af0>]}
[0m23:34:39.598913 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:39.608834 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:39.708474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:39.708872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:39.727375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836e1130>]}
[0m23:34:39.738860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837077f0>]}
[0m23:34:39.739205 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:39.742628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8359aaf0>]}
[0m23:34:39.744278 [info ] [MainThread]: 
[0m23:34:39.747826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:39.748570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:34:39.765913 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:34:39.766311 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:34:39.766626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:39.768932 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:34:39.769647 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:34:39.772065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:34:39.775523 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:39.775830 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:34:39.776120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:39.777635 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:34:39.777938 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:34:39.778265 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:34:39.779530 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:34:39.780249 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:34:39.780600 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:34:39.783399 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.783655 [debug] [MainThread]: On master: BEGIN
[0m23:34:39.783864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:39.785170 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:34:39.785423 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.785682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:39.790263 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:34:39.790997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83479970>]}
[0m23:34:39.791328 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:39.791649 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.791940 [debug] [MainThread]: On master: BEGIN
[0m23:34:39.792346 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:34:39.792600 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.792814 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.793027 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.793306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:39.793529 [debug] [MainThread]: On master: Close
[0m23:34:39.793836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:39.794281 [info ] [MainThread]: 
[0m23:34:39.798119 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:34:39.798529 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m23:34:39.798935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m23:34:39.799262 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:34:39.803897 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:34:39.807143 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:34:39.827184 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m23:34:39.828200 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:34:39.828487 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m23:34:39.828732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:34:39.830394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:34:39.830692 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:34:39.831001 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m23:34:39.831670 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column st.team_name does not exist
LINE 17:         st.team_name,
                 ^

[0m23:34:39.831954 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: ROLLBACK
[0m23:34:39.832361 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m23:34:39.833541 [debug] [Thread-1  ]: Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  column st.team_name does not exist
  LINE 17:         st.team_name,
                   ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:34:39.834379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464f1222-825a-435f-ae5c-1a7c23717d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6589d8e0>]}
[0m23:34:39.834776 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analysis_crm_sales.crm_performance ....... [[31mERROR[0m in 0.03s]
[0m23:34:39.835310 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:34:39.836080 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.836357 [debug] [MainThread]: On master: BEGIN
[0m23:34:39.836631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:39.838015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:34:39.838299 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.838553 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:39.838774 [debug] [MainThread]: On master: COMMIT
[0m23:34:39.839047 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:34:39.839337 [debug] [MainThread]: On master: Close
[0m23:34:39.839823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:39.840165 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:34:39.840443 [info ] [MainThread]: 
[0m23:34:39.840851 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m23:34:39.841355 [debug] [MainThread]: Command end result
[0m23:34:39.841601 [info ] [MainThread]: 
[0m23:34:39.841940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:34:39.842263 [info ] [MainThread]: 
[0m23:34:39.842643 [error] [MainThread]:   Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  column st.team_name does not exist
  LINE 17:         st.team_name,
                   ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:34:39.843019 [info ] [MainThread]: 
[0m23:34:39.843416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:34:39.843973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.378663, "process_user_time": 2.067805, "process_kernel_time": 0.04909, "process_mem_max_rss": "120176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:39.844460 [debug] [MainThread]: Command `dbt run` failed at 23:34:39.844417 after 0.38 seconds
[0m23:34:39.844803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff668f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f76af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8359adc0>]}
[0m23:34:39.845055 [debug] [MainThread]: Flushing usage events
[0m23:34:41.524063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d7a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d7a6a0>]}


============================== 23:34:41.527440 | db99e987-87b1-4943-ba5c-f649a2019159 ==============================
[0m23:34:41.527440 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:34:41.528043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:34:41.607818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db99e987-87b1-4943-ba5c-f649a2019159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7677b100>]}
[0m23:34:41.631759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db99e987-87b1-4943-ba5c-f649a2019159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74fa2af0>]}
[0m23:34:41.632331 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:34:41.641798 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:34:41.738544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:41.738889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:41.757420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db99e987-87b1-4943-ba5c-f649a2019159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936bf130>]}
[0m23:34:41.767822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db99e987-87b1-4943-ba5c-f649a2019159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9330ac40>]}
[0m23:34:41.768210 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:34:41.768657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db99e987-87b1-4943-ba5c-f649a2019159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93578850>]}
[0m23:34:41.769336 [info ] [MainThread]: 
[0m23:34:41.769700 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:34:41.770704 [debug] [MainThread]: Command end result
[0m23:34:41.771165 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2712552, "process_user_time": 1.990859, "process_kernel_time": 0.052818, "process_mem_max_rss": "116600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:41.771544 [debug] [MainThread]: Command `dbt test` succeeded at 23:34:41.771499 after 0.27 seconds
[0m23:34:41.771840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9383ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93578dc0>]}
[0m23:34:41.772094 [debug] [MainThread]: Flushing usage events
[0m23:38:19.703369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f712e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872c2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872c26a0>]}


============================== 23:38:19.709962 | 30870892-fcdb-4be2-b705-162a27462e6e ==============================
[0m23:38:19.709962 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:38:19.710721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:38:19.829355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88879b20>]}
[0m23:38:19.859699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5edad60>]}
[0m23:38:19.860427 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:38:19.871711 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:38:19.987481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:19.988007 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/analysis/crm_performance.sql
[0m23:38:20.096541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d94130>]}
[0m23:38:20.102249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2dab250>]}
[0m23:38:20.102611 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:38:20.103009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c20eb0>]}
[0m23:38:20.103756 [info ] [MainThread]: 
[0m23:38:20.104169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:20.104715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:38:20.121582 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:38:20.122009 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:38:20.122452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:20.126399 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m23:38:20.127162 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:38:20.129912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:38:20.133516 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:38:20.133826 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:38:20.134129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:20.135919 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:38:20.136255 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:38:20.136551 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:38:20.138245 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:38:20.138947 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:38:20.139348 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:38:20.142236 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.142522 [debug] [MainThread]: On master: BEGIN
[0m23:38:20.142776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:20.144232 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:38:20.144516 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.144802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:38:20.149720 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m23:38:20.150432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dee5e20>]}
[0m23:38:20.150747 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:20.151100 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.151352 [debug] [MainThread]: On master: BEGIN
[0m23:38:20.151730 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:38:20.151976 [debug] [MainThread]: On master: COMMIT
[0m23:38:20.152263 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.152520 [debug] [MainThread]: On master: COMMIT
[0m23:38:20.152820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:38:20.153091 [debug] [MainThread]: On master: Close
[0m23:38:20.153402 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:20.153703 [info ] [MainThread]: 
[0m23:38:20.157732 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:38:20.158157 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m23:38:20.158569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m23:38:20.158928 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:38:20.163456 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:38:20.165868 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:38:20.183951 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m23:38:20.185370 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:38:20.185672 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m23:38:20.185977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:38:20.187890 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:38:20.188191 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:38:20.188539 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.manager || ' | ' || st.regional_office AS team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m23:38:20.193183 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type integer: "1C1I7A6R"

[0m23:38:20.193513 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: ROLLBACK
[0m23:38:20.193969 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m23:38:20.195166 [debug] [Thread-1  ]: Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type integer: "1C1I7A6R"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:38:20.196034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30870892-fcdb-4be2-b705-162a27462e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f8f2e0>]}
[0m23:38:20.196534 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analysis_crm_sales.crm_performance ....... [[31mERROR[0m in 0.04s]
[0m23:38:20.197016 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:38:20.197839 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.198104 [debug] [MainThread]: On master: BEGIN
[0m23:38:20.198362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:20.199834 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:38:20.200078 [debug] [MainThread]: On master: COMMIT
[0m23:38:20.200324 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:20.200573 [debug] [MainThread]: On master: COMMIT
[0m23:38:20.200875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:38:20.201101 [debug] [MainThread]: On master: Close
[0m23:38:20.201392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:20.201617 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:38:20.201849 [info ] [MainThread]: 
[0m23:38:20.202142 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:38:20.202558 [debug] [MainThread]: Command end result
[0m23:38:20.202786 [info ] [MainThread]: 
[0m23:38:20.203068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:20.203350 [info ] [MainThread]: 
[0m23:38:20.203639 [error] [MainThread]:   Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type integer: "1C1I7A6R"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:38:20.203947 [info ] [MainThread]: 
[0m23:38:20.204257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:38:20.204772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.54384744, "process_user_time": 2.313467, "process_kernel_time": 0.140963, "process_mem_max_rss": "122584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:38:20.205159 [debug] [MainThread]: Command `dbt run` failed at 23:38:20.205111 after 0.54 seconds
[0m23:38:20.205463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f712e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2dab2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2dabee0>]}
[0m23:38:20.205720 [debug] [MainThread]: Flushing usage events
[0m23:54:41.259245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f7e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f7e730>]}


============================== 23:54:41.262959 | 4f829216-8502-49d2-8db5-2d258499ef20 ==============================
[0m23:54:41.262959 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:41.263505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'send_anonymous_usage_stats': 'True'}
[0m23:54:41.351671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a01adc0>]}
[0m23:54:41.375853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79fa5e50>]}
[0m23:54:41.376512 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:41.387810 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:41.511565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:54:41.512225 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m23:54:41.512585 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:54:41.512937 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/analysis/crm_performance.sql
[0m23:54:41.670634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93945130>]}
[0m23:54:41.681551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939567f0>]}
[0m23:54:41.682650 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:41.683099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987ccb80>]}
[0m23:54:41.684135 [info ] [MainThread]: 
[0m23:54:41.684670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:41.685340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:54:41.706739 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:54:41.707226 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:54:41.707518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:41.710962 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:54:41.711774 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:54:41.714882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:54:41.718859 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:41.719205 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:54:41.719472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:41.721767 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:54:41.722141 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:41.722414 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:54:41.724284 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:54:41.725023 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:54:41.725390 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:54:41.728480 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.728913 [debug] [MainThread]: On master: BEGIN
[0m23:54:41.729211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:41.731543 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:41.731912 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.732272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:41.736388 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:54:41.737128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93956d60>]}
[0m23:54:41.737533 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:41.738002 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.738349 [debug] [MainThread]: On master: BEGIN
[0m23:54:41.738897 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:41.739200 [debug] [MainThread]: On master: COMMIT
[0m23:54:41.739532 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.739839 [debug] [MainThread]: On master: COMMIT
[0m23:54:41.740248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:41.740535 [debug] [MainThread]: On master: Close
[0m23:54:41.740945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:41.741258 [info ] [MainThread]: 
[0m23:54:41.745908 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m23:54:41.746346 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m23:54:41.746940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m23:54:41.747303 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:54:41.751637 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:54:41.753088 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:54:41.770293 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m23:54:41.771915 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:54:41.772251 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m23:54:41.772564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:54:41.774504 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:54:41.774853 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:54:41.775162 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m23:54:41.776580 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:54:41.780818 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:54:41.781166 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m23:54:41.781632 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:54:41.788847 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:54:41.789305 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:54:41.789637 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:54:41.791058 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:54:41.794520 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup"
[0m23:54:41.796846 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:54:41.797203 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup" cascade
[0m23:54:41.797655 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:54:41.798970 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m23:54:41.799902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f829216-8502-49d2-8db5-2d258499ef20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff910e43d0>]}
[0m23:54:41.800380 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_products ........... [[32mCREATE VIEW[0m in 0.05s]
[0m23:54:41.800880 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:54:41.801786 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.802089 [debug] [MainThread]: On master: BEGIN
[0m23:54:41.802367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:41.804278 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:41.804646 [debug] [MainThread]: On master: COMMIT
[0m23:54:41.804940 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:41.805215 [debug] [MainThread]: On master: COMMIT
[0m23:54:41.805586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:41.805881 [debug] [MainThread]: On master: Close
[0m23:54:41.806246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:41.806571 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m23:54:41.806939 [info ] [MainThread]: 
[0m23:54:41.807304 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:54:41.807779 [debug] [MainThread]: Command end result
[0m23:54:41.808077 [info ] [MainThread]: 
[0m23:54:41.808434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:41.808769 [info ] [MainThread]: 
[0m23:54:41.809106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:41.809806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5743512, "process_user_time": 2.236979, "process_kernel_time": 0.114613, "process_mem_max_rss": "125048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:41.810235 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:41.810173 after 0.57 seconds
[0m23:54:41.810584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1a5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93956e80>]}
[0m23:54:41.810902 [debug] [MainThread]: Flushing usage events
[0m23:54:43.814588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c45d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c45d700>]}


============================== 23:54:43.817993 | 1f26c716-dc8c-445d-be4e-9ad06a3e9aed ==============================
[0m23:54:43.817993 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:43.818589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:43.894805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6119a0>]}
[0m23:54:43.921066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c48ef10>]}
[0m23:54:43.921808 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:43.932424 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:44.048996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:44.049444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:44.068760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadef130>]}
[0m23:54:44.074678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae15820>]}
[0m23:54:44.075104 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:44.075511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacabb20>]}
[0m23:54:44.076386 [info ] [MainThread]: 
[0m23:54:44.076872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:44.077550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:54:44.096105 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:54:44.096562 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:54:44.096905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:44.099655 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:54:44.100426 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:54:44.103130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:54:44.106810 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:44.107154 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:54:44.107474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:44.109549 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:54:44.109868 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:44.110226 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:54:44.111751 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m23:54:44.112508 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:54:44.112915 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:54:44.115953 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.116325 [debug] [MainThread]: On master: BEGIN
[0m23:54:44.116648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:44.118455 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:44.118805 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.119166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:44.123064 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m23:54:44.123825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae4d8e0>]}
[0m23:54:44.124239 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:44.124638 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.124929 [debug] [MainThread]: On master: BEGIN
[0m23:54:44.125342 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:44.125679 [debug] [MainThread]: On master: COMMIT
[0m23:54:44.125993 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.126281 [debug] [MainThread]: On master: COMMIT
[0m23:54:44.126660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:44.126984 [debug] [MainThread]: On master: Close
[0m23:54:44.127389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:44.127798 [info ] [MainThread]: 
[0m23:54:44.131869 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:54:44.132325 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m23:54:44.132760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m23:54:44.133092 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:54:44.137576 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:54:44.138680 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:54:44.156941 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m23:54:44.158344 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:54:44.158711 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m23:54:44.159055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:54:44.161140 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:54:44.161531 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:54:44.161890 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m23:54:44.163046 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:54:44.166593 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:54:44.166925 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m23:54:44.167394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:54:44.174783 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:54:44.175167 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:54:44.175497 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:54:44.176431 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:54:44.179946 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup"
[0m23:54:44.182395 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:54:44.182725 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup" cascade
[0m23:54:44.183171 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:54:44.184446 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m23:54:44.185349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f26c716-dc8c-445d-be4e-9ad06a3e9aed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8b5a60>]}
[0m23:54:44.185867 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_accounts ........... [[32mCREATE VIEW[0m in 0.05s]
[0m23:54:44.186334 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:54:44.187232 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.187539 [debug] [MainThread]: On master: BEGIN
[0m23:54:44.187832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:44.189859 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:44.190234 [debug] [MainThread]: On master: COMMIT
[0m23:54:44.190543 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:44.190833 [debug] [MainThread]: On master: COMMIT
[0m23:54:44.191207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:44.191503 [debug] [MainThread]: On master: Close
[0m23:54:44.191864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:44.192146 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m23:54:44.192460 [info ] [MainThread]: 
[0m23:54:44.192861 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:54:44.193355 [debug] [MainThread]: Command end result
[0m23:54:44.193703 [info ] [MainThread]: 
[0m23:54:44.194068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:44.194382 [info ] [MainThread]: 
[0m23:54:44.194722 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:44.195330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4045615, "process_user_time": 2.093605, "process_kernel_time": 0.068477, "process_mem_max_rss": "122768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:44.195768 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:44.195721 after 0.41 seconds
[0m23:54:44.196112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9479a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacabeb0>]}
[0m23:54:44.196455 [debug] [MainThread]: Flushing usage events
[0m23:54:45.817360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b2c22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9977e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9977e730>]}


============================== 23:54:45.821166 | 0b72a783-882a-4dbe-b07c-ba51e60eed37 ==============================
[0m23:54:45.821166 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:45.821736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:45.897803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99819dc0>]}
[0m23:54:45.921106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997a6e50>]}
[0m23:54:45.921663 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:45.931804 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:46.041983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:46.042401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:46.061137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80c9dc0>]}
[0m23:54:46.066385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80e1fa0>]}
[0m23:54:46.066802 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:46.067195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f7fb80>]}
[0m23:54:46.067989 [info ] [MainThread]: 
[0m23:54:46.068443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:46.069054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:54:46.085826 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:54:46.086236 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:54:46.086552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:46.088945 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:54:46.089776 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:54:46.092289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:54:46.095759 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:46.096097 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:54:46.096387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:46.098080 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:54:46.098365 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:46.098649 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:54:46.099955 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m23:54:46.100650 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:54:46.101002 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:54:46.103774 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.104077 [debug] [MainThread]: On master: BEGIN
[0m23:54:46.104352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:46.105869 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:46.106151 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.106473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:46.110371 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m23:54:46.111077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e3c100>]}
[0m23:54:46.111426 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:46.111802 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.112076 [debug] [MainThread]: On master: BEGIN
[0m23:54:46.112485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:46.112790 [debug] [MainThread]: On master: COMMIT
[0m23:54:46.113055 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.113314 [debug] [MainThread]: On master: COMMIT
[0m23:54:46.113701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:46.114008 [debug] [MainThread]: On master: Close
[0m23:54:46.114381 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:46.114706 [info ] [MainThread]: 
[0m23:54:46.118826 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:54:46.119269 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m23:54:46.119682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m23:54:46.120014 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:54:46.124318 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.125470 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:54:46.143449 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.144583 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.144901 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m23:54:46.145204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:54:46.147107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:54:46.147430 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.147774 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        engage_date::timestamp,
        close_date::timestamp,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m23:54:46.149187 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:54:46.152448 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.152764 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m23:54:46.153169 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:54:46.160352 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:54:46.160703 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.160972 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:54:46.161791 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m23:54:46.164834 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup"
[0m23:54:46.167010 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:54:46.167301 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m23:54:46.167661 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:54:46.168950 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m23:54:46.169881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b72a783-882a-4dbe-b07c-ba51e60eed37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a7bb80>]}
[0m23:54:46.170359 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_pipelines .... [[32mCREATE VIEW[0m in 0.05s]
[0m23:54:46.170856 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:54:46.171734 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.172027 [debug] [MainThread]: On master: BEGIN
[0m23:54:46.172280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:46.173914 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:46.174209 [debug] [MainThread]: On master: COMMIT
[0m23:54:46.174515 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:46.174799 [debug] [MainThread]: On master: COMMIT
[0m23:54:46.175166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:46.175479 [debug] [MainThread]: On master: Close
[0m23:54:46.175856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:46.176166 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:54:46.176475 [info ] [MainThread]: 
[0m23:54:46.176842 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:54:46.177308 [debug] [MainThread]: Command end result
[0m23:54:46.177625 [info ] [MainThread]: 
[0m23:54:46.178013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:46.178341 [info ] [MainThread]: 
[0m23:54:46.178677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:46.179292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.38919026, "process_user_time": 2.087609, "process_kernel_time": 0.055935, "process_mem_max_rss": "118760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:46.179696 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:46.179650 after 0.39 seconds
[0m23:54:46.180014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b2c22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999a6400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80e1fd0>]}
[0m23:54:46.180322 [debug] [MainThread]: Flushing usage events
[0m23:54:48.176715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72a532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71050790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71050730>]}


============================== 23:54:48.180122 | 685df66e-7786-44d0-8f56-4b8607525673 ==============================
[0m23:54:48.180122 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:48.180660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:54:48.255165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710ecdc0>]}
[0m23:54:48.278973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71077e50>]}
[0m23:54:48.279561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:48.289817 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:48.400457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:48.400889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:48.418769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f75bdc0>]}
[0m23:54:48.424065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f773fa0>]}
[0m23:54:48.424451 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:48.424858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8ecb80>]}
[0m23:54:48.425653 [info ] [MainThread]: 
[0m23:54:48.426116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:48.426736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:54:48.443612 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:54:48.444022 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:54:48.444321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:48.446579 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:54:48.447277 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:54:48.449731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:54:48.453248 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:48.453568 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:54:48.453872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:54:48.455451 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:54:48.455766 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:54:48.456098 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:54:48.457296 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m23:54:48.458021 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:54:48.458377 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:54:48.461153 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.461461 [debug] [MainThread]: On master: BEGIN
[0m23:54:48.461802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:48.463264 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:54:48.463550 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.463866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:48.468003 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:54:48.468721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7a9100>]}
[0m23:54:48.469064 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:48.469411 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.469703 [debug] [MainThread]: On master: BEGIN
[0m23:54:48.470097 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:48.470370 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.470675 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.470963 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.471305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:48.471595 [debug] [MainThread]: On master: Close
[0m23:54:48.471967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:48.472271 [info ] [MainThread]: 
[0m23:54:48.476063 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:54:48.476521 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m23:54:48.476933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m23:54:48.477243 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:54:48.481478 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.482539 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:54:48.499722 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.500902 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.501235 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m23:54:48.501565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:54:48.503366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:54:48.503699 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.504059 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || ' | ' || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m23:54:48.505066 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:54:48.508380 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.508704 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m23:54:48.509125 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:54:48.516401 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:54:48.516777 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.517110 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:54:48.517750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m23:54:48.520905 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup"
[0m23:54:48.523101 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:54:48.523409 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup" cascade
[0m23:54:48.523826 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:54:48.525055 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m23:54:48.525971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '685df66e-7786-44d0-8f56-4b8607525673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3d0c70>]}
[0m23:54:48.526447 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_teams ........ [[32mCREATE VIEW[0m in 0.05s]
[0m23:54:48.526917 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:54:48.527753 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.528087 [debug] [MainThread]: On master: BEGIN
[0m23:54:48.528366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:48.530048 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:54:48.530328 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.530620 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:48.530897 [debug] [MainThread]: On master: COMMIT
[0m23:54:48.531252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:48.531538 [debug] [MainThread]: On master: Close
[0m23:54:48.531899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:48.532202 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:54:48.532517 [info ] [MainThread]: 
[0m23:54:48.532857 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:54:48.533337 [debug] [MainThread]: Command end result
[0m23:54:48.533621 [info ] [MainThread]: 
[0m23:54:48.533978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:48.534312 [info ] [MainThread]: 
[0m23:54:48.534664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:54:48.535229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.38341337, "process_user_time": 2.057465, "process_kernel_time": 0.07728, "process_mem_max_rss": "117568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:48.535662 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:48.535619 after 0.38 seconds
[0m23:54:48.535981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72a532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71277400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f773fd0>]}
[0m23:54:48.536290 [debug] [MainThread]: Flushing usage events
[0m23:54:51.250459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b207730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2076d0>]}


============================== 23:54:51.254237 | bfac4b2f-df28-4410-8ddd-4ebedb459998 ==============================
[0m23:54:51.254237 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:51.254861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'send_anonymous_usage_stats': 'True'}
[0m23:54:51.332808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfac4b2f-df28-4410-8ddd-4ebedb459998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b22f5e0>]}
[0m23:54:51.355870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfac4b2f-df28-4410-8ddd-4ebedb459998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb7f40>]}
[0m23:54:51.356498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:51.366773 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:51.477401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:51.477851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:51.496732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfac4b2f-df28-4410-8ddd-4ebedb459998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b9b130>]}
[0m23:54:51.506966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfac4b2f-df28-4410-8ddd-4ebedb459998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997e6e50>]}
[0m23:54:51.507377 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:51.507775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfac4b2f-df28-4410-8ddd-4ebedb459998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a548b0>]}
[0m23:54:51.508449 [info ] [MainThread]: 
[0m23:54:51.508824 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:54:51.509911 [debug] [MainThread]: Command end result
[0m23:54:51.510397 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2850896, "process_user_time": 2.003394, "process_kernel_time": 0.072868, "process_mem_max_rss": "112168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:51.510815 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:51.510761 after 0.29 seconds
[0m23:54:51.511132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b239130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a54ee0>]}
[0m23:54:51.511443 [debug] [MainThread]: Flushing usage events
[0m23:54:53.849738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff685d82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66a35760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66a35700>]}


============================== 23:54:53.853087 | 472f8890-f7bb-4320-811f-91b72f0fe69f ==============================
[0m23:54:53.853087 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:53.853638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:54:53.926695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '472f8890-f7bb-4320-811f-91b72f0fe69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855caac0>]}
[0m23:54:53.949465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '472f8890-f7bb-4320-811f-91b72f0fe69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67e6f3a0>]}
[0m23:54:53.950069 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:53.960148 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:54.069500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:54.069919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:54.087803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '472f8890-f7bb-4320-811f-91b72f0fe69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853c8130>]}
[0m23:54:54.097297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '472f8890-f7bb-4320-811f-91b72f0fe69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85014d30>]}
[0m23:54:54.097702 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:54.098096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '472f8890-f7bb-4320-811f-91b72f0fe69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8527e7c0>]}
[0m23:54:54.098778 [info ] [MainThread]: 
[0m23:54:54.099125 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:54:54.100135 [debug] [MainThread]: Command end result
[0m23:54:54.100625 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.27496484, "process_user_time": 1.97915, "process_kernel_time": 0.062161, "process_mem_max_rss": "119084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:54.101034 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:54.100990 after 0.28 seconds
[0m23:54:54.101357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff685d82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67e6f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8527eeb0>]}
[0m23:54:54.101683 [debug] [MainThread]: Flushing usage events
[0m23:54:55.823819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff629857f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62985790>]}


============================== 23:54:55.827573 | 3c353303-fc54-44ce-a7e4-785108b9e9bf ==============================
[0m23:54:55.827573 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:55.828149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'send_anonymous_usage_stats': 'True'}
[0m23:54:55.904425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c353303-fc54-44ce-a7e4-785108b9e9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643378b0>]}
[0m23:54:55.930202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c353303-fc54-44ce-a7e4-785108b9e9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b3b190>]}
[0m23:54:55.930953 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:55.941011 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:56.049740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:56.050157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:56.067998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c353303-fc54-44ce-a7e4-785108b9e9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812cb130>]}
[0m23:54:56.077536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c353303-fc54-44ce-a7e4-785108b9e9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f16cd0>]}
[0m23:54:56.077919 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:56.078271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c353303-fc54-44ce-a7e4-785108b9e9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811847f0>]}
[0m23:54:56.078950 [info ] [MainThread]: 
[0m23:54:56.079313 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:54:56.080304 [debug] [MainThread]: Command end result
[0m23:54:56.080817 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.281598, "process_user_time": 1.961665, "process_kernel_time": 0.065121, "process_mem_max_rss": "115004", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:56.081260 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:56.081215 after 0.28 seconds
[0m23:54:56.081585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff644ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b3b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81184ee0>]}
[0m23:54:56.081902 [debug] [MainThread]: Flushing usage events
[0m23:54:57.839338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d6072e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc02790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc02730>]}


============================== 23:54:57.843612 | 04a517e5-2a5e-4dd0-8b02-b84756abd2ac ==============================
[0m23:54:57.843612 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:54:57.844172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'send_anonymous_usage_stats': 'True'}
[0m23:54:57.917469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04a517e5-2a5e-4dd0-8b02-b84756abd2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc9d310>]}
[0m23:54:57.940064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04a517e5-2a5e-4dd0-8b02-b84756abd2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc2a1f0>]}
[0m23:54:57.940629 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:57.950698 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:54:58.064873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:58.065284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:58.083328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a517e5-2a5e-4dd0-8b02-b84756abd2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a30fdc0>]}
[0m23:54:58.093058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04a517e5-2a5e-4dd0-8b02-b84756abd2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1af8e0>]}
[0m23:54:58.093455 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:54:58.093831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a517e5-2a5e-4dd0-8b02-b84756abd2ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a49d8e0>]}
[0m23:54:58.094541 [info ] [MainThread]: 
[0m23:54:58.094892 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:54:58.095958 [debug] [MainThread]: Command end result
[0m23:54:58.096472 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2812402, "process_user_time": 1.99112, "process_kernel_time": 0.062128, "process_mem_max_rss": "114524", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:54:58.096895 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:58.096852 after 0.28 seconds
[0m23:54:58.097250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d6072e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6be2b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc9d310>]}
[0m23:54:58.097579 [debug] [MainThread]: Flushing usage events
[0m23:55:01.227160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e65790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e65730>]}


============================== 23:55:01.230547 | 59b6b93c-33e4-4c35-bc34-5e50ac7878dd ==============================
[0m23:55:01.230547 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:55:01.231095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:55:01.305142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f01dc0>]}
[0m23:55:01.328316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e8ce50>]}
[0m23:55:01.328954 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:55:01.339053 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:55:01.448155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:01.448562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:01.466199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27fddc0>]}
[0m23:55:01.471766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2815fa0>]}
[0m23:55:01.472304 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:55:01.472710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26b3b80>]}
[0m23:55:01.473543 [info ] [MainThread]: 
[0m23:55:01.474196 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:01.474834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:55:01.493879 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:55:01.494255 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:55:01.494518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:01.496558 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:55:01.497308 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:55:01.499768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:55:01.503295 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:55:01.503631 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:55:01.503921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:55:01.505502 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:55:01.505851 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:55:01.506178 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:55:01.507345 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:55:01.508064 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:55:01.508467 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:55:01.511358 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.511676 [debug] [MainThread]: On master: BEGIN
[0m23:55:01.511959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:55:01.513437 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:55:01.513734 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.514060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:55:01.518682 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:55:01.519426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2570100>]}
[0m23:55:01.519792 [debug] [MainThread]: On master: ROLLBACK
[0m23:55:01.520134 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.520401 [debug] [MainThread]: On master: BEGIN
[0m23:55:01.520832 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:55:01.521141 [debug] [MainThread]: On master: COMMIT
[0m23:55:01.521419 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.521732 [debug] [MainThread]: On master: COMMIT
[0m23:55:01.522085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:55:01.522359 [debug] [MainThread]: On master: Close
[0m23:55:01.522743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:55:01.523066 [info ] [MainThread]: 
[0m23:55:01.526965 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:55:01.527403 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m23:55:01.527863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m23:55:01.528189 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:55:01.532709 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:55:01.533833 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:55:01.552350 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m23:55:01.553863 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:55:01.554233 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m23:55:01.554579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:55:01.556370 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:55:01.556692 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:55:01.557023 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m23:55:01.560655 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "NaN"

[0m23:55:01.560954 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: ROLLBACK
[0m23:55:01.561347 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m23:55:01.562631 [debug] [Thread-1  ]: Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type timestamp: "NaN"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:55:01.563546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59b6b93c-33e4-4c35-bc34-5e50ac7878dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2161e50>]}
[0m23:55:01.563990 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analysis_crm_sales.crm_performance ....... [[31mERROR[0m in 0.04s]
[0m23:55:01.564424 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:55:01.565252 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.565545 [debug] [MainThread]: On master: BEGIN
[0m23:55:01.565811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:55:01.567220 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:55:01.567524 [debug] [MainThread]: On master: COMMIT
[0m23:55:01.567778 [debug] [MainThread]: Using postgres connection "master"
[0m23:55:01.568004 [debug] [MainThread]: On master: COMMIT
[0m23:55:01.568288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:55:01.568540 [debug] [MainThread]: On master: Close
[0m23:55:01.568844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:01.569071 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:55:01.569309 [info ] [MainThread]: 
[0m23:55:01.569632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:55:01.570056 [debug] [MainThread]: Command end result
[0m23:55:01.570327 [info ] [MainThread]: 
[0m23:55:01.570704 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:55:01.571011 [info ] [MainThread]: 
[0m23:55:01.571332 [error] [MainThread]:   Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type timestamp: "NaN"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:55:01.571635 [info ] [MainThread]: 
[0m23:55:01.571910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:55:01.572433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36926275, "process_user_time": 2.044242, "process_kernel_time": 0.071322, "process_mem_max_rss": "121212", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:55:01.572849 [debug] [MainThread]: Command `dbt run` failed at 23:55:01.572802 after 0.37 seconds
[0m23:55:01.573175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e8ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26b3ee0>]}
[0m23:55:01.573480 [debug] [MainThread]: Flushing usage events
[0m23:56:48.424291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8361f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8361f790>]}


============================== 23:56:48.429318 | 1201e4ec-75b1-4d67-9e5b-5752ea86360b ==============================
[0m23:56:48.429318 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:56:48.429838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:56:48.512514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fcf8b0>]}
[0m23:56:48.539483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837d3190>]}
[0m23:56:48.542470 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:56:48.554869 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:56:48.737250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:56:48.737828 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:56:48.868842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efe3130>]}
[0m23:56:48.875823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1642eb0>]}
[0m23:56:48.876446 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:56:48.876850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e6ebb0>]}
[0m23:56:48.877800 [info ] [MainThread]: 
[0m23:56:48.878316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:48.879039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:56:48.899156 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:56:48.899708 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:56:48.900204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:48.903796 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m23:56:48.904676 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:56:48.907399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:56:48.911838 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:48.912265 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:56:48.912578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:48.914817 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:56:48.915198 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:48.915749 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:56:48.917593 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:56:48.918507 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:56:48.918923 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:56:48.922904 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:48.923364 [debug] [MainThread]: On master: BEGIN
[0m23:56:48.923679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:48.925930 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:48.926371 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:48.926723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:48.931504 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:56:48.932395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16422b0>]}
[0m23:56:48.932881 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:48.933289 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:48.933603 [debug] [MainThread]: On master: BEGIN
[0m23:56:48.934017 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:56:48.934310 [debug] [MainThread]: On master: COMMIT
[0m23:56:48.934585 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:48.934863 [debug] [MainThread]: On master: COMMIT
[0m23:56:48.935209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:48.935485 [debug] [MainThread]: On master: Close
[0m23:56:48.935864 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:48.936197 [info ] [MainThread]: 
[0m23:56:48.940303 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m23:56:48.940868 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m23:56:48.941314 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m23:56:48.941653 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:56:48.945849 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:56:48.947698 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:56:48.965614 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m23:56:48.967796 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:48.968186 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m23:56:48.968560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:48.970691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:56:48.971139 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:48.971514 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m23:56:48.972905 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:56:48.977375 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:48.977790 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m23:56:48.978410 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:48.980720 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:48.981139 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m23:56:48.981726 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:48.993406 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:56:48.994468 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:48.995326 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:56:48.997175 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:56:49.002427 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup"
[0m23:56:49.006422 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:56:49.006931 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup" cascade
[0m23:56:49.008421 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:49.010796 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m23:56:49.012645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1201e4ec-75b1-4d67-9e5b-5752ea86360b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a78baf0>]}
[0m23:56:49.013455 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_products ........... [[32mCREATE VIEW[0m in 0.07s]
[0m23:56:49.014129 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:56:49.015198 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:49.015573 [debug] [MainThread]: On master: BEGIN
[0m23:56:49.015916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:49.018979 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:56:49.019954 [debug] [MainThread]: On master: COMMIT
[0m23:56:49.020662 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:49.021047 [debug] [MainThread]: On master: COMMIT
[0m23:56:49.021827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:49.022193 [debug] [MainThread]: On master: Close
[0m23:56:49.022649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:49.022981 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m23:56:49.023375 [info ] [MainThread]: 
[0m23:56:49.023807 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m23:56:49.024414 [debug] [MainThread]: Command end result
[0m23:56:49.024904 [info ] [MainThread]: 
[0m23:56:49.025539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:49.026852 [info ] [MainThread]: 
[0m23:56:49.027849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:56:49.029269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6320241, "process_user_time": 2.330019, "process_kernel_time": 0.145372, "process_mem_max_rss": "128980", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:56:49.029876 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:49.029812 after 0.63 seconds
[0m23:56:49.030295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851c12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837d3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e6ef10>]}
[0m23:56:49.030699 [debug] [MainThread]: Flushing usage events
[0m23:56:51.426732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2ec2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7a87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7a8790>]}


============================== 23:56:51.430304 | f10b41e1-333e-471d-aea5-d939fcba0113 ==============================
[0m23:56:51.430304 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:56:51.430903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:56:51.508487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1588b0>]}
[0m23:56:51.531954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a95c190>]}
[0m23:56:51.532605 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:56:51.542615 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:56:51.656114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:51.656527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:51.674863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890ec130>]}
[0m23:56:51.681020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8910aa00>]}
[0m23:56:51.681436 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:56:51.681771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fa8bb0>]}
[0m23:56:51.682649 [info ] [MainThread]: 
[0m23:56:51.683103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:51.683718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:56:51.704258 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:56:51.706802 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:56:51.708097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:51.711628 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m23:56:51.712692 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:56:51.717545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:56:51.726195 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:51.726651 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:56:51.727005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:51.729541 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:56:51.730074 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:51.731872 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:56:51.734214 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:56:51.735390 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:56:51.736168 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:56:51.740600 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.741178 [debug] [MainThread]: On master: BEGIN
[0m23:56:51.741563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:51.744186 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:56:51.744668 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.745152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:51.752086 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m23:56:51.753877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e859d0>]}
[0m23:56:51.754949 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:51.755658 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.756087 [debug] [MainThread]: On master: BEGIN
[0m23:56:51.756858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:56:51.757209 [debug] [MainThread]: On master: COMMIT
[0m23:56:51.757550 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.757940 [debug] [MainThread]: On master: COMMIT
[0m23:56:51.758588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:51.759494 [debug] [MainThread]: On master: Close
[0m23:56:51.760041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:51.760453 [info ] [MainThread]: 
[0m23:56:51.765806 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:56:51.766430 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m23:56:51.767091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m23:56:51.767440 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:56:51.772250 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.773341 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:56:51.801945 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.803983 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.804515 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m23:56:51.805140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:51.807290 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:56:51.808595 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.808944 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        engage_date::timestamp,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m23:56:51.810631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:56:51.815084 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.815734 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m23:56:51.816806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:51.819371 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.819824 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m23:56:51.820390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:51.830713 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:56:51.831223 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.831522 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:56:51.832407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m23:56:51.836988 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup"
[0m23:56:51.839610 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:56:51.839991 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m23:56:51.840997 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:51.842851 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m23:56:51.843902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10b41e1-333e-471d-aea5-d939fcba0113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b0cdf0>]}
[0m23:56:51.844502 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_pipelines .... [[32mCREATE VIEW[0m in 0.08s]
[0m23:56:51.844983 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:56:51.845870 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.846189 [debug] [MainThread]: On master: BEGIN
[0m23:56:51.846467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:51.848301 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:51.848721 [debug] [MainThread]: On master: COMMIT
[0m23:56:51.849040 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:51.849376 [debug] [MainThread]: On master: COMMIT
[0m23:56:51.849976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:51.850435 [debug] [MainThread]: On master: Close
[0m23:56:51.850956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:51.851298 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:56:51.851699 [info ] [MainThread]: 
[0m23:56:51.852039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m23:56:51.852583 [debug] [MainThread]: Command end result
[0m23:56:51.852878 [info ] [MainThread]: 
[0m23:56:51.853227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:51.853513 [info ] [MainThread]: 
[0m23:56:51.853854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:56:51.854461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45333493, "process_user_time": 2.240441, "process_kernel_time": 0.084317, "process_mem_max_rss": "119628", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:56:51.855328 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:51.854990 after 0.45 seconds
[0m23:56:51.855944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2ec2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a95c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8910a9a0>]}
[0m23:56:51.856403 [debug] [MainThread]: Flushing usage events
[0m23:56:54.360262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71cc52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702c2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702c26d0>]}


============================== 23:56:54.363680 | e3b05c70-2dfb-426e-a238-8c41e609dee7 ==============================
[0m23:56:54.363680 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:56:54.364291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:54.440476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702e9a90>]}
[0m23:56:54.465270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed27f40>]}
[0m23:56:54.466109 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:56:54.482606 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:56:54.647553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:54.648072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:54.670074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9c7130>]}
[0m23:56:54.676232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9e3a00>]}
[0m23:56:54.676721 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:56:54.677212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb62b50>]}
[0m23:56:54.678049 [info ] [MainThread]: 
[0m23:56:54.678563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:54.679405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:56:54.697739 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:56:54.698187 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:56:54.698526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:54.700872 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:56:54.701620 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:56:54.704190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:56:54.708023 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:54.708364 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:56:54.708655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:54.710545 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:56:54.710868 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:54.711326 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:56:54.712871 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:56:54.713681 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:56:54.714065 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:56:54.717138 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.717441 [debug] [MainThread]: On master: BEGIN
[0m23:56:54.717753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:54.719479 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:54.719767 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.720098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:54.724920 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:56:54.725736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea1ab20>]}
[0m23:56:54.726187 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:54.726578 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.726855 [debug] [MainThread]: On master: BEGIN
[0m23:56:54.727272 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:56:54.727558 [debug] [MainThread]: On master: COMMIT
[0m23:56:54.727858 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.728130 [debug] [MainThread]: On master: COMMIT
[0m23:56:54.728559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:54.728924 [debug] [MainThread]: On master: Close
[0m23:56:54.729474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:54.729919 [info ] [MainThread]: 
[0m23:56:54.733826 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:56:54.734263 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m23:56:54.734692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m23:56:54.735018 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:56:54.739561 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.740792 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:56:54.758807 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.760428 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.760749 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m23:56:54.761084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:54.763168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:56:54.763514 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.763790 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || ' | ' || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m23:56:54.764689 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:56:54.768045 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.768363 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m23:56:54.768853 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:54.770839 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.771297 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m23:56:54.771954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:54.780471 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:56:54.780933 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.781278 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:56:54.782154 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:56:54.785658 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup"
[0m23:56:54.788042 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:56:54.788401 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup" cascade
[0m23:56:54.789259 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:54.790556 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m23:56:54.791456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b05c70-2dfb-426e-a238-8c41e609dee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5c0970>]}
[0m23:56:54.791901 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_teams ........ [[32mCREATE VIEW[0m in 0.06s]
[0m23:56:54.792418 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:56:54.793237 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.793517 [debug] [MainThread]: On master: BEGIN
[0m23:56:54.793755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:54.795309 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:54.795748 [debug] [MainThread]: On master: COMMIT
[0m23:56:54.796044 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:54.796343 [debug] [MainThread]: On master: COMMIT
[0m23:56:54.796672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:54.796927 [debug] [MainThread]: On master: Close
[0m23:56:54.797281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:54.797521 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:56:54.797773 [info ] [MainThread]: 
[0m23:56:54.798167 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:56:54.798666 [debug] [MainThread]: Command end result
[0m23:56:54.798959 [info ] [MainThread]: 
[0m23:56:54.799333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:54.799650 [info ] [MainThread]: 
[0m23:56:54.800026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:56:54.800606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.465394, "process_user_time": 2.260015, "process_kernel_time": 0.082438, "process_mem_max_rss": "122368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:56:54.801025 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:54.800980 after 0.47 seconds
[0m23:56:54.801378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71cc52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702f3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9e39d0>]}
[0m23:56:54.801746 [debug] [MainThread]: Flushing usage events
[0m23:56:58.385356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c457c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c45760>]}


============================== 23:56:58.388738 | 2bae6edb-2eb2-417c-8a96-02127d61afc4 ==============================
[0m23:56:58.388738 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:56:58.389349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:58.465478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7867910>]}
[0m23:56:58.494141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7884190>]}
[0m23:56:58.494984 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:56:58.518348 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:56:58.681162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:58.681655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:58.701779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76eadc0>]}
[0m23:56:58.707878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7702fa0>]}
[0m23:56:58.708325 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:56:58.708668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75a0b80>]}
[0m23:56:58.709538 [info ] [MainThread]: 
[0m23:56:58.709988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:58.710636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:56:58.729211 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:56:58.729775 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:56:58.730098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:58.732679 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:56:58.733415 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:56:58.735952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:56:58.739923 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:58.740332 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:56:58.740630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:58.743030 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:56:58.743709 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:56:58.744576 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:56:58.746937 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m23:56:58.747857 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:56:58.748252 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:56:58.751406 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.751736 [debug] [MainThread]: On master: BEGIN
[0m23:56:58.752026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:58.753774 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:58.754133 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.754550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:58.759589 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m23:56:58.760504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7702f10>]}
[0m23:56:58.760964 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:58.761392 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.761671 [debug] [MainThread]: On master: BEGIN
[0m23:56:58.762187 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:56:58.762569 [debug] [MainThread]: On master: COMMIT
[0m23:56:58.762880 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.763171 [debug] [MainThread]: On master: COMMIT
[0m23:56:58.763585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:58.763865 [debug] [MainThread]: On master: Close
[0m23:56:58.764262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:58.764581 [info ] [MainThread]: 
[0m23:56:58.768686 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:56:58.769123 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m23:56:58.769535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m23:56:58.769852 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:56:58.774359 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:56:58.775452 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:56:58.794288 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m23:56:58.795663 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.796094 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m23:56:58.796418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:56:58.798253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:56:58.798564 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.798849 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m23:56:58.799905 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:56:58.803400 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.803747 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m23:56:58.804310 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:58.806248 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.806664 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m23:56:58.807311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:56:58.815582 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:56:58.815966 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.816334 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:56:58.818840 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m23:56:58.822492 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup"
[0m23:56:58.824632 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:56:58.824941 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup" cascade
[0m23:56:58.825963 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:56:58.827274 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m23:56:58.828210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bae6edb-2eb2-417c-8a96-02127d61afc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7103e50>]}
[0m23:56:58.828686 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_accounts ........... [[32mCREATE VIEW[0m in 0.06s]
[0m23:56:58.829235 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:56:58.830104 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.830389 [debug] [MainThread]: On master: BEGIN
[0m23:56:58.830620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:58.832263 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:56:58.832545 [debug] [MainThread]: On master: COMMIT
[0m23:56:58.832775 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:58.832998 [debug] [MainThread]: On master: COMMIT
[0m23:56:58.833302 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:58.833571 [debug] [MainThread]: On master: Close
[0m23:56:58.833886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:58.834168 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m23:56:58.834463 [info ] [MainThread]: 
[0m23:56:58.834776 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:56:58.835248 [debug] [MainThread]: Command end result
[0m23:56:58.835546 [info ] [MainThread]: 
[0m23:56:58.835891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:58.836230 [info ] [MainThread]: 
[0m23:56:58.836587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:56:58.837342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4770813, "process_user_time": 2.217215, "process_kernel_time": 0.078254, "process_mem_max_rss": "122328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:56:58.837754 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:58.837709 after 0.48 seconds
[0m23:56:58.838081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb789f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7702fd0>]}
[0m23:56:58.838399 [debug] [MainThread]: Flushing usage events
[0m23:57:00.720186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9802e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ddb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ddb730>]}


============================== 23:57:00.723678 | 2339f8eb-18da-41d5-bb60-826a3f662754 ==============================
[0m23:57:00.723678 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:57:00.724287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:00.807444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2339f8eb-18da-41d5-bb60-826a3f662754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e78310>]}
[0m23:57:00.831682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2339f8eb-18da-41d5-bb60-826a3f662754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e031f0>]}
[0m23:57:00.832480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:00.843638 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:57:00.991445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:00.991999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:01.020353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2339f8eb-18da-41d5-bb60-826a3f662754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7775dc0>]}
[0m23:57:01.036900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2339f8eb-18da-41d5-bb60-826a3f662754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73ba8e0>]}
[0m23:57:01.037616 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:57:01.038097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2339f8eb-18da-41d5-bb60-826a3f662754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76288e0>]}
[0m23:57:01.039126 [info ] [MainThread]: 
[0m23:57:01.039665 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:57:01.041282 [debug] [MainThread]: Command end result
[0m23:57:01.041968 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.34692067, "process_user_time": 2.106175, "process_kernel_time": 0.069169, "process_mem_max_rss": "112404", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:01.042444 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:01.042385 after 0.35 seconds
[0m23:57:01.042782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9802e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99004400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e78310>]}
[0m23:57:01.043096 [debug] [MainThread]: Flushing usage events
[0m23:57:03.334804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c033730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0336d0>]}


============================== 23:57:03.338373 | 73304922-7ded-4e6b-84f3-f9e2d6fa1e1c ==============================
[0m23:57:03.338373 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:57:03.338930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:03.420361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73304922-7ded-4e6b-84f3-f9e2d6fa1e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c05a5e0>]}
[0m23:57:03.443994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73304922-7ded-4e6b-84f3-f9e2d6fa1e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa94f40>]}
[0m23:57:03.444635 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:03.455352 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:57:03.569148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:03.569589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:03.588022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73304922-7ded-4e6b-84f3-f9e2d6fa1e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba978130>]}
[0m23:57:03.597884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73304922-7ded-4e6b-84f3-f9e2d6fa1e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5c4700>]}
[0m23:57:03.598300 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:57:03.598663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73304922-7ded-4e6b-84f3-f9e2d6fa1e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8348b0>]}
[0m23:57:03.599360 [info ] [MainThread]: 
[0m23:57:03.599714 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:57:03.600766 [debug] [MainThread]: Command end result
[0m23:57:03.601295 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2917271, "process_user_time": 2.023343, "process_kernel_time": 0.069912, "process_mem_max_rss": "112268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:03.601685 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:03.601638 after 0.29 seconds
[0m23:57:03.602006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c064130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba834ee0>]}
[0m23:57:03.602340 [debug] [MainThread]: Flushing usage events
[0m23:57:06.424834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b30d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99907730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999076d0>]}


============================== 23:57:06.428334 | 3003723a-ba56-43dd-b90a-7716eb207126 ==============================
[0m23:57:06.428334 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:57:06.428945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:06.506494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3003723a-ba56-43dd-b90a-7716eb207126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9992e5e0>]}
[0m23:57:06.530298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3003723a-ba56-43dd-b90a-7716eb207126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8369f40>]}
[0m23:57:06.530902 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:06.541123 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:57:06.674593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:06.675338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:06.707893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3003723a-ba56-43dd-b90a-7716eb207126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb800d130>]}
[0m23:57:06.719712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3003723a-ba56-43dd-b90a-7716eb207126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7eb3700>]}
[0m23:57:06.720224 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:57:06.720637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3003723a-ba56-43dd-b90a-7716eb207126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81a48b0>]}
[0m23:57:06.721529 [info ] [MainThread]: 
[0m23:57:06.721942 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:57:06.723216 [debug] [MainThread]: Command end result
[0m23:57:06.723798 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3239088, "process_user_time": 2.140511, "process_kernel_time": 0.074692, "process_mem_max_rss": "121480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:06.724227 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:06.724174 after 0.32 seconds
[0m23:57:06.724575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b30d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99938130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81a4ee0>]}
[0m23:57:06.724933 [debug] [MainThread]: Flushing usage events
[0m23:57:10.376682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e19f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c4f1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c4f1700>]}


============================== 23:57:10.380775 | b4e72b89-1477-4a54-98fa-519e4febb97d ==============================
[0m23:57:10.380775 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:57:10.381357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:57:10.460829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b191ac0>]}
[0m23:57:10.484692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6da373a0>]}
[0m23:57:10.485286 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:10.495608 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:57:10.605261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:10.605673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:10.624002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af8f130>]}
[0m23:57:10.629284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afb57f0>]}
[0m23:57:10.629659 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:57:10.629990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae4fb80>]}
[0m23:57:10.630762 [info ] [MainThread]: 
[0m23:57:10.631187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:10.631827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:57:10.649198 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:57:10.649632 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:57:10.649935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:10.653161 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:57:10.653968 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:57:10.656703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:57:10.660403 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:57:10.660772 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:57:10.661039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:10.662773 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:57:10.663110 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:57:10.663417 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:57:10.664834 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:57:10.665539 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:57:10.665890 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:57:10.668758 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.669138 [debug] [MainThread]: On master: BEGIN
[0m23:57:10.669451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:10.670873 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:57:10.671167 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.671505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:10.676285 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:57:10.677009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d199a0>]}
[0m23:57:10.677404 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:10.677757 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.678049 [debug] [MainThread]: On master: BEGIN
[0m23:57:10.678466 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:57:10.678747 [debug] [MainThread]: On master: COMMIT
[0m23:57:10.679013 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.679329 [debug] [MainThread]: On master: COMMIT
[0m23:57:10.679671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:10.679964 [debug] [MainThread]: On master: Close
[0m23:57:10.680357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:10.680669 [info ] [MainThread]: 
[0m23:57:10.684656 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:57:10.685048 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m23:57:10.685480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m23:57:10.685787 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:57:10.690454 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:57:10.691686 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:57:10.711002 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m23:57:10.712145 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:57:10.712528 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m23:57:10.712833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:57:10.714646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:57:10.714959 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:57:10.715358 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m23:57:10.722042 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type timestamp: "NaN"

[0m23:57:10.722386 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: ROLLBACK
[0m23:57:10.722806 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m23:57:10.724103 [debug] [Thread-1  ]: Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type timestamp: "NaN"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:57:10.725053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e72b89-1477-4a54-98fa-519e4febb97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8899fdc0>]}
[0m23:57:10.725547 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analysis_crm_sales.crm_performance ....... [[31mERROR[0m in 0.04s]
[0m23:57:10.725979 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:57:10.726818 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.727116 [debug] [MainThread]: On master: BEGIN
[0m23:57:10.727391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:10.728836 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:57:10.729105 [debug] [MainThread]: On master: COMMIT
[0m23:57:10.729364 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:10.729607 [debug] [MainThread]: On master: COMMIT
[0m23:57:10.729892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:10.730168 [debug] [MainThread]: On master: Close
[0m23:57:10.730482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:10.730735 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:57:10.731029 [info ] [MainThread]: 
[0m23:57:10.731381 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:57:10.731842 [debug] [MainThread]: Command end result
[0m23:57:10.732107 [info ] [MainThread]: 
[0m23:57:10.732433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:57:10.732704 [info ] [MainThread]: 
[0m23:57:10.732977 [error] [MainThread]:   Database Error in model crm_performance (models/crm_sales_data/analysis/crm_performance.sql)
  invalid input syntax for type timestamp: "NaN"
  compiled Code at target/run/matt_demo/models/crm_sales_data/analysis/crm_performance.sql
[0m23:57:10.733309 [info ] [MainThread]: 
[0m23:57:10.733608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:57:10.734112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3827998, "process_user_time": 2.088912, "process_kernel_time": 0.070064, "process_mem_max_rss": "118576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:10.734474 [debug] [MainThread]: Command `dbt run` failed at 23:57:10.734430 after 0.38 seconds
[0m23:57:10.734779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e19f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889067f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae4fe50>]}
[0m23:57:10.735042 [debug] [MainThread]: Flushing usage events
[0m23:57:13.337742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a73e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68a8f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68a8f700>]}


============================== 23:57:13.341892 | 7cf28d99-7a58-4a33-85bc-3c04028cd050 ==============================
[0m23:57:13.341892 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:57:13.342509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:13.420718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cf28d99-7a58-4a33-85bc-3c04028cd050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87730ac0>]}
[0m23:57:13.444724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cf28d99-7a58-4a33-85bc-3c04028cd050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69fd53a0>]}
[0m23:57:13.445281 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:13.455655 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:57:13.567328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:57:13.567732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:57:13.586895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cf28d99-7a58-4a33-85bc-3c04028cd050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8752e130>]}
[0m23:57:13.597203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cf28d99-7a58-4a33-85bc-3c04028cd050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87179d30>]}
[0m23:57:13.597587 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:57:13.597973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf28d99-7a58-4a33-85bc-3c04028cd050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873e77c0>]}
[0m23:57:13.598759 [info ] [MainThread]: 
[0m23:57:13.599091 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:57:13.600120 [debug] [MainThread]: Command end result
[0m23:57:13.600618 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2893313, "process_user_time": 2.05374, "process_kernel_time": 0.063898, "process_mem_max_rss": "113124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:57:13.601015 [debug] [MainThread]: Command `dbt test` succeeded at 23:57:13.600970 after 0.29 seconds
[0m23:57:13.601321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a73e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69fd53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873e7eb0>]}
[0m23:57:13.601598 [debug] [MainThread]: Flushing usage events
[0m23:59:10.778383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75e9e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75e9e6d0>]}


============================== 23:59:10.784892 | 8a78b511-69f5-4e3a-93f3-0db2268e8797 ==============================
[0m23:59:10.784892 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:10.785547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:10.868896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ec5a90>]}
[0m23:59:10.893539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a5af40>]}
[0m23:59:10.894122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:10.904995 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:11.021218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:59:11.021766 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m23:59:11.129934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f56c130>]}
[0m23:59:11.136560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fcdeb0>]}
[0m23:59:11.136994 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:11.137363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947fbb50>]}
[0m23:59:11.138238 [info ] [MainThread]: 
[0m23:59:11.138698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:11.139288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:59:11.156627 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:59:11.157059 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:59:11.157382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:11.160128 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:59:11.160901 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:59:11.163393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:59:11.167163 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:11.167504 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:59:11.167815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:11.169722 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:11.170042 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:11.170401 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:59:11.172067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:59:11.172828 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:59:11.173217 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:59:11.176239 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.176560 [debug] [MainThread]: On master: BEGIN
[0m23:59:11.176847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:11.178467 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:11.178786 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.179143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:11.184034 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m23:59:11.184788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fcd2b0>]}
[0m23:59:11.185148 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:11.185528 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.185813 [debug] [MainThread]: On master: BEGIN
[0m23:59:11.186279 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:11.186581 [debug] [MainThread]: On master: COMMIT
[0m23:59:11.186860 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.187133 [debug] [MainThread]: On master: COMMIT
[0m23:59:11.187506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:11.187802 [debug] [MainThread]: On master: Close
[0m23:59:11.188213 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:11.188558 [info ] [MainThread]: 
[0m23:59:11.193072 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:59:11.193524 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m23:59:11.193960 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m23:59:11.194277 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:59:11.198616 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:59:11.201165 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:59:11.217938 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m23:59:11.219183 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.219508 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m23:59:11.219822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:59:11.221838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:59:11.222165 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.222499 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m23:59:11.224198 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:59:11.228666 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.229146 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m23:59:11.229985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:11.232438 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.232796 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m23:59:11.233326 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:11.242835 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:59:11.243353 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.243756 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m23:59:11.244577 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m23:59:11.248409 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup"
[0m23:59:11.250831 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m23:59:11.251156 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup" cascade
[0m23:59:11.252169 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:59:11.253502 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m23:59:11.254836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a78b511-69f5-4e3a-93f3-0db2268e8797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f131af0>]}
[0m23:59:11.255387 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_accounts ........... [[32mCREATE VIEW[0m in 0.06s]
[0m23:59:11.255850 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:59:11.256693 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.257000 [debug] [MainThread]: On master: BEGIN
[0m23:59:11.257269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:11.259018 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:11.259310 [debug] [MainThread]: On master: COMMIT
[0m23:59:11.259611 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:11.259880 [debug] [MainThread]: On master: COMMIT
[0m23:59:11.260210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:11.260518 [debug] [MainThread]: On master: Close
[0m23:59:11.260845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:11.261136 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m23:59:11.261444 [info ] [MainThread]: 
[0m23:59:11.261785 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m23:59:11.262804 [debug] [MainThread]: Command end result
[0m23:59:11.263245 [info ] [MainThread]: 
[0m23:59:11.263705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:11.263993 [info ] [MainThread]: 
[0m23:59:11.264270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:11.264932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5146027, "process_user_time": 2.187236, "process_kernel_time": 0.120564, "process_mem_max_rss": "126224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:11.265357 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:11.265302 after 0.52 seconds
[0m23:59:11.265730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ecf160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947fbee0>]}
[0m23:59:11.266074 [debug] [MainThread]: Flushing usage events
[0m23:59:13.408315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930a82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913fa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913fa6a0>]}


============================== 23:59:13.413860 | cb807cdc-b322-483e-ae49-8521e8b6ab00 ==============================
[0m23:59:13.413860 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:13.414558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:13.534885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f06100>]}
[0m23:59:13.561517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9160caf0>]}
[0m23:59:13.562382 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:13.573965 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:13.694091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:13.694531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:13.713508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe98130>]}
[0m23:59:13.719201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafebf820>]}
[0m23:59:13.719610 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:13.720021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd54af0>]}
[0m23:59:13.720869 [info ] [MainThread]: 
[0m23:59:13.721350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:13.721956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:59:13.738938 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:59:13.739357 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:59:13.739692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:13.742061 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:59:13.742923 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:59:13.745413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:59:13.749109 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:13.749415 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:59:13.749704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:13.751354 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:13.751628 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:13.751892 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:59:13.753070 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:59:13.753851 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:59:13.754221 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:59:13.757118 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.757437 [debug] [MainThread]: On master: BEGIN
[0m23:59:13.757745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:13.759278 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:13.759577 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.759910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:13.764422 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:59:13.765173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc10e80>]}
[0m23:59:13.765513 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:13.765878 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.766159 [debug] [MainThread]: On master: BEGIN
[0m23:59:13.766584 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:13.766877 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.767147 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.767431 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.767779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:13.768064 [debug] [MainThread]: On master: Close
[0m23:59:13.768437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:13.768846 [info ] [MainThread]: 
[0m23:59:13.772877 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m23:59:13.773301 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m23:59:13.773725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m23:59:13.774041 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:59:13.778216 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:59:13.779464 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:59:13.797466 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m23:59:13.798762 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.799074 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m23:59:13.799400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:59:13.801271 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:59:13.801587 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.801888 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m23:59:13.802810 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:59:13.806071 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.806376 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m23:59:13.806790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:13.808519 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.808825 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m23:59:13.809235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:13.817638 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:59:13.818033 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.818377 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m23:59:13.819200 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:59:13.822408 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup"
[0m23:59:13.824567 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m23:59:13.824867 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup" cascade
[0m23:59:13.825681 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:59:13.826929 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m23:59:13.827821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb807cdc-b322-483e-ae49-8521e8b6ab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8b7d60>]}
[0m23:59:13.828295 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_products ........... [[32mCREATE VIEW[0m in 0.05s]
[0m23:59:13.828752 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:59:13.829597 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.829882 [debug] [MainThread]: On master: BEGIN
[0m23:59:13.830129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:13.831682 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:13.831965 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.832205 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:13.832453 [debug] [MainThread]: On master: COMMIT
[0m23:59:13.832763 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:13.833034 [debug] [MainThread]: On master: Close
[0m23:59:13.833385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:13.833681 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m23:59:13.833991 [info ] [MainThread]: 
[0m23:59:13.834296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:59:13.834759 [debug] [MainThread]: Command end result
[0m23:59:13.835008 [info ] [MainThread]: 
[0m23:59:13.835298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:13.835573 [info ] [MainThread]: 
[0m23:59:13.835858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:13.836385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45776662, "process_user_time": 2.180498, "process_kernel_time": 0.084902, "process_mem_max_rss": "119152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:13.836835 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:13.836789 after 0.46 seconds
[0m23:59:13.837137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930a82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9160caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafebf880>]}
[0m23:59:13.837407 [debug] [MainThread]: Flushing usage events
[0m23:59:16.767317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ca32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702a0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702a0730>]}


============================== 23:59:16.772453 | 2c2efebb-ce08-4171-b567-03a3517ec6ca ==============================
[0m23:59:16.772453 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:16.773099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:59:16.855357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7033cdc0>]}
[0m23:59:16.880600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702c7e50>]}
[0m23:59:16.881342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:16.892406 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:17.007054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:17.007489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:17.025918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9abdc0>]}
[0m23:59:17.031216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9c7a30>]}
[0m23:59:17.031594 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:17.031976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb3fb80>]}
[0m23:59:17.032765 [info ] [MainThread]: 
[0m23:59:17.033220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:17.033868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:59:17.050972 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:59:17.051368 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:59:17.051681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:17.054009 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m23:59:17.054692 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:59:17.057166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:59:17.060614 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:17.060930 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:59:17.061221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:17.062788 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:17.063072 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:17.063362 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:59:17.064645 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:59:17.065376 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:59:17.065782 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:59:17.068626 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.068945 [debug] [MainThread]: On master: BEGIN
[0m23:59:17.069217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:17.070829 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:17.071140 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.071449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:17.075969 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:59:17.076656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9f8100>]}
[0m23:59:17.077023 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:17.077382 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.077706 [debug] [MainThread]: On master: BEGIN
[0m23:59:17.078108 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:17.078390 [debug] [MainThread]: On master: COMMIT
[0m23:59:17.078707 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.078990 [debug] [MainThread]: On master: COMMIT
[0m23:59:17.079336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:17.079610 [debug] [MainThread]: On master: Close
[0m23:59:17.079980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:17.080306 [info ] [MainThread]: 
[0m23:59:17.084128 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:59:17.084542 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m23:59:17.084970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m23:59:17.085289 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:59:17.089404 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.090471 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:59:17.108631 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.109811 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.110169 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m23:59:17.110500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:59:17.112341 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:59:17.112637 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.112955 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || ' | ' || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m23:59:17.113928 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:59:17.117207 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.117512 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m23:59:17.117944 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:17.119694 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.119986 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m23:59:17.120388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:17.128304 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:59:17.128627 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.128971 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m23:59:17.129788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:59:17.132948 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup"
[0m23:59:17.135066 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m23:59:17.135372 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup" cascade
[0m23:59:17.136158 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m23:59:17.137391 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m23:59:17.138253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2efebb-ce08-4171-b567-03a3517ec6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e59d940>]}
[0m23:59:17.138728 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_teams ........ [[32mCREATE VIEW[0m in 0.05s]
[0m23:59:17.139170 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:59:17.139997 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.140291 [debug] [MainThread]: On master: BEGIN
[0m23:59:17.140525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:17.142045 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:17.142365 [debug] [MainThread]: On master: COMMIT
[0m23:59:17.142615 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:17.142883 [debug] [MainThread]: On master: COMMIT
[0m23:59:17.143173 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:17.143428 [debug] [MainThread]: On master: Close
[0m23:59:17.143739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:17.143998 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:59:17.144269 [info ] [MainThread]: 
[0m23:59:17.144558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:59:17.144978 [debug] [MainThread]: Command end result
[0m23:59:17.145256 [info ] [MainThread]: 
[0m23:59:17.145587 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:17.145884 [info ] [MainThread]: 
[0m23:59:17.146159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:17.146664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43095347, "process_user_time": 2.145408, "process_kernel_time": 0.086059, "process_mem_max_rss": "126760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:17.147131 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:17.147080 after 0.43 seconds
[0m23:59:17.147451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ca32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704c7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9c7a00>]}
[0m23:59:17.147734 [debug] [MainThread]: Flushing usage events
[0m23:59:20.795926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ee0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ee0730>]}


============================== 23:59:20.802251 | a0b4c26f-ddbb-4f6e-af3c-f73971a92cff ==============================
[0m23:59:20.802251 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:20.803103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:20.935711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f7ddc0>]}
[0m23:59:20.970354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f08e50>]}
[0m23:59:20.971217 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:20.983258 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:21.097704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:21.098165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:21.117696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb182bdc0>]}
[0m23:59:21.123287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1843fa0>]}
[0m23:59:21.123695 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:21.124100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16e1b80>]}
[0m23:59:21.124968 [info ] [MainThread]: 
[0m23:59:21.125402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:21.126075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:59:21.144141 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:59:21.144621 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:59:21.144995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:21.147610 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:59:21.148325 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:59:21.150771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:59:21.154331 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:21.154644 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:59:21.155013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:21.156721 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:21.157016 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:21.157339 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:59:21.158591 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:59:21.159323 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:59:21.159687 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:59:21.162700 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.163004 [debug] [MainThread]: On master: BEGIN
[0m23:59:21.163299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:21.164800 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:21.165110 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.165441 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:21.170205 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:59:21.170986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb159d100>]}
[0m23:59:21.171327 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:21.171697 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.172014 [debug] [MainThread]: On master: BEGIN
[0m23:59:21.172436 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:21.172732 [debug] [MainThread]: On master: COMMIT
[0m23:59:21.173016 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.173305 [debug] [MainThread]: On master: COMMIT
[0m23:59:21.173662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:21.173976 [debug] [MainThread]: On master: Close
[0m23:59:21.174335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:21.174629 [info ] [MainThread]: 
[0m23:59:21.178584 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:21.179038 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m23:59:21.179449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m23:59:21.179779 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:21.183964 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.184977 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:21.203045 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.204203 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.204519 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m23:59:21.204822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:59:21.206749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:59:21.207074 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.207396 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m23:59:21.208615 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m23:59:21.211982 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.212295 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m23:59:21.212724 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:21.214373 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.214716 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m23:59:21.215153 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:21.223430 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:59:21.223792 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.224135 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m23:59:21.225075 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:59:21.228279 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup"
[0m23:59:21.230376 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:21.230689 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m23:59:21.231465 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m23:59:21.232681 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m23:59:21.233506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0b4c26f-ddbb-4f6e-af3c-f73971a92cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11dd940>]}
[0m23:59:21.233970 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_pipelines .... [[32mCREATE VIEW[0m in 0.05s]
[0m23:59:21.234396 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:21.235177 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.235454 [debug] [MainThread]: On master: BEGIN
[0m23:59:21.235717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:21.237327 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:21.237593 [debug] [MainThread]: On master: COMMIT
[0m23:59:21.237857 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:21.238118 [debug] [MainThread]: On master: COMMIT
[0m23:59:21.238410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:21.238671 [debug] [MainThread]: On master: Close
[0m23:59:21.238994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:21.239274 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:59:21.239569 [info ] [MainThread]: 
[0m23:59:21.239913 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:59:21.240375 [debug] [MainThread]: Command end result
[0m23:59:21.240648 [info ] [MainThread]: 
[0m23:59:21.241039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:21.241372 [info ] [MainThread]: 
[0m23:59:21.241710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:21.242264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48558924, "process_user_time": 2.226931, "process_kernel_time": 0.087666, "process_mem_max_rss": "122212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:21.242655 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:21.242612 after 0.49 seconds
[0m23:59:21.243006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93108400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1843fd0>]}
[0m23:59:21.243318 [debug] [MainThread]: Flushing usage events
[0m23:59:23.436766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff674c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff674c7670>]}


============================== 23:59:23.440989 | cf228dfd-8ae2-4efa-a400-8831fe3b7139 ==============================
[0m23:59:23.440989 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:23.441628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:59:23.526956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf228dfd-8ae2-4efa-a400-8831fe3b7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff676d5430>]}
[0m23:59:23.553732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf228dfd-8ae2-4efa-a400-8831fe3b7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff676d57f0>]}
[0m23:59:23.554493 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:23.567208 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:23.688993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:23.689443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:23.709657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf228dfd-8ae2-4efa-a400-8831fe3b7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f66130>]}
[0m23:59:23.721636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf228dfd-8ae2-4efa-a400-8831fe3b7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bb1cd0>]}
[0m23:59:23.722115 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:23.722478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf228dfd-8ae2-4efa-a400-8831fe3b7139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e1f820>]}
[0m23:59:23.723202 [info ] [MainThread]: 
[0m23:59:23.723520 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:23.724560 [debug] [MainThread]: Command end result
[0m23:59:23.725079 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.31582484, "process_user_time": 2.006901, "process_kernel_time": 0.085981, "process_mem_max_rss": "113408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:23.725440 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:23.725398 after 0.32 seconds
[0m23:59:23.725755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff676d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e1fd90>]}
[0m23:59:23.726034 [debug] [MainThread]: Flushing usage events
[0m23:59:26.680421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9783d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9783d730>]}


============================== 23:59:26.683922 | f458754f-5f77-47d4-ae1d-627a2bef8a5b ==============================
[0m23:59:26.683922 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:26.684459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:59:26.781348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f458754f-5f77-47d4-ae1d-627a2bef8a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978d9310>]}
[0m23:59:26.805946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f458754f-5f77-47d4-ae1d-627a2bef8a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978641f0>]}
[0m23:59:26.806572 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:26.817303 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:26.928853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:26.929278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:26.947929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f458754f-5f77-47d4-ae1d-627a2bef8a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f49dc0>]}
[0m23:59:26.958067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f458754f-5f77-47d4-ae1d-627a2bef8a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5dea8e0>]}
[0m23:59:26.958480 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:26.958903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f458754f-5f77-47d4-ae1d-627a2bef8a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60da8e0>]}
[0m23:59:26.959584 [info ] [MainThread]: 
[0m23:59:26.959955 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:26.961066 [debug] [MainThread]: Command end result
[0m23:59:26.961559 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.30588984, "process_user_time": 1.974929, "process_kernel_time": 0.074959, "process_mem_max_rss": "113304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:26.961940 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:26.961896 after 0.31 seconds
[0m23:59:26.962234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992412e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a65400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978d9310>]}
[0m23:59:26.962500 [debug] [MainThread]: Flushing usage events
[0m23:59:30.731032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2cf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8ca730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8ca6d0>]}


============================== 23:59:30.734640 | 54297444-2b26-4c03-8252-d328d8a0a129 ==============================
[0m23:59:30.734640 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:30.735213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:30.811714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54297444-2b26-4c03-8252-d328d8a0a129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8f15e0>]}
[0m23:59:30.836573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54297444-2b26-4c03-8252-d328d8a0a129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b32ff40>]}
[0m23:59:30.837374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:30.848842 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:30.965986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:30.966400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:30.985486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54297444-2b26-4c03-8252-d328d8a0a129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afd0130>]}
[0m23:59:30.995472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54297444-2b26-4c03-8252-d328d8a0a129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae76e50>]}
[0m23:59:30.995906 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:30.996341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54297444-2b26-4c03-8252-d328d8a0a129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1688b0>]}
[0m23:59:30.997078 [info ] [MainThread]: 
[0m23:59:30.997435 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:30.998472 [debug] [MainThread]: Command end result
[0m23:59:30.999009 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2927875, "process_user_time": 2.016696, "process_kernel_time": 0.070725, "process_mem_max_rss": "122704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:30.999410 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:30.999363 after 0.29 seconds
[0m23:59:30.999756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2cf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c8fb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b168e20>]}
[0m23:59:31.000070 [debug] [MainThread]: Flushing usage events
[0m23:59:33.395401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a1d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a1d730>]}


============================== 23:59:33.398987 | 35c5670d-cdd8-4fce-b7f2-2499e4bb87dd ==============================
[0m23:59:33.398987 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:33.399513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:33.475289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c5670d-cdd8-4fce-b7f2-2499e4bb87dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73aba310>]}
[0m23:59:33.501899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35c5670d-cdd8-4fce-b7f2-2499e4bb87dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a451f0>]}
[0m23:59:33.502490 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:33.513817 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:33.631297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:33.631721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:33.650879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35c5670d-cdd8-4fce-b7f2-2499e4bb87dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92369dc0>]}
[0m23:59:33.660520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35c5670d-cdd8-4fce-b7f2-2499e4bb87dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fae8e0>]}
[0m23:59:33.660999 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:33.661399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35c5670d-cdd8-4fce-b7f2-2499e4bb87dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9221c8e0>]}
[0m23:59:33.662069 [info ] [MainThread]: 
[0m23:59:33.662423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:33.663474 [debug] [MainThread]: Command end result
[0m23:59:33.663975 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29296067, "process_user_time": 1.981346, "process_kernel_time": 0.067283, "process_mem_max_rss": "113044", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:33.664379 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:33.664324 after 0.29 seconds
[0m23:59:33.664691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c46400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73aba310>]}
[0m23:59:33.664972 [debug] [MainThread]: Flushing usage events
[0m23:59:36.765030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b8012e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b52700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69b526a0>]}


============================== 23:59:36.769789 | 4d63263b-895e-453c-8e7f-4d81f09ad9a4 ==============================
[0m23:59:36.769789 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:36.770595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:59:36.853328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b65f100>]}
[0m23:59:36.877834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d65af0>]}
[0m23:59:36.878433 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:36.889118 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:37.005422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:37.005851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:37.024791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885f1130>]}
[0m23:59:37.030194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88618820>]}
[0m23:59:37.030577 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:37.031155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884adaf0>]}
[0m23:59:37.032011 [info ] [MainThread]: 
[0m23:59:37.032471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:37.033115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:59:37.051224 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:59:37.051701 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:59:37.052058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:37.054835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m23:59:37.055548 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:59:37.058111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m23:59:37.061660 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:37.062021 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m23:59:37.062346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:37.064061 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:37.064362 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m23:59:37.064660 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m23:59:37.065900 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m23:59:37.066629 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m23:59:37.067000 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m23:59:37.069940 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.070257 [debug] [MainThread]: On master: BEGIN
[0m23:59:37.070536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:37.072083 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:37.072389 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.072731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:37.077422 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m23:59:37.078140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88369e80>]}
[0m23:59:37.078495 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:37.078885 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.079173 [debug] [MainThread]: On master: BEGIN
[0m23:59:37.079584 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:37.079902 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.080188 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.080457 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.080824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:37.081111 [debug] [MainThread]: On master: Close
[0m23:59:37.081507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:37.081956 [info ] [MainThread]: 
[0m23:59:37.085817 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:59:37.086228 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m23:59:37.086681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m23:59:37.087003 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:59:37.091749 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:59:37.092840 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:59:37.111937 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m23:59:37.113557 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:59:37.113925 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m23:59:37.114244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:59:37.116074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m23:59:37.116387 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:59:37.116762 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m23:59:37.132396 [debug] [Thread-1  ]: SQL status: SELECT 1050 in 0.015 seconds
[0m23:59:37.136008 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:59:37.136349 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp" rename to "crm_performance"
[0m23:59:37.136882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:59:37.145496 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m23:59:37.145845 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:59:37.146145 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m23:59:37.147449 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:59:37.150659 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_performance__dbt_backup"
[0m23:59:37.152859 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m23:59:37.153161 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
drop table if exists "company_dw"."analysis_crm_sales"."crm_performance__dbt_backup" cascade
[0m23:59:37.153583 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m23:59:37.154810 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m23:59:37.155643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d63263b-895e-453c-8e7f-4d81f09ad9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88010d60>]}
[0m23:59:37.156123 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analysis_crm_sales.crm_performance ........... [[32mSELECT 1050[0m in 0.07s]
[0m23:59:37.156620 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:59:37.157459 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.157757 [debug] [MainThread]: On master: BEGIN
[0m23:59:37.158001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:37.159572 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:37.159894 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.160163 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:37.160446 [debug] [MainThread]: On master: COMMIT
[0m23:59:37.160818 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:37.161109 [debug] [MainThread]: On master: Close
[0m23:59:37.161460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:37.161770 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:59:37.162082 [info ] [MainThread]: 
[0m23:59:37.162438 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m23:59:37.162909 [debug] [MainThread]: Command end result
[0m23:59:37.163191 [info ] [MainThread]: 
[0m23:59:37.163559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:37.163912 [info ] [MainThread]: 
[0m23:59:37.164234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:37.164844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.45188847, "process_user_time": 2.114167, "process_kernel_time": 0.086006, "process_mem_max_rss": "129804", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:37.165234 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:37.165192 after 0.45 seconds
[0m23:59:37.165563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b8012e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d65af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88618880>]}
[0m23:59:37.165936 [debug] [MainThread]: Flushing usage events
[0m23:59:40.762119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60be42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef33700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef336a0>]}


============================== 23:59:40.765573 | 8103377c-0e24-4fe6-a12c-a4d75c8e5185 ==============================
[0m23:59:40.765573 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:40.766226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_performance', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:40.843899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8103377c-0e24-4fe6-a12c-a4d75c8e5185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60a42100>]}
[0m23:59:40.867928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8103377c-0e24-4fe6-a12c-a4d75c8e5185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f147af0>]}
[0m23:59:40.868621 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:40.878876 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m23:59:40.983645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:40.984045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:41.003694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8103377c-0e24-4fe6-a12c-a4d75c8e5185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9d3130>]}
[0m23:59:41.017918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8103377c-0e24-4fe6-a12c-a4d75c8e5185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d61ea60>]}
[0m23:59:41.018306 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:41.018785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8103377c-0e24-4fe6-a12c-a4d75c8e5185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d88c850>]}
[0m23:59:41.019461 [info ] [MainThread]: 
[0m23:59:41.019824 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:59:41.020900 [debug] [MainThread]: Command end result
[0m23:59:41.021347 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2854948, "process_user_time": 2.014648, "process_kernel_time": 0.06792, "process_mem_max_rss": "121068", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:41.021686 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:41.021631 after 0.29 seconds
[0m23:59:41.021964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60be42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db55d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d88cdc0>]}
[0m23:59:41.022199 [debug] [MainThread]: Flushing usage events
[0m23:59:42.810717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831d82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817d49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817d4970>]}


============================== 23:59:42.814428 | e95e7039-602f-4ec3-bdde-cc6b2480195d ==============================
[0m23:59:42.814428 [info ] [MainThread]: Running with dbt=1.8.3
[0m23:59:42.814954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:42.898926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817fb880>]}
[0m23:59:42.923506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186fd30>]}
[0m23:59:42.924142 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:59:42.934721 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m23:59:43.009419 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:59:43.009964 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m23:59:43.010320 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:59:43.010686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bfb910>]}
[0m23:59:43.739187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0124ca0>]}
[0m23:59:43.746090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa006f550>]}
[0m23:59:43.746438 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m23:59:43.746772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0067dc0>]}
[0m23:59:43.747761 [info ] [MainThread]: 
[0m23:59:43.748157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:43.750298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:59:43.765415 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:59:43.765841 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:59:43.766176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:43.768405 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:43.768715 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:59:43.769070 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:59:43.770287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m23:59:43.770966 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:59:43.771350 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:59:43.774203 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:43.774479 [debug] [MainThread]: On master: BEGIN
[0m23:59:43.774714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:43.776254 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:59:43.776512 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:43.776796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:43.781705 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m23:59:43.782442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e95e7039-602f-4ec3-bdde-cc6b2480195d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8186fc40>]}
[0m23:59:43.782765 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:43.783104 [debug] [MainThread]: On master: Close
[0m23:59:43.783461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:43.783807 [info ] [MainThread]: 
[0m23:59:43.787633 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m23:59:43.788280 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m23:59:43.788496 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:43.788726 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m23:59:43.789094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m23:59:43.789545 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m23:59:43.789930 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m23:59:43.790327 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m23:59:43.790659 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m23:59:43.790981 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m23:59:43.791313 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:43.791630 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m23:59:43.795991 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m23:59:43.797701 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m23:59:43.799310 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m23:59:43.800858 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m23:59:43.802403 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m23:59:43.802655 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m23:59:43.802929 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:43.803240 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m23:59:43.803606 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m23:59:43.804013 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m23:59:43.804490 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m23:59:43.804913 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m23:59:43.805255 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m23:59:43.805951 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m23:59:43.806284 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m23:59:43.806576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.crm_performance)
[0m23:59:43.806854 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m23:59:43.807097 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m23:59:43.808810 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m23:59:43.811287 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m23:59:43.812573 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m23:59:43.812777 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m23:59:43.813290 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m23:59:43.813802 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m23:59:43.814672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:43.814939 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m23:59:43.815185 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m23:59:43.815397 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m23:59:43.815574 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m23:59:43.816232 [debug] [MainThread]: Command end result
[0m23:59:43.874690 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:59:43.874980 [info ] [MainThread]: Building catalog
[0m23:59:43.880109 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:59:43.884245 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:59:43.884531 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:59:43.884784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:43.886725 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m23:59:43.887039 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:59:43.887371 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_teams')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_sales_pipelines')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_pipeline')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_sales_teams')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_performance')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_accounts')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('crm_stg_products')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:59:43.889009 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.001 seconds
[0m23:59:43.891557 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:59:43.891933 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:59:43.919404 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:59:43.920081 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1393046, "process_user_time": 2.827567, "process_kernel_time": 0.089397, "process_mem_max_rss": "197656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:43.920500 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:59:43.920449 after 1.14 seconds
[0m23:59:43.920773 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:59:43.921037 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:59:43.921337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831d82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83095eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82372cd0>]}
[0m23:59:43.921615 [debug] [MainThread]: Flushing usage events
[0m00:10:24.242376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d257730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2576d0>]}


============================== 00:10:24.246421 | 0f00323f-9848-4638-b92b-be521b0c2b79 ==============================
[0m00:10:24.246421 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:24.247051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:24.332022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d27fa90>]}
[0m00:10:24.356584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcb9f40>]}
[0m00:10:24.357379 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:24.369155 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:24.446966 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:10:24.447529 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m00:10:24.447889 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:10:24.448260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5b94c0>]}
[0m00:10:25.247716 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:10:25.248453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab978d30>]}
[0m00:10:25.410595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa458bf40>]}
[0m00:10:25.418528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45add30>]}
[0m00:10:25.419044 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:25.419439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa458bf40>]}
[0m00:10:25.420536 [info ] [MainThread]: 
[0m00:10:25.421783 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:25.422936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m00:10:25.444778 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m00:10:25.445307 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:10:25.446022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:25.450395 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:10:25.451467 [debug] [ThreadPool]: On list_company_dw: Close
[0m00:10:25.454806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m00:10:25.459132 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:25.459639 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:25.460001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:25.462161 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:25.462657 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:25.463127 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:25.464968 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:25.466217 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:25.466813 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:25.471120 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.471722 [debug] [MainThread]: On master: BEGIN
[0m00:10:25.472090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:25.474620 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:10:25.475085 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.475472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:25.481438 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:25.482534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa45adca0>]}
[0m00:10:25.482974 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:25.483401 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.483704 [debug] [MainThread]: On master: BEGIN
[0m00:10:25.484121 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:25.484407 [debug] [MainThread]: On master: COMMIT
[0m00:10:25.484696 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.484974 [debug] [MainThread]: On master: COMMIT
[0m00:10:25.485334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:25.485610 [debug] [MainThread]: On master: Close
[0m00:10:25.486022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:25.486432 [info ] [MainThread]: 
[0m00:10:25.491623 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:10:25.492152 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_teams ............. [RUN]
[0m00:10:25.492648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_teams)
[0m00:10:25.493042 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:10:25.497914 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.499760 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:10:25.520172 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.521325 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.521674 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m00:10:25.521953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:10:25.524053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:10:25.524483 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.524843 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || ' | ' || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m00:10:25.526345 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m00:10:25.529987 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.530307 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m00:10:25.530785 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:25.532761 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.533140 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m00:10:25.533630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:25.541719 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m00:10:25.542102 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.542472 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m00:10:25.544061 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:10:25.547571 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup"
[0m00:10:25.550020 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m00:10:25.550405 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_teams__dbt_backup" cascade
[0m00:10:25.551536 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m00:10:25.552877 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m00:10:25.553772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f00323f-9848-4638-b92b-be521b0c2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8f4c40>]}
[0m00:10:25.554274 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_teams ........ [[32mCREATE VIEW[0m in 0.06s]
[0m00:10:25.554759 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:10:25.555598 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.555869 [debug] [MainThread]: On master: BEGIN
[0m00:10:25.556106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:25.558249 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:25.558642 [debug] [MainThread]: On master: COMMIT
[0m00:10:25.558942 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:25.559212 [debug] [MainThread]: On master: COMMIT
[0m00:10:25.559566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:25.559827 [debug] [MainThread]: On master: Close
[0m00:10:25.560171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:25.560427 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m00:10:25.560700 [info ] [MainThread]: 
[0m00:10:25.560971 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m00:10:25.561443 [debug] [MainThread]: Command end result
[0m00:10:25.561736 [info ] [MainThread]: 
[0m00:10:25.562042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:25.562305 [info ] [MainThread]: 
[0m00:10:25.562636 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:25.563279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3487574, "process_user_time": 3.103229, "process_kernel_time": 0.110008, "process_mem_max_rss": "128156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:25.563721 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:25.563668 after 1.35 seconds
[0m00:10:25.564100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcb9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6bb5b50>]}
[0m00:10:25.564418 [debug] [MainThread]: Flushing usage events
[0m00:10:29.087801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864e92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84946730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849466d0>]}


============================== 00:10:29.091231 | 8539ed4f-7791-4745-b7ef-3ef15f463c31 ==============================
[0m00:10:29.091231 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:29.091830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:29.168900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8496ea90>]}
[0m00:10:29.195565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33f8f40>]}
[0m00:10:29.196389 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:29.214654 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:29.398050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:29.398586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:29.428425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3308ee0>]}
[0m00:10:29.434654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32a2fd0>]}
[0m00:10:29.435115 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:29.435476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa10661f0>]}
[0m00:10:29.436339 [info ] [MainThread]: 
[0m00:10:29.436823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:29.437517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m00:10:29.456314 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m00:10:29.456860 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:10:29.457218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:29.460233 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m00:10:29.461112 [debug] [ThreadPool]: On list_company_dw: Close
[0m00:10:29.463639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m00:10:29.467533 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:29.467929 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:29.468239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:29.470140 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:29.470461 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:29.470821 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:29.472093 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:29.472872 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:29.473258 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:29.476495 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.476835 [debug] [MainThread]: On master: BEGIN
[0m00:10:29.477132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:29.478758 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:29.479081 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.479420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:29.484565 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:29.485403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32f16a0>]}
[0m00:10:29.485832 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:29.486219 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.486516 [debug] [MainThread]: On master: BEGIN
[0m00:10:29.486940 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:29.487247 [debug] [MainThread]: On master: COMMIT
[0m00:10:29.487543 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.487833 [debug] [MainThread]: On master: COMMIT
[0m00:10:29.488167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:29.488451 [debug] [MainThread]: On master: Close
[0m00:10:29.488845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:29.489169 [info ] [MainThread]: 
[0m00:10:29.493500 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:10:29.493973 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_accounts ................ [RUN]
[0m00:10:29.494429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_accounts)
[0m00:10:29.494774 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:10:29.499382 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:10:29.500542 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:10:29.518910 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m00:10:29.520417 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.520725 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m00:10:29.521010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:10:29.522889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:10:29.523200 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.523583 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m00:10:29.524882 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m00:10:29.528472 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.528818 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m00:10:29.529342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:29.531097 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.531479 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m00:10:29.532096 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:29.540136 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m00:10:29.540562 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.540898 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m00:10:29.541842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:10:29.545212 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup"
[0m00:10:29.547335 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m00:10:29.547703 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_accounts__dbt_backup" cascade
[0m00:10:29.548511 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m00:10:29.549810 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m00:10:29.550729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8539ed4f-7791-4745-b7ef-3ef15f463c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ca0be0>]}
[0m00:10:29.551196 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_accounts ........... [[32mCREATE VIEW[0m in 0.06s]
[0m00:10:29.551637 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:10:29.552502 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.552769 [debug] [MainThread]: On master: BEGIN
[0m00:10:29.553000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:29.554582 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:29.554906 [debug] [MainThread]: On master: COMMIT
[0m00:10:29.555162 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:29.555401 [debug] [MainThread]: On master: COMMIT
[0m00:10:29.555705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:29.555971 [debug] [MainThread]: On master: Close
[0m00:10:29.556302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:29.556587 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m00:10:29.556992 [info ] [MainThread]: 
[0m00:10:29.557331 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m00:10:29.557827 [debug] [MainThread]: Command end result
[0m00:10:29.558095 [info ] [MainThread]: 
[0m00:10:29.558409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:29.558673 [info ] [MainThread]: 
[0m00:10:29.558970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:29.559524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.50035304, "process_user_time": 2.130283, "process_kernel_time": 0.096695, "process_mem_max_rss": "122240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:29.559901 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:29.559853 after 0.50 seconds
[0m00:10:29.560210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864e92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84978160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32a2820>]}
[0m00:10:29.560519 [debug] [MainThread]: Flushing usage events
[0m00:10:31.940917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7027f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5d1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5d1700>]}


============================== 00:10:31.944308 | 22b65205-2a6c-4fb5-b48c-58d90c90ac44 ==============================
[0m00:10:31.944308 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:31.944952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:32.020673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d273ac0>]}
[0m00:10:32.044103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb163a0>]}
[0m00:10:32.044771 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:32.057010 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:32.245852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:32.246413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:32.279229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d09da00>]}
[0m00:10:32.285533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d038e50>]}
[0m00:10:32.286509 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:32.287137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce05160>]}
[0m00:10:32.288540 [info ] [MainThread]: 
[0m00:10:32.289247 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:32.290380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m00:10:32.311152 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m00:10:32.311656 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:10:32.312050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:32.314532 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m00:10:32.315481 [debug] [ThreadPool]: On list_company_dw: Close
[0m00:10:32.318263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m00:10:32.322083 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:32.322469 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:32.322801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:32.325019 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:32.325419 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:32.325775 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:32.327081 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:32.327924 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:32.328351 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:32.331832 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.332253 [debug] [MainThread]: On master: BEGIN
[0m00:10:32.332587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:32.334521 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:32.334838 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.335204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:32.340595 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:32.341627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d089640>]}
[0m00:10:32.342029 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:32.342451 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.342809 [debug] [MainThread]: On master: BEGIN
[0m00:10:32.343266 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:32.343580 [debug] [MainThread]: On master: COMMIT
[0m00:10:32.343876 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.344185 [debug] [MainThread]: On master: COMMIT
[0m00:10:32.344559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:32.344883 [debug] [MainThread]: On master: Close
[0m00:10:32.345288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:32.345646 [info ] [MainThread]: 
[0m00:10:32.350283 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m00:10:32.350784 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_products ................ [RUN]
[0m00:10:32.351221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_products)
[0m00:10:32.351585 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:10:32.356219 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:10:32.357571 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:10:32.376856 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m00:10:32.377918 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.378253 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m00:10:32.378560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:10:32.380603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:10:32.381058 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.381405 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m00:10:32.382522 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m00:10:32.386768 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.387150 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m00:10:32.387748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:32.389765 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.390081 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m00:10:32.390556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:32.399299 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m00:10:32.399796 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.400166 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m00:10:32.401633 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:10:32.405077 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup"
[0m00:10:32.407445 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m00:10:32.407832 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_products__dbt_backup" cascade
[0m00:10:32.408682 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m00:10:32.409969 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m00:10:32.410886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b65205-2a6c-4fb5-b48c-58d90c90ac44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca41bb0>]}
[0m00:10:32.411346 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_products ........... [[32mCREATE VIEW[0m in 0.06s]
[0m00:10:32.411795 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:10:32.412662 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.412957 [debug] [MainThread]: On master: BEGIN
[0m00:10:32.413192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:32.414805 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:32.415131 [debug] [MainThread]: On master: COMMIT
[0m00:10:32.415436 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:32.415693 [debug] [MainThread]: On master: COMMIT
[0m00:10:32.416064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:32.416354 [debug] [MainThread]: On master: Close
[0m00:10:32.416734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:32.416987 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m00:10:32.417242 [info ] [MainThread]: 
[0m00:10:32.417572 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m00:10:32.418072 [debug] [MainThread]: Command end result
[0m00:10:32.418343 [info ] [MainThread]: 
[0m00:10:32.418675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:32.418934 [info ] [MainThread]: 
[0m00:10:32.419197 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:32.419716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5050669, "process_user_time": 2.246445, "process_kernel_time": 0.090867, "process_mem_max_rss": "120256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:32.420111 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:32.420059 after 0.51 seconds
[0m00:10:32.420412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7027f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce05460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d038820>]}
[0m00:10:32.420809 [debug] [MainThread]: Flushing usage events
[0m00:10:34.334504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76550760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76550700>]}


============================== 00:10:34.341083 | bc90687e-316e-4aeb-9054-2271aff063ea ==============================
[0m00:10:34.341083 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:34.341808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:34.462020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95098ac0>]}
[0m00:10:34.489002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7798a3a0>]}
[0m00:10:34.489790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:34.502739 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:34.639246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:34.639668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:34.668397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ec2a00>]}
[0m00:10:34.673939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e5de50>]}
[0m00:10:34.674344 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:34.674776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c2a160>]}
[0m00:10:34.675621 [info ] [MainThread]: 
[0m00:10:34.676080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:34.676688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m00:10:34.694206 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m00:10:34.694618 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:10:34.694948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:34.697707 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m00:10:34.698424 [debug] [ThreadPool]: On list_company_dw: Close
[0m00:10:34.700886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m00:10:34.704385 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:34.704716 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:34.704989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:34.706631 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:34.706935 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:34.707240 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:34.708432 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:34.709148 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:34.709526 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:34.712436 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.712757 [debug] [MainThread]: On master: BEGIN
[0m00:10:34.713024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:34.714579 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:34.714901 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.715238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:34.720175 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:34.720909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94eae640>]}
[0m00:10:34.721274 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:34.721670 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.721958 [debug] [MainThread]: On master: BEGIN
[0m00:10:34.722382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:34.722682 [debug] [MainThread]: On master: COMMIT
[0m00:10:34.722948 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.723206 [debug] [MainThread]: On master: COMMIT
[0m00:10:34.723539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:34.723847 [debug] [MainThread]: On master: Close
[0m00:10:34.724243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:34.724571 [info ] [MainThread]: 
[0m00:10:34.728570 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:10:34.728986 [info ] [Thread-1  ]: 1 of 1 START sql view model analysis_crm_sales.crm_stg_sales_pipelines ......... [RUN]
[0m00:10:34.729407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_stg_sales_pipelines)
[0m00:10:34.729749 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:10:34.733990 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.735015 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:10:34.752707 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.753838 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.754151 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m00:10:34.754450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:10:34.756301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:10:34.756620 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.756907 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m00:10:34.758212 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m00:10:34.761576 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.761894 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m00:10:34.762344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:34.764014 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.764339 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m00:10:34.764884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:34.772737 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m00:10:34.773111 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.773447 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m00:10:34.775045 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:10:34.778399 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup"
[0m00:10:34.780481 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m00:10:34.780793 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m00:10:34.781600 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m00:10:34.782864 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m00:10:34.783770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc90687e-316e-4aeb-9054-2271aff063ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77eddfd0>]}
[0m00:10:34.784226 [info ] [Thread-1  ]: 1 of 1 OK created sql view model analysis_crm_sales.crm_stg_sales_pipelines .... [[32mCREATE VIEW[0m in 0.05s]
[0m00:10:34.784665 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:10:34.785462 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.785763 [debug] [MainThread]: On master: BEGIN
[0m00:10:34.786032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:34.787524 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:10:34.787811 [debug] [MainThread]: On master: COMMIT
[0m00:10:34.788054 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:34.788275 [debug] [MainThread]: On master: COMMIT
[0m00:10:34.788554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:34.788791 [debug] [MainThread]: On master: Close
[0m00:10:34.789088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:34.789373 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m00:10:34.789690 [info ] [MainThread]: 
[0m00:10:34.790007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m00:10:34.790451 [debug] [MainThread]: Command end result
[0m00:10:34.790706 [info ] [MainThread]: 
[0m00:10:34.791003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:34.791262 [info ] [MainThread]: 
[0m00:10:34.791557 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:34.792116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5067322, "process_user_time": 2.337138, "process_kernel_time": 0.096199, "process_mem_max_rss": "122372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:34.792502 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:34.792446 after 0.51 seconds
[0m00:10:34.792803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c2a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e5d820>]}
[0m00:10:34.793073 [debug] [MainThread]: Flushing usage events
[0m00:10:37.117146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858652e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e60760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e60700>]}


============================== 00:10:37.120616 | f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8 ==============================
[0m00:10:37.120616 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:37.121224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:37.198900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840159a0>]}
[0m00:10:37.222287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e91f10>]}
[0m00:10:37.222833 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:37.233164 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:37.358407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:37.358811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:37.387035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2594a00>]}
[0m00:10:37.396810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23aff10>]}
[0m00:10:37.397218 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:37.397582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26b6eb0>]}
[0m00:10:37.398441 [info ] [MainThread]: 
[0m00:10:37.398908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:37.401017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analysis_crm_sales'
[0m00:10:37.418836 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:37.419238 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:37.419556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:37.421938 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:37.422240 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:37.422550 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:37.423832 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:37.424603 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:37.424971 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:37.428010 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.428328 [debug] [MainThread]: On master: BEGIN
[0m00:10:37.428609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:37.430237 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:37.430520 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.430858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:37.435809 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:37.436545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ea92fa-9bbd-4dae-9a2c-3f414315d2a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23af760>]}
[0m00:10:37.436893 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:37.437254 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.437541 [debug] [MainThread]: On master: BEGIN
[0m00:10:37.437951 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:37.438224 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.438500 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.438783 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.439132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:37.439410 [debug] [MainThread]: On master: Close
[0m00:10:37.439787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:37.440083 [info ] [MainThread]: 
[0m00:10:37.444024 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:10:37.444372 [info ] [Thread-1  ]: 1 of 1 START test no_nan_values_crm_stg_sales_teams_ ........................... [RUN]
[0m00:10:37.444791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0)
[0m00:10:37.445093 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:10:37.452417 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:37.452799 [error] [Thread-1  ]: 1 of 1 ERROR no_nan_values_crm_stg_sales_teams_ ................................ [[31mERROR[0m in 0.01s]
[0m00:10:37.453227 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:10:37.454057 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.454339 [debug] [MainThread]: On master: BEGIN
[0m00:10:37.454620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:37.456257 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:37.456580 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.456851 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:37.457110 [debug] [MainThread]: On master: COMMIT
[0m00:10:37.457440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:37.457735 [debug] [MainThread]: On master: Close
[0m00:10:37.458070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:37.458357 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0' was properly closed.
[0m00:10:37.458716 [info ] [MainThread]: 
[0m00:10:37.459039 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m00:10:37.459466 [debug] [MainThread]: Command end result
[0m00:10:37.459776 [info ] [MainThread]: 
[0m00:10:37.460135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:37.460451 [info ] [MainThread]: 
[0m00:10:37.460858 [error] [MainThread]:   Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:37.461182 [info ] [MainThread]: 
[0m00:10:37.461546 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:10:37.462068 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.371281, "process_user_time": 2.129368, "process_kernel_time": 0.098109, "process_mem_max_rss": "119148", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:37.462479 [debug] [MainThread]: Command `dbt test` failed at 00:10:37.462429 after 0.37 seconds
[0m00:10:37.462822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858652e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26aa040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fe0a00>]}
[0m00:10:37.463132 [debug] [MainThread]: Flushing usage events
[0m00:10:39.086000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62f222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61273700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff612736a0>]}


============================== 00:10:39.089465 | 9a96a3c1-6167-4f61-b051-7b8b813ca26b ==============================
[0m00:10:39.089465 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:39.089958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:39.165320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6286c2e0>]}
[0m00:10:39.188739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7feda490>]}
[0m00:10:39.189294 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:39.200331 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:39.362930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:39.363506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:39.405522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd40130>]}
[0m00:10:39.420540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7faa7c40>]}
[0m00:10:39.421035 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:39.421450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7faa7d60>]}
[0m00:10:39.422391 [info ] [MainThread]: 
[0m00:10:39.423012 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:39.425583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analysis_crm_sales'
[0m00:10:39.447211 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:39.447799 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:39.448169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:39.450702 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:39.451223 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:39.451564 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:39.453500 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m00:10:39.454630 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:39.455173 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:39.458914 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.459431 [debug] [MainThread]: On master: BEGIN
[0m00:10:39.459816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:39.462320 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:39.462787 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.463155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:39.469323 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m00:10:39.470414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a96a3c1-6167-4f61-b051-7b8b813ca26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f90ccd0>]}
[0m00:10:39.470897 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:39.471474 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.471825 [debug] [MainThread]: On master: BEGIN
[0m00:10:39.472295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:39.472621 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.472921 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.473238 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.473634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:39.473932 [debug] [MainThread]: On master: Close
[0m00:10:39.474320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:39.474654 [info ] [MainThread]: 
[0m00:10:39.479170 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:10:39.479710 [info ] [Thread-1  ]: 1 of 1 START test no_nan_values_crm_stg_accounts_ .............................. [RUN]
[0m00:10:39.480211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c)
[0m00:10:39.480548 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:10:39.488505 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:39.489080 [error] [Thread-1  ]: 1 of 1 ERROR no_nan_values_crm_stg_accounts_ ................................... [[31mERROR[0m in 0.01s]
[0m00:10:39.489578 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:10:39.490418 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.490732 [debug] [MainThread]: On master: BEGIN
[0m00:10:39.491044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:39.493004 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:39.493307 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.493583 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:39.493853 [debug] [MainThread]: On master: COMMIT
[0m00:10:39.494224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:39.494619 [debug] [MainThread]: On master: Close
[0m00:10:39.495115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:39.495954 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c' was properly closed.
[0m00:10:39.496258 [info ] [MainThread]: 
[0m00:10:39.496598 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m00:10:39.497141 [debug] [MainThread]: Command end result
[0m00:10:39.497418 [info ] [MainThread]: 
[0m00:10:39.497804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:39.498120 [info ] [MainThread]: 
[0m00:10:39.498480 [error] [MainThread]:   Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:39.498831 [info ] [MainThread]: 
[0m00:10:39.499212 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:10:39.499792 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.43871054, "process_user_time": 2.136405, "process_kernel_time": 0.077159, "process_mem_max_rss": "121756", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:39.500215 [debug] [MainThread]: Command `dbt test` failed at 00:10:39.500172 after 0.44 seconds
[0m00:10:39.500563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62f222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7faa7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f52dc70>]}
[0m00:10:39.500917 [debug] [MainThread]: Flushing usage events
[0m00:10:41.784809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72155700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff721556a0>]}


============================== 00:10:41.788341 | 1c5d8588-de0b-4447-964a-f4bec97900b3 ==============================
[0m00:10:41.788341 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:41.788963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:41.864988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7374eee0>]}
[0m00:10:41.891367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dbc490>]}
[0m00:10:41.892173 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:41.902987 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:42.030367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:42.030766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:42.059277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c22130>]}
[0m00:10:42.069067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90989c40>]}
[0m00:10:42.069480 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:42.069933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90989d60>]}
[0m00:10:42.070732 [info ] [MainThread]: 
[0m00:10:42.071207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:42.073423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analysis_crm_sales'
[0m00:10:42.091111 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:42.091532 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:42.091830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:42.093947 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:42.094263 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:42.094553 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:42.095762 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:42.096493 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:42.096879 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:42.099864 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.100228 [debug] [MainThread]: On master: BEGIN
[0m00:10:42.100517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:42.102042 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:42.102348 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.102689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:42.107605 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:42.108389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c5d8588-de0b-4447-964a-f4bec97900b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907eecd0>]}
[0m00:10:42.108759 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:42.109129 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.109425 [debug] [MainThread]: On master: BEGIN
[0m00:10:42.109833 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:42.110114 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.110393 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.110661 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.110996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:42.111289 [debug] [MainThread]: On master: Close
[0m00:10:42.111667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:42.112106 [info ] [MainThread]: 
[0m00:10:42.116057 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:10:42.116432 [info ] [Thread-1  ]: 1 of 1 START test no_nan_values_crm_stg_products_ .............................. [RUN]
[0m00:10:42.116883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now test.matt_demo.no_nan_values_crm_stg_products_.24667bb123)
[0m00:10:42.117201 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:10:42.124509 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_products_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:42.124913 [error] [Thread-1  ]: 1 of 1 ERROR no_nan_values_crm_stg_products_ ................................... [[31mERROR[0m in 0.01s]
[0m00:10:42.125406 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:10:42.126298 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.126633 [debug] [MainThread]: On master: BEGIN
[0m00:10:42.126925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:42.128718 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:42.129019 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.129329 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:42.129601 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.129938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:42.130230 [debug] [MainThread]: On master: Close
[0m00:10:42.130584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:42.130915 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_products_.24667bb123' was properly closed.
[0m00:10:42.131216 [info ] [MainThread]: 
[0m00:10:42.131611 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m00:10:42.132055 [debug] [MainThread]: Command end result
[0m00:10:42.132329 [info ] [MainThread]: 
[0m00:10:42.132682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:42.132996 [info ] [MainThread]: 
[0m00:10:42.133392 [error] [MainThread]:   Compilation Error in test no_nan_values_crm_stg_products_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:42.133786 [info ] [MainThread]: 
[0m00:10:42.134129 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:10:42.134673 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.37477642, "process_user_time": 2.089637, "process_kernel_time": 0.073763, "process_mem_max_rss": "129920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:42.135160 [debug] [MainThread]: Command `dbt test` failed at 00:10:42.135116 after 0.38 seconds
[0m00:10:42.135479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73e042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90989460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9040fc70>]}
[0m00:10:42.135810 [debug] [MainThread]: Flushing usage events
[0m00:10:44.096771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86216730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862166d0>]}


============================== 00:10:44.100703 | b1da4e36-9f91-422b-a134-e247efbbefcb ==============================
[0m00:10:44.100703 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:44.101220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_performance', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:44.181905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8623da90>]}
[0m00:10:44.208139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c7af40>]}
[0m00:10:44.208903 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:44.219506 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:44.355355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:44.355791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:44.386038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa494bee0>]}
[0m00:10:44.392160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48e4fd0>]}
[0m00:10:44.392579 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:44.392920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49902e0>]}
[0m00:10:44.393842 [info ] [MainThread]: 
[0m00:10:44.394332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:44.394995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m00:10:44.413590 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m00:10:44.414060 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m00:10:44.414421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:44.416835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m00:10:44.417661 [debug] [ThreadPool]: On list_company_dw: Close
[0m00:10:44.420264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analysis_crm_sales)
[0m00:10:44.424151 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:44.424512 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:44.424816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:44.426594 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:44.426913 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:44.427248 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:44.428531 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:44.429355 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:44.429858 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:44.433199 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.433556 [debug] [MainThread]: On master: BEGIN
[0m00:10:44.433861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:44.435568 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:44.435898 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.436287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:44.441465 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:44.442359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49346a0>]}
[0m00:10:44.442755 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:44.443169 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.443468 [debug] [MainThread]: On master: BEGIN
[0m00:10:44.443899 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:44.444214 [debug] [MainThread]: On master: COMMIT
[0m00:10:44.444497 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.444784 [debug] [MainThread]: On master: COMMIT
[0m00:10:44.445166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:44.445485 [debug] [MainThread]: On master: Close
[0m00:10:44.445891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:44.446235 [info ] [MainThread]: 
[0m00:10:44.450470 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m00:10:44.450926 [info ] [Thread-1  ]: 1 of 1 START sql table model analysis_crm_sales.crm_performance ................ [RUN]
[0m00:10:44.451403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now model.matt_demo.crm_performance)
[0m00:10:44.451759 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m00:10:44.456737 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:10:44.458033 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m00:10:44.478590 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m00:10:44.480276 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.480620 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m00:10:44.480950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:10:44.482843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:10:44.483190 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.483555 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."analysis_crm_sales"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m00:10:44.499965 [debug] [Thread-1  ]: SQL status: SELECT 1050 in 0.016 seconds
[0m00:10:44.503767 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.504177 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."analysis_crm_sales"."crm_performance" rename to "crm_performance__dbt_backup"
[0m00:10:44.504788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:44.506607 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.506964 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."analysis_crm_sales"."crm_performance__dbt_tmp" rename to "crm_performance"
[0m00:10:44.507423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:10:44.517356 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m00:10:44.517720 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.518041 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m00:10:44.519384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:10:44.522813 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analysis_crm_sales"."crm_performance__dbt_backup"
[0m00:10:44.525113 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m00:10:44.525415 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
drop table if exists "company_dw"."analysis_crm_sales"."crm_performance__dbt_backup" cascade
[0m00:10:44.526861 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m00:10:44.528312 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m00:10:44.529344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1da4e36-9f91-422b-a134-e247efbbefcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa454cbe0>]}
[0m00:10:44.529896 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analysis_crm_sales.crm_performance ........... [[32mSELECT 1050[0m in 0.08s]
[0m00:10:44.530431 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m00:10:44.531519 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.531850 [debug] [MainThread]: On master: BEGIN
[0m00:10:44.532124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:44.533904 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:44.534324 [debug] [MainThread]: On master: COMMIT
[0m00:10:44.534625 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:44.534900 [debug] [MainThread]: On master: COMMIT
[0m00:10:44.535260 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:44.535557 [debug] [MainThread]: On master: Close
[0m00:10:44.535926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:44.536178 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:10:44.536490 [info ] [MainThread]: 
[0m00:10:44.536939 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m00:10:44.537497 [debug] [MainThread]: Command end result
[0m00:10:44.537789 [info ] [MainThread]: 
[0m00:10:44.538193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:44.538587 [info ] [MainThread]: 
[0m00:10:44.538955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:10:44.539628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.46761337, "process_user_time": 2.14351, "process_kernel_time": 0.066356, "process_mem_max_rss": "119580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:44.540175 [debug] [MainThread]: Command `dbt run` succeeded at 00:10:44.540127 after 0.47 seconds
[0m00:10:44.540505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e11d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c7af40>]}
[0m00:10:44.540843 [debug] [MainThread]: Flushing usage events
[0m00:10:47.009103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8732e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857e9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857e96d0>]}


============================== 00:10:47.013455 | 34abf147-4b13-4096-8d22-9dfef95f1454 ==============================
[0m00:10:47.013455 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:47.014142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:47.100465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858105e0>]}
[0m00:10:47.124443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa424af40>]}
[0m00:10:47.124962 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:47.135500 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:47.251438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:47.251789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:47.283530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa415eee0>]}
[0m00:10:47.294219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d186d0>]}
[0m00:10:47.294749 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:47.295130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f93040>]}
[0m00:10:47.296190 [info ] [MainThread]: 
[0m00:10:47.296704 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:10:47.299942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analysis_crm_sales'
[0m00:10:47.318178 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:47.318553 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: BEGIN
[0m00:10:47.318816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:47.320823 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:10:47.321106 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analysis_crm_sales"
[0m00:10:47.321410 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_analysis_crm_sales"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analysis_crm_sales'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analysis_crm_sales'
  
[0m00:10:47.322581 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m00:10:47.323281 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: ROLLBACK
[0m00:10:47.323615 [debug] [ThreadPool]: On list_company_dw_analysis_crm_sales: Close
[0m00:10:47.326600 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.326880 [debug] [MainThread]: On master: BEGIN
[0m00:10:47.327114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:47.328652 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:47.328905 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.329183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:10:47.334041 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:10:47.334762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34abf147-4b13-4096-8d22-9dfef95f1454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d18b20>]}
[0m00:10:47.335075 [debug] [MainThread]: On master: ROLLBACK
[0m00:10:47.335406 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.335626 [debug] [MainThread]: On master: BEGIN
[0m00:10:47.335955 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:10:47.336208 [debug] [MainThread]: On master: COMMIT
[0m00:10:47.336429 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.336638 [debug] [MainThread]: On master: COMMIT
[0m00:10:47.336919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:47.337193 [debug] [MainThread]: On master: Close
[0m00:10:47.337515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:10:47.337794 [info ] [MainThread]: 
[0m00:10:47.341843 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:10:47.342108 [debug] [Thread-2  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:10:47.342342 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:10:47.342682 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_ ....................... [RUN]
[0m00:10:47.343104 [info ] [Thread-2  ]: 2 of 3 START test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date ... [RUN]
[0m00:10:47.343506 [info ] [Thread-3  ]: 3 of 3 START test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date .. [RUN]
[0m00:10:47.343928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analysis_crm_sales, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4)
[0m00:10:47.344348 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63'
[0m00:10:47.344736 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39'
[0m00:10:47.345071 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:10:47.345422 [debug] [Thread-2  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:10:47.345750 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:10:47.358672 [debug] [Thread-3  ]: Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.359218 [debug] [Thread-2  ]: Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.359577 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.359938 [error] [Thread-3  ]: 3 of 3 ERROR valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date ....... [[31mERROR[0m in 0.02s]
[0m00:10:47.360388 [error] [Thread-2  ]: 2 of 3 ERROR valid_timestamp_or_null_crm_stg_sales_pipelines_close_date ........ [[31mERROR[0m in 0.02s]
[0m00:10:47.360843 [error] [Thread-1  ]: 1 of 3 ERROR no_nan_values_crm_stg_sales_pipelines_ ............................ [[31mERROR[0m in 0.02s]
[0m00:10:47.361276 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:10:47.361653 [debug] [Thread-2  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:10:47.362026 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:10:47.363275 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.363530 [debug] [MainThread]: On master: BEGIN
[0m00:10:47.363744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:47.365453 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:10:47.365696 [debug] [MainThread]: On master: COMMIT
[0m00:10:47.365916 [debug] [MainThread]: Using postgres connection "master"
[0m00:10:47.366119 [debug] [MainThread]: On master: COMMIT
[0m00:10:47.366395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:10:47.366651 [debug] [MainThread]: On master: Close
[0m00:10:47.366970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:47.367243 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4' was properly closed.
[0m00:10:47.367492 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63' was properly closed.
[0m00:10:47.367739 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:10:47.368000 [info ] [MainThread]: 
[0m00:10:47.368331 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m00:10:47.368823 [debug] [MainThread]: Command end result
[0m00:10:47.369053 [info ] [MainThread]: 
[0m00:10:47.369416 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:10:47.369708 [info ] [MainThread]: 
[0m00:10:47.370058 [error] [MainThread]:   Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.370423 [info ] [MainThread]: 
[0m00:10:47.370766 [error] [MainThread]:   Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.371118 [info ] [MainThread]: 
[0m00:10:47.371462 [error] [MainThread]:   Compilation Error in test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:10:47.371800 [info ] [MainThread]: 
[0m00:10:47.372124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m00:10:47.372652 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.39585888, "process_user_time": 2.109938, "process_kernel_time": 0.078625, "process_mem_max_rss": "122920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:47.373056 [debug] [MainThread]: Command `dbt test` failed at 00:10:47.373009 after 0.40 seconds
[0m00:10:47.373384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8732e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858105e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863e6d30>]}
[0m00:10:47.373669 [debug] [MainThread]: Flushing usage events
[0m00:10:49.084415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93674790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93674730>]}


============================== 00:10:49.087825 | 42e62460-5e14-4a36-b0c1-bfaa252729b0 ==============================
[0m00:10:49.087825 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:10:49.088428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_performance', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:10:49.164531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42e62460-5e14-4a36-b0c1-bfaa252729b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93710310>]}
[0m00:10:49.188275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42e62460-5e14-4a36-b0c1-bfaa252729b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9369b1f0>]}
[0m00:10:49.188825 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:10:49.198994 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:10:49.313943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:10:49.314286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:10:49.343125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42e62460-5e14-4a36-b0c1-bfaa252729b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2036f10>]}
[0m00:10:49.352688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42e62460-5e14-4a36-b0c1-bfaa252729b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bf16d0>]}
[0m00:10:49.353030 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:10:49.353493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42e62460-5e14-4a36-b0c1-bfaa252729b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1da1040>]}
[0m00:10:49.354259 [info ] [MainThread]: 
[0m00:10:49.354588 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:10:49.355597 [debug] [MainThread]: Command end result
[0m00:10:49.356092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29743695, "process_user_time": 2.041194, "process_kernel_time": 0.04614, "process_mem_max_rss": "116876", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:49.356471 [debug] [MainThread]: Command `dbt test` succeeded at 00:10:49.356430 after 0.30 seconds
[0m00:10:49.356763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9389c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93710310>]}
[0m00:10:49.357026 [debug] [MainThread]: Flushing usage events
[0m00:12:06.233432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6c32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8acbd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8acbd700>]}


============================== 00:12:06.236860 | 7151f9ff-d9e5-4d9f-9651-82bc769bdd3d ==============================
[0m00:12:06.236860 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:12:06.237394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:06.318640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97ae7f0>]}
[0m00:12:06.341625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeb6520>]}
[0m00:12:06.342134 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:06.353035 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:12:06.440192 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:12:06.440731 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m00:12:06.441037 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:12:06.441477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b85d2b0>]}
[0m00:12:07.183880 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:12:07.184587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cd6760>]}
[0m00:12:07.297601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ff2eb0>]}
[0m00:12:07.427883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2050d90>]}
[0m00:12:07.428313 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 652 macros
[0m00:12:07.428677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2006ee0>]}
[0m00:12:07.430002 [info ] [MainThread]: 
[0m00:12:07.430548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:07.433050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:12:07.450862 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:12:07.451328 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:12:07.451667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:07.453969 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:12:07.454289 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:12:07.454582 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:12:07.455883 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:12:07.456604 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:12:07.456963 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:12:07.460029 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:07.460268 [debug] [MainThread]: On master: BEGIN
[0m00:12:07.460457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:07.461886 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:12:07.462152 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:07.462408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:12:07.467602 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:12:07.468282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7151f9ff-d9e5-4d9f-9651-82bc769bdd3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93a4850>]}
[0m00:12:07.468591 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:07.468912 [debug] [MainThread]: On master: Close
[0m00:12:07.469229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:12:07.469594 [info ] [MainThread]: 
[0m00:12:07.474104 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:12:07.474350 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:12:07.474620 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:12:07.474918 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:12:07.475207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:12:07.475700 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:12:07.476162 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:12:07.476664 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:12:07.477093 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:12:07.477514 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:12:07.477864 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:12:07.478213 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:12:07.482727 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:12:07.484566 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:12:07.486323 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:12:07.487937 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:12:07.489948 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:12:07.490157 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:12:07.490805 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:12:07.491070 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:12:07.491402 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:12:07.491755 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:12:07.492105 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:12:07.492633 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:12:07.493074 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:12:07.493408 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values
[0m00:12:07.493836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:12:07.494171 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null
[0m00:12:07.494621 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:12:07.495020 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.no_nan_values)
[0m00:12:07.495308 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:12:07.495646 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.valid_timestamp_or_null)
[0m00:12:07.495960 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c)
[0m00:12:07.496250 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values
[0m00:12:07.498601 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:12:07.498912 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null
[0m00:12:07.499204 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:12:07.529194 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values"
[0m00:12:07.531369 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null"
[0m00:12:07.534458 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:12:07.534729 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values
[0m00:12:07.535128 [debug] [Thread-3  ]: Began executing node test.matt_demo.valid_timestamp_or_null
[0m00:12:07.535753 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:12:07.536195 [debug] [Thread-4  ]: Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.536595 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values
[0m00:12:07.537052 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null
[0m00:12:07.537404 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:12:07.537835 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:12:07.538172 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:12:07.538543 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:12:07.538923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now test.matt_demo.no_nan_values_crm_stg_products_.24667bb123)
[0m00:12:07.539309 [debug] [Thread-4  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:12:07.539668 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4)
[0m00:12:07.540007 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.valid_timestamp_or_null, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63)
[0m00:12:07.540312 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:12:07.540646 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39)
[0m00:12:07.540947 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:12:07.541300 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:12:07.544093 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_products_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.544304 [debug] [Thread-4  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:12:07.546786 [debug] [Thread-2  ]: Compilation Error in test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.549657 [debug] [Thread-3  ]: Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.550079 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:12:07.552401 [debug] [Thread-4  ]: Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  'test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.552813 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:12:07.553203 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:12:07.553594 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m00:12:07.554025 [debug] [Thread-4  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:12:07.554396 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:12:07.555042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_products_.24667bb123, now model.matt_demo.crm_performance)
[0m00:12:07.555639 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4, now test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0)
[0m00:12:07.555957 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m00:12:07.556272 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:12:07.558266 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:12:07.560713 [debug] [Thread-2  ]: Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.561308 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:12:07.561905 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m00:12:07.562330 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m00:12:07.562712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:07.562997 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:12:07.563195 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0' was properly closed.
[0m00:12:07.563414 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63' was properly closed.
[0m00:12:07.563653 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:12:07.563942 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
    'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:12:07.564545 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.3570026, "process_user_time": 3.126594, "process_kernel_time": 0.092999, "process_mem_max_rss": "138300", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:12:07.564911 [debug] [MainThread]: Command `dbt compile` failed at 00:12:07.564864 after 1.36 seconds
[0m00:12:07.565183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6c32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2050520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa203c340>]}
[0m00:12:07.565470 [debug] [MainThread]: Flushing usage events
[0m00:14:12.939381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6274c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d47730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d476d0>]}


============================== 00:14:12.943507 | 0da96e64-6b70-4f77-a377-b61cdce17df9 ==============================
[0m00:14:12.943507 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:14:12.944174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:14:13.023915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f6ac10>]}
[0m00:14:13.047850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60db6bb0>]}
[0m00:14:13.048481 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:14:13.060466 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:14:13.180083 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m00:14:13.180506 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/valid_timestamp_or_null.sql
[0m00:14:13.180824 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/no_nan_values.sql
[0m00:14:13.181114 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://tests/no_nan_values.sql
[0m00:14:13.181331 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://tests/valid_timestamp_or_null.sql
[0m00:14:13.232836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f426130>]}
[0m00:14:13.299793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f360e80>]}
[0m00:14:13.300200 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 654 macros
[0m00:14:13.300494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4359d0>]}
[0m00:14:13.301661 [info ] [MainThread]: 
[0m00:14:13.302215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:13.304632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:14:13.321900 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:14:13.322285 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:14:13.322589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:13.325335 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:14:13.325652 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:14:13.325947 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:14:13.327745 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:14:13.328436 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:14:13.328796 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:14:13.331854 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:13.332121 [debug] [MainThread]: On master: BEGIN
[0m00:14:13.332360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:14:13.334208 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:14:13.334456 [debug] [MainThread]: Using postgres connection "master"
[0m00:14:13.334744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:14:13.340110 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:14:13.340839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0da96e64-6b70-4f77-a377-b61cdce17df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60de5460>]}
[0m00:14:13.341165 [debug] [MainThread]: On master: ROLLBACK
[0m00:14:13.341490 [debug] [MainThread]: On master: Close
[0m00:14:13.341848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:13.342176 [info ] [MainThread]: 
[0m00:14:13.346215 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:14:13.346454 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:14:13.346686 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:14:13.346917 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:14:13.347324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:14:13.347733 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:14:13.348133 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:14:13.348527 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:14:13.348856 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:14:13.349212 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:14:13.349539 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:14:13.349846 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:14:13.353837 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:14:13.355427 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:14:13.356964 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:14:13.359109 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:14:13.360498 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:14:13.360836 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:14:13.361039 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:14:13.361451 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:14:13.361761 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:14:13.362098 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:14:13.362558 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:14:13.362919 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m00:14:13.363504 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:14:13.363828 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:14:13.364202 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:14:13.364583 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m00:14:13.364933 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:14:13.365306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_products_.24667bb123)
[0m00:14:13.365620 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c)
[0m00:14:13.365935 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m00:14:13.366262 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4)
[0m00:14:13.366554 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:14:13.366827 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:14:13.368561 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:14:13.368888 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:14:13.381590 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m00:14:13.382758 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m00:14:13.383154 [debug] [Thread-3  ]: Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
[0m00:14:13.383641 [debug] [Thread-1  ]: Compilation Error in test no_nan_values_crm_stg_products_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_products_ (models/crm_sales_data/staging/schema.yml)
[0m00:14:13.384106 [debug] [Thread-4  ]: Compilation Error in test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/staging/schema.yml)
[0m00:14:13.384361 [debug] [Thread-2  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:14:13.384764 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c
[0m00:14:13.385150 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_products_.24667bb123
[0m00:14:13.385538 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4
[0m00:14:13.385843 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63)
[0m00:14:13.386200 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:14:13.386615 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m00:14:13.386968 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:14:13.387269 [debug] [Thread-2  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:14:13.387597 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_accounts_.cbff4a134c, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39)
[0m00:14:13.387918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_products_.24667bb123, now model.matt_demo.crm_performance)
[0m00:14:13.388270 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_.ccf093fcc4, now test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0)
[0m00:14:13.390978 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:14:13.391391 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:14:13.391739 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m00:14:13.392068 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:14:13.394509 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:14:13.396467 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:14:13.396810 [debug] [Thread-2  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:14:13.399153 [debug] [Thread-4  ]: Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:14:13.399960 [debug] [Thread-2  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:14:13.400292 [debug] [Thread-3  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:14:13.400595 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0
[0m00:14:13.400847 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m00:14:13.401374 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:14:13.401955 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m00:14:13.402463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:13.402773 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:14:13.403020 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63' was properly closed.
[0m00:14:13.403264 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:14:13.403499 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_.9bcf3e7ab0' was properly closed.
[0m00:14:13.403808 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
    The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
    
    > in macro test_no_nan_values (macros/no_nan_values.sql)
    > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:14:13.404437 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4894647, "process_user_time": 2.185137, "process_kernel_time": 0.102334, "process_mem_max_rss": "124668", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:14:13.404870 [debug] [MainThread]: Command `dbt compile` failed at 00:14:13.404808 after 0.49 seconds
[0m00:14:13.405215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6274c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef0df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1420d0>]}
[0m00:14:13.405477 [debug] [MainThread]: Flushing usage events
[0m00:15:37.158843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b4c42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69abf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69abf6d0>]}


============================== 00:15:37.165297 | 441d8dd0-bcb5-4406-89f8-81732bc65a0c ==============================
[0m00:15:37.165297 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:15:37.165901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:37.243788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '441d8dd0-bcb5-4406-89f8-81732bc65a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885afee0>]}
[0m00:15:37.267984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '441d8dd0-bcb5-4406-89f8-81732bc65a0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a628550>]}
[0m00:15:37.268517 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:37.279083 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:15:37.394418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:15:37.394879 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m00:15:37.489002 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:37.489564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '441d8dd0-bcb5-4406-89f8-81732bc65a0c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881bf0d0>]}
[0m00:15:37.536080 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:15:37.536805 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.41405007, "process_user_time": 2.272995, "process_kernel_time": 0.106474, "process_mem_max_rss": "120716", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:37.537269 [debug] [MainThread]: Command `dbt compile` failed at 00:15:37.537208 after 0.41 seconds
[0m00:15:37.537575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b4c42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b1e0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852f6970>]}
[0m00:15:37.537839 [debug] [MainThread]: Flushing usage events
[0m00:15:39.808129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e5d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e5d6d0>]}


============================== 00:15:39.811631 | 406000a2-8217-44e2-9e07-e78feb0ce696 ==============================
[0m00:15:39.811631 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:15:39.812133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:39.890377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406000a2-8217-44e2-9e07-e78feb0ce696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e845e0>]}
[0m00:15:39.914587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '406000a2-8217-44e2-9e07-e78feb0ce696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988c0f40>]}
[0m00:15:39.915163 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:39.925050 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:15:40.006026 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:15:40.006523 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m00:15:40.006900 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:15:40.007355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '406000a2-8217-44e2-9e07-e78feb0ce696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1bd4c0>]}
[0m00:15:40.674020 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:40.674635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '406000a2-8217-44e2-9e07-e78feb0ce696', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987b8460>]}
[0m00:15:40.724292 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
[0m00:15:40.725043 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.94158506, "process_user_time": 2.701836, "process_kernel_time": 0.073293, "process_mem_max_rss": "115024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:40.725523 [debug] [MainThread]: Command `dbt test` failed at 00:15:40.725457 after 0.94 seconds
[0m00:15:40.725896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9876d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9567e9a0>]}
[0m00:15:40.726229 [debug] [MainThread]: Flushing usage events
[0m00:15:44.026075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607dc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ec39790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ec39730>]}


============================== 00:15:44.029458 | 2c8198ad-0f28-49a0-8458-a47866935298 ==============================
[0m00:15:44.029458 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:15:44.030064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:15:44.106175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c8198ad-0f28-49a0-8458-a47866935298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ecd5310>]}
[0m00:15:44.128815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c8198ad-0f28-49a0-8458-a47866935298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ec601f0>]}
[0m00:15:44.129360 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:44.139487 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:15:44.219513 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:15:44.220024 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m00:15:44.220355 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:15:44.220733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c8198ad-0f28-49a0-8458-a47866935298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f7d72b0>]}
[0m00:15:44.878826 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:44.879414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c8198ad-0f28-49a0-8458-a47866935298', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d680e50>]}
[0m00:15:44.930306 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
[0m00:15:44.931184 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.9292978, "process_user_time": 2.647185, "process_kernel_time": 0.053124, "process_mem_max_rss": "124536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:44.931690 [debug] [MainThread]: Command `dbt test` failed at 00:15:44.931623 after 0.93 seconds
[0m00:15:44.932054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607dc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ccbbb80>]}
[0m00:15:44.932399 [debug] [MainThread]: Flushing usage events
[0m00:15:48.063741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bc82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92024790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92024730>]}


============================== 00:15:48.067049 | fca08e03-b4fc-449f-a13c-22c9341869ae ==============================
[0m00:15:48.067049 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:15:48.067600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:15:48.141325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fca08e03-b4fc-449f-a13c-22c9341869ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920c0310>]}
[0m00:15:48.165061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fca08e03-b4fc-449f-a13c-22c9341869ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9204b1f0>]}
[0m00:15:48.165622 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:48.177613 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:15:48.261304 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:15:48.261855 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m00:15:48.262206 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:15:48.262637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fca08e03-b4fc-449f-a13c-22c9341869ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bc32b0>]}
[0m00:15:48.965303 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:48.965951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fca08e03-b4fc-449f-a13c-22c9341869ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a6be50>]}
[0m00:15:49.021729 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
[0m00:15:49.022654 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.98281956, "process_user_time": 2.660791, "process_kernel_time": 0.075908, "process_mem_max_rss": "130944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:49.023279 [debug] [MainThread]: Command `dbt test` failed at 00:15:49.023215 after 0.98 seconds
[0m00:15:49.023705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bc82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08de7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00a8a00>]}
[0m00:15:49.024067 [debug] [MainThread]: Flushing usage events
[0m00:15:52.265622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6509b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63557760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63557700>]}


============================== 00:15:52.269189 | 36502d11-8612-4adf-a974-79bb0f58d825 ==============================
[0m00:15:52.269189 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:15:52.269939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'send_anonymous_usage_stats': 'True'}
[0m00:15:52.353075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36502d11-8612-4adf-a974-79bb0f58d825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8209eac0>]}
[0m00:15:52.376437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36502d11-8612-4adf-a974-79bb0f58d825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649923a0>]}
[0m00:15:52.377048 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:15:52.389003 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m00:15:52.475564 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:15:52.476100 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m00:15:52.476462 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:15:52.476853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36502d11-8612-4adf-a974-79bb0f58d825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64abf910>]}
[0m00:15:53.146939 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:15:53.147464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '36502d11-8612-4adf-a974-79bb0f58d825', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f53aa90>]}
[0m00:15:53.199789 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_accounts_ (models/crm_sales_data/staging/schema.yml)
[0m00:15:53.200665 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.96240133, "process_user_time": 2.865404, "process_kernel_time": 0.120733, "process_mem_max_rss": "119236", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:15:53.201216 [debug] [MainThread]: Command `dbt test` failed at 00:15:53.201146 after 0.96 seconds
[0m00:15:53.201593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6509b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81dcb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cabdbb0>]}
[0m00:15:53.201939 [debug] [MainThread]: Flushing usage events
[0m00:17:02.562687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdd32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3ce700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3ce6a0>]}


============================== 00:17:02.566135 | 27b45302-001f-4ae4-b4f7-967f70105f64 ==============================
[0m00:17:02.566135 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:17:02.566775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m00:17:02.650642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b45302-001f-4ae4-b4f7-967f70105f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ebe8b0>]}
[0m00:17:02.674125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b45302-001f-4ae4-b4f7-967f70105f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5f1eb0>]}
[0m00:17:02.674755 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:17:02.685810 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:17:02.801386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:17:02.801837 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:17:02.802217 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m00:17:02.897834 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:17:02.898369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '27b45302-001f-4ae4-b4f7-967f70105f64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a94e20>]}
[0m00:17:02.950107 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:17:02.950945 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.41446775, "process_user_time": 2.155582, "process_kernel_time": 0.092024, "process_mem_max_rss": "119184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:17:02.951394 [debug] [MainThread]: Command `dbt compile` failed at 00:17:02.951307 after 0.41 seconds
[0m00:17:02.951716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdd32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c663d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cf4ca0>]}
[0m00:17:02.952020 [debug] [MainThread]: Flushing usage events
[0m00:20:41.108653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bee92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4e3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4e36d0>]}


============================== 00:20:41.112794 | 966ab1d1-4cd5-4b9d-9c51-2637568c8eae ==============================
[0m00:20:41.112794 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:20:41.113339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:41.193009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '966ab1d1-4cd5-4b9d-9c51-2637568c8eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fd5ee0>]}
[0m00:20:41.217809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '966ab1d1-4cd5-4b9d-9c51-2637568c8eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b04d550>]}
[0m00:20:41.218497 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:20:41.230938 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:20:41.351979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:20:41.352409 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m00:20:41.352671 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:20:41.449466 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:20:41.450025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '966ab1d1-4cd5-4b9d-9c51-2637568c8eae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bf92b0>]}
[0m00:20:41.496451 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:20:41.497161 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.41379282, "process_user_time": 2.123669, "process_kernel_time": 0.128029, "process_mem_max_rss": "123448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:20:41.497561 [debug] [MainThread]: Command `dbt compile` failed at 00:20:41.497498 after 0.41 seconds
[0m00:20:41.497880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bee92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d3c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3dcacd0>]}
[0m00:20:41.498183 [debug] [MainThread]: Flushing usage events
[0m00:22:02.354876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d98b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf86730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf866d0>]}


============================== 00:22:02.359102 | 46293de7-8d8b-4807-b8ba-d85bfafadeee ==============================
[0m00:22:02.359102 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:22:02.359659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:22:02.445623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa76ee0>]}
[0m00:22:02.470535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9caef550>]}
[0m00:22:02.471081 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:22:02.482841 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:22:02.597234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:22:02.597836 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:22:02.598153 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:22:02.598452 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m00:22:02.698410 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:22:02.698950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba96bd60>]}
[0m00:22:02.749292 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_stg_sales_teams_.d2b59e6c67' (models/crm_sales_data/staging/schema.yml) depends on a node named 'stg_sales_teams' in package '' which was not found
[0m00:22:02.789316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb52cd130>]}
[0m00:22:02.857077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb785ee50>]}
[0m00:22:02.857442 [info ] [MainThread]: Found 6 models, 4 sources, 654 macros
[0m00:22:02.857792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77b7910>]}
[0m00:22:02.859022 [info ] [MainThread]: 
[0m00:22:02.859483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:22:02.861931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:22:02.878401 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:22:02.878776 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:22:02.879076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:02.881857 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:22:02.882261 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:22:02.882620 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:22:02.884800 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m00:22:02.885500 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:22:02.885853 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:22:02.888654 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:02.888897 [debug] [MainThread]: On master: BEGIN
[0m00:22:02.889082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:02.890460 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:22:02.890739 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:02.891022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:22:02.896284 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:22:02.896949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46293de7-8d8b-4807-b8ba-d85bfafadeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c025400>]}
[0m00:22:02.897272 [debug] [MainThread]: On master: ROLLBACK
[0m00:22:02.897598 [debug] [MainThread]: On master: Close
[0m00:22:02.897958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:02.898305 [info ] [MainThread]: 
[0m00:22:02.902571 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:22:02.902824 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:22:02.903028 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:02.903308 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:22:02.903555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:22:02.904050 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:22:02.904434 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:22:02.904823 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:22:02.905168 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:22:02.905497 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:22:02.905843 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:02.906152 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:22:02.910247 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:22:02.912408 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:22:02.914003 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:22:02.915544 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:22:02.917056 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:22:02.917265 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:22:02.917570 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:02.917974 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:22:02.918189 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:22:02.919902 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:22:02.919108 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:02.919451 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:22:02.918597 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:22:02.920433 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m00:22:02.920738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:22:02.921133 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m00:22:02.921415 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:22:02.921674 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m00:22:02.923260 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:22:02.925234 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:22:02.925940 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:22:02.926241 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m00:22:02.926568 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:22:02.927031 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m00:22:02.927857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:02.928108 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:22:02.928377 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m00:22:02.928714 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m00:22:02.928971 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:22:02.929670 [debug] [MainThread]: Command end result
[0m00:22:02.981414 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.65264124, "process_user_time": 2.430909, "process_kernel_time": 0.122156, "process_mem_max_rss": "131456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:22:02.981813 [debug] [MainThread]: Command `dbt compile` succeeded at 00:22:02.981759 after 0.65 seconds
[0m00:22:02.982096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d98b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5979d0>]}
[0m00:22:02.982367 [debug] [MainThread]: Flushing usage events
[0m00:22:17.361537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce442e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b43e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b43e6d0>]}


============================== 00:22:17.365146 | c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe ==============================
[0m00:22:17.365146 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:22:17.365687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m00:22:17.444495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f2fee0>]}
[0m00:22:17.468701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfa8550>]}
[0m00:22:17.469208 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:22:17.480399 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:22:17.589684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:22:17.590228 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:22:17.683099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:22:17.683676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c7daf0>]}
[0m00:22:17.765790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa47c0130>]}
[0m00:22:17.829986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f39af0>]}
[0m00:22:17.830355 [info ] [MainThread]: Found 6 models, 1 test, 4 sources, 654 macros
[0m00:22:17.830703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb18a60>]}
[0m00:22:17.831662 [info ] [MainThread]: 
[0m00:22:17.832139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:22:17.834469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:22:17.849874 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:22:17.850275 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:22:17.850598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:17.852828 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:22:17.853121 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:22:17.853401 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:22:17.854535 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:22:17.855195 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:22:17.855554 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:22:17.858311 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:17.858588 [debug] [MainThread]: On master: BEGIN
[0m00:22:17.858840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:17.860342 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:22:17.860579 [debug] [MainThread]: Using postgres connection "master"
[0m00:22:17.860861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:22:17.865746 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:22:17.866464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45e40fe-f61f-4bf5-a58a-00ae3ec43dbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cac1f70>]}
[0m00:22:17.866793 [debug] [MainThread]: On master: ROLLBACK
[0m00:22:17.867121 [debug] [MainThread]: On master: Close
[0m00:22:17.867460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:22:17.867862 [info ] [MainThread]: 
[0m00:22:17.871837 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:22:17.872092 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:22:17.872315 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:17.872598 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:22:17.872838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:22:17.873279 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:22:17.873675 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:22:17.874068 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:22:17.874399 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:22:17.874719 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:22:17.875044 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:17.875378 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:22:17.879576 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:22:17.881306 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:22:17.883524 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:22:17.885098 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:22:17.886571 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:22:17.886851 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:22:17.887168 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:17.887525 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:22:17.887788 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:22:17.888200 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:22:17.888681 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:22:17.889029 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m00:22:17.889565 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:22:17.890378 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m00:22:17.890907 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m00:22:17.891131 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m00:22:17.891360 [debug] [Thread-3  ]: Began running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:22:17.891672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.crm_performance)
[0m00:22:17.893449 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:22:17.893796 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06)
[0m00:22:17.894077 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m00:22:17.894566 [debug] [Thread-3  ]: Began compiling node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:22:17.896428 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:22:17.896816 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m00:22:17.900419 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m00:22:17.900929 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m00:22:17.901664 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m00:22:17.902030 [debug] [Thread-3  ]: Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:22:17.902533 [debug] [Thread-3  ]: Finished running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:22:17.902932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:17.903288 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:22:17.903514 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:22:17.903719 [debug] [MainThread]: Connection 'test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06' was properly closed.
[0m00:22:17.903925 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m00:22:17.904237 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
    'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:22:17.904820 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5716439, "process_user_time": 2.45092, "process_kernel_time": 0.085415, "process_mem_max_rss": "125328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:22:17.905266 [debug] [MainThread]: Command `dbt compile` failed at 00:22:17.905216 after 0.57 seconds
[0m00:22:17.905573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce442e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c4b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9cf4160>]}
[0m00:22:17.905888 [debug] [MainThread]: Flushing usage events
[0m00:23:16.020480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9d02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf6b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf6b5e0>]}


============================== 00:23:16.023789 | 4b470641-d916-478c-b407-9d126f7a0a6e ==============================
[0m00:23:16.023789 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:23:16.024328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:16.075640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b470641-d916-478c-b407-9d126f7a0a6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfdb310>]}
[0m00:23:16.134577 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j9s0yl_k'
[0m00:23:16.135265 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:23:16.294795 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:23:16.295675 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:23:16.366587 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:23:16.372390 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:23:16.894444 [info ] [MainThread]: Installed from version 0.8.6
[0m00:23:16.894898 [info ] [MainThread]: Updated version available: 1.2.0
[0m00:23:16.895300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b470641-d916-478c-b407-9d126f7a0a6e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab62c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab70a6a0>]}
[0m00:23:16.895598 [info ] [MainThread]: 
[0m00:23:16.895920 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:23:16.896707 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.90033907, "process_user_time": 1.955318, "process_kernel_time": 0.092683, "process_mem_max_rss": "106108", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m00:23:16.897109 [debug] [MainThread]: Command `dbt deps` succeeded at 00:23:16.897048 after 0.90 seconds
[0m00:23:16.897377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9d02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfa9b50>]}
[0m00:23:16.897642 [debug] [MainThread]: Flushing usage events
[0m00:23:23.746768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993d42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979cf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979cf6d0>]}


============================== 00:23:23.750150 | a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5 ==============================
[0m00:23:23.750150 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:23:23.750740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:23:23.824627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64bfee0>]}
[0m00:23:23.848666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98538550>]}
[0m00:23:23.849492 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:23:23.862399 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:23:23.987472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:23.987836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:24.012462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60ef130>]}
[0m00:23:24.077023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6104af0>]}
[0m00:23:24.077377 [info ] [MainThread]: Found 6 models, 1 test, 4 sources, 654 macros
[0m00:23:24.077678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99177040>]}
[0m00:23:24.078612 [info ] [MainThread]: 
[0m00:23:24.079035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:23:24.081393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:23:24.097893 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:23:24.098292 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:23:24.098611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:24.100828 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:23:24.101117 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:23:24.101416 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:23:24.102620 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:23:24.103243 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:23:24.103585 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:23:24.106259 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:24.106547 [debug] [MainThread]: On master: BEGIN
[0m00:23:24.106818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:24.108292 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:23:24.108543 [debug] [MainThread]: Using postgres connection "master"
[0m00:23:24.108842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:23:24.113548 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m00:23:24.114272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a28d23dd-17c1-4ef9-8ac9-d8c1438e19e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a6d0a0>]}
[0m00:23:24.114645 [debug] [MainThread]: On master: ROLLBACK
[0m00:23:24.114967 [debug] [MainThread]: On master: Close
[0m00:23:24.115321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:23:24.115678 [info ] [MainThread]: 
[0m00:23:24.119649 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:23:24.119902 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:23:24.120171 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:23:24.120438 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:23:24.120679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:23:24.121099 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:23:24.121495 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:23:24.121889 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:23:24.122218 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:23:24.122531 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:23:24.122848 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:23:24.123181 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:23:24.127436 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:23:24.129455 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:23:24.131046 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:23:24.132700 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:23:24.134259 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:23:24.134514 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:23:24.134840 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:23:24.135229 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:23:24.135438 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:23:24.137121 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:23:24.136313 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:23:24.136652 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:23:24.135852 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:23:24.137587 [debug] [Thread-4  ]: Began running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:23:24.137982 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_performance
[0m00:23:24.138230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:23:24.138690 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06)
[0m00:23:24.139077 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.crm_performance)
[0m00:23:24.139368 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:23:24.139645 [debug] [Thread-4  ]: Began compiling node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:23:24.139955 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_performance
[0m00:23:24.141570 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:23:24.148555 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:23:24.149200 [debug] [Thread-4  ]: Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:23:24.150176 [debug] [Thread-4  ]: Finished running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:23:24.150485 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:23:24.151065 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_performance
[0m00:23:24.151382 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:23:24.151819 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_performance
[0m00:23:24.152378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:24.152672 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:23:24.152888 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m00:23:24.153107 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:23:24.153318 [debug] [MainThread]: Connection 'test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06' was properly closed.
[0m00:23:24.153626 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
    'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:23:24.154263 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.43241867, "process_user_time": 2.10469, "process_kernel_time": 0.07854, "process_mem_max_rss": "120160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:23:24.154597 [debug] [MainThread]: Command `dbt compile` failed at 00:23:24.154555 after 0.43 seconds
[0m00:23:24.154871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993d42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6104970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d24c10>]}
[0m00:23:24.155165 [debug] [MainThread]: Flushing usage events
[0m00:24:36.320222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f6e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865085e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86508580>]}


============================== 00:24:36.324094 | 5afb3335-dcb7-4e98-ada3-478dc27f6eb1 ==============================
[0m00:24:36.324094 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:24:36.324734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:24:36.383404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5afb3335-dcb7-4e98-ada3-478dc27f6eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867344f0>]}
[0m00:24:36.443571 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_xe5vcrj'
[0m00:24:36.444136 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:24:36.550738 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:24:36.551307 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:24:36.638110 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:24:36.643156 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:24:37.181499 [info ] [MainThread]: Installed from version 0.8.6
[0m00:24:37.182157 [info ] [MainThread]: Updated version available: 1.2.0
[0m00:24:37.182543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5afb3335-dcb7-4e98-ada3-478dc27f6eb1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ca64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cb5250>]}
[0m00:24:37.183068 [info ] [MainThread]: 
[0m00:24:37.183548 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:24:37.184664 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.88918823, "process_user_time": 1.959481, "process_kernel_time": 0.122842, "process_mem_max_rss": "110592", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m00:24:37.185273 [debug] [MainThread]: Command `dbt deps` succeeded at 00:24:37.185173 after 0.89 seconds
[0m00:24:37.185766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f6e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87865970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5be1f10>]}
[0m00:24:37.186153 [debug] [MainThread]: Flushing usage events
[0m00:24:49.965400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85413760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85413700>]}


============================== 00:24:49.969108 | 5b25f962-4b01-4677-8100-c49839683381 ==============================
[0m00:24:49.969108 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:24:49.969743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:50.058828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f03550>]}
[0m00:24:50.083506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8560b520>]}
[0m00:24:50.084141 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:24:50.095312 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:24:50.217054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:50.217409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:50.242654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b33130>]}
[0m00:24:50.314865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dfe070>]}
[0m00:24:50.315235 [info ] [MainThread]: Found 6 models, 1 test, 4 sources, 654 macros
[0m00:24:50.315572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e17a30>]}
[0m00:24:50.316563 [info ] [MainThread]: 
[0m00:24:50.317021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:24:50.319513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:24:50.336049 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:24:50.336457 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:24:50.336758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:50.339015 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:24:50.339306 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:24:50.339636 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:24:50.341238 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:24:50.341945 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:24:50.342310 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:24:50.345112 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:50.345387 [debug] [MainThread]: On master: BEGIN
[0m00:24:50.345643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:50.347159 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:24:50.347438 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:50.347720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:24:50.352825 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:24:50.353483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b25f962-4b01-4677-8100-c49839683381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e17a30>]}
[0m00:24:50.353777 [debug] [MainThread]: On master: ROLLBACK
[0m00:24:50.354099 [debug] [MainThread]: On master: Close
[0m00:24:50.354491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:50.354863 [info ] [MainThread]: 
[0m00:24:50.358947 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:24:50.359171 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:24:50.359445 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:24:50.359669 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:24:50.359992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:24:50.360392 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:24:50.360781 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:24:50.361161 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:24:50.361494 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:24:50.361810 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:24:50.362117 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:24:50.362421 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:24:50.366593 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:24:50.368571 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:24:50.370273 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:24:50.371921 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:24:50.373435 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:24:50.373683 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:24:50.374014 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:24:50.374399 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:24:50.374730 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:24:50.375070 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:24:50.375506 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:24:50.375821 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m00:24:50.376312 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:24:50.376988 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m00:24:50.377945 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m00:24:50.377742 [debug] [Thread-3  ]: Began running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:24:50.377516 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m00:24:50.379693 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:24:50.380038 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06)
[0m00:24:50.380778 [debug] [Thread-3  ]: Began compiling node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:24:50.380341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.crm_performance)
[0m00:24:50.385164 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m00:24:50.385400 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m00:24:50.386273 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m00:24:50.388995 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:24:50.389654 [debug] [Thread-3  ]: Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:24:50.390119 [debug] [Thread-3  ]: Finished running node test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06
[0m00:24:50.390473 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m00:24:50.391015 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m00:24:50.391319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:50.391654 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:24:50.391874 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:24:50.392081 [debug] [MainThread]: Connection 'test.matt_demo.test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_.1df42e7f06' was properly closed.
[0m00:24:50.392298 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m00:24:50.392608 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
    'test_test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:24:50.393219 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.45515072, "process_user_time": 2.179385, "process_kernel_time": 0.093059, "process_mem_max_rss": "119296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:50.393658 [debug] [MainThread]: Command `dbt compile` failed at 00:24:50.393607 after 0.46 seconds
[0m00:24:50.393979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b48820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36215e0>]}
[0m00:24:50.394292 [debug] [MainThread]: Flushing usage events
[0m00:25:14.445561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0292e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b624730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b6246d0>]}


============================== 00:25:14.448767 | cdec1118-cd0d-4c82-9b23-507b575fd929 ==============================
[0m00:25:14.448767 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:25:14.449375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:14.523319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdec1118-cd0d-4c82-9b23-507b575fd929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a114ee0>]}
[0m00:25:14.546437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdec1118-cd0d-4c82-9b23-507b575fd929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c18dfd0>]}
[0m00:25:14.546971 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:25:14.557264 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:25:14.679565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:14.680073 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:25:14.774613 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:25:14.775245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdec1118-cd0d-4c82-9b23-507b575fd929', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d61f40>]}
[0m00:25:14.828152 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'args'
[0m00:25:14.828999 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4074733, "process_user_time": 2.136064, "process_kernel_time": 0.088002, "process_mem_max_rss": "117540", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:25:14.829481 [debug] [MainThread]: Command `dbt compile` failed at 00:25:14.829415 after 0.41 seconds
[0m00:25:14.829826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0292e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e51910>]}
[0m00:25:14.830125 [debug] [MainThread]: Flushing usage events
[0m00:25:32.945408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff657ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63dc5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63dc5700>]}


============================== 00:25:32.948646 | 3e0af582-1e8e-4398-9710-6f858038f91f ==============================
[0m00:25:32.948646 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:25:32.949213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:33.023623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e0af582-1e8e-4398-9710-6f858038f91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828b5850>]}
[0m00:25:33.046482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e0af582-1e8e-4398-9710-6f858038f91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63fbe520>]}
[0m00:25:33.047017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:25:33.058647 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:25:33.171802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:33.172303 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:25:33.262866 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:25:33.263427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e0af582-1e8e-4398-9710-6f858038f91f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff654ce640>]}
[0m00:25:33.311964 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:25:33.312666 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.3912774, "process_user_time": 2.153896, "process_kernel_time": 0.065996, "process_mem_max_rss": "119136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:25:33.313148 [debug] [MainThread]: Command `dbt compile` failed at 00:25:33.313098 after 0.39 seconds
[0m00:25:33.313457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff657ca2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6a5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824619a0>]}
[0m00:25:33.313734 [debug] [MainThread]: Flushing usage events
[0m00:27:58.925131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70eb36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70eb3640>]}


============================== 00:27:58.929715 | a95f39a1-eb91-468c-8c42-6aa5b8132f69 ==============================
[0m00:27:58.929715 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:27:58.930227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:58.989814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95f39a1-eb91-468c-8c42-6aa5b8132f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727258b0>]}
[0m00:27:59.046791 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-xm7vi8ln'
[0m00:27:59.047442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:27:59.167525 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:27:59.168231 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:27:59.224577 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:27:59.228835 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:27:59.779978 [info ] [MainThread]: Installed from version 0.8.6
[0m00:27:59.780462 [info ] [MainThread]: Updated version available: 1.2.0
[0m00:27:59.781115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a95f39a1-eb91-468c-8c42-6aa5b8132f69', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9069d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f07940>]}
[0m00:27:59.781556 [info ] [MainThread]: 
[0m00:27:59.782087 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m00:27:59.782988 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8837073, "process_user_time": 1.9327, "process_kernel_time": 0.122615, "process_mem_max_rss": "107888", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m00:27:59.783454 [debug] [MainThread]: Command `dbt deps` succeeded at 00:27:59.783395 after 0.88 seconds
[0m00:27:59.783944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff729182e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9069d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff727258b0>]}
[0m00:27:59.784322 [debug] [MainThread]: Flushing usage events
[0m00:28:04.590720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d13e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b739730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7396d0>]}


============================== 00:28:04.594057 | 88f77f7d-2e90-4110-a414-f7b7e163b172 ==============================
[0m00:28:04.594057 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:28:04.594648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:04.669668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88f77f7d-2e90-4110-a414-f7b7e163b172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa229ee0>]}
[0m00:28:04.693876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88f77f7d-2e90-4110-a414-f7b7e163b172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2a2550>]}
[0m00:28:04.694415 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:28:04.706187 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:28:04.833646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:28:04.834224 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:28:04.834615 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:28:04.929691 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:28:04.930247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88f77f7d-2e90-4110-a414-f7b7e163b172', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa193970>]}
[0m00:28:04.982031 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'model'
[0m00:28:04.982792 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4175162, "process_user_time": 2.156448, "process_kernel_time": 0.078197, "process_mem_max_rss": "123516", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:04.983206 [debug] [MainThread]: Command `dbt compile` failed at 00:28:04.983152 after 0.42 seconds
[0m00:28:04.983525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d13e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7058f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7058d00>]}
[0m00:28:04.983870 [debug] [MainThread]: Flushing usage events
[0m00:28:41.427542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bda0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bda05b0>]}


============================== 00:28:41.430942 | aba932ad-bf9b-4dbb-98dc-7fdcc13521ef ==============================
[0m00:28:41.430942 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:28:41.431541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:41.507615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba932ad-bf9b-4dbb-98dc-7fdcc13521ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d663100>]}
[0m00:28:41.530780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba932ad-bf9b-4dbb-98dc-7fdcc13521ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8aa8b0>]}
[0m00:28:41.531301 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:28:41.541367 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:28:41.659254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:28:41.659744 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:28:41.660097 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:28:41.751768 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:28:41.752310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aba932ad-bf9b-4dbb-98dc-7fdcc13521ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba84acd0>]}
[0m00:28:41.758931 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/crm_sales_data/staging/schema.yml:
  	test arguments must be a dict, got <class 'NoneType'> (value None)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:28:41.759613 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.36093315, "process_user_time": 2.271573, "process_kernel_time": 0.071593, "process_mem_max_rss": "119336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:41.760004 [debug] [MainThread]: Command `dbt compile` failed at 00:28:41.759951 after 0.36 seconds
[0m00:28:41.760301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d7a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76c0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76a65b0>]}
[0m00:28:41.760621 [debug] [MainThread]: Flushing usage events
[0m00:28:59.527813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b0d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94108730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941086d0>]}


============================== 00:28:59.531423 | 184840b4-1e70-4be9-aef0-374020313d1e ==============================
[0m00:28:59.531423 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:28:59.531973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:59.669000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '184840b4-1e70-4be9-aef0-374020313d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2bf8ee0>]}
[0m00:28:59.693303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '184840b4-1e70-4be9-aef0-374020313d1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c71550>]}
[0m00:28:59.693927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:28:59.705073 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:28:59.819786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:28:59.820314 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:28:59.820629 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:28:59.914823 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:28:59.915459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '184840b4-1e70-4be9-aef0-374020313d1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b62970>]}
[0m00:28:59.921856 [error] [MainThread]: Encountered an error:
Compilation Error
  Invalid generic test configuration given in models/crm_sales_data/staging/schema.yml: 
  Test arguments include "model", which is a reserved argument
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:28:59.922557 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4242656, "process_user_time": 2.171753, "process_kernel_time": 0.080323, "process_mem_max_rss": "123168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:28:59.922941 [debug] [MainThread]: Command `dbt compile` failed at 00:28:59.922889 after 0.42 seconds
[0m00:28:59.923234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b0d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5e8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5d1730>]}
[0m00:28:59.923554 [debug] [MainThread]: Flushing usage events
[0m00:29:15.560507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f4042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d9fd6d0>]}


============================== 00:29:15.563803 | e0411cd2-94a1-4be7-8466-2def434db026 ==============================
[0m00:29:15.563803 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:29:15.564413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m00:29:15.644000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0411cd2-94a1-4be7-8466-2def434db026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f2c06d0>]}
[0m00:29:15.668100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0411cd2-94a1-4be7-8466-2def434db026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dc21a90>]}
[0m00:29:15.668693 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:29:15.679916 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:29:15.797671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:29:15.798186 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:29:15.798489 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:29:15.893772 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:29:15.894356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0411cd2-94a1-4be7-8466-2def434db026', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0d14f0>]}
[0m00:29:15.945319 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'model'
[0m00:29:15.946037 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.41042432, "process_user_time": 2.202748, "process_kernel_time": 0.091696, "process_mem_max_rss": "119092", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:29:15.946445 [debug] [MainThread]: Command `dbt compile` failed at 00:29:15.946393 after 0.41 seconds
[0m00:29:15.946751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f4042e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8930b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8931dcd0>]}
[0m00:29:15.947093 [debug] [MainThread]: Flushing usage events
[0m00:30:29.442488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755d42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bce730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73bce6d0>]}


============================== 00:30:29.446972 | 3be6417c-c9a4-4c67-9c65-1aa8d2c65e90 ==============================
[0m00:30:29.446972 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:30:29.447612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m00:30:29.531694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3be6417c-c9a4-4c67-9c65-1aa8d2c65e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73df1c10>]}
[0m00:30:29.561661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3be6417c-c9a4-4c67-9c65-1aa8d2c65e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c3ebb0>]}
[0m00:30:29.562548 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:30:29.575412 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:30:29.694213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:30:29.694715 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:30:29.695025 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:30:29.791608 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:30:29.792176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3be6417c-c9a4-4c67-9c65-1aa8d2c65e90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d46c970>]}
[0m00:30:29.842557 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_team_name__crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'column_name'
[0m00:30:29.843282 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.42622286, "process_user_time": 2.143096, "process_kernel_time": 0.098279, "process_mem_max_rss": "121168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:30:29.843693 [debug] [MainThread]: Command `dbt compile` failed at 00:30:29.843638 after 0.43 seconds
[0m00:30:29.844019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff755d42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff752f0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3d4fa0>]}
[0m00:30:29.844355 [debug] [MainThread]: Flushing usage events
[0m00:30:53.535560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9422e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f3c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f3c700>]}


============================== 00:30:53.538846 | ee8b62fd-daf1-41a7-b7f3-1f50f3e90ce6 ==============================
[0m00:30:53.538846 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:30:53.539420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:30:53.615384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee8b62fd-daf1-41a7-b7f3-1f50f3e90ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ad18b0>]}
[0m00:30:53.638290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee8b62fd-daf1-41a7-b7f3-1f50f3e90ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7a4cd30>]}
[0m00:30:53.638806 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:30:53.649225 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:30:53.766561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:30:53.767031 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:30:53.767354 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:30:53.862713 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:30:53.863282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee8b62fd-daf1-41a7-b7f3-1f50f3e90ce6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79e6c40>]}
[0m00:30:53.910621 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'model'
[0m00:30:53.911321 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.39967808, "process_user_time": 2.067378, "process_kernel_time": 0.08547, "process_mem_max_rss": "121868", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:30:53.911713 [debug] [MainThread]: Command `dbt compile` failed at 00:30:53.911665 after 0.40 seconds
[0m00:30:53.912004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9422e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa284d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa285bd00>]}
[0m00:30:53.912313 [debug] [MainThread]: Flushing usage events
[0m00:35:47.091664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bc72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff751c1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff751c1610>]}


============================== 00:35:47.095808 | 677e59f6-59fd-4425-9219-c32f4a84e99f ==============================
[0m00:35:47.095808 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:35:47.096427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:47.182134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677e59f6-59fd-4425-9219-c32f4a84e99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76a84100>]}
[0m00:35:47.206012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677e59f6-59fd-4425-9219-c32f4a84e99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cb2c40>]}
[0m00:35:47.206573 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:35:47.219978 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:35:47.340907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:35:47.341387 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:35:47.341648 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:35:47.444022 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:35:47.444664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '677e59f6-59fd-4425-9219-c32f4a84e99f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c1c430>]}
[0m00:35:47.492736 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
[0m00:35:47.493554 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4286855, "process_user_time": 2.164126, "process_kernel_time": 0.140748, "process_mem_max_rss": "119756", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:35:47.493989 [debug] [MainThread]: Command `dbt compile` failed at 00:35:47.493916 after 0.43 seconds
[0m00:35:47.494337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bc72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ad3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ae0c70>]}
[0m00:35:47.494662 [debug] [MainThread]: Flushing usage events
[0m00:40:54.836367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f2212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d81c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d81c700>]}


============================== 00:40:54.840444 | 71a666d9-e481-4c0e-abcd-c9c7c6810643 ==============================
[0m00:40:54.840444 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:40:54.841005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:40:54.921236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71a666d9-e481-4c0e-abcd-c9c7c6810643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c30c2b0>]}
[0m00:40:54.945458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71a666d9-e481-4c0e-abcd-c9c7c6810643', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6da14520>]}
[0m00:40:54.946027 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:40:54.958061 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:40:55.075519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:40:55.076015 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:40:55.076286 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:40:55.170193 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:40:55.170727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '71a666d9-e481-4c0e-abcd-c9c7c6810643', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e67430>]}
[0m00:40:55.174957 [error] [MainThread]: Encountered an error:
Compilation Error
  Invalid generic test configuration given in models/crm_sales_data/staging/schema.yml: 
  Test arguments include "model", which is a reserved argument
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m00:40:55.175594 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.36562243, "process_user_time": 2.115135, "process_kernel_time": 0.108494, "process_mem_max_rss": "116740", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:40:55.176027 [debug] [MainThread]: Command `dbt compile` failed at 00:40:55.175976 after 0.37 seconds
[0m00:40:55.176325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f2212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cf8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cea430>]}
[0m00:40:55.176620 [debug] [MainThread]: Flushing usage events
[0m00:41:21.708898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f456760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f456700>]}


============================== 00:41:21.712146 | d5de3b58-2fb6-4f49-86d2-34d8225ecc0a ==============================
[0m00:41:21.712146 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:41:21.712728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:21.789796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5de3b58-2fb6-4f49-86d2-34d8225ecc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df46550>]}
[0m00:41:21.813481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5de3b58-2fb6-4f49-86d2-34d8225ecc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f64e520>]}
[0m00:41:21.813994 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:41:21.825288 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:41:21.943050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:41:21.943563 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:41:21.943888 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:41:22.038871 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:41:22.039424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5de3b58-2fb6-4f49-86d2-34d8225ecc0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8badb970>]}
[0m00:41:22.083652 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_ref_crm_stg_sales_teams_ (models/crm_sales_data/staging/schema.yml)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m00:41:22.084307 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.40048578, "process_user_time": 2.147727, "process_kernel_time": 0.073126, "process_mem_max_rss": "117252", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:41:22.084890 [debug] [MainThread]: Command `dbt compile` failed at 00:41:22.084827 after 0.40 seconds
[0m00:41:22.085185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d34f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d34d30>]}
[0m00:41:22.085500 [debug] [MainThread]: Flushing usage events
[0m00:41:49.995572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876492e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c44670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c44610>]}


============================== 00:41:50.000219 | eac2715f-4b57-42d8-9fc5-0543936d9cff ==============================
[0m00:41:50.000219 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:41:50.000840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m00:41:50.083429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eac2715f-4b57-42d8-9fc5-0543936d9cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87506100>]}
[0m00:41:50.108572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eac2715f-4b57-42d8-9fc5-0543936d9cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4734c40>]}
[0m00:41:50.109276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:41:50.120488 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:41:50.236546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:41:50.237048 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:41:50.237353 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:41:50.333984 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:41:50.334547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eac2715f-4b57-42d8-9fc5-0543936d9cff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa469e430>]}
[0m00:41:50.386051 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'model'
[0m00:41:50.386931 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.41690537, "process_user_time": 2.163379, "process_kernel_time": 0.100971, "process_mem_max_rss": "116648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:41:50.387431 [debug] [MainThread]: Command `dbt compile` failed at 00:41:50.387362 after 0.42 seconds
[0m00:41:50.387815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876492e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f113250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f120c70>]}
[0m00:41:50.388206 [debug] [MainThread]: Flushing usage events
[0m00:44:26.756061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bef5e0>]}


============================== 00:44:26.760370 | d56c3ade-2d78-4d6e-92b4-e1036022b9f4 ==============================
[0m00:44:26.760370 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:44:26.760994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:44:26.841660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa761c910>]}
[0m00:44:26.864919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89264160>]}
[0m00:44:26.865555 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:44:26.877566 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:44:26.989828 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m00:44:26.990296 [debug] [MainThread]: Partial parsing: added file: matt_demo://tests/valid_timestamp_or_null.sql
[0m00:44:26.990586 [debug] [MainThread]: Partial parsing: added file: matt_demo://tests/no_nan_values.sql
[0m00:44:26.990906 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:44:26.991177 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/valid_timestamp_or_null.sql
[0m00:44:26.991448 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/no_nan_values.sql
[0m00:44:27.138295 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:44:27.138855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7296b20>]}
[0m00:44:27.216124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe71ee0>]}
[0m00:44:27.295113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe7cdc0>]}
[0m00:44:27.295504 [info ] [MainThread]: Found 6 models, 3 data tests, 4 sources, 652 macros
[0m00:44:27.295837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe86400>]}
[0m00:44:27.297282 [info ] [MainThread]: 
[0m00:44:27.297787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:27.300148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:44:27.318101 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:44:27.318561 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:44:27.318895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:27.321450 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:44:27.321752 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:44:27.322069 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:44:27.323941 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m00:44:27.324595 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:44:27.324948 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:44:27.327677 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:27.327958 [debug] [MainThread]: On master: BEGIN
[0m00:44:27.328229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:27.329693 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:44:27.329937 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:27.330254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:44:27.335577 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:44:27.336273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd56c3ade-2d78-4d6e-92b4-e1036022b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5c9f10>]}
[0m00:44:27.336566 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:27.336880 [debug] [MainThread]: On master: Close
[0m00:44:27.337261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:27.337617 [info ] [MainThread]: 
[0m00:44:27.341842 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:44:27.342078 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:44:27.342339 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:44:27.342569 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:44:27.342896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:44:27.343331 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:44:27.343677 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:44:27.344066 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:44:27.344443 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:44:27.344776 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:44:27.345127 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:44:27.345475 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:44:27.350044 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:44:27.379592 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:44:27.381457 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:44:27.383013 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:44:27.386212 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:44:27.386471 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:44:27.386773 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:44:27.387207 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:44:27.387597 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:44:27.387934 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:44:27.388411 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:44:27.388760 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:44:27.389217 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:44:27.389527 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values
[0m00:44:27.389849 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null
[0m00:44:27.390213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:44:27.390713 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m00:44:27.390939 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.no_nan_values)
[0m00:44:27.391246 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.valid_timestamp_or_null)
[0m00:44:27.391539 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:44:27.391860 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m00:44:27.392177 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values
[0m00:44:27.392444 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null
[0m00:44:27.394122 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:44:27.394476 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m00:44:27.398187 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values"
[0m00:44:27.400187 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null"
[0m00:44:27.403265 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:44:27.403655 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values
[0m00:44:27.403953 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:44:27.404143 [debug] [Thread-3  ]: Began executing node test.matt_demo.valid_timestamp_or_null
[0m00:44:27.404743 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values
[0m00:44:27.405326 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:44:27.405616 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m00:44:27.405955 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null
[0m00:44:27.406296 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m00:44:27.406895 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m00:44:27.407343 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m00:44:27.407749 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m00:44:27.410687 [debug] [Thread-2  ]: Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
  'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:44:27.411015 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m00:44:27.411406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:27.411681 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:44:27.411913 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m00:44:27.412134 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null' was properly closed.
[0m00:44:27.412350 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:44:27.412702 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams (models/crm_sales_data/staging/schema.yml)
    'test_no_nan_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:44:27.413439 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.68282986, "process_user_time": 2.36384, "process_kernel_time": 0.103817, "process_mem_max_rss": "129820", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:44:27.413880 [debug] [MainThread]: Command `dbt compile` failed at 00:44:27.413828 after 0.68 seconds
[0m00:44:27.414163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b329400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3293d0>]}
[0m00:44:27.414490 [debug] [MainThread]: Flushing usage events
[0m00:49:59.333178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90baf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1a9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1a9700>]}


============================== 00:49:59.337743 | 6844b174-6623-4362-a9e1-02bbb74ba91d ==============================
[0m00:49:59.337743 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:49:59.338384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:49:59.430210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadce9850>]}
[0m00:49:59.457806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1e5a30>]}
[0m00:49:59.458460 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:49:59.471004 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:49:59.609522 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m00:49:59.609951 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/valid_timestamp_or_null.sql
[0m00:49:59.610183 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/no_nan_values.sql
[0m00:49:59.610512 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:49:59.610757 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://tests/valid_timestamp_or_null.sql
[0m00:49:59.611065 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://tests/no_nan_values.sql
[0m00:49:59.707325 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:49:59.707890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8681b20>]}
[0m00:49:59.794469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8568130>]}
[0m00:49:59.862265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada4a8e0>]}
[0m00:49:59.862634 [info ] [MainThread]: Found 6 models, 1 test, 4 sources, 654 macros
[0m00:49:59.862947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85a8d60>]}
[0m00:49:59.863884 [info ] [MainThread]: 
[0m00:49:59.864367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:49:59.866900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:49:59.882966 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:49:59.883385 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:49:59.883695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:49:59.885980 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:49:59.886298 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:49:59.886596 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:49:59.888185 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:49:59.888808 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:49:59.889179 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:49:59.891892 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:59.892176 [debug] [MainThread]: On master: BEGIN
[0m00:49:59.892432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:49:59.893894 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:49:59.894147 [debug] [MainThread]: Using postgres connection "master"
[0m00:49:59.894436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:49:59.899630 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:49:59.900329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6844b174-6623-4362-a9e1-02bbb74ba91d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa857bf10>]}
[0m00:49:59.900637 [debug] [MainThread]: On master: ROLLBACK
[0m00:49:59.900953 [debug] [MainThread]: On master: Close
[0m00:49:59.901292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:49:59.901659 [info ] [MainThread]: 
[0m00:49:59.905754 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:49:59.906024 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:49:59.906245 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:49:59.906470 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:49:59.906804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:49:59.907255 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:49:59.907646 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:49:59.908044 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:49:59.908387 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:49:59.908707 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:49:59.909020 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:49:59.909341 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:49:59.913473 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:49:59.915050 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:49:59.917171 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:49:59.918712 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:49:59.920212 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:49:59.920473 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:49:59.920720 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:49:59.921007 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:49:59.921360 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:49:59.921768 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:49:59.922266 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:49:59.922685 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:49:59.923012 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:49:59.923591 [debug] [Thread-2  ]: Began running node test.matt_demo.test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.ad7617234b
[0m00:49:59.923998 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_performance
[0m00:49:59.924328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:49:59.924620 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.ad7617234b)
[0m00:49:59.924952 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.crm_performance)
[0m00:49:59.925275 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:49:59.925553 [debug] [Thread-2  ]: Began compiling node test.matt_demo.test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.ad7617234b
[0m00:49:59.925904 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_performance
[0m00:49:59.927597 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:49:59.930577 [debug] [Thread-2  ]: Compilation Error in test test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  'test_test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:49:59.932882 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:49:59.933570 [debug] [Thread-2  ]: Finished running node test.matt_demo.test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.ad7617234b
[0m00:49:59.934455 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:49:59.934836 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_performance
[0m00:49:59.935222 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:49:59.935635 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_performance
[0m00:49:59.936198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:49:59.936521 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:49:59.936764 [debug] [MainThread]: Connection 'test.matt_demo.test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.ad7617234b' was properly closed.
[0m00:49:59.936991 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:49:59.937200 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m00:49:59.937515 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
    'test_test_valid_timestamp_or_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:49:59.938116 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.6337348, "process_user_time": 2.314434, "process_kernel_time": 0.129024, "process_mem_max_rss": "130844", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:49:59.938446 [debug] [MainThread]: Command `dbt compile` failed at 00:49:59.938404 after 0.63 seconds
[0m00:49:59.938719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90baf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85b3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81828e0>]}
[0m00:49:59.939000 [debug] [MainThread]: Flushing usage events
[0m00:50:10.384939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dffd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5f8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5f86d0>]}


============================== 00:50:10.388456 | c28e456b-c116-4d64-bdd7-14a4bec20228 ==============================
[0m00:50:10.388456 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:50:10.389062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:50:10.467385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c28e456b-c116-4d64-bdd7-14a4bec20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0e8ee0>]}
[0m00:50:10.492340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c28e456b-c116-4d64-bdd7-14a4bec20228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d161550>]}
[0m00:50:10.493030 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:50:10.506413 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:50:10.698234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:50:10.698739 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:50:10.792540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:50:10.793138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c28e456b-c116-4d64-bdd7-14a4bec20228', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0e8b20>]}
[0m00:50:10.841911 [error] [MainThread]: Encountered an error:
Compilation Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  macro 'dbt_macro__test_valid_timestamp_or_null' takes no keyword argument 'model'
[0m00:50:10.842749 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.48670983, "process_user_time": 2.218226, "process_kernel_time": 0.079149, "process_mem_max_rss": "117948", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:50:10.843223 [debug] [MainThread]: Command `dbt compile` failed at 00:50:10.843166 after 0.49 seconds
[0m00:50:10.843564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dffd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e171c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f42ca0>]}
[0m00:50:10.843879 [debug] [MainThread]: Flushing usage events
[0m00:52:25.008464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff732362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71831730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718316d0>]}


============================== 00:52:25.012918 | dabee833-45b3-4e45-895d-5b3560f38e6e ==============================
[0m00:52:25.012918 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:52:25.013530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:52:25.098571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a54c10>]}
[0m00:52:25.123476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718a0bb0>]}
[0m00:52:25.124079 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:52:25.138267 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:52:25.253658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:52:25.254162 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:52:25.254484 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/valid_timestamp_or_null.sql
[0m00:52:25.349230 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:52:25.349807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d0b580>]}
[0m00:52:25.435739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bd7130>]}
[0m00:52:25.501167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c3a0d0>]}
[0m00:52:25.501554 [info ] [MainThread]: Found 6 models, 1 test, 4 sources, 654 macros
[0m00:52:25.501888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff95790>]}
[0m00:52:25.502918 [info ] [MainThread]: 
[0m00:52:25.503377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:52:25.505797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:52:25.522266 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:52:25.522673 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:52:25.522983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:25.525377 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:52:25.525720 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:52:25.526036 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:52:25.527885 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m00:52:25.528572 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:52:25.528933 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:52:25.531632 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:25.531908 [debug] [MainThread]: On master: BEGIN
[0m00:52:25.532146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:25.533698 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:52:25.533940 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:25.534245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:52:25.539444 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:52:25.540215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dabee833-45b3-4e45-895d-5b3560f38e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7320bbe0>]}
[0m00:52:25.540567 [debug] [MainThread]: On master: ROLLBACK
[0m00:52:25.540886 [debug] [MainThread]: On master: Close
[0m00:52:25.541237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:25.541648 [info ] [MainThread]: 
[0m00:52:25.545661 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:52:25.545912 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:52:25.546138 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:52:25.546382 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:52:25.546745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:52:25.547209 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:52:25.547600 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:52:25.547986 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:52:25.548323 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:52:25.548668 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:52:25.548982 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:52:25.549331 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:52:25.553578 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:52:25.555280 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:52:25.557533 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:52:25.559365 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:52:25.561042 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:52:25.561383 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:52:25.561613 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:52:25.562329 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:52:25.562620 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:52:25.563172 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:52:25.563807 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:52:25.564740 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:52:25.565282 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:52:25.565898 [debug] [Thread-2  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:52:25.566188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:52:25.566629 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_performance
[0m00:52:25.566924 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39)
[0m00:52:25.567216 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:52:25.567531 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.crm_performance)
[0m00:52:25.567792 [debug] [Thread-2  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:52:25.569614 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:52:25.569921 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_performance
[0m00:52:25.571972 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:52:25.574539 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:52:25.575098 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:52:25.575989 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:52:25.576411 [debug] [Thread-2  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:52:25.576694 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_performance
[0m00:52:25.577052 [debug] [Thread-2  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:52:25.577601 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_performance
[0m00:52:25.578564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:25.578891 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:52:25.579136 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:52:25.579344 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:52:25.579564 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m00:52:25.580255 [debug] [MainThread]: Command end result
[0m00:52:25.633813 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.65001076, "process_user_time": 2.367736, "process_kernel_time": 0.121191, "process_mem_max_rss": "126796", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:52:25.634220 [debug] [MainThread]: Command `dbt compile` succeeded at 00:52:25.634173 after 0.65 seconds
[0m00:52:25.634506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff732362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d956d0>]}
[0m00:52:25.634791 [debug] [MainThread]: Flushing usage events
[0m00:53:46.940752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8621a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84815730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848156d0>]}


============================== 00:53:46.944153 | 8adb7ecb-f270-4dee-984c-7c688b8fbdcd ==============================
[0m00:53:46.944153 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:53:46.944729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:47.021795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860d76d0>]}
[0m00:53:47.046302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a38a90>]}
[0m00:53:47.046881 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:53:47.058384 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:53:47.175995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:53:47.176482 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/schema.yml
[0m00:53:47.176802 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/no_nan_values.sql
[0m00:53:47.273539 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:53:47.274150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2edd430>]}
[0m00:53:47.367569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbb4130>]}
[0m00:53:47.432975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f732e0>]}
[0m00:53:47.433360 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 654 macros
[0m00:53:47.433656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc209d0>]}
[0m00:53:47.434653 [info ] [MainThread]: 
[0m00:53:47.435113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:53:47.437539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:53:47.453929 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:53:47.454358 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:53:47.454676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:47.457097 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:53:47.457415 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:53:47.457682 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:53:47.459095 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:53:47.459798 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:53:47.460120 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:53:47.462982 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:47.463249 [debug] [MainThread]: On master: BEGIN
[0m00:53:47.463490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:53:47.465255 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:53:47.465548 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:47.465874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:53:47.471035 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:53:47.471782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8adb7ecb-f270-4dee-984c-7c688b8fbdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc4b4f0>]}
[0m00:53:47.472103 [debug] [MainThread]: On master: ROLLBACK
[0m00:53:47.472419 [debug] [MainThread]: On master: Close
[0m00:53:47.472752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:53:47.473105 [info ] [MainThread]: 
[0m00:53:47.477143 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m00:53:47.477373 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m00:53:47.477594 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m00:53:47.477888 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m00:53:47.478125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m00:53:47.478543 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m00:53:47.478991 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m00:53:47.479391 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m00:53:47.479717 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m00:53:47.480033 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m00:53:47.480377 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m00:53:47.480691 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m00:53:47.484842 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m00:53:47.487071 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m00:53:47.488740 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m00:53:47.490261 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m00:53:47.491801 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m00:53:47.492010 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m00:53:47.492284 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m00:53:47.492570 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m00:53:47.492954 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m00:53:47.493383 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m00:53:47.493860 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m00:53:47.494272 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m00:53:47.494624 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m00:53:47.495349 [debug] [Thread-2  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:47.495628 [debug] [Thread-3  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:47.495984 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m00:53:47.496220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m00:53:47.496553 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63)
[0m00:53:47.496931 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39)
[0m00:53:47.497251 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m00:53:47.497540 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m00:53:47.497809 [debug] [Thread-2  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:47.498105 [debug] [Thread-3  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:47.498389 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m00:53:47.500050 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m00:53:47.502309 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:53:47.504653 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:53:47.533803 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m00:53:47.535537 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m00:53:47.535925 [debug] [Thread-2  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:47.536449 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m00:53:47.536745 [debug] [Thread-3  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:47.537201 [debug] [Thread-2  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:47.537453 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m00:53:47.538038 [debug] [Thread-3  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:47.538594 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m00:53:47.539439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:47.539687 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m00:53:47.539911 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63' was properly closed.
[0m00:53:47.540106 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:53:47.540319 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m00:53:47.541068 [debug] [MainThread]: Command end result
[0m00:53:47.566764 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.65066427, "process_user_time": 2.322867, "process_kernel_time": 0.098007, "process_mem_max_rss": "128664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:53:47.567179 [debug] [MainThread]: Command `dbt compile` succeeded at 00:53:47.567134 after 0.65 seconds
[0m00:53:47.567443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8621a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbc7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853b3880>]}
[0m00:53:47.567684 [debug] [MainThread]: Flushing usage events
[0m00:53:51.629032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1a3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1a3700>]}


============================== 00:53:51.632694 | 3b18f85f-62ec-464b-8772-82e7f5b9e941 ==============================
[0m00:53:51.632694 [info ] [MainThread]: Running with dbt=1.8.3
[0m00:53:51.633267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:51.712440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacce2550>]}
[0m00:53:51.737432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e39c520>]}
[0m00:53:51.738177 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:53:51.750169 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m00:53:51.863602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:51.863963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:51.888898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac915130>]}
[0m00:53:51.960398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac707ee0>]}
[0m00:53:51.960817 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 654 macros
[0m00:53:51.961219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac92c0a0>]}
[0m00:53:51.962145 [info ] [MainThread]: 
[0m00:53:51.962644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:53:51.964954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m00:53:51.981113 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:53:51.981507 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m00:53:51.981860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:51.984116 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m00:53:51.984384 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m00:53:51.984640 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m00:53:51.985820 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m00:53:51.986441 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m00:53:51.986753 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m00:53:51.989555 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:51.989843 [debug] [MainThread]: On master: BEGIN
[0m00:53:51.990075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:53:51.991743 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:53:51.992012 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:51.992298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:53:51.997165 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m00:53:51.997890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b18f85f-62ec-464b-8772-82e7f5b9e941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbdceb0>]}
[0m00:53:51.998193 [debug] [MainThread]: On master: ROLLBACK
[0m00:53:51.998509 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:51.998765 [debug] [MainThread]: On master: BEGIN
[0m00:53:51.999139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:53:51.999382 [debug] [MainThread]: On master: COMMIT
[0m00:53:51.999638 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:51.999869 [debug] [MainThread]: On master: COMMIT
[0m00:53:52.000152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:53:52.000383 [debug] [MainThread]: On master: Close
[0m00:53:52.000693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:53:52.001090 [info ] [MainThread]: 
[0m00:53:52.005467 [debug] [Thread-1  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:52.005710 [debug] [Thread-2  ]: Began running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:52.006077 [info ] [Thread-1  ]: 1 of 2 START test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date ... [RUN]
[0m00:53:52.006531 [info ] [Thread-2  ]: 2 of 2 START test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date .. [RUN]
[0m00:53:52.007034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63)
[0m00:53:52.007438 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39'
[0m00:53:52.007810 [debug] [Thread-1  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:52.008156 [debug] [Thread-2  ]: Began compiling node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:52.015008 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:53:52.017129 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:53:52.018458 [debug] [Thread-1  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:52.018689 [debug] [Thread-2  ]: Began executing node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:52.026618 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:53:52.027960 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:53:52.029246 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:53:52.029668 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:53:52.029935 [debug] [Thread-1  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63: BEGIN
[0m00:53:52.030319 [debug] [Thread-2  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39: BEGIN
[0m00:53:52.030652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:53:52.030957 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:53:52.032897 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m00:53:52.033116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:53:52.033371 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"
[0m00:53:52.033664 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"
[0m00:53:52.033959 [debug] [Thread-2  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with invalid_timestamps as (
        select
            engage_date
        from
            "company_dw"."dev"."crm_stg_sales_pipelines"
        where
            engage_date is not null
            and (
                to_timestamp(engage_date, 'YYYY-MM-DD HH24:MI:SS') is null
                or to_timestamp(engage_date, 'YYYY-MM-DD HH24:MI:SS') = 'epoch'
            )
    )

    select * from invalid_timestamps

      
    ) dbt_internal_test
[0m00:53:52.034318 [debug] [Thread-1  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    with invalid_timestamps as (
        select
            close_date
        from
            "company_dw"."dev"."crm_stg_sales_pipelines"
        where
            close_date is not null
            and (
                to_timestamp(close_date, 'YYYY-MM-DD HH24:MI:SS') is null
                or to_timestamp(close_date, 'YYYY-MM-DD HH24:MI:SS') = 'epoch'
            )
    )

    select * from invalid_timestamps

      
    ) dbt_internal_test
[0m00:53:52.034801 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "dev.crm_stg_sales_pipelines" does not exist
LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                     ^

[0m00:53:52.035124 [debug] [Thread-2  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39: ROLLBACK
[0m00:53:52.035337 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dev.crm_stg_sales_pipelines" does not exist
LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                     ^

[0m00:53:52.035749 [debug] [Thread-2  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39: Close
[0m00:53:52.036016 [debug] [Thread-1  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63: ROLLBACK
[0m00:53:52.037928 [debug] [Thread-2  ]: Database Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                       ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/schema.yml/valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.sql
[0m00:53:52.038403 [debug] [Thread-1  ]: On test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63: Close
[0m00:53:52.038681 [error] [Thread-2  ]: 2 of 2 ERROR valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date ....... [[31mERROR[0m in 0.03s]
[0m00:53:52.039487 [debug] [Thread-1  ]: Database Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date (models/crm_sales_data/staging/schema.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                       ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/schema.yml/valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.sql
[0m00:53:52.039868 [debug] [Thread-2  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39
[0m00:53:52.040269 [error] [Thread-1  ]: 1 of 2 ERROR valid_timestamp_or_null_crm_stg_sales_pipelines_close_date ........ [[31mERROR[0m in 0.03s]
[0m00:53:52.041100 [debug] [Thread-1  ]: Finished running node test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63
[0m00:53:52.041969 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:52.042232 [debug] [MainThread]: On master: BEGIN
[0m00:53:52.042469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:53:52.044078 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:53:52.044344 [debug] [MainThread]: On master: COMMIT
[0m00:53:52.044591 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:52.044867 [debug] [MainThread]: On master: COMMIT
[0m00:53:52.045181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:53:52.045414 [debug] [MainThread]: On master: Close
[0m00:53:52.045714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:52.045999 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.9e109fbc63' was properly closed.
[0m00:53:52.046262 [debug] [MainThread]: Connection 'test.matt_demo.valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.2a0a671f39' was properly closed.
[0m00:53:52.046542 [info ] [MainThread]: 
[0m00:53:52.046893 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m00:53:52.047438 [debug] [MainThread]: Command end result
[0m00:53:52.072779 [info ] [MainThread]: 
[0m00:53:52.073187 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:53:52.073487 [info ] [MainThread]: 
[0m00:53:52.073848 [error] [MainThread]:   Database Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date (models/crm_sales_data/staging/schema.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                       ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/schema.yml/valid_timestamp_or_null_crm_stg_sales_pipelines_engage_date.sql
[0m00:53:52.074142 [info ] [MainThread]: 
[0m00:53:52.074454 [error] [MainThread]:   Database Error in test valid_timestamp_or_null_crm_stg_sales_pipelines_close_date (models/crm_sales_data/staging/schema.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 12:             "company_dw"."dev"."crm_stg_sales_pipelines"
                       ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/schema.yml/valid_timestamp_or_null_crm_stg_sales_pipelines_close_date.sql
[0m00:53:52.074775 [info ] [MainThread]: 
[0m00:53:52.075067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m00:53:52.075607 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4716663, "process_user_time": 2.214946, "process_kernel_time": 0.105088, "process_mem_max_rss": "124460", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:53:52.076021 [debug] [MainThread]: Command `dbt test` failed at 00:53:52.075967 after 0.47 seconds
[0m00:53:52.076302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc082e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e39c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eda0af0>]}
[0m00:53:52.076552 [debug] [MainThread]: Flushing usage events
[0m18:21:49.860269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8211d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8211d700>]}


============================== 18:21:49.863820 | 75141da8-626e-4b80-bea1-edc415fadb85 ==============================
[0m18:21:49.863820 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:21:49.864491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:21:49.942855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75141da8-626e-4b80-bea1-edc415fadb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c5d850>]}
[0m18:21:49.965692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75141da8-626e-4b80-bea1-edc415fadb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82158a30>]}
[0m18:21:49.966192 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:21:49.977311 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:21:50.098450 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m18:21:50.098854 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:21:50.099207 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/no_nan_values.sql
[0m18:21:50.099451 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/valid_timestamp_or_null.sql
[0m18:21:50.231748 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "crm_sales_data_accounts".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("crm_sales_data", "accounts").
  
  To fix this, change the name of one of these resources:
  - source.matt_demo.crm_sales_data.accounts (models/crm_sales_data/crm_sales.yml)
  - source.matt_demo.crm_sales_data.accounts (models/sources.yml)
[0m18:21:50.232593 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.397705, "process_user_time": 2.146807, "process_kernel_time": 0.079177, "process_mem_max_rss": "123812", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:21:50.232996 [debug] [MainThread]: Command `dbt compile` failed at 18:21:50.232937 after 0.40 seconds
[0m18:21:50.233343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6b0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b534d60>]}
[0m18:21:50.233648 [debug] [MainThread]: Flushing usage events
[0m18:22:09.398607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c2e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84228730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842286d0>]}


============================== 18:22:09.401869 | 2e463763-c8ca-45b2-a94e-e631e762d528 ==============================
[0m18:22:09.401869 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:22:09.402400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:09.476547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d1bee0>]}
[0m18:22:09.500276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d92550>]}
[0m18:22:09.500990 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:22:09.512655 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:22:09.641039 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 1 files added, 0 files changed.
[0m18:22:09.641486 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:22:09.641914 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/no_nan_values.sql
[0m18:22:09.642125 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/valid_timestamp_or_null.sql
[0m18:22:09.817541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b599eb0>]}
[0m18:22:09.876328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da68fa0>]}
[0m18:22:09.876748 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m18:22:09.877170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29878e0>]}
[0m18:22:09.878263 [info ] [MainThread]: 
[0m18:22:09.878755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:09.881018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:22:09.897018 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:22:09.897404 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:22:09.897734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:09.900033 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:22:09.900386 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:22:09.900709 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:22:09.902326 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:22:09.903017 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:22:09.903398 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:22:09.906176 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:09.906461 [debug] [MainThread]: On master: BEGIN
[0m18:22:09.906711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:09.908446 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:22:09.908693 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:09.908980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:09.914304 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m18:22:09.914998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e463763-c8ca-45b2-a94e-e631e762d528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8594a190>]}
[0m18:22:09.915321 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:09.915630 [debug] [MainThread]: On master: Close
[0m18:22:09.915980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:09.916330 [info ] [MainThread]: 
[0m18:22:09.920721 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m18:22:09.920965 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m18:22:09.921233 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:09.921466 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m18:22:09.921807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m18:22:09.922254 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m18:22:09.922660 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m18:22:09.923066 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m18:22:09.923388 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m18:22:09.923708 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m18:22:09.924040 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:09.924357 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m18:22:09.928609 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m18:22:09.930311 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m18:22:09.931926 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:22:09.934103 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m18:22:09.937463 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m18:22:09.937722 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m18:22:09.937971 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:09.938261 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m18:22:09.938630 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m18:22:09.939058 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m18:22:09.939500 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:09.939957 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m18:22:09.940298 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m18:22:09.941033 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_performance
[0m18:22:09.941350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m18:22:09.941650 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.crm_performance)
[0m18:22:09.941977 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m18:22:09.942228 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_performance
[0m18:22:09.943836 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m18:22:09.945850 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m18:22:09.946937 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m18:22:09.947180 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_performance
[0m18:22:09.947599 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m18:22:09.948065 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_performance
[0m18:22:09.949054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:09.949310 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m18:22:09.949544 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m18:22:09.949746 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m18:22:09.949969 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m18:22:09.950610 [debug] [MainThread]: Command end result
[0m18:22:10.002895 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.62830096, "process_user_time": 2.302617, "process_kernel_time": 0.091865, "process_mem_max_rss": "127312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:22:10.003296 [debug] [MainThread]: Command `dbt compile` succeeded at 18:22:10.003249 after 0.63 seconds
[0m18:22:10.003575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c2e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85778460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d92550>]}
[0m18:22:10.003838 [debug] [MainThread]: Flushing usage events
[0m18:22:39.367858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a242e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7001e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7001e700>]}


============================== 18:22:39.371146 | 12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53 ==============================
[0m18:22:39.371146 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:22:39.371710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:22:39.447609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb5f850>]}
[0m18:22:39.471788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7005aa30>]}
[0m18:22:39.472379 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:22:39.482494 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:22:39.602678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:39.603087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:39.622787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e726130>]}
[0m18:22:39.678557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e771850>]}
[0m18:22:39.678894 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m18:22:39.679215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea7a190>]}
[0m18:22:39.680282 [info ] [MainThread]: 
[0m18:22:39.680876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:39.683173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:22:39.699399 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:22:39.699811 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:22:39.700148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:39.702227 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:22:39.702529 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:22:39.702829 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:22:39.704143 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:22:39.704958 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:22:39.705400 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:22:39.708193 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:39.708514 [debug] [MainThread]: On master: BEGIN
[0m18:22:39.708775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:39.710406 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:22:39.710662 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:39.710944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:39.715922 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m18:22:39.716673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ad10f2-2f6c-4ad4-b507-cb1d9a4f9d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb10d30>]}
[0m18:22:39.716981 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:39.717293 [debug] [MainThread]: On master: Close
[0m18:22:39.717626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:39.718067 [info ] [MainThread]: 
[0m18:22:39.721960 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m18:22:39.722200 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m18:22:39.722500 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:39.722716 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m18:22:39.723054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m18:22:39.723464 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m18:22:39.723842 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m18:22:39.724217 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m18:22:39.724548 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m18:22:39.724893 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m18:22:39.725204 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:39.725550 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m18:22:39.730109 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m18:22:39.731763 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m18:22:39.733928 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:22:39.735620 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m18:22:39.737240 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m18:22:39.737460 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m18:22:39.737797 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:39.738215 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m18:22:39.738466 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m18:22:39.740065 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m18:22:39.739324 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m18:22:39.739640 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m18:22:39.738895 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m18:22:39.740660 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m18:22:39.740973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m18:22:39.741362 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m18:22:39.741651 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m18:22:39.741890 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m18:22:39.743595 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m18:22:39.745490 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m18:22:39.746162 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m18:22:39.746482 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m18:22:39.746825 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m18:22:39.747228 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m18:22:39.748072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:39.748363 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m18:22:39.748619 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m18:22:39.748879 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m18:22:39.749098 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m18:22:39.749800 [debug] [MainThread]: Command end result
[0m18:22:39.774971 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.43160725, "process_user_time": 2.137433, "process_kernel_time": 0.080166, "process_mem_max_rss": "118516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:22:39.775362 [debug] [MainThread]: Command `dbt compile` succeeded at 18:22:39.775310 after 0.43 seconds
[0m18:22:39.775650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a242e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7467c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7005aa30>]}
[0m18:22:39.775911 [debug] [MainThread]: Flushing usage events
[0m18:22:49.445485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75cfd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75cfd700>]}


============================== 18:22:49.448693 | 45fdf660-d282-403a-9718-663e5317895a ==============================
[0m18:22:49.448693 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:22:49.449237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:49.526854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45fdf660-d282-403a-9718-663e5317895a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9488b850>]}
[0m18:22:49.560298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45fdf660-d282-403a-9718-663e5317895a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d39a30>]}
[0m18:22:49.561016 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:22:49.573423 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:22:49.674248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:49.674642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:49.694086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45fdf660-d282-403a-9718-663e5317895a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94453130>]}
[0m18:22:49.754883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45fdf660-d282-403a-9718-663e5317895a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942b8eb0>]}
[0m18:22:49.755271 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m18:22:49.755682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45fdf660-d282-403a-9718-663e5317895a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944625e0>]}
[0m18:22:49.756470 [info ] [MainThread]: 
[0m18:22:49.756861 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:22:49.757985 [debug] [MainThread]: Command end result
[0m18:22:49.780543 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.35954717, "process_user_time": 2.091156, "process_kernel_time": 0.066813, "process_mem_max_rss": "119208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:22:49.780914 [debug] [MainThread]: Command `dbt test` succeeded at 18:22:49.780868 after 0.36 seconds
[0m18:22:49.781185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777622e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff768a4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948231f0>]}
[0m18:22:49.781431 [debug] [MainThread]: Flushing usage events
[0m18:23:13.019196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9b12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afaf820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afaf7c0>]}


============================== 18:23:13.022439 | f3adaa8d-9fa4-46a4-9124-6e54808afb03 ==============================
[0m18:23:13.022439 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:23:13.022956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:13.098566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3adaa8d-9fa4-46a4-9124-6e54808afb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a79bb0>]}
[0m18:23:13.121518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3adaa8d-9fa4-46a4-9124-6e54808afb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afd69d0>]}
[0m18:23:13.122044 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:13.131976 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:23:13.236242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:13.236596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:13.255847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3adaa8d-9fa4-46a4-9124-6e54808afb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996b6130>]}
[0m18:23:13.322125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3adaa8d-9fa4-46a4-9124-6e54808afb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99518970>]}
[0m18:23:13.322600 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m18:23:13.322950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3adaa8d-9fa4-46a4-9124-6e54808afb03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996c19a0>]}
[0m18:23:13.323736 [info ] [MainThread]: 
[0m18:23:13.324079 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:23:13.325178 [debug] [MainThread]: Command end result
[0m18:23:13.347536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3525875, "process_user_time": 2.055277, "process_kernel_time": 0.067369, "process_mem_max_rss": "119048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:13.347924 [debug] [MainThread]: Command `dbt test` succeeded at 18:23:13.347880 after 0.35 seconds
[0m18:23:13.348223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9b12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b54f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99518e80>]}
[0m18:23:13.348510 [debug] [MainThread]: Flushing usage events
[0m18:23:37.370299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff627262e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d24850>]}


============================== 18:23:37.373754 | 1d346f79-3b8e-4137-b8ad-c2a9316cb70b ==============================
[0m18:23:37.373754 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:23:37.374755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:37.458517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d346f79-3b8e-4137-b8ad-c2a9316cb70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f80a400>]}
[0m18:23:37.484822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d346f79-3b8e-4137-b8ad-c2a9316cb70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6188af70>]}
[0m18:23:37.485501 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:37.495748 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:23:37.575887 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading matt_demo: crm_sales_data/crm_sales.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |     description: "Staging model for sales pipelines"
    19 |     columns:
    20 |       - name: opportunity_id
    21 |           test:
    22 |             - unique
    23 |             - non_null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 21, column 15
[0m18:23:37.576648 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.23124917, "process_user_time": 2.059708, "process_kernel_time": 0.088316, "process_mem_max_rss": "119448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:37.577070 [debug] [MainThread]: Command `dbt test` failed at 18:23:37.577010 after 0.23 seconds
[0m18:23:37.577452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff627262e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d44c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d44c3d0>]}
[0m18:23:37.577762 [debug] [MainThread]: Flushing usage events
[0m18:27:37.983141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73da52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723a37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723a3790>]}


============================== 18:27:37.986742 | 9fa12a40-006f-47d4-9b0f-bc178cfcf383 ==============================
[0m18:27:37.986742 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:27:37.987378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:38.066942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c62100>]}
[0m18:27:38.092589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e59430>]}
[0m18:27:38.093198 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:27:38.105529 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:27:38.214759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:38.215289 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:27:38.308733 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:27:38.309266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcde970>]}
[0m18:27:38.410560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89720130>]}
[0m18:27:38.488345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89505eb0>]}
[0m18:27:38.488728 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 652 macros
[0m18:27:38.489061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896f0040>]}
[0m18:27:38.489897 [info ] [MainThread]: 
[0m18:27:38.490343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:38.492627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:27:38.508422 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:27:38.508801 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:27:38.509143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:38.511672 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:27:38.511936 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:27:38.512197 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:27:38.513734 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:27:38.514385 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:27:38.514745 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:27:38.517486 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.517760 [debug] [MainThread]: On master: BEGIN
[0m18:27:38.518029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:38.519512 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:27:38.519764 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.520058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:38.525110 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m18:27:38.525777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa12a40-006f-47d4-9b0f-bc178cfcf383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcded00>]}
[0m18:27:38.526124 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:38.526442 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.526674 [debug] [MainThread]: On master: BEGIN
[0m18:27:38.527032 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:27:38.527273 [debug] [MainThread]: On master: COMMIT
[0m18:27:38.527518 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.527745 [debug] [MainThread]: On master: COMMIT
[0m18:27:38.528051 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:38.528283 [debug] [MainThread]: On master: Close
[0m18:27:38.528582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:38.529023 [info ] [MainThread]: 
[0m18:27:38.533013 [debug] [Thread-1  ]: Began running node test.matt_demo.non_null_crm_stg_sales_pipelines_opportunity_id.9e47d536e7
[0m18:27:38.533253 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:27:38.533595 [info ] [Thread-1  ]: 1 of 2 START test non_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:27:38.534092 [info ] [Thread-2  ]: 2 of 2 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:27:38.534574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.non_null_crm_stg_sales_pipelines_opportunity_id.9e47d536e7)
[0m18:27:38.535375 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:27:38.535706 [debug] [Thread-1  ]: Began compiling node test.matt_demo.non_null_crm_stg_sales_pipelines_opportunity_id.9e47d536e7
[0m18:27:38.536042 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:27:38.544257 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:27:38.545348 [debug] [Thread-1  ]: Compilation Error in test non_null_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  'test_non_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:27:38.545801 [error] [Thread-1  ]: 1 of 2 ERROR non_null_crm_stg_sales_pipelines_opportunity_id ................... [[31mERROR[0m in 0.01s]
[0m18:27:38.546364 [debug] [Thread-1  ]: Finished running node test.matt_demo.non_null_crm_stg_sales_pipelines_opportunity_id.9e47d536e7
[0m18:27:38.546699 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:27:38.554828 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:27:38.555878 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:27:38.556132 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:27:38.556360 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:27:38.558541 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m18:27:38.558909 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:27:38.559203 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:27:38.559627 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "dev.crm_stg_sales_pipelines" does not exist
LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
              ^

[0m18:27:38.559913 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:27:38.560309 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:27:38.561338 [debug] [Thread-2  ]: Database Error in test unique_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/unique_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:27:38.561721 [error] [Thread-2  ]: 2 of 2 ERROR unique_crm_stg_sales_pipelines_opportunity_id ..................... [[31mERROR[0m in 0.03s]
[0m18:27:38.562193 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:27:38.562993 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.563266 [debug] [MainThread]: On master: BEGIN
[0m18:27:38.563484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:38.564909 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:27:38.565182 [debug] [MainThread]: On master: COMMIT
[0m18:27:38.565388 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:38.565608 [debug] [MainThread]: On master: COMMIT
[0m18:27:38.565928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:38.566169 [debug] [MainThread]: On master: Close
[0m18:27:38.566449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:38.566672 [debug] [MainThread]: Connection 'test.matt_demo.non_null_crm_stg_sales_pipelines_opportunity_id.9e47d536e7' was properly closed.
[0m18:27:38.566881 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:27:38.567152 [info ] [MainThread]: 
[0m18:27:38.567496 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m18:27:38.568058 [debug] [MainThread]: Command end result
[0m18:27:38.620575 [info ] [MainThread]: 
[0m18:27:38.621012 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:27:38.621319 [info ] [MainThread]: 
[0m18:27:38.621689 [error] [MainThread]:   Compilation Error in test non_null_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  'test_non_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:27:38.622010 [info ] [MainThread]: 
[0m18:27:38.622335 [error] [MainThread]:   Database Error in test unique_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/unique_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:27:38.622632 [info ] [MainThread]: 
[0m18:27:38.622960 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m18:27:38.623519 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6658639, "process_user_time": 2.337646, "process_kernel_time": 0.110645, "process_mem_max_rss": "135508", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:38.623870 [debug] [MainThread]: Command `dbt test` failed at 18:27:38.623827 after 0.67 seconds
[0m18:27:38.624166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73da52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a1d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a1d5e0>]}
[0m18:27:38.624441 [debug] [MainThread]: Flushing usage events
[0m18:29:37.409998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7df2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ddd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ddd850>]}


============================== 18:29:37.415054 | 0b62f60a-1d1e-4260-a49d-ca6433e73964 ==============================
[0m18:29:37.415054 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:29:37.415631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:37.496072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78c3400>]}
[0m18:29:37.519917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89943f70>]}
[0m18:29:37.520482 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:29:37.531822 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:29:37.647030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:37.647581 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:29:37.740228 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:29:37.740742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7467970>]}
[0m18:29:37.824737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2154130>]}
[0m18:29:37.895427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f5d640>]}
[0m18:29:37.895833 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 652 macros
[0m18:29:37.896163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7526f70>]}
[0m18:29:37.897002 [info ] [MainThread]: 
[0m18:29:37.897455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:37.899614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:29:37.915455 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:29:37.915841 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:29:37.916145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:37.918358 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:29:37.918692 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:29:37.918994 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:29:37.920591 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:29:37.921272 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:29:37.921684 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:29:37.924428 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.924735 [debug] [MainThread]: On master: BEGIN
[0m18:29:37.924987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:37.926440 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:29:37.926718 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.927000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:37.932066 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m18:29:37.932722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b62f60a-1d1e-4260-a49d-ca6433e73964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa476a4c0>]}
[0m18:29:37.933026 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:37.933376 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.933645 [debug] [MainThread]: On master: BEGIN
[0m18:29:37.934032 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:29:37.934272 [debug] [MainThread]: On master: COMMIT
[0m18:29:37.934524 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.934754 [debug] [MainThread]: On master: COMMIT
[0m18:29:37.935088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:29:37.935333 [debug] [MainThread]: On master: Close
[0m18:29:37.935637 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:29:37.935962 [info ] [MainThread]: 
[0m18:29:37.939929 [debug] [Thread-1  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:29:37.940164 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:29:37.940546 [info ] [Thread-1  ]: 1 of 2 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:29:37.940995 [info ] [Thread-2  ]: 2 of 2 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:29:37.941460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m18:29:37.942235 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:29:37.942587 [debug] [Thread-1  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:29:37.942907 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:29:37.951213 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:29:37.954491 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:29:37.957036 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:29:37.957278 [debug] [Thread-1  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:29:37.964355 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:29:37.965814 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:29:37.967376 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:29:37.967646 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:29:37.967915 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:29:37.968342 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m18:29:37.968700 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:29:37.969024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:37.971029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m18:29:37.971250 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m18:29:37.971549 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:29:37.971820 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:29:37.972093 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m18:29:37.972369 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:29:37.972819 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "dev.crm_stg_sales_pipelines" does not exist
LINE 14: from "company_dw"."dev"."crm_stg_sales_pipelines"
              ^

[0m18:29:37.973132 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "dev.crm_stg_sales_pipelines" does not exist
LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
              ^

[0m18:29:37.973370 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m18:29:37.973631 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:29:37.974037 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m18:29:37.974336 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:29:37.976442 [debug] [Thread-2  ]: Database Error in test unique_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/unique_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:29:37.976827 [debug] [Thread-1  ]: Database Error in test not_null_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 14: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/not_null_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:29:37.977184 [error] [Thread-2  ]: 2 of 2 ERROR unique_crm_stg_sales_pipelines_opportunity_id ..................... [[31mERROR[0m in 0.04s]
[0m18:29:37.977660 [error] [Thread-1  ]: 1 of 2 ERROR not_null_crm_stg_sales_pipelines_opportunity_id ................... [[31mERROR[0m in 0.04s]
[0m18:29:37.978145 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:29:37.978584 [debug] [Thread-1  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:29:37.979873 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.980148 [debug] [MainThread]: On master: BEGIN
[0m18:29:37.980385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:37.981932 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:29:37.982186 [debug] [MainThread]: On master: COMMIT
[0m18:29:37.982444 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:37.982702 [debug] [MainThread]: On master: COMMIT
[0m18:29:37.983009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:29:37.983253 [debug] [MainThread]: On master: Close
[0m18:29:37.983577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:37.983828 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:29:37.984068 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:29:37.984377 [info ] [MainThread]: 
[0m18:29:37.984738 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:29:37.985318 [debug] [MainThread]: Command end result
[0m18:29:38.039837 [info ] [MainThread]: 
[0m18:29:38.040264 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:29:38.040569 [info ] [MainThread]: 
[0m18:29:38.040893 [error] [MainThread]:   Database Error in test unique_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 15: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/unique_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:29:38.041174 [info ] [MainThread]: 
[0m18:29:38.041525 [error] [MainThread]:   Database Error in test not_null_crm_stg_sales_pipelines_opportunity_id (models/crm_sales_data/crm_sales.yml)
  relation "dev.crm_stg_sales_pipelines" does not exist
  LINE 14: from "company_dw"."dev"."crm_stg_sales_pipelines"
                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/crm_sales.yml/not_null_crm_stg_sales_pipelines_opportunity_id.sql
[0m18:29:38.041856 [info ] [MainThread]: 
[0m18:29:38.042184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m18:29:38.042761 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6576307, "process_user_time": 2.265647, "process_kernel_time": 0.11819, "process_mem_max_rss": "131772", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:29:38.043111 [debug] [MainThread]: Command `dbt test` failed at 18:29:38.043067 after 0.66 seconds
[0m18:29:38.043365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7df2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8992aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74ece80>]}
[0m18:29:38.043626 [debug] [MainThread]: Flushing usage events
[0m18:30:53.326721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886bb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886bb7f0>]}


============================== 18:30:53.329942 | 00606a35-2176-470b-b00d-d06604474fba ==============================
[0m18:30:53.329942 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:30:53.330501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:53.404322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00606a35-2176-470b-b00d-d06604474fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71aaa30>]}
[0m18:30:53.427449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00606a35-2176-470b-b00d-d06604474fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71a17f0>]}
[0m18:30:53.427948 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:30:53.438057 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:30:53.553822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:53.554337 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:30:53.685446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00606a35-2176-470b-b00d-d06604474fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4033f10>]}
[0m18:30:53.746132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00606a35-2176-470b-b00d-d06604474fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa192be50>]}
[0m18:30:53.746550 [info ] [MainThread]: Found 6 models, 4 sources, 652 macros
[0m18:30:53.746846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00606a35-2176-470b-b00d-d06604474fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8874d130>]}
[0m18:30:53.747518 [info ] [MainThread]: 
[0m18:30:53.747814 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:30:53.748252 [debug] [MainThread]: Command end result
[0m18:30:53.771444 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46867475, "process_user_time": 2.200032, "process_kernel_time": 0.073234, "process_mem_max_rss": "130100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:30:53.771823 [debug] [MainThread]: Command `dbt test` succeeded at 18:30:53.771780 after 0.47 seconds
[0m18:30:53.772120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8925f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f81c10>]}
[0m18:30:53.772390 [debug] [MainThread]: Flushing usage events
[0m18:34:20.107479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775122e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b10850>]}


============================== 18:34:20.111181 | d3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d ==============================
[0m18:34:20.111181 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:34:20.111715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crm_stg_sales_pipelines', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:20.193270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945f6400>]}
[0m18:34:20.217440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76676f70>]}
[0m18:34:20.218134 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:34:20.228911 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:34:20.339066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:20.339622 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:34:20.432634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:34:20.433167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941e51f0>]}
[0m18:34:20.524650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ec0130>]}
[0m18:34:20.590991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9441a970>]}
[0m18:34:20.591350 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 652 macros
[0m18:34:20.591665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9426ff40>]}
[0m18:34:20.592436 [info ] [MainThread]: 
[0m18:34:20.592969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:20.593573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:34:20.609644 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:34:20.610035 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:34:20.610368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:20.613237 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m18:34:20.613935 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:34:20.614441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dev)
[0m18:34:20.614854 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dev"
"
[0m18:34:20.617810 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m18:34:20.618109 [debug] [ThreadPool]: On create_company_dw_dev: BEGIN
[0m18:34:20.618391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:20.619865 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m18:34:20.620109 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m18:34:20.620337 [debug] [ThreadPool]: On create_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dev"} */
create schema if not exists "dev"
[0m18:34:20.620887 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m18:34:20.621336 [debug] [ThreadPool]: On create_company_dw_dev: COMMIT
[0m18:34:20.621578 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m18:34:20.621791 [debug] [ThreadPool]: On create_company_dw_dev: COMMIT
[0m18:34:20.622703 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:34:20.622946 [debug] [ThreadPool]: On create_company_dw_dev: Close
[0m18:34:20.625274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dev, now list_company_dw_dev)
[0m18:34:20.628437 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:34:20.628734 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:34:20.628964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:20.630528 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:34:20.630790 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:34:20.631087 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:34:20.632590 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m18:34:20.633212 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:34:20.633537 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:34:20.636032 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.636287 [debug] [MainThread]: On master: BEGIN
[0m18:34:20.636490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:20.638049 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:34:20.638312 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.638609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:20.643988 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m18:34:20.644721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e328e0>]}
[0m18:34:20.645031 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:20.645330 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.645549 [debug] [MainThread]: On master: BEGIN
[0m18:34:20.645891 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:34:20.646114 [debug] [MainThread]: On master: COMMIT
[0m18:34:20.646314 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.646509 [debug] [MainThread]: On master: COMMIT
[0m18:34:20.646817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:20.647030 [debug] [MainThread]: On master: Close
[0m18:34:20.647317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:20.647681 [info ] [MainThread]: 
[0m18:34:20.651608 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m18:34:20.652036 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m18:34:20.652480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_sales_pipelines)
[0m18:34:20.652874 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m18:34:20.656999 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.658089 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m18:34:20.675408 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.676680 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.676967 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m18:34:20.677224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:20.678969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m18:34:20.679245 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.679519 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        sales_agent::text,
        product::text as product_name,
        account::text as company_name,
        deal_stage::text,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m18:34:20.681050 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:34:20.684258 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.684502 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m18:34:20.684941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:34:20.692038 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m18:34:20.692352 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.692601 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m18:34:20.693416 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:34:20.696483 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m18:34:20.698485 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m18:34:20.698788 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m18:34:20.699198 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m18:34:20.700369 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m18:34:20.701252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3737a0f-0cf7-4cb4-b9a5-999cf2ab7d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1e75e0>]}
[0m18:34:20.701693 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:34:20.702205 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m18:34:20.703067 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.703340 [debug] [MainThread]: On master: BEGIN
[0m18:34:20.703560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:20.704938 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:34:20.705179 [debug] [MainThread]: On master: COMMIT
[0m18:34:20.705404 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:20.705652 [debug] [MainThread]: On master: COMMIT
[0m18:34:20.705970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:20.706194 [debug] [MainThread]: On master: Close
[0m18:34:20.706465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:20.706731 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m18:34:20.706984 [info ] [MainThread]: 
[0m18:34:20.707352 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:34:20.707824 [debug] [MainThread]: Command end result
[0m18:34:20.761306 [info ] [MainThread]: 
[0m18:34:20.761798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:20.762163 [info ] [MainThread]: 
[0m18:34:20.762511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:20.763154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.68043923, "process_user_time": 2.372077, "process_kernel_time": 0.114196, "process_mem_max_rss": "135084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:34:20.763526 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:20.763474 after 0.68 seconds
[0m18:34:20.763822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775122e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76e5f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76676f70>]}
[0m18:34:20.764111 [debug] [MainThread]: Flushing usage events
[0m18:34:25.838074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609402e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef3d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ef3d7f0>]}


============================== 18:34:25.841516 | 36ec457e-506b-4ea0-a6a7-3cca66a73aa8 ==============================
[0m18:34:25.841516 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:34:25.842060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:34:25.916554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da08c70>]}
[0m18:34:25.940564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f4e76d0>]}
[0m18:34:25.941114 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:34:25.952285 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:34:26.061085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:26.061442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:26.086724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d661eb0>]}
[0m18:34:26.155178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d45fa90>]}
[0m18:34:26.155555 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 652 macros
[0m18:34:26.155888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f18ef40>]}
[0m18:34:26.156686 [info ] [MainThread]: 
[0m18:34:26.157200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:26.159464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:34:26.175341 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:34:26.175807 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:34:26.176119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:26.178272 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:34:26.178552 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:34:26.178801 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:34:26.179964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:34:26.180721 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:34:26.181047 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:34:26.184003 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.184276 [debug] [MainThread]: On master: BEGIN
[0m18:34:26.184495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:26.186135 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:34:26.186378 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.186641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:26.191767 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:34:26.192480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ec457e-506b-4ea0-a6a7-3cca66a73aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5efd8310>]}
[0m18:34:26.192867 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:26.193183 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.193434 [debug] [MainThread]: On master: BEGIN
[0m18:34:26.193806 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:34:26.194052 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.194262 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.194463 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.194750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:26.194967 [debug] [MainThread]: On master: Close
[0m18:34:26.195266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:26.195622 [info ] [MainThread]: 
[0m18:34:26.199680 [debug] [Thread-1  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:34:26.199925 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:34:26.200321 [info ] [Thread-1  ]: 1 of 2 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:34:26.200821 [info ] [Thread-2  ]: 2 of 2 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:34:26.201297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m18:34:26.201703 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:34:26.202055 [debug] [Thread-1  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:34:26.202366 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:34:26.210979 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:34:26.214252 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:34:26.215595 [debug] [Thread-1  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:34:26.215801 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:34:26.223376 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:34:26.225240 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:34:26.226273 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:34:26.226549 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:34:26.226970 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m18:34:26.227410 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:34:26.227810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:34:26.228233 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:34:26.230232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m18:34:26.230455 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m18:34:26.230718 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:34:26.231026 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:34:26.231300 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m18:34:26.231586 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:26.232821 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m18:34:26.235071 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m18:34:26.235288 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:26.235643 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m18:34:26.236380 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:34:26.236861 [info ] [Thread-1  ]: 1 of 2 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.04s]
[0m18:34:26.237379 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:34:26.237853 [debug] [Thread-1  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:34:26.238325 [info ] [Thread-2  ]: 2 of 2 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.04s]
[0m18:34:26.239005 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:34:26.239854 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.240116 [debug] [MainThread]: On master: BEGIN
[0m18:34:26.240331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:26.241755 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:34:26.242005 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.242219 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.242415 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.242709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:26.242967 [debug] [MainThread]: On master: Close
[0m18:34:26.243272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:26.243518 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:34:26.243755 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:34:26.244021 [info ] [MainThread]: 
[0m18:34:26.244361 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:34:26.244909 [debug] [MainThread]: Command end result
[0m18:34:26.269577 [info ] [MainThread]: 
[0m18:34:26.269997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:26.270295 [info ] [MainThread]: 
[0m18:34:26.270583 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:34:26.271147 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45698643, "process_user_time": 2.16908, "process_kernel_time": 0.085003, "process_mem_max_rss": "126960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:34:26.271493 [debug] [MainThread]: Command `dbt test` succeeded at 18:34:26.271448 after 0.46 seconds
[0m18:34:26.271783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609402e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9f0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f4e76d0>]}
[0m18:34:26.272060 [debug] [MainThread]: Flushing usage events
[0m18:36:19.137763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff724a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70aa3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70aa37f0>]}


============================== 18:36:19.142252 | cb37bb2d-3e3f-4777-8636-942777c54ca3 ==============================
[0m18:36:19.142252 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:36:19.142770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:36:19.226586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb37bb2d-3e3f-4777-8636-942777c54ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f593df0>]}
[0m18:36:19.257411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb37bb2d-3e3f-4777-8636-942777c54ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f58a7f0>]}
[0m18:36:19.258133 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:36:19.271887 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:36:19.472988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:36:19.474456 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/test_no_nan_values.sql
[0m18:36:19.479564 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:36:19.630358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:36:19.631068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb37bb2d-3e3f-4777-8636-942777c54ca3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d145790>]}
[0m18:36:19.680237 [error] [MainThread]: Encountered an error:
Compilation Error
  Invalid generic test configuration given in models/crm_sales_data/crm_sales.yml: 
  Test arguments include "model", which is a reserved argument
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:36:19.681210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5690776, "process_user_time": 2.2709, "process_kernel_time": 0.124377, "process_mem_max_rss": "132404", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:19.681730 [debug] [MainThread]: Command `dbt test` failed at 18:36:19.681663 after 0.57 seconds
[0m18:36:19.682171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff724a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ec8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3f2490>]}
[0m18:36:19.682558 [debug] [MainThread]: Flushing usage events
[0m18:36:33.939155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b6212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69c1f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69c1f8b0>]}


============================== 18:36:33.942474 | 0fcfcd2e-2f50-4a16-af36-15a1ac6707c7 ==============================
[0m18:36:33.942474 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:36:33.943005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:36:34.019452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fcfcd2e-2f50-4a16-af36-15a1ac6707c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887039d0>]}
[0m18:36:34.042673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fcfcd2e-2f50-4a16-af36-15a1ac6707c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8876dc40>]}
[0m18:36:34.043173 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:36:34.053396 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:36:34.165651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:36:34.166073 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/test_no_nan_values.sql
[0m18:36:34.166450 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:36:34.260982 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:36:34.261510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fcfcd2e-2f50-4a16-af36-15a1ac6707c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882f09d0>]}
[0m18:36:34.314561 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/crm_sales.yml)
  The name argument to ref() must be a string, got <class 'dbt.adapters.postgres.relation.PostgresRelation'>
  
  > in macro test_no_nan_values (macros/test_no_nan_values.sql)
  > called by test no_nan_values_crm_stg_sales_pipelines_ (models/crm_sales_data/crm_sales.yml)
[0m18:36:34.315342 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.40068105, "process_user_time": 2.172075, "process_kernel_time": 0.058216, "process_mem_max_rss": "117552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:34.315755 [debug] [MainThread]: Command `dbt test` failed at 18:36:34.315700 after 0.40 seconds
[0m18:36:34.316116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b6212e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854a98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855ac520>]}
[0m18:36:34.316409 [debug] [MainThread]: Flushing usage events
[0m18:38:02.868409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7976d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7976d5b0>]}


============================== 18:38:02.872832 | b28ac95a-e87f-4c41-a1d6-5e48f1375c11 ==============================
[0m18:38:02.872832 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:38:02.873565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:02.954134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28ac95a-e87f-4c41-a1d6-5e48f1375c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b030100>]}
[0m18:38:02.978458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28ac95a-e87f-4c41-a1d6-5e48f1375c11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982778b0>]}
[0m18:38:02.979111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:38:02.993710 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:38:03.104509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:38:03.104926 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/test_no_nan_values.sql
[0m18:38:03.105322 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:38:03.200787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:38:03.201339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b28ac95a-e87f-4c41-a1d6-5e48f1375c11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9826db80>]}
[0m18:38:03.252588 [error] [MainThread]: Encountered an error:
Compilation Error in test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines (models/crm_sales_data/crm_sales.yml)
  macro 'dbt_macro__test_no_nan_values' takes no keyword argument 'model'
[0m18:38:03.253282 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.4103123, "process_user_time": 2.141395, "process_kernel_time": 0.094237, "process_mem_max_rss": "122976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:38:03.253700 [debug] [MainThread]: Command `dbt compile` failed at 18:38:03.253640 after 0.41 seconds
[0m18:38:03.253993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b1732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fd1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e71dc0>]}
[0m18:38:03.254257 [debug] [MainThread]: Flushing usage events
[0m18:39:10.437305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829702e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f6b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f6b6d0>]}


============================== 18:39:10.440650 | 4f6a2924-d003-4965-922b-76fe25a68989 ==============================
[0m18:39:10.440650 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:39:10.441205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:10.516183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f6a2924-d003-4965-922b-76fe25a68989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa5bee0>]}
[0m18:39:10.540287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f6a2924-d003-4965-922b-76fe25a68989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad4550>]}
[0m18:39:10.540940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:39:10.552904 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:39:10.665029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:39:10.665463 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/test_no_nan_values.sql
[0m18:39:10.665862 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:39:10.759648 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:39:10.760206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f6a2924-d003-4965-922b-76fe25a68989', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6746a0>]}
[0m18:39:10.803217 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/crm_sales_data/crm_sales.yml:
  	test arguments must be a dict, got <class 'NoneType'> (value None)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:39:10.804041 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.3909883, "process_user_time": 2.158177, "process_kernel_time": 0.07404, "process_mem_max_rss": "123624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:39:10.804477 [debug] [MainThread]: Command `dbt compile` failed at 18:39:10.804411 after 0.39 seconds
[0m18:39:10.804791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829702e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f945370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d684ac0>]}
[0m18:39:10.805108 [debug] [MainThread]: Flushing usage events
[0m18:42:16.907173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72af12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710ec700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710ec6a0>]}


============================== 18:42:16.911132 | e0f860f7-7553-47d7-b4cf-d846851907b2 ==============================
[0m18:42:16.911132 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:42:16.911711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:42:16.998597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbdc8b0>]}
[0m18:42:17.022591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7130feb0>]}
[0m18:42:17.023157 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:42:17.035088 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:42:17.166324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:42:17.166742 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/test_no_nan_values.sql
[0m18:42:17.167091 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:42:17.262833 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:42:17.263387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb47d00>]}
[0m18:42:17.315002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_piepelines.e529dd742a' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_piepelines' in package '' which was not found
[0m18:42:17.353621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8846b130>]}
[0m18:42:17.435585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884b07c0>]}
[0m18:42:17.436045 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 653 macros
[0m18:42:17.436381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f85b4f0>]}
[0m18:42:17.437402 [info ] [MainThread]: 
[0m18:42:17.437882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:42:17.440264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:42:17.458664 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:42:17.459147 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:42:17.459474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:17.462365 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:42:17.462699 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:42:17.463082 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:42:17.465056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:42:17.465813 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:42:17.466157 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:42:17.469162 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:17.469412 [debug] [MainThread]: On master: BEGIN
[0m18:42:17.469602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:17.471339 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:42:17.471606 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:17.471862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:42:17.477684 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m18:42:17.478432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f860f7-7553-47d7-b4cf-d846851907b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f82cd30>]}
[0m18:42:17.478750 [debug] [MainThread]: On master: ROLLBACK
[0m18:42:17.479060 [debug] [MainThread]: On master: Close
[0m18:42:17.479401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:42:17.479781 [info ] [MainThread]: 
[0m18:42:17.484147 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m18:42:17.484391 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m18:42:17.484630 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m18:42:17.484841 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m18:42:17.485182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m18:42:17.485631 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m18:42:17.486036 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m18:42:17.486438 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m18:42:17.486778 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m18:42:17.487087 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m18:42:17.487436 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m18:42:17.487753 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m18:42:17.491972 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m18:42:17.493596 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m18:42:17.495791 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:42:17.497440 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m18:42:17.499745 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m18:42:17.500085 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m18:42:17.500289 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m18:42:17.500694 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m18:42:17.500900 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m18:42:17.502598 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m18:42:17.501813 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m18:42:17.502156 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m18:42:17.501298 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m18:42:17.503226 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m18:42:17.503464 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:17.503702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m18:42:17.504015 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:17.505251 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m18:42:17.504663 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m18:42:17.504958 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m18:42:17.504322 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m18:42:17.505515 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:17.505814 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:17.507559 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m18:42:17.507847 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m18:42:17.511369 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:42:17.515762 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:42:17.544679 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m18:42:17.545341 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m18:42:17.546979 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:17.547204 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:17.547565 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m18:42:17.548052 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:17.548335 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m18:42:17.548722 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:17.549517 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m18:42:17.550385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:17.550640 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m18:42:17.550854 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:42:17.551040 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:42:17.551215 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m18:42:17.551896 [debug] [MainThread]: Command end result
[0m18:42:17.578285 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6966268, "process_user_time": 2.426097, "process_kernel_time": 0.162811, "process_mem_max_rss": "134424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:17.578694 [debug] [MainThread]: Command `dbt compile` succeeded at 18:42:17.578646 after 0.70 seconds
[0m18:42:17.578974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72af12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71c93c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f802640>]}
[0m18:42:17.579208 [debug] [MainThread]: Flushing usage events
[0m18:42:31.925931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ee52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824e38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824e3850>]}


============================== 18:42:31.929643 | e9970334-e030-4757-a1ad-22f82de93f7b ==============================
[0m18:42:31.929643 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:42:31.930247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:42:32.005520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0fc8400>]}
[0m18:42:32.029064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83049f70>]}
[0m18:42:32.029710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:42:32.041938 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:42:32.151870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:42:32.152220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:42:32.176815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c02130>]}
[0m18:42:32.254117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09f9a30>]}
[0m18:42:32.254608 [info ] [MainThread]: Found 6 models, 2 data tests, 4 sources, 653 macros
[0m18:42:32.254998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bf2d60>]}
[0m18:42:32.255781 [info ] [MainThread]: 
[0m18:42:32.256324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:42:32.258677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:42:32.274898 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:42:32.275346 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:42:32.275672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:32.277841 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:42:32.278128 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:42:32.278413 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:42:32.279625 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:42:32.280388 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:42:32.280759 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:42:32.283835 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.284127 [debug] [MainThread]: On master: BEGIN
[0m18:42:32.284389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:32.285848 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:42:32.286115 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.286414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:42:32.291511 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:42:32.292210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9970334-e030-4757-a1ad-22f82de93f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ebaeb0>]}
[0m18:42:32.292563 [debug] [MainThread]: On master: ROLLBACK
[0m18:42:32.292882 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.293125 [debug] [MainThread]: On master: BEGIN
[0m18:42:32.293494 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:42:32.293743 [debug] [MainThread]: On master: COMMIT
[0m18:42:32.294000 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.294239 [debug] [MainThread]: On master: COMMIT
[0m18:42:32.294548 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:42:32.294777 [debug] [MainThread]: On master: Close
[0m18:42:32.295079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:42:32.295426 [info ] [MainThread]: 
[0m18:42:32.299439 [debug] [Thread-1  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:32.299690 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:32.300078 [info ] [Thread-1  ]: 1 of 2 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:42:32.300578 [info ] [Thread-2  ]: 2 of 2 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:42:32.301024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m18:42:32.301466 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:42:32.301814 [debug] [Thread-1  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:32.302134 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:32.310288 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:42:32.313417 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:42:32.314641 [debug] [Thread-1  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:32.314861 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:32.322953 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:42:32.324335 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:42:32.325531 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:42:32.325854 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:42:32.326163 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m18:42:32.326607 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:42:32.326966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:42:32.327336 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:42:32.329292 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m18:42:32.329573 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m18:42:32.329866 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:42:32.330141 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:42:32.330429 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:42:32.330726 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m18:42:32.332094 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m18:42:32.334384 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m18:42:32.334628 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.004 seconds
[0m18:42:32.334970 [debug] [Thread-1  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m18:42:32.335707 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:42:32.336294 [info ] [Thread-1  ]: 1 of 2 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.04s]
[0m18:42:32.336916 [debug] [Thread-2  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:42:32.337246 [debug] [Thread-1  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:42:32.337728 [info ] [Thread-2  ]: 2 of 2 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.04s]
[0m18:42:32.338458 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:42:32.339239 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.339542 [debug] [MainThread]: On master: BEGIN
[0m18:42:32.339823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:42:32.341258 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:42:32.341562 [debug] [MainThread]: On master: COMMIT
[0m18:42:32.341818 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:32.342059 [debug] [MainThread]: On master: COMMIT
[0m18:42:32.342376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:42:32.342640 [debug] [MainThread]: On master: Close
[0m18:42:32.342954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:32.343226 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:42:32.343506 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:42:32.343808 [info ] [MainThread]: 
[0m18:42:32.344165 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m18:42:32.344705 [debug] [MainThread]: Command end result
[0m18:42:32.369715 [info ] [MainThread]: 
[0m18:42:32.370120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:32.370445 [info ] [MainThread]: 
[0m18:42:32.370774 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:42:32.371346 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4697963, "process_user_time": 2.107332, "process_kernel_time": 0.08856, "process_mem_max_rss": "128900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:32.371751 [debug] [MainThread]: Command `dbt test` succeeded at 18:42:32.371700 after 0.47 seconds
[0m18:42:32.372033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ee52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82513760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83049f70>]}
[0m18:42:32.372314 [debug] [MainThread]: Flushing usage events
[0m18:43:44.257769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb9f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b19a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b19a5b0>]}


============================== 18:43:44.261232 | 118e7b86-c26b-4758-b3c0-9b8dc3f85364 ==============================
[0m18:43:44.261232 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:43:44.261761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:43:44.345323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca5c100>]}
[0m18:43:44.369781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ca38b0>]}
[0m18:43:44.370483 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:43:44.383644 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:43:44.498323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:44.498847 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:43:44.593139 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:43:44.593728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c8bd00>]}
[0m18:43:44.685123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24d3130>]}
[0m18:43:44.752673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb990f130>]}
[0m18:43:44.753056 [info ] [MainThread]: Found 6 models, 3 data tests, 4 sources, 653 macros
[0m18:43:44.753369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c873040>]}
[0m18:43:44.754502 [info ] [MainThread]: 
[0m18:43:44.755071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:44.757468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:43:44.773705 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:43:44.774099 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:43:44.774424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:44.776863 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:43:44.777186 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:43:44.777499 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:43:44.779162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:43:44.779884 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:43:44.780269 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:43:44.783065 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:44.783341 [debug] [MainThread]: On master: BEGIN
[0m18:43:44.783582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:44.785040 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:43:44.785333 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:44.785622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:44.791088 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:43:44.791954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118e7b86-c26b-4758-b3c0-9b8dc3f85364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb74670>]}
[0m18:43:44.792311 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:44.792688 [debug] [MainThread]: On master: Close
[0m18:43:44.793047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:44.793516 [info ] [MainThread]: 
[0m18:43:44.797904 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m18:43:44.798173 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m18:43:44.798408 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m18:43:44.798650 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m18:43:44.799035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m18:43:44.799508 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m18:43:44.799896 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m18:43:44.800360 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m18:43:44.800752 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m18:43:44.801111 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m18:43:44.801405 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m18:43:44.801755 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m18:43:44.806215 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m18:43:44.808085 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m18:43:44.810453 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m18:43:44.812186 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m18:43:44.813762 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m18:43:44.813972 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m18:43:44.814278 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m18:43:44.814704 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m18:43:44.814934 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m18:43:44.816630 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m18:43:44.815832 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m18:43:44.816193 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m18:43:44.815334 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m18:43:44.817205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m18:43:44.817651 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_performance
[0m18:43:44.817934 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:44.818144 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:44.818361 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m18:43:44.818682 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_performance)
[0m18:43:44.818999 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m18:43:44.819294 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m18:43:44.821037 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m18:43:44.821340 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_performance
[0m18:43:44.821673 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:44.821967 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:44.824142 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m18:43:44.859322 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:44.859769 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m18:43:44.863849 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:43:44.864426 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m18:43:44.864919 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m18:43:44.865211 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_performance
[0m18:43:44.865536 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:43:44.866400 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:44.866955 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_performance
[0m18:43:44.867175 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:44.867753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m18:43:44.868427 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:44.868734 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:44.869203 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m18:43:44.872353 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:43:44.872727 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:44.873657 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m18:43:44.874042 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:44.874591 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:44.877993 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.004 seconds
[0m18:43:44.880339 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:44.881103 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:44.881411 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m18:43:44.881770 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m18:43:44.882254 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:44.882989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:44.883268 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:43:44.883505 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m18:43:44.883737 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:43:44.883970 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m18:43:44.884849 [debug] [MainThread]: Command end result
[0m18:43:44.914407 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6844175, "process_user_time": 2.392578, "process_kernel_time": 0.111586, "process_mem_max_rss": "129012", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:43:44.914977 [debug] [MainThread]: Command `dbt compile` succeeded at 18:43:44.914920 after 0.69 seconds
[0m18:43:44.915468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb9f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4f5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bceaa60>]}
[0m18:43:44.915781 [debug] [MainThread]: Flushing usage events
[0m18:43:48.777537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8a22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ea07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ea0790>]}


============================== 18:43:48.781025 | 9c27a537-ada1-49e9-a436-2ef02f3e6489 ==============================
[0m18:43:48.781025 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:43:48.781552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:43:48.859788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a75f100>]}
[0m18:43:48.884283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7955430>]}
[0m18:43:48.884863 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:43:48.896082 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:43:49.016161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:49.016498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:49.041273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5595130>]}
[0m18:43:49.113977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa538db20>]}
[0m18:43:49.114371 [info ] [MainThread]: Found 6 models, 3 data tests, 4 sources, 653 macros
[0m18:43:49.114715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa798f6a0>]}
[0m18:43:49.115554 [info ] [MainThread]: 
[0m18:43:49.116032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:49.118235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:43:49.134165 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:43:49.134606 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:43:49.134951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:49.137203 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m18:43:49.137556 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:43:49.137865 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:43:49.139133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:43:49.139872 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:43:49.140262 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:43:49.143454 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.143788 [debug] [MainThread]: On master: BEGIN
[0m18:43:49.144096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:49.145889 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:43:49.146238 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.146551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:49.151961 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:43:49.152729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c27a537-ada1-49e9-a436-2ef02f3e6489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55ebf70>]}
[0m18:43:49.153058 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:49.153381 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.153620 [debug] [MainThread]: On master: BEGIN
[0m18:43:49.153980 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:43:49.154235 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.154455 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.154659 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.155002 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:43:49.155249 [debug] [MainThread]: On master: Close
[0m18:43:49.155557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:43:49.155912 [info ] [MainThread]: 
[0m18:43:49.160037 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:49.160274 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:49.160541 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:49.160917 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m18:43:49.161378 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:43:49.161809 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:43:49.162289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m18:43:49.162652 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m18:43:49.163028 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:43:49.163398 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:49.163682 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:49.163993 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:49.178748 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:49.182851 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:43:49.186379 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:43:49.186731 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m18:43:49.187611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:43:49.188225 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:49.188496 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:49.195739 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:43:49.197166 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:43:49.197405 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:43:49.198230 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:49.198751 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m18:43:49.199099 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:43:49.199447 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:43:49.199788 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m18:43:49.200164 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:43:49.200480 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:43:49.200818 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:43:49.202561 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m18:43:49.202777 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m18:43:49.203017 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m18:43:49.203297 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:43:49.203583 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:43:49.205667 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:49.205978 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m18:43:49.206300 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:43:49.207187 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:49.208808 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:49.209037 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m18:43:49.209298 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m18:43:49.211806 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m18:43:49.212656 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:43:49.212903 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:43:49.213750 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m18:43:49.213527 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:43:49.213240 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m18:43:49.214336 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.05s]
[0m18:43:49.214854 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.05s]
[0m18:43:49.215370 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:43:49.215734 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:43:49.216342 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m18:43:49.217152 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m18:43:49.217487 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m18:43:49.217853 [error] [Thread-1  ]: 1 of 3 FAIL 1425 no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines . [[31mFAIL 1425[0m in 0.06s]
[0m18:43:49.218327 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:43:49.219165 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.219430 [debug] [MainThread]: On master: BEGIN
[0m18:43:49.219651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:49.221378 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:43:49.221698 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.221968 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:49.222232 [debug] [MainThread]: On master: COMMIT
[0m18:43:49.222549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:43:49.222784 [debug] [MainThread]: On master: Close
[0m18:43:49.223089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:49.223344 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m18:43:49.223576 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:43:49.223797 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:43:49.224048 [info ] [MainThread]: 
[0m18:43:49.224367 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m18:43:49.224969 [debug] [MainThread]: Command end result
[0m18:43:49.252161 [info ] [MainThread]: 
[0m18:43:49.252583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:49.252910 [info ] [MainThread]: 
[0m18:43:49.253301 [error] [MainThread]: [31mFailure in test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines (models/crm_sales_data/crm_sales.yml)[0m
[0m18:43:49.253651 [error] [MainThread]:   Got 1425 results, configured to fail if != 0
[0m18:43:49.253980 [info ] [MainThread]: 
[0m18:43:49.254304 [info ] [MainThread]:   compiled code at target/compiled/matt_demo/models/crm_sales_data/crm_sales.yml/no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.sql
[0m18:43:49.254615 [info ] [MainThread]: 
[0m18:43:49.254936 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:43:49.255499 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5027251, "process_user_time": 2.199675, "process_kernel_time": 0.073255, "process_mem_max_rss": "130808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:43:49.255836 [debug] [MainThread]: Command `dbt test` failed at 18:43:49.255796 after 0.50 seconds
[0m18:43:49.256131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8a22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7955430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899eda60>]}
[0m18:43:49.256401 [debug] [MainThread]: Flushing usage events
[0m18:50:14.067674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fa97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fa9790>]}


============================== 18:50:14.071529 | b5b7b4da-a461-4522-b68a-48e207a0e9bb ==============================
[0m18:50:14.071529 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:50:14.072081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:14.159627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ad7b80>]}
[0m18:50:14.183454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a69c40>]}
[0m18:50:14.184077 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:14.194953 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:50:14.313755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m18:50:14.314361 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m18:50:14.314705 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_accounts.sql
[0m18:50:14.315033 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m18:50:14.315396 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_products.sql
[0m18:50:14.417610 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:50:14.418341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26d6eb0>]}
[0m18:50:14.428127 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m18:50:14.429307 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m18:50:14.489541 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m18:50:14.490167 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m18:50:14.490659 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m18:50:14.491076 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m18:50:14.491507 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m18:50:14.491890 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m18:50:14.492308 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m18:50:14.492743 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m18:50:14.533574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2eaee0>]}
[0m18:50:14.661960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0c0460>]}
[0m18:50:14.662441 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m18:50:14.662933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d323910>]}
[0m18:50:14.664076 [info ] [MainThread]: 
[0m18:50:14.664726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:14.667402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:50:14.686533 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:50:14.686958 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:50:14.687303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:14.690511 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m18:50:14.690818 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:50:14.691101 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:50:14.692727 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m18:50:14.693444 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:50:14.693802 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:50:14.696935 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.697209 [debug] [MainThread]: On master: BEGIN
[0m18:50:14.697523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:14.699049 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:50:14.699305 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.699627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:14.705052 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:50:14.705787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b7b4da-a461-4522-b68a-48e207a0e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8bc100>]}
[0m18:50:14.706109 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:14.706443 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.706683 [debug] [MainThread]: On master: BEGIN
[0m18:50:14.707048 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:50:14.707292 [debug] [MainThread]: On master: COMMIT
[0m18:50:14.707551 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.707786 [debug] [MainThread]: On master: COMMIT
[0m18:50:14.708097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:14.708344 [debug] [MainThread]: On master: Close
[0m18:50:14.708673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:14.709004 [info ] [MainThread]: 
[0m18:50:14.713008 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:50:14.713265 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:50:14.713589 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:50:14.713926 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m18:50:14.714444 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m18:50:14.714892 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m18:50:14.715440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m18:50:14.715926 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m18:50:14.716383 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m18:50:14.716731 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:50:14.717062 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:50:14.717496 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:50:14.757975 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:50:14.762250 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:50:14.765410 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:50:14.765792 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m18:50:14.766521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:14.767675 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:50:14.768603 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:50:14.776004 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:50:14.777480 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:50:14.777735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:50:14.778511 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:50:14.778995 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m18:50:14.779731 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:50:14.780063 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:50:14.780486 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m18:50:14.780855 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m18:50:14.781153 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:50:14.781506 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:50:14.783728 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m18:50:14.783963 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m18:50:14.784242 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m18:50:14.784523 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.004 seconds
[0m18:50:14.784733 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m18:50:14.785034 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:50:14.787822 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:50:14.788159 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m18:50:14.790145 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:50:14.790430 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m18:50:14.792010 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:50:14.792253 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m18:50:14.794297 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m18:50:14.795539 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m18:50:14.795911 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m18:50:14.796190 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m18:50:14.796520 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m18:50:14.796788 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m18:50:14.797296 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.08s]
[0m18:50:14.797811 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.08s]
[0m18:50:14.798462 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m18:50:14.798814 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m18:50:14.800276 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m18:50:14.801163 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m18:50:14.801546 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m18:50:14.802026 [error] [Thread-1  ]: 1 of 3 FAIL 1425 no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines . [[31mFAIL 1425[0m in 0.09s]
[0m18:50:14.802538 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m18:50:14.803381 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.803657 [debug] [MainThread]: On master: BEGIN
[0m18:50:14.803878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:14.805692 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:50:14.805994 [debug] [MainThread]: On master: COMMIT
[0m18:50:14.806210 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:14.806476 [debug] [MainThread]: On master: COMMIT
[0m18:50:14.806852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:14.807109 [debug] [MainThread]: On master: Close
[0m18:50:14.807448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:14.807725 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m18:50:14.807953 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m18:50:14.808163 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m18:50:14.808485 [info ] [MainThread]: 
[0m18:50:14.808864 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:50:14.809614 [debug] [MainThread]: Command end result
[0m18:50:14.838204 [info ] [MainThread]: 
[0m18:50:14.838581 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:14.838834 [info ] [MainThread]: 
[0m18:50:14.839144 [error] [MainThread]: [31mFailure in test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines (models/crm_sales_data/crm_sales.yml)[0m
[0m18:50:14.839436 [error] [MainThread]:   Got 1425 results, configured to fail if != 0
[0m18:50:14.839805 [info ] [MainThread]: 
[0m18:50:14.840151 [info ] [MainThread]:   compiled code at target/compiled/matt_demo/models/crm_sales_data/crm_sales.yml/no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.sql
[0m18:50:14.840465 [info ] [MainThread]: 
[0m18:50:14.840764 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:50:14.841350 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8067231, "process_user_time": 2.468781, "process_kernel_time": 0.122684, "process_mem_max_rss": "130532", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:50:14.841726 [debug] [MainThread]: Command `dbt test` failed at 18:50:14.841676 after 0.81 seconds
[0m18:50:14.841998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0c0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0c0700>]}
[0m18:50:14.842257 [debug] [MainThread]: Flushing usage events
[0m19:36:13.842523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7669d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74c38760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74c38700>]}


============================== 19:36:13.846326 | 34e29fca-0d29-4063-b986-ddef10639f61 ==============================
[0m19:36:13.846326 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:36:13.847039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:13.929091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937767f0>]}
[0m19:36:13.952962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74e31520>]}
[0m19:36:13.953628 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:36:13.965484 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:36:14.084836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:14.085155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:14.109200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933bcee0>]}
[0m19:36:14.175883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933eed30>]}
[0m19:36:14.176317 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m19:36:14.176654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933a8820>]}
[0m19:36:14.177740 [info ] [MainThread]: 
[0m19:36:14.178229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:14.180552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:36:14.199979 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:36:14.200378 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:36:14.200690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:14.204038 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m19:36:14.204796 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:36:14.205844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m19:36:14.209365 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:36:14.209682 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m19:36:14.210007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:14.211659 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:36:14.211964 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:36:14.212237 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:36:14.213736 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m19:36:14.214471 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m19:36:14.214811 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m19:36:14.217488 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.217755 [debug] [MainThread]: On master: BEGIN
[0m19:36:14.218017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:14.219453 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:36:14.219700 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.219981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:14.225316 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m19:36:14.225961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937d8e20>]}
[0m19:36:14.226300 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:14.226613 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.226878 [debug] [MainThread]: On master: BEGIN
[0m19:36:14.227248 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:36:14.227488 [debug] [MainThread]: On master: COMMIT
[0m19:36:14.227723 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.227956 [debug] [MainThread]: On master: COMMIT
[0m19:36:14.228252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:14.228486 [debug] [MainThread]: On master: Close
[0m19:36:14.228784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:36:14.229166 [info ] [MainThread]: 
[0m19:36:14.233887 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m19:36:14.234172 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m19:36:14.234441 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m19:36:14.234735 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m19:36:14.235038 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m19:36:14.235660 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m19:36:14.236190 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m19:36:14.236687 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m19:36:14.237285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m19:36:14.237972 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m19:36:14.238439 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m19:36:14.238924 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m19:36:14.239307 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m19:36:14.239756 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m19:36:14.240148 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m19:36:14.240516 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m19:36:14.245344 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m19:36:14.247221 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m19:36:14.248962 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.250630 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.252101 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m19:36:14.252352 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m19:36:14.252669 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m19:36:14.259389 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m19:36:14.271313 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m19:36:14.273169 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m19:36:14.275003 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.276811 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.279276 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:36:14.279676 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.279897 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:36:14.280147 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m19:36:14.280390 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.281607 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m19:36:14.281003 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m19:36:14.281331 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:36:14.280678 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m19:36:14.281838 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:36:14.282114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:14.282552 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:36:14.284559 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m19:36:14.284830 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m19:36:14.285234 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m19:36:14.285449 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:36:14.285681 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m19:36:14.285987 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.286290 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.286600 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        halfmd5(product, series) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m19:36:14.286929 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:36:14.287217 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m19:36:14.287543 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m19:36:14.288023 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        halfmd5(account, sector, year_established, office_location) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m19:36:14.288287 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function halfmd5(text, text) does not exist
LINE 9:         halfmd5(product, series) as product_id,
                ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:36:14.289023 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: ROLLBACK
[0m19:36:14.289371 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function halfmd5(text, text, text, text) does not exist
LINE 9:         halfmd5(account, sector, year_established, office_lo...
                ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:36:14.290079 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m19:36:14.290334 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: ROLLBACK
[0m19:36:14.290571 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:36:14.290791 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:36:14.291558 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m19:36:14.295674 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.297574 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.298916 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m19:36:14.299449 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m19:36:14.300037 [debug] [Thread-2  ]: Database Error in model crm_stg_products (models/crm_sales_data/staging/crm_stg_products.sql)
  function halfmd5(text, text) does not exist
  LINE 9:         halfmd5(product, series) as product_id,
                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_products.sql
[0m19:36:14.300459 [debug] [Thread-1  ]: Database Error in model crm_stg_accounts (models/crm_sales_data/staging/crm_stg_accounts.sql)
  function halfmd5(text, text, text, text) does not exist
  LINE 9:         halfmd5(account, sector, year_established, office_lo...
                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_accounts.sql
[0m19:36:14.302481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ea6e20>]}
[0m19:36:14.301175 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:14.302143 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f0b0d0>]}
[0m19:36:14.300922 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:14.302905 [error] [Thread-1  ]: 1 of 6 ERROR creating sql view model dev.crm_stg_accounts ...................... [[31mERROR[0m in 0.07s]
[0m19:36:14.304778 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.305222 [error] [Thread-2  ]: 2 of 6 ERROR creating sql view model dev.crm_stg_products ...................... [[31mERROR[0m in 0.06s]
[0m19:36:14.312283 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m19:36:14.312663 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m19:36:14.312990 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m19:36:14.313398 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m19:36:14.313681 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.314065 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m19:36:14.314732 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:14.315043 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m19:36:14.315448 [info ] [Thread-1  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m19:36:14.317319 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m19:36:14.317836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m19:36:14.318235 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.318489 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m19:36:14.318800 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m19:36:14.319161 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m19:36:14.322439 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m19:36:14.324264 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m19:36:14.327253 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:36:14.327492 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m19:36:14.327940 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m19:36:14.329415 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m19:36:14.329819 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m19:36:14.330071 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:36:14.330441 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:36:14.341780 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m19:36:14.343037 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m19:36:14.343322 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m19:36:14.343947 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9303ca60>]}
[0m19:36:14.344554 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:36:14.345208 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:36:14.344983 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:36:14.345614 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m19:36:14.346417 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m19:36:14.346806 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m19:36:14.347088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:36:14.347502 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9303c970>]}
[0m19:36:14.348300 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:36:14.348770 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m19:36:14.349250 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_performance
[0m19:36:14.349633 [info ] [Thread-2  ]: 6 of 6 START sql table model dev.crm_performance ............................... [RUN]
[0m19:36:14.349945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:36:14.350268 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.crm_performance)
[0m19:36:14.350541 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:36:14.350830 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_performance
[0m19:36:14.351165 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m19:36:14.353554 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m19:36:14.354513 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_performance
[0m19:36:14.357324 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m19:36:14.358037 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:36:14.358347 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: BEGIN
[0m19:36:14.358615 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:36:14.360733 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m19:36:14.361039 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:36:14.361437 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."dev"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."dev"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."dev"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m19:36:14.378528 [debug] [Thread-2  ]: SQL status: SELECT 1050 in 0.017 seconds
[0m19:36:14.381226 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:36:14.381521 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."dev"."crm_performance__dbt_tmp" rename to "crm_performance"
[0m19:36:14.381993 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:14.384467 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: COMMIT
[0m19:36:14.384765 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:36:14.385085 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: COMMIT
[0m19:36:14.386506 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m19:36:14.388060 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_performance__dbt_backup"
[0m19:36:14.389326 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:36:14.389583 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
drop table if exists "company_dw"."dev"."crm_performance__dbt_backup" cascade
[0m19:36:14.389964 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.000 seconds
[0m19:36:14.390677 [debug] [Thread-2  ]: On model.matt_demo.crm_performance: Close
[0m19:36:14.391086 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75835af0>]}
[0m19:36:14.391507 [info ] [Thread-2  ]: 6 of 6 OK created sql table model dev.crm_performance .......................... [[32mSELECT 1050[0m in 0.04s]
[0m19:36:14.392019 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_performance
[0m19:36:14.488703 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.135 seconds
[0m19:36:14.490923 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:36:14.491321 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:36:14.491905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:14.492837 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m19:36:14.493234 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:36:14.493651 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m19:36:14.499799 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m19:36:14.501565 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m19:36:14.501960 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:36:14.502205 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m19:36:14.502557 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m19:36:14.503355 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m19:36:14.503740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e29fca-0d29-4063-b986-ddef10639f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d4cf70>]}
[0m19:36:14.504200 [info ] [Thread-1  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.19s]
[0m19:36:14.504738 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m19:36:14.505626 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.505958 [debug] [MainThread]: On master: BEGIN
[0m19:36:14.506181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:14.507787 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:36:14.508046 [debug] [MainThread]: On master: COMMIT
[0m19:36:14.508328 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:14.508604 [debug] [MainThread]: On master: COMMIT
[0m19:36:14.508931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:14.509194 [debug] [MainThread]: On master: Close
[0m19:36:14.509488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:14.509704 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m19:36:14.509940 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m19:36:14.510179 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m19:36:14.510383 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m19:36:14.510636 [info ] [MainThread]: 
[0m19:36:14.511000 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m19:36:14.511770 [debug] [MainThread]: Command end result
[0m19:36:14.563200 [info ] [MainThread]: 
[0m19:36:14.563614 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:36:14.563911 [info ] [MainThread]: 
[0m19:36:14.564285 [error] [MainThread]:   Database Error in model crm_stg_accounts (models/crm_sales_data/staging/crm_stg_accounts.sql)
  function halfmd5(text, text, text, text) does not exist
  LINE 9:         halfmd5(account, sector, year_established, office_lo...
                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_accounts.sql
[0m19:36:14.564620 [info ] [MainThread]: 
[0m19:36:14.564993 [error] [MainThread]:   Database Error in model crm_stg_products (models/crm_sales_data/staging/crm_stg_products.sql)
  function halfmd5(text, text) does not exist
  LINE 9:         halfmd5(product, series) as product_id,
                  ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_products.sql
[0m19:36:14.565320 [info ] [MainThread]: 
[0m19:36:14.565606 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m19:36:14.566174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.74854535, "process_user_time": 2.267455, "process_kernel_time": 0.159313, "process_mem_max_rss": "132876", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:14.566530 [debug] [MainThread]: Command `dbt run` failed at 19:36:14.566486 after 0.75 seconds
[0m19:36:14.566779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7669d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e3b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e3beb0>]}
[0m19:36:14.567013 [debug] [MainThread]: Flushing usage events
[0m19:49:26.436193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b7d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93119670>]}


============================== 19:49:26.440522 | 0496ced8-92bf-4fab-90ac-fe24ac45dce5 ==============================
[0m19:49:26.440522 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:49:26.441128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:26.518151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949db6d0>]}
[0m19:49:26.540812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bcbb50>]}
[0m19:49:26.541304 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:49:26.553620 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:49:26.671127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:49:26.671604 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_accounts.sql
[0m19:49:26.671906 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_products.sql
[0m19:49:26.785436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1167e20>]}
[0m19:49:26.854603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ad9a00>]}
[0m19:49:26.854982 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m19:49:26.855283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacacf9a0>]}
[0m19:49:26.856286 [info ] [MainThread]: 
[0m19:49:26.856797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:26.859116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:49:26.874656 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:49:26.875019 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:49:26.875317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:26.877784 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m19:49:26.878454 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:49:26.879403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m19:49:26.882631 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:49:26.882933 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m19:49:26.883245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:26.884669 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m19:49:26.884960 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:49:26.885243 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:49:26.886486 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m19:49:26.887179 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m19:49:26.887536 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m19:49:26.890642 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:26.890920 [debug] [MainThread]: On master: BEGIN
[0m19:49:26.891153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:26.892563 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:49:26.892835 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:26.893131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:26.899247 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m19:49:26.900025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1caff40>]}
[0m19:49:26.900378 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:26.900718 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:26.900986 [debug] [MainThread]: On master: BEGIN
[0m19:49:26.901351 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:49:26.901611 [debug] [MainThread]: On master: COMMIT
[0m19:49:26.901834 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:26.902089 [debug] [MainThread]: On master: COMMIT
[0m19:49:26.902397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:26.902653 [debug] [MainThread]: On master: Close
[0m19:49:26.902982 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:26.903346 [info ] [MainThread]: 
[0m19:49:26.907255 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m19:49:26.907497 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m19:49:26.907778 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m19:49:26.908017 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m19:49:26.908380 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m19:49:26.908859 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m19:49:26.909332 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m19:49:26.909861 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m19:49:26.910323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m19:49:26.910734 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m19:49:26.911142 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m19:49:26.911562 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m19:49:26.911923 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m19:49:26.912238 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m19:49:26.912581 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m19:49:26.912909 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m19:49:26.917061 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m19:49:26.918658 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m19:49:26.920280 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:26.921816 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m19:49:26.924039 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m19:49:26.924339 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m19:49:26.924539 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m19:49:26.941788 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m19:49:26.942391 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m19:49:26.944164 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m19:49:26.945965 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:26.947976 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m19:49:26.949010 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:49:26.949252 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:49:26.950091 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:26.950298 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m19:49:26.950829 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:26.951100 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m19:49:26.951769 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m19:49:26.952053 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:49:26.952334 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m19:49:26.952607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:49:26.952879 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:49:26.953313 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:49:26.954975 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m19:49:26.955236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m19:49:26.955596 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:49:26.955840 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m19:49:26.956050 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m19:49:26.956319 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:49:26.956626 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m19:49:26.956946 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:26.957241 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:26.957526 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m19:49:26.958004 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m19:49:26.958370 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m19:49:26.958986 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m19:49:26.962588 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:49:26.962814 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:49:26.963035 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:49:26.963244 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:49:26.963559 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m19:49:26.965320 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:49:26.967170 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:26.968968 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:26.969381 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m19:49:26.969623 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:26.969891 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m19:49:26.970186 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m19:49:26.976850 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m19:49:26.977096 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m19:49:26.977611 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:26.977844 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:26.978124 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:49:26.978791 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m19:49:26.980866 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:27.006062 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:27.006454 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m19:49:27.006785 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:49:27.007127 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m19:49:27.007472 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m19:49:27.007940 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m19:49:27.008535 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m19:49:27.008808 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:27.009019 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:27.012442 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m19:49:27.012694 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m19:49:27.014365 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m19:49:27.015203 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m19:49:27.017244 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m19:49:27.018642 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m19:49:27.018951 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:27.019244 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:27.019547 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m19:49:27.019922 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m19:49:27.020214 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m19:49:27.020503 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m19:49:27.020919 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m19:49:27.021141 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:49:27.021650 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m19:49:27.021893 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m19:49:27.022130 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m19:49:27.023312 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m19:49:27.024820 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m19:49:27.026738 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m19:49:27.027429 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m19:49:27.028370 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a14250>]}
[0m19:49:27.028794 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m19:49:27.029191 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m19:49:27.029578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9a14400>]}
[0m19:49:27.030002 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:49:27.030376 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m19:49:27.030739 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m19:49:27.031141 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:49:27.031673 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m19:49:27.032290 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m19:49:27.032563 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:49:27.032804 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m19:49:27.033053 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m19:49:27.033976 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m19:49:27.034697 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m19:49:27.035059 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m19:49:27.035533 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b49a90>]}
[0m19:49:27.035924 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b49490>]}
[0m19:49:27.036261 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m19:49:27.036685 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:49:27.037150 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:49:27.037537 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m19:49:27.037945 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m19:49:27.038320 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m19:49:27.040199 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m19:49:27.040851 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_performance
[0m19:49:27.041396 [info ] [Thread-1  ]: 6 of 6 START sql table model dev.crm_performance ............................... [RUN]
[0m19:49:27.041813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.crm_performance)
[0m19:49:27.042122 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_performance
[0m19:49:27.042404 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m19:49:27.044338 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_performance"
[0m19:49:27.055290 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m19:49:27.056240 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_performance
[0m19:49:27.056914 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.058713 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_performance"
[0m19:49:27.058998 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m19:49:27.059567 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:49:27.060083 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.060372 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: BEGIN
[0m19:49:27.060677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:49:27.061425 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:27.061716 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.062032 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m19:49:27.062424 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:27.062713 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.063058 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */

  
    

  create  table "company_dw"."dev"."crm_performance__dbt_tmp"
  
  
    as
  
  (
    

with sales_performance as (
    select
        st.manager,
        st.team_name,
        st.sales_agent,
        sp.opportunity_id,
        sp.product_name,
        sp.company_name,
        sp.deal_stage,
        sp.engage_date,
        sp.close_date,
        sp.revenue,
        date_trunc('quarter', sp.close_date) as close_quarter
    from 
        "company_dw"."dev"."crm_stg_sales_pipelines" sp
    join 
        "company_dw"."dev"."crm_stg_sales_teams" st on sp.sales_agent = st.sales_agent
),

team_performance as (
    select
        manager,
        team_name,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value,
        array_agg(distinct sales_agent) as sales_agents
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        manager, team_name
),

agent_performance as (
    select
        sales_agent,
        manager,
        count(opportunity_id) as won_opportunities,
        sum(revenue) as total_value
    from 
        sales_performance
    where 
        deal_stage = 'Won'
    group by 
        sales_agent, manager
    order by 
        won_opportunities asc
),

quarterly_trends as (
    select
        close_quarter,
        count(opportunity_id) as total_opportunities,
        sum(revenue) as total_value,
        avg(revenue) as average_value
    from 
        sales_performance
    group by 
        close_quarter
    order by 
        close_quarter
),

product_win_rates as (
    select
        product_name,
        count(case when deal_stage = 'Won' then 1 end) as won_opportunities,
        count(case when deal_stage = 'Lost' then 1 end) as lost_opportunities,
        round(
            (count(case when deal_stage = 'Won' then 1 end) * 1.0 / 
            (count(case when deal_stage = 'Won' then 1 end) + count(case when deal_stage = 'Lost' then 1 end))) * 100, 2
        ) as win_rate
    from 
        sales_performance
    group by 
        product_name
)

select 
    tp.manager,
    tp.team_name,
    tp.total_opportunities,
    tp.total_value,
    tp.average_value,
    tp.sales_agents,
    ap.sales_agent,
    ap.won_opportunities,
    ap.total_value as agent_total_value,
    qt.close_quarter,
    qt.total_opportunities as quarter_total_opportunities,
    qt.total_value as quarter_total_value,
    qt.average_value as quarter_average_value,
    pw.product_name,
    pw.won_opportunities as product_won_opportunities,
    pw.lost_opportunities as product_lost_opportunities,
    pw.win_rate
from 
    team_performance tp
left join 
    agent_performance ap on tp.manager = ap.manager
left join 
    quarterly_trends qt on tp.manager is not null
left join 
    product_win_rates pw on tp.manager is not null
  );
  
[0m19:49:27.078296 [debug] [Thread-1  ]: SQL status: SELECT 1050 in 0.015 seconds
[0m19:49:27.081079 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.081399 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."dev"."crm_performance" rename to "crm_performance__dbt_backup"
[0m19:49:27.081892 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:27.083589 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.083880 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
alter table "company_dw"."dev"."crm_performance__dbt_tmp" rename to "crm_performance"
[0m19:49:27.084280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:27.086703 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m19:49:27.086996 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.087282 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: COMMIT
[0m19:49:27.088383 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:49:27.089817 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_performance__dbt_backup"
[0m19:49:27.091035 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_performance"
[0m19:49:27.091305 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_performance"} */
drop table if exists "company_dw"."dev"."crm_performance__dbt_backup" cascade
[0m19:49:27.092557 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m19:49:27.093251 [debug] [Thread-1  ]: On model.matt_demo.crm_performance: Close
[0m19:49:27.093664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca6b9a0>]}
[0m19:49:27.094060 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dev.crm_performance .......................... [[32mSELECT 1050[0m in 0.05s]
[0m19:49:27.094580 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_performance
[0m19:49:27.183109 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.121 seconds
[0m19:49:27.185183 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.185529 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m19:49:27.186019 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:27.187588 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.187900 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:49:27.188315 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:27.189041 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m19:49:27.189347 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.189653 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m19:49:27.194388 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m19:49:27.196599 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m19:49:27.196988 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m19:49:27.197256 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m19:49:27.199533 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m19:49:27.200225 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m19:49:27.200660 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0496ced8-92bf-4fab-90ac-fe24ac45dce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99811c0>]}
[0m19:49:27.201096 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.16s]
[0m19:49:27.201637 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m19:49:27.202501 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:27.202775 [debug] [MainThread]: On master: BEGIN
[0m19:49:27.203012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:27.204469 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:49:27.204721 [debug] [MainThread]: On master: COMMIT
[0m19:49:27.204922 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:27.205155 [debug] [MainThread]: On master: COMMIT
[0m19:49:27.205460 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:27.205761 [debug] [MainThread]: On master: Close
[0m19:49:27.206055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:27.206311 [debug] [MainThread]: Connection 'model.matt_demo.crm_performance' was properly closed.
[0m19:49:27.206572 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m19:49:27.206829 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m19:49:27.207058 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m19:49:27.207350 [info ] [MainThread]: 
[0m19:49:27.207693 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m19:49:27.208436 [debug] [MainThread]: Command end result
[0m19:49:27.236857 [info ] [MainThread]: 
[0m19:49:27.237265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:27.237573 [info ] [MainThread]: 
[0m19:49:27.237952 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:49:27.238547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.82639986, "process_user_time": 2.373173, "process_kernel_time": 0.092201, "process_mem_max_rss": "128572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:27.238930 [debug] [MainThread]: Command `dbt run` succeeded at 19:49:27.238879 after 0.83 seconds
[0m19:49:27.239196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b7d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90839f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90839fd0>]}
[0m19:49:27.239466 [debug] [MainThread]: Flushing usage events
[0m19:49:38.172641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd12760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd12700>]}


============================== 19:49:38.175881 | 30569bc9-1079-4f0f-91a7-701324b33ba5 ==============================
[0m19:49:38.175881 [info ] [MainThread]: Running with dbt=1.8.3
[0m19:49:38.176441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:38.249930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae84e550>]}
[0m19:49:38.272465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff0a520>]}
[0m19:49:38.272927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:49:38.282913 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m19:49:38.401736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:38.402128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:38.426320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae49bee0>]}
[0m19:49:38.497660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae22b1c0>]}
[0m19:49:38.498123 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m19:49:38.498552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae43ee80>]}
[0m19:49:38.499568 [info ] [MainThread]: 
[0m19:49:38.500059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:38.502280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m19:49:38.518161 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:49:38.518575 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m19:49:38.518870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:38.521013 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:49:38.521279 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:49:38.521547 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:49:38.522778 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m19:49:38.523487 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m19:49:38.523841 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m19:49:38.527078 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.527349 [debug] [MainThread]: On master: BEGIN
[0m19:49:38.527592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:38.529065 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:49:38.529424 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.529897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:38.537190 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m19:49:38.537927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30569bc9-1079-4f0f-91a7-701324b33ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9174ceb0>]}
[0m19:49:38.538260 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:38.538607 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.538851 [debug] [MainThread]: On master: BEGIN
[0m19:49:38.539221 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:49:38.539460 [debug] [MainThread]: On master: COMMIT
[0m19:49:38.539702 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.539924 [debug] [MainThread]: On master: COMMIT
[0m19:49:38.540183 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:38.540402 [debug] [MainThread]: On master: Close
[0m19:49:38.540746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:38.541075 [info ] [MainThread]: 
[0m19:49:38.545204 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m19:49:38.545446 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m19:49:38.545692 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m19:49:38.545964 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m19:49:38.546196 [info ] [Thread-1  ]: 1 of 6 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m19:49:38.546592 [info ] [Thread-2  ]: 2 of 6 START test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams ........ [RUN]
[0m19:49:38.546987 [info ] [Thread-3  ]: 3 of 6 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m19:49:38.547382 [info ] [Thread-4  ]: 4 of 6 START test not_null_crm_stg_sales_teams_sales_agent ..................... [RUN]
[0m19:49:38.547843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m19:49:38.548250 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267'
[0m19:49:38.548672 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m19:49:38.549066 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800'
[0m19:49:38.549399 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m19:49:38.549735 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m19:49:38.550083 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m19:49:38.550400 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m19:49:38.564892 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m19:49:38.568585 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m19:49:38.572669 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m19:49:38.574875 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m19:49:38.575242 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m19:49:38.575579 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m19:49:38.576337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:49:38.576885 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:49:38.577512 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m19:49:38.577760 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m19:49:38.585528 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m19:49:38.587215 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m19:49:38.587427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m19:49:38.587638 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m19:49:38.588463 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m19:49:38.589193 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m19:49:38.589722 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m19:49:38.590006 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m19:49:38.590206 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m19:49:38.590478 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m19:49:38.590937 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m19:49:38.591229 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: BEGIN
[0m19:49:38.591619 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:49:38.591929 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:49:38.593646 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:38.593873 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:38.594140 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.003 seconds
[0m19:49:38.594356 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m19:49:38.597301 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m19:49:38.594848 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m19:49:38.597000 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m19:49:38.594552 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.003 seconds
[0m19:49:38.597717 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_agent
from "company_dw"."dev"."crm_stg_sales_teams"
where sales_agent is null



      
    ) dbt_internal_test
[0m19:49:38.598619 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:38.599455 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m19:49:38.599962 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m19:49:38.602132 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m19:49:38.602357 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m19:49:38.604308 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m19:49:38.604621 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m19:49:38.604921 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m19:49:38.605625 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: ROLLBACK
[0m19:49:38.607199 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m19:49:38.607682 [info ] [Thread-3  ]: 3 of 6 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.06s]
[0m19:49:38.608099 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m19:49:38.608392 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: Close
[0m19:49:38.608983 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m19:49:38.609302 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m19:49:38.609561 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m19:49:38.609996 [info ] [Thread-4  ]: 4 of 6 PASS not_null_crm_stg_sales_teams_sales_agent ........................... [[32mPASS[0m in 0.06s]
[0m19:49:38.610414 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m19:49:38.610828 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    

    
    
        
        SELECT * FROM "company_dw"."dev"."crm_stg_sales_teams" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_teams" WHERE manager = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_teams" WHERE regional_office = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_teams" WHERE team_name = 'NaN'
    

      
    ) dbt_internal_test
[0m19:49:38.611394 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m19:49:38.611732 [info ] [Thread-3  ]: 5 of 6 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m19:49:38.612238 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m19:49:38.612535 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:38.612819 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m19:49:38.613123 [info ] [Thread-4  ]: 6 of 6 START test unique_crm_stg_sales_teams_sales_agent ....................... [RUN]
[0m19:49:38.614118 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m19:49:38.614395 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m19:49:38.614715 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m19:49:38.615036 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m19:49:38.615414 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m19:49:38.616183 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m19:49:38.619618 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m19:49:38.619918 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m19:49:38.620400 [info ] [Thread-2  ]: 2 of 6 PASS no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams .............. [[32mPASS[0m in 0.07s]
[0m19:49:38.620847 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m19:49:38.623402 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m19:49:38.623858 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m19:49:38.624184 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m19:49:38.624522 [info ] [Thread-1  ]: 1 of 6 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.08s]
[0m19:49:38.627095 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m19:49:38.627327 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m19:49:38.629117 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m19:49:38.627663 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m19:49:38.629958 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m19:49:38.630234 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m19:49:38.630449 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m19:49:38.630729 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: BEGIN
[0m19:49:38.631008 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:49:38.631249 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:49:38.632959 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:38.633192 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m19:49:38.633502 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m19:49:38.633853 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m19:49:38.634142 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_agent as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_teams"
where sales_agent is not null
group by sales_agent
having count(*) > 1



      
    ) dbt_internal_test
[0m19:49:38.634437 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:49:38.635248 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:38.636150 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: ROLLBACK
[0m19:49:38.636446 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: Close
[0m19:49:38.637095 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:49:38.636888 [info ] [Thread-4  ]: 6 of 6 PASS unique_crm_stg_sales_teams_sales_agent ............................. [[32mPASS[0m in 0.02s]
[0m19:49:38.638070 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m19:49:38.638446 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m19:49:38.638829 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m19:49:38.639287 [info ] [Thread-3  ]: 5 of 6 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.03s]
[0m19:49:38.639764 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m19:49:38.640592 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.640855 [debug] [MainThread]: On master: BEGIN
[0m19:49:38.641097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:38.642567 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:49:38.642802 [debug] [MainThread]: On master: COMMIT
[0m19:49:38.643041 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:38.643288 [debug] [MainThread]: On master: COMMIT
[0m19:49:38.643605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:38.643840 [debug] [MainThread]: On master: Close
[0m19:49:38.644133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:38.644361 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m19:49:38.644599 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m19:49:38.644827 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m19:49:38.645042 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m19:49:38.645298 [info ] [MainThread]: 
[0m19:49:38.645697 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m19:49:38.646428 [debug] [MainThread]: Command end result
[0m19:49:38.674249 [info ] [MainThread]: 
[0m19:49:38.674663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:38.674960 [info ] [MainThread]: 
[0m19:49:38.675235 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:49:38.675796 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5269779, "process_user_time": 2.176183, "process_kernel_time": 0.082589, "process_mem_max_rss": "129140", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:38.676151 [debug] [MainThread]: Command `dbt test` succeeded at 19:49:38.676106 after 0.53 seconds
[0m19:49:38.676402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917762e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff910614c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae81b2b0>]}
[0m19:49:38.676655 [debug] [MainThread]: Flushing usage events
[0m20:04:23.261662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f10e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6aa760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6aa700>]}


============================== 20:04:23.265387 | 7761bec2-eda5-4129-ac0f-d80798640a59 ==============================
[0m20:04:23.265387 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:04:23.266020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:04:23.346877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac28b8b0>]}
[0m20:04:23.369483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac205d30>]}
[0m20:04:23.369980 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:04:23.381947 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:04:23.501349 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 1 files changed.
[0m20:04:23.501772 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:04:23.502030 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:04:23.502325 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/fact/product_win_rates.sql
[0m20:04:23.502593 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/fact/team_performance.sql
[0m20:04:23.502862 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://models/crm_sales_data/analysis/crm_performance.sql
[0m20:04:23.503198 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:04:23.599510 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:04:23.600054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac19ffa0>]}
[0m20:04:23.694225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a06130>]}
[0m20:04:23.762786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4984d60>]}
[0m20:04:23.763161 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:04:23.763597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a27bb0>]}
[0m20:04:23.764552 [info ] [MainThread]: 
[0m20:04:23.765103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:23.767443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:04:23.783579 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:04:23.783985 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:04:23.784308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:23.787055 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:04:23.787775 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:04:23.788924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:04:23.792103 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:04:23.792435 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:04:23.792708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:23.794353 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:04:23.794660 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:04:23.794945 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:04:23.796559 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:04:23.797282 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:04:23.797645 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:04:23.800957 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.801282 [debug] [MainThread]: On master: BEGIN
[0m20:04:23.801556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:23.803198 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:04:23.803468 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.803760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:23.811220 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m20:04:23.811905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7470d0>]}
[0m20:04:23.812209 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:23.812522 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.812761 [debug] [MainThread]: On master: BEGIN
[0m20:04:23.813142 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:04:23.813383 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.813644 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:23.813876 [debug] [MainThread]: On master: COMMIT
[0m20:04:23.814156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:23.814398 [debug] [MainThread]: On master: Close
[0m20:04:23.814786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:23.815129 [info ] [MainThread]: 
[0m20:04:23.819108 [debug] [Thread-1  ]: Began running node model.matt_demo.agent_performance
[0m20:04:23.819370 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:04:23.819664 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_products
[0m20:04:23.819956 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:04:23.820250 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.agent_performance .............................. [RUN]
[0m20:04:23.820710 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m20:04:23.821240 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m20:04:23.821715 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:04:23.822221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.agent_performance)
[0m20:04:23.822588 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_accounts'
[0m20:04:23.822957 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m20:04:23.823324 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:04:23.823685 [debug] [Thread-1  ]: Began compiling node model.matt_demo.agent_performance
[0m20:04:23.824004 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:04:23.824328 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:04:23.824683 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:04:23.828285 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:04:23.829905 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:04:23.831532 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:04:23.833914 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:04:23.836517 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:04:23.836795 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:04:23.837023 [debug] [Thread-1  ]: Began executing node model.matt_demo.agent_performance
[0m20:04:23.837303 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:04:23.883830 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:04:23.884415 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:04:23.886272 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:04:23.888531 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:04:23.892267 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.892647 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.892898 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:04:23.893100 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:04:23.893316 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:04:23.893591 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:04:23.893878 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:04:23.894123 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:04:23.894382 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:04:23.894634 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:04:23.895045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:04:23.895368 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:04:23.896990 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:04:23.897252 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:04:23.897622 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.897846 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:04:23.898061 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:04:23.898361 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.898674 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:04:23.898980 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:04:23.899279 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:04:23.899575 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:04:23.900006 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  create view "company_dw"."dev"."agent_performance__dbt_tmp"
    
    
  as (
    with agent_performance as (
    select 
        
)
  );
[0m20:04:23.900360 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as close_date,
        age(close_date, engage_date) as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:04:23.901029 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 11:   );
           ^

[0m20:04:23.901323 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:04:23.901775 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: ROLLBACK
[0m20:04:23.902064 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:04:23.902306 [debug] [Thread-4  ]: Postgres adapter: Postgres error: function age(text, text) does not exist
LINE 16:         age(close_date, engage_date) as deal_age,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:04:23.905867 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.906358 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: Close
[0m20:04:23.908149 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.908467 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: ROLLBACK
[0m20:04:23.908772 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:04:23.909355 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:04:23.909936 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:04:23.910530 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:23.910790 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:23.913075 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.913741 [debug] [Thread-1  ]: Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 11:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:04:23.914105 [debug] [Thread-4  ]: Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  function age(text, text) does not exist
  LINE 16:         age(close_date, engage_date) as deal_age,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:04:23.915764 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.916148 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:04:23.917032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a0d760>]}
[0m20:04:23.917381 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fd30a0>]}
[0m20:04:23.917689 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:04:23.918323 [error] [Thread-1  ]: 1 of 6 ERROR creating sql view model dev.agent_performance ..................... [[31mERROR[0m in 0.09s]
[0m20:04:23.918687 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:04:23.919001 [error] [Thread-4  ]: 4 of 6 ERROR creating sql view model dev.crm_stg_sales_pipelines ............... [[31mERROR[0m in 0.09s]
[0m20:04:23.919670 [debug] [Thread-1  ]: Finished running node model.matt_demo.agent_performance
[0m20:04:23.919892 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:23.927788 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:04:23.928172 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:04:23.928534 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:04:23.929280 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:04:23.929605 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.929959 [debug] [Thread-4  ]: Began running node model.matt_demo.dim_date
[0m20:04:23.930378 [info ] [Thread-1  ]: 5 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m20:04:23.930773 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.931088 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:04:23.931493 [info ] [Thread-4  ]: 6 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:04:23.931952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.agent_performance, now model.matt_demo.crm_stg_sales_teams)
[0m20:04:23.932234 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:04:23.932797 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.dim_date)
[0m20:04:23.933094 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:04:23.933374 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:04:23.933869 [debug] [Thread-4  ]: Began compiling node model.matt_demo.dim_date
[0m20:04:23.934103 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m20:04:23.937957 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m20:04:23.939653 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.941478 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:04:23.942865 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m20:04:23.944957 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:04:23.946265 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:04:23.946652 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:04:23.946878 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m20:04:23.947243 [debug] [Thread-4  ]: Began executing node model.matt_demo.dim_date
[0m20:04:23.947457 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m20:04:23.949456 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.961473 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:04:23.961725 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.012 seconds
[0m20:04:23.963609 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: Close
[0m20:04:23.963836 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:04:23.964166 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.964533 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe3a730>]}
[0m20:04:23.964860 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:23.965568 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:04:23.965865 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:04:23.966286 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:04:23.966660 [debug] [Thread-4  ]: On model.matt_demo.dim_date: BEGIN
[0m20:04:23.967056 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe3a340>]}
[0m20:04:23.967339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:04:23.967778 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:04:23.968055 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:04:23.968454 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:04:23.969486 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:04:23.970256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:04:23.970474 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:04:23.970753 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.971038 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:23.971314 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:04:23.971729 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:04:23.972853 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:04:23.976263 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.976597 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:04:23.977182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:23.979101 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.979415 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:04:23.980010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:23.980838 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:04:23.981094 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.981326 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:04:23.981884 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m20:04:23.983422 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m20:04:23.983797 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:04:23.984049 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:04:23.984770 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:04:23.985484 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:04:23.985871 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fd3130>]}
[0m20:04:23.986266 [info ] [Thread-1  ]: 5 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:04:23.986788 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:04:24.098629 [debug] [Thread-4  ]: SQL status: SELECT 29220 in 0.126 seconds
[0m20:04:24.100852 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:24.101189 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:04:24.101735 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:24.104543 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:24.104887 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:04:24.105350 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:04:24.107889 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:04:24.108201 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:24.108492 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:04:24.110526 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m20:04:24.112046 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:04:24.113254 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:04:24.113549 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:04:24.115471 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:04:24.116209 [debug] [Thread-4  ]: On model.matt_demo.dim_date: Close
[0m20:04:24.116637 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7761bec2-eda5-4129-ac0f-d80798640a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe3a610>]}
[0m20:04:24.117076 [info ] [Thread-4  ]: 6 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.18s]
[0m20:04:24.117600 [debug] [Thread-4  ]: Finished running node model.matt_demo.dim_date
[0m20:04:24.118482 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.118767 [debug] [MainThread]: On master: BEGIN
[0m20:04:24.119006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:24.120577 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:04:24.120836 [debug] [MainThread]: On master: COMMIT
[0m20:04:24.121053 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:24.121255 [debug] [MainThread]: On master: COMMIT
[0m20:04:24.121544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:24.121799 [debug] [MainThread]: On master: Close
[0m20:04:24.122117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:24.122339 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:04:24.122560 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:04:24.122790 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m20:04:24.122995 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:04:24.123245 [info ] [MainThread]: 
[0m20:04:24.123571 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:04:24.124328 [debug] [MainThread]: Command end result
[0m20:04:24.151527 [info ] [MainThread]: 
[0m20:04:24.151940 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:04:24.152227 [info ] [MainThread]: 
[0m20:04:24.152599 [error] [MainThread]:   Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 11:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:04:24.152914 [info ] [MainThread]: 
[0m20:04:24.153229 [error] [MainThread]:   Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  function age(text, text) does not exist
  LINE 16:         age(close_date, engage_date) as deal_age,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:04:24.153543 [info ] [MainThread]: 
[0m20:04:24.153835 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m20:04:24.154419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.91700053, "process_user_time": 2.450043, "process_kernel_time": 0.117771, "process_mem_max_rss": "134384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:04:24.154820 [debug] [MainThread]: Command `dbt run` failed at 20:04:24.154772 after 0.92 seconds
[0m20:04:24.155106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f10e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edb8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa702f670>]}
[0m20:04:24.155358 [debug] [MainThread]: Flushing usage events
[0m20:05:51.531394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762bc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762bc700>]}


============================== 20:05:51.534628 | e7408206-5531-4c19-ad12-69acc3e7f01d ==============================
[0m20:05:51.534628 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:05:51.535200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:05:51.612781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dfc2b0>]}
[0m20:05:51.644823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff764b6520>]}
[0m20:05:51.645595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:05:51.660668 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:05:51.780889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:05:51.781366 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:05:51.781661 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:05:51.875728 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:05:51.876326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d35be0>]}
[0m20:05:51.966095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d659130>]}
[0m20:05:52.035226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d61b970>]}
[0m20:05:52.035591 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:05:52.035911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d678850>]}
[0m20:05:52.036960 [info ] [MainThread]: 
[0m20:05:52.037648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:05:52.039962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:05:52.054890 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:05:52.055316 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:05:52.055641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:52.058788 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:05:52.059534 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:05:52.060899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:05:52.064152 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:05:52.064442 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:05:52.064715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:52.066289 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:05:52.066585 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:05:52.066892 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:05:52.068092 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:05:52.068761 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:05:52.069115 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:05:52.072451 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.072731 [debug] [MainThread]: On master: BEGIN
[0m20:05:52.072951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:52.074394 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:05:52.074637 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.074929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:05:52.081582 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m20:05:52.082270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d61bc70>]}
[0m20:05:52.082587 [debug] [MainThread]: On master: ROLLBACK
[0m20:05:52.082938 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.083192 [debug] [MainThread]: On master: BEGIN
[0m20:05:52.083575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:05:52.083826 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.084066 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.084296 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.084598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:52.084835 [debug] [MainThread]: On master: Close
[0m20:05:52.085159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:05:52.085482 [info ] [MainThread]: 
[0m20:05:52.089394 [debug] [Thread-1  ]: Began running node model.matt_demo.agent_performance
[0m20:05:52.089697 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:05:52.089920 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_products
[0m20:05:52.090227 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:05:52.090555 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.agent_performance .............................. [RUN]
[0m20:05:52.091090 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m20:05:52.091580 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m20:05:52.092045 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:05:52.092542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.agent_performance)
[0m20:05:52.092951 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_accounts'
[0m20:05:52.093365 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m20:05:52.093702 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:05:52.094057 [debug] [Thread-1  ]: Began compiling node model.matt_demo.agent_performance
[0m20:05:52.094460 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:05:52.094771 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:05:52.095068 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:05:52.099183 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:05:52.100750 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:05:52.102405 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:05:52.103970 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:05:52.106977 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:05:52.107187 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:05:52.107373 [debug] [Thread-1  ]: Began executing node model.matt_demo.agent_performance
[0m20:05:52.107740 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:05:52.153201 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:05:52.153529 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:05:52.155398 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:05:52.157247 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:05:52.158768 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.159150 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.159426 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:05:52.159635 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:05:52.159931 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:05:52.160205 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:05:52.160524 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:05:52.160802 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:05:52.161115 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:05:52.161385 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:05:52.161873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:52.162279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:05:52.163587 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:05:52.164093 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.164363 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:05:52.164745 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:05:52.164987 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:05:52.165211 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:05:52.165490 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.165937 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:05:52.166300 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:05:52.166620 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:05:52.166857 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:05:52.167161 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        age(ts_close_date, ts_engage_date) as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:05:52.167489 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  create view "company_dw"."dev"."agent_performance__dbt_tmp"
    
    
  as (
    with agent_performance as (
    select * 
    from "company_dw"."crm_sales_data"."sales_pipeline"

)
  );
[0m20:05:52.171899 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.172151 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:05:52.172750 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 12:   );
           ^

[0m20:05:52.172964 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:05:52.173200 [debug] [Thread-4  ]: Postgres adapter: Postgres error: column "ts_close_date" does not exist
LINE 16:         age(ts_close_date, ts_engage_date) as deal_age,
                     ^
HINT:  Perhaps you meant to reference the column "sales_pipeline.close_date".

[0m20:05:52.174900 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.175276 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: ROLLBACK
[0m20:05:52.175777 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: ROLLBACK
[0m20:05:52.176005 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.176280 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:05:52.176757 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: Close
[0m20:05:52.177119 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:05:52.178629 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.179472 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:05:52.180981 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:05:52.183806 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.184193 [debug] [Thread-4  ]: Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  column "ts_close_date" does not exist
  LINE 16:         age(ts_close_date, ts_engage_date) as deal_age,
                       ^
  HINT:  Perhaps you meant to reference the column "sales_pipeline.close_date".
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:05:52.184536 [debug] [Thread-1  ]: Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 12:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:05:52.185028 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:05:52.185251 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.186106 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dea520>]}
[0m20:05:52.186502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889aa1c0>]}
[0m20:05:52.194248 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:05:52.194450 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m20:05:52.194870 [error] [Thread-4  ]: 4 of 6 ERROR creating sql view model dev.crm_stg_sales_pipelines ............... [[31mERROR[0m in 0.09s]
[0m20:05:52.195424 [error] [Thread-1  ]: 1 of 6 ERROR creating sql view model dev.agent_performance ..................... [[31mERROR[0m in 0.09s]
[0m20:05:52.195798 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.196520 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:05:52.196921 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:05:52.197365 [debug] [Thread-1  ]: Finished running node model.matt_demo.agent_performance
[0m20:05:52.197678 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:05:52.197960 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.198437 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:05:52.198837 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m20:05:52.199350 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:05:52.199788 [info ] [Thread-4  ]: 5 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m20:05:52.200102 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:05:52.200412 [info ] [Thread-1  ]: 6 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:05:52.201068 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.crm_stg_sales_teams)
[0m20:05:52.201301 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:05:52.205272 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m20:05:52.205600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.agent_performance, now model.matt_demo.dim_date)
[0m20:05:52.205904 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:05:52.207321 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m20:05:52.209354 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:05:52.209636 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m20:05:52.211277 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.211659 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:05:52.211991 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m20:05:52.213596 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:05:52.214182 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m20:05:52.214753 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:05:52.215144 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:05:52.217236 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.217515 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:05:52.217721 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m20:05:52.218893 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_products: Close
[0m20:05:52.219771 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:05:52.231460 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:05:52.231829 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.232212 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a887f0>]}
[0m20:05:52.232649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c37e20>]}
[0m20:05:52.233361 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:05:52.233825 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:05:52.234251 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.234568 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:05:52.234931 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:05:52.235361 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:05:52.235642 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m20:05:52.235989 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:05:52.236711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:05:52.238106 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:05:52.238415 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.238626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:05:52.238890 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:05:52.239203 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.239666 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:05:52.240310 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:05:52.242589 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.242903 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:05:52.243458 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.245615 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.245962 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:05:52.246366 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.247205 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:05:52.247622 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.247856 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:05:52.248581 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m20:05:52.250311 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m20:05:52.250724 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:05:52.250964 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:05:52.251703 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:05:52.252454 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:05:52.252884 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889aaf40>]}
[0m20:05:52.253368 [info ] [Thread-4  ]: 5 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:05:52.253883 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:05:52.364561 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.124 seconds
[0m20:05:52.366642 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.366952 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:05:52.367426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.369722 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.370038 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:05:52.370442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:05:52.372727 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:05:52.373041 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.373344 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:05:52.380344 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m20:05:52.381962 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:05:52.383258 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:05:52.383531 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:05:52.384890 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:05:52.385631 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m20:05:52.386094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7408206-5531-4c19-ad12-69acc3e7f01d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889aaee0>]}
[0m20:05:52.386535 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.18s]
[0m20:05:52.387062 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m20:05:52.387968 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.388232 [debug] [MainThread]: On master: BEGIN
[0m20:05:52.388468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:52.389973 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:05:52.390255 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.390469 [debug] [MainThread]: Using postgres connection "master"
[0m20:05:52.390650 [debug] [MainThread]: On master: COMMIT
[0m20:05:52.390891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:05:52.391136 [debug] [MainThread]: On master: Close
[0m20:05:52.391450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:52.391668 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:05:52.391888 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:05:52.392126 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m20:05:52.392357 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:05:52.392632 [info ] [MainThread]: 
[0m20:05:52.392957 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m20:05:52.393692 [debug] [MainThread]: Command end result
[0m20:05:52.422788 [info ] [MainThread]: 
[0m20:05:52.423211 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:05:52.423515 [info ] [MainThread]: 
[0m20:05:52.423843 [error] [MainThread]:   Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  column "ts_close_date" does not exist
  LINE 16:         age(ts_close_date, ts_engage_date) as deal_age,
                       ^
  HINT:  Perhaps you meant to reference the column "sales_pipeline.close_date".
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:05:52.424147 [info ] [MainThread]: 
[0m20:05:52.424464 [error] [MainThread]:   Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 12:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:05:52.424743 [info ] [MainThread]: 
[0m20:05:52.425034 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m20:05:52.425594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.91829205, "process_user_time": 2.441912, "process_kernel_time": 0.091071, "process_mem_max_rss": "137168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:05:52.425921 [debug] [MainThread]: Command `dbt run` failed at 20:05:52.425880 after 0.92 seconds
[0m20:05:52.426175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d222e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dfc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff764b6520>]}
[0m20:05:52.426470 [debug] [MainThread]: Flushing usage events
[0m20:05:57.902861 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:11:30.323891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607bc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff607bc7f0>]}


============================== 20:11:30.327629 | 34ca5a4d-3234-48ed-aa86-d39acc97dabf ==============================
[0m20:11:30.327629 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:11:30.328192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m crm_stg_sales_pipelines', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:11:30.406009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f286c70>]}
[0m20:11:30.430943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d666d0>]}
[0m20:11:30.431672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:11:30.442754 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:11:30.561124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:30.561581 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:11:30.654462 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:11:30.655004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee9bd60>]}
[0m20:11:30.744295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b99130>]}
[0m20:11:30.812368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b05940>]}
[0m20:11:30.812749 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:11:30.813059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b64c40>]}
[0m20:11:30.813869 [info ] [MainThread]: 
[0m20:11:30.814336 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:30.814940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:11:30.831968 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:11:30.832393 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:11:30.832743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:30.835947 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:11:30.836726 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:11:30.839472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:11:30.842717 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:11:30.843023 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:11:30.843295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:30.845035 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:11:30.845314 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:11:30.845586 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:11:30.847161 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:11:30.847885 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:11:30.848216 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:11:30.851568 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.851856 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.852093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:30.853656 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:11:30.853947 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.854242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:30.861765 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m20:11:30.862499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f193550>]}
[0m20:11:30.862826 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:30.863144 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.863391 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.863762 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:11:30.864003 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.864238 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.864467 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.864773 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:30.865005 [debug] [MainThread]: On master: Close
[0m20:11:30.865313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:30.865747 [info ] [MainThread]: 
[0m20:11:30.869828 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:30.870251 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:11:30.870708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_sales_pipelines)
[0m20:11:30.871039 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:30.875214 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:30.877374 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:30.894449 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:30.896272 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:30.896592 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:11:30.896919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:30.898906 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:11:30.899164 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:30.899413 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(engage_date::timestamp, close_date::timestamp) as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:11:30.899787 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 19: ...ge(engage_date::timestamp, close_date::timestamp) as deal_ag...
                                                              ^

[0m20:11:30.900058 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: ROLLBACK
[0m20:11:30.900419 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:11:30.901745 [debug] [Thread-1  ]: Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  syntax error at or near "as"
  LINE 19: ...ge(engage_date::timestamp, close_date::timestamp) as deal_ag...
                                                                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:11:30.902603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34ca5a4d-3234-48ed-aa86-d39acc97dabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61d41e80>]}
[0m20:11:30.903022 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev.crm_stg_sales_pipelines ............... [[31mERROR[0m in 0.03s]
[0m20:11:30.903508 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:30.904375 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.904656 [debug] [MainThread]: On master: BEGIN
[0m20:11:30.904893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:30.906347 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:11:30.906656 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.906963 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:30.907212 [debug] [MainThread]: On master: COMMIT
[0m20:11:30.907546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:30.907795 [debug] [MainThread]: On master: Close
[0m20:11:30.908166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:30.908415 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:11:30.908687 [info ] [MainThread]: 
[0m20:11:30.909075 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m20:11:30.909586 [debug] [MainThread]: Command end result
[0m20:11:30.965933 [info ] [MainThread]: 
[0m20:11:30.966376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:11:30.966700 [info ] [MainThread]: 
[0m20:11:30.967051 [error] [MainThread]:   Database Error in model crm_stg_sales_pipelines (models/crm_sales_data/staging/crm_stg_sales_pipelines.sql)
  syntax error at or near "as"
  LINE 19: ...ge(engage_date::timestamp, close_date::timestamp) as deal_ag...
                                                                ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:11:30.967361 [info ] [MainThread]: 
[0m20:11:30.967678 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:11:30.968266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.66901284, "process_user_time": 2.344914, "process_kernel_time": 0.119995, "process_mem_max_rss": "129792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:30.968587 [debug] [MainThread]: Command `dbt run` failed at 20:11:30.968547 after 0.67 seconds
[0m20:11:30.968885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77bade80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77bad370>]}
[0m20:11:30.969159 [debug] [MainThread]: Flushing usage events
[0m20:11:39.580218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890fb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876f87f0>]}


============================== 20:11:39.583779 | 45103382-2c1a-4a43-bb64-79b4015ca3c3 ==============================
[0m20:11:39.583779 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:11:39.584301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m crm_stg_sales_pipelines', 'send_anonymous_usage_stats': 'True'}
[0m20:11:39.662368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61e9a30>]}
[0m20:11:39.685448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61de7f0>]}
[0m20:11:39.685941 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:11:39.696772 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:11:39.808079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:39.808533 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:11:39.903605 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:11:39.904151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5dbc220>]}
[0m20:11:39.992882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ae2130>]}
[0m20:11:40.058904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a3ee80>]}
[0m20:11:40.059272 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:11:40.059574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a9dca0>]}
[0m20:11:40.060366 [info ] [MainThread]: 
[0m20:11:40.060864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:40.061508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:11:40.076604 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:11:40.077007 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:11:40.077309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:40.079888 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:11:40.080574 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:11:40.083105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:11:40.086311 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:11:40.086614 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:11:40.086915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:40.088450 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:11:40.088732 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:11:40.089023 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:11:40.090286 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:11:40.091062 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:11:40.091435 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:11:40.094776 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.095058 [debug] [MainThread]: On master: BEGIN
[0m20:11:40.095308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:40.096785 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:11:40.097046 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.097335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:40.104013 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m20:11:40.104748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a3ecd0>]}
[0m20:11:40.105054 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:40.105365 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.105599 [debug] [MainThread]: On master: BEGIN
[0m20:11:40.105965 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:11:40.106227 [debug] [MainThread]: On master: COMMIT
[0m20:11:40.106481 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.106721 [debug] [MainThread]: On master: COMMIT
[0m20:11:40.107049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:40.107274 [debug] [MainThread]: On master: Close
[0m20:11:40.107564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:11:40.107959 [info ] [MainThread]: 
[0m20:11:40.111827 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:40.112260 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:11:40.112753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_sales_pipelines)
[0m20:11:40.113070 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:40.117313 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.118350 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:40.136255 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.137640 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.137956 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:11:40.138225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:11:40.140052 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:11:40.140340 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.140586 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(engage_date::timestamp, close_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:11:40.142625 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:11:40.146172 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.146478 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:11:40.147001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:11:40.149217 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.149520 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:11:40.150087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:11:40.184625 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:11:40.185079 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.185372 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:11:40.186222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:11:40.189272 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m20:11:40.191189 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:11:40.191447 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:11:40.192576 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:11:40.193765 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:11:40.194620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45103382-2c1a-4a43-bb64-79b4015ca3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a3ecd0>]}
[0m20:11:40.195062 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:11:40.195536 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:11:40.196347 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.196615 [debug] [MainThread]: On master: BEGIN
[0m20:11:40.196865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:40.198427 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:11:40.198655 [debug] [MainThread]: On master: COMMIT
[0m20:11:40.198880 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:40.199129 [debug] [MainThread]: On master: COMMIT
[0m20:11:40.199432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:40.199662 [debug] [MainThread]: On master: Close
[0m20:11:40.199957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:40.200204 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:11:40.200474 [info ] [MainThread]: 
[0m20:11:40.200795 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:11:40.201263 [debug] [MainThread]: Command end result
[0m20:11:40.227846 [info ] [MainThread]: 
[0m20:11:40.228277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:11:40.228571 [info ] [MainThread]: 
[0m20:11:40.228877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:11:40.229493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.67470956, "process_user_time": 2.41922, "process_kernel_time": 0.112428, "process_mem_max_rss": "129536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:11:40.229854 [debug] [MainThread]: Command `dbt run` succeeded at 20:11:40.229787 after 0.68 seconds
[0m20:11:40.230159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890fb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8829d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cff3d0>]}
[0m20:11:40.230440 [debug] [MainThread]: Flushing usage events
[0m20:14:44.139578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861cf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847cc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847cc850>]}


============================== 20:14:44.144006 | 102a6f66-bea4-436f-85e9-76502bb0ced0 ==============================
[0m20:14:44.144006 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:14:44.144556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m crm_stg_sales_pipelines', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:44.221764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32b3400>]}
[0m20:14:44.245762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85333f70>]}
[0m20:14:44.246355 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:14:44.259097 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:14:44.374595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:44.375082 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:14:44.480513 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:14:44.481182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e94a30>]}
[0m20:14:44.571509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffa8130>]}
[0m20:14:44.642297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dad4e50>]}
[0m20:14:44.642745 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:14:44.643138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db37850>]}
[0m20:14:44.643970 [info ] [MainThread]: 
[0m20:14:44.644409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:44.645025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:14:44.661004 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:14:44.661387 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:14:44.661712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:44.664698 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:14:44.665429 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:14:44.667966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:14:44.671321 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:14:44.671662 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:14:44.671979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:44.673969 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:14:44.674264 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:14:44.674551 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:14:44.676221 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:14:44.677009 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:14:44.677412 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:14:44.680780 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.681064 [debug] [MainThread]: On master: BEGIN
[0m20:14:44.681315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:44.682726 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:14:44.682996 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.683281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:44.690213 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m20:14:44.690980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dad4910>]}
[0m20:14:44.691292 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:44.691625 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.691924 [debug] [MainThread]: On master: BEGIN
[0m20:14:44.692286 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:14:44.692526 [debug] [MainThread]: On master: COMMIT
[0m20:14:44.692774 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.693002 [debug] [MainThread]: On master: COMMIT
[0m20:14:44.693295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:44.693533 [debug] [MainThread]: On master: Close
[0m20:14:44.693868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:44.694200 [info ] [MainThread]: 
[0m20:14:44.698160 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:14:44.698575 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:14:44.699039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_sales_pipelines)
[0m20:14:44.699363 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:14:44.703489 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.704577 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:14:44.720929 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.722104 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.722380 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:14:44.722637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:14:44.724498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:14:44.724764 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.725076 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:14:44.726780 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:14:44.730007 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.730271 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:14:44.730728 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:44.732932 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.733290 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:14:44.733854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:44.767242 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:14:44.767679 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.767991 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:14:44.769525 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:14:44.772609 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m20:14:44.774518 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:14:44.774785 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:14:44.775714 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:14:44.776936 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:14:44.777832 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '102a6f66-bea4-436f-85e9-76502bb0ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dad44c0>]}
[0m20:14:44.778249 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.08s]
[0m20:14:44.778770 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:14:44.779573 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.779852 [debug] [MainThread]: On master: BEGIN
[0m20:14:44.780067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:44.781632 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:14:44.781889 [debug] [MainThread]: On master: COMMIT
[0m20:14:44.782094 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:44.782309 [debug] [MainThread]: On master: COMMIT
[0m20:14:44.782583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:44.782816 [debug] [MainThread]: On master: Close
[0m20:14:44.783088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:44.783298 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:14:44.783531 [info ] [MainThread]: 
[0m20:14:44.783868 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m20:14:44.784326 [debug] [MainThread]: Command end result
[0m20:14:44.811356 [info ] [MainThread]: 
[0m20:14:44.811791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:44.812107 [info ] [MainThread]: 
[0m20:14:44.812459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:14:44.813090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6998047, "process_user_time": 2.352564, "process_kernel_time": 0.122353, "process_mem_max_rss": "129176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:14:44.813431 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:44.813390 after 0.70 seconds
[0m20:14:44.813685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861cf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b1c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848a7f40>]}
[0m20:14:44.813940 [debug] [MainThread]: Flushing usage events
[0m20:15:35.649538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874962e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a93850>]}


============================== 20:15:35.653854 | dc4990d7-094a-47e0-9630-f9be1587f5e7 ==============================
[0m20:15:35.653854 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:15:35.654430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m crm_stg_sales_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:15:35.737842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc4990d7-094a-47e0-9630-f9be1587f5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4579400>]}
[0m20:15:35.762116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc4990d7-094a-47e0-9630-f9be1587f5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865faf70>]}
[0m20:15:35.762821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:15:35.776324 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:15:35.902874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:35.903259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:35.930175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc4990d7-094a-47e0-9630-f9be1587f5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41cc130>]}
[0m20:15:36.010169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc4990d7-094a-47e0-9630-f9be1587f5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f65b80>]}
[0m20:15:36.010629 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:15:36.011140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc4990d7-094a-47e0-9630-f9be1587f5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4178f70>]}
[0m20:15:36.011643 [warn ] [MainThread]: The selection criterion 'crm_stg_sales_pipeline' does not match any enabled nodes
[0m20:15:36.012322 [info ] [MainThread]: 
[0m20:15:36.012666 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:15:36.013886 [debug] [MainThread]: Command end result
[0m20:15:36.044084 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4225399, "process_user_time": 2.150313, "process_kernel_time": 0.078633, "process_mem_max_rss": "125308", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:15:36.044583 [debug] [MainThread]: Command `dbt test` succeeded at 20:15:36.044525 after 0.42 seconds
[0m20:15:36.044947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874962e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86de34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865faf70>]}
[0m20:15:36.045261 [debug] [MainThread]: Flushing usage events
[0m20:15:45.089017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6939b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67998880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67998820>]}


============================== 20:15:45.093901 | 5c62f82e-b8f8-405f-8007-31d7cc5c983b ==============================
[0m20:15:45.093901 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:15:45.094443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m crm_stg_sales_pipelines', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:15:45.175742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67fabbb0>]}
[0m20:15:45.199841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67fa3fd0>]}
[0m20:15:45.200344 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:15:45.215493 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:15:45.333560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:45.333885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:45.358094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860d1130>]}
[0m20:15:45.432708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e6aee0>]}
[0m20:15:45.433171 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:15:45.433585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8607bf40>]}
[0m20:15:45.434446 [info ] [MainThread]: 
[0m20:15:45.434910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:45.437337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m20:15:45.454801 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:15:45.455213 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:15:45.455506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:45.457942 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:15:45.458253 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:15:45.458531 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:15:45.460111 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:15:45.460919 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:15:45.461299 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:15:45.464631 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.464923 [debug] [MainThread]: On master: BEGIN
[0m20:15:45.465182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:45.466938 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:15:45.467194 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.467479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:15:45.474910 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m20:15:45.475631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c62f82e-b8f8-405f-8007-31d7cc5c983b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e6a1c0>]}
[0m20:15:45.475977 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:45.476301 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.476553 [debug] [MainThread]: On master: BEGIN
[0m20:15:45.476928 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:15:45.477164 [debug] [MainThread]: On master: COMMIT
[0m20:15:45.477399 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.477637 [debug] [MainThread]: On master: COMMIT
[0m20:15:45.477988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:15:45.478225 [debug] [MainThread]: On master: Close
[0m20:15:45.478571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:45.478909 [info ] [MainThread]: 
[0m20:15:45.483057 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m20:15:45.483303 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m20:15:45.483539 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m20:15:45.483874 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m20:15:45.484336 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m20:15:45.484767 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m20:15:45.485272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m20:15:45.485728 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m20:15:45.486121 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m20:15:45.486443 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m20:15:45.486786 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m20:15:45.487089 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m20:15:45.501660 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m20:15:45.506194 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m20:15:45.509314 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m20:15:45.509661 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m20:15:45.510467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:45.512708 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m20:15:45.513100 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m20:15:45.520570 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m20:15:45.520806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:15:45.522078 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m20:15:45.522599 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m20:15:45.523631 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev'
        
      order by ordinal_position

  
[0m20:15:45.523952 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m20:15:45.524504 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m20:15:45.524879 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m20:15:45.525250 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m20:15:45.525560 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:15:45.525936 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:15:45.528139 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:15:45.528381 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:15:45.528626 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.004 seconds
[0m20:15:45.528834 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m20:15:45.529123 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m20:15:45.531284 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m20:15:45.531594 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:15:45.531924 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m20:15:45.533160 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m20:15:45.535035 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m20:15:45.535287 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m20:15:45.535575 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:15:45.537986 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m20:15:45.538387 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m20:15:45.539109 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m20:15:45.539522 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m20:15:45.539777 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m20:15:45.540118 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m20:15:45.540477 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.05s]
[0m20:15:45.541165 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.06s]
[0m20:15:45.541688 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m20:15:45.542085 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m20:15:45.543408 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:15:45.544251 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m20:15:45.544597 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m20:15:45.545040 [info ] [Thread-1  ]: 1 of 3 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.06s]
[0m20:15:45.545527 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m20:15:45.546366 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.546595 [debug] [MainThread]: On master: BEGIN
[0m20:15:45.546799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:45.548522 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:15:45.548764 [debug] [MainThread]: On master: COMMIT
[0m20:15:45.549019 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:45.549240 [debug] [MainThread]: On master: COMMIT
[0m20:15:45.549549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:15:45.549801 [debug] [MainThread]: On master: Close
[0m20:15:45.550110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:45.550340 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m20:15:45.550557 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m20:15:45.550787 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m20:15:45.551044 [info ] [MainThread]: 
[0m20:15:45.551400 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m20:15:45.552010 [debug] [MainThread]: Command end result
[0m20:15:45.580066 [info ] [MainThread]: 
[0m20:15:45.580493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:45.580804 [info ] [MainThread]: 
[0m20:15:45.581145 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:15:45.581728 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5180469, "process_user_time": 2.21926, "process_kernel_time": 0.107416, "process_mem_max_rss": "126436", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:15:45.582129 [debug] [MainThread]: Command `dbt test` succeeded at 20:15:45.582081 after 0.52 seconds
[0m20:15:45.582433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6939b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6853dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e6ae80>]}
[0m20:15:45.582707 [debug] [MainThread]: Flushing usage events
[0m20:16:43.965155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2022e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7ff850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7ff7f0>]}


============================== 20:16:43.968493 | 05d9869c-2dfd-4533-8e03-1cea2f96b56c ==============================
[0m20:16:43.968493 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:16:43.969140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m agent_performance', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:44.047174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d9869c-2dfd-4533-8e03-1cea2f96b56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e06f8b0>]}
[0m20:16:44.070480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d9869c-2dfd-4533-8e03-1cea2f96b56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca50f10>]}
[0m20:16:44.070980 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:16:44.082567 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:16:44.205773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:44.206230 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:16:44.274871 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.matt_demo.agent_performance' (models/crm_sales_data/fact/agent_performance.sql) depends on a node named 'crm_stg_sales_pielines' which was not found
[0m20:16:44.275635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3377285, "process_user_time": 2.081645, "process_kernel_time": 0.077395, "process_mem_max_rss": "117648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:44.276067 [debug] [MainThread]: Command `dbt run` failed at 20:16:44.276000 after 0.34 seconds
[0m20:16:44.276414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2022e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1edf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af14e20>]}
[0m20:16:44.276737 [debug] [MainThread]: Flushing usage events
[0m20:16:56.102728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80213730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802136d0>]}


============================== 20:16:56.106102 | 5e16a740-c91e-4f20-8338-b0ef00b4155e ==============================
[0m20:16:56.106102 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:16:56.106711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:56.183491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e16a740-c91e-4f20-8338-b0ef00b4155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad56d0>]}
[0m20:16:56.206789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e16a740-c91e-4f20-8338-b0ef00b4155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80436a90>]}
[0m20:16:56.207347 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:16:56.217526 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:16:56.337071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:56.337526 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:16:56.406583 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.matt_demo.agent_performance' (models/crm_sales_data/fact/agent_performance.sql) depends on a node named 'crm_stg_sales_pielines' which was not found
[0m20:16:56.407376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.32909316, "process_user_time": 2.022983, "process_kernel_time": 0.077999, "process_mem_max_rss": "112448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:56.407802 [debug] [MainThread]: Command `dbt run` failed at 20:16:56.407742 after 0.33 seconds
[0m20:16:56.408119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e901550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8f64f0>]}
[0m20:16:56.408406 [debug] [MainThread]: Flushing usage events
[0m20:17:04.690377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ec730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ec6d0>]}


============================== 20:17:04.693622 | a5d2c564-fbba-45f0-8320-1cebfdb5de3b ==============================
[0m20:17:04.693622 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:17:04.694170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:17:04.769209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa22bee0>]}
[0m20:17:04.793006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c256550>]}
[0m20:17:04.793551 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:17:04.803736 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:17:04.919874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:04.920334 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:17:05.034550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7071130>]}
[0m20:17:05.102092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa706de80>]}
[0m20:17:05.102483 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:17:05.102822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7098c70>]}
[0m20:17:05.103808 [info ] [MainThread]: 
[0m20:17:05.104323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:05.106734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:17:05.123424 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:17:05.123956 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:17:05.124306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:05.126814 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:17:05.127572 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:17:05.128650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:17:05.131962 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:17:05.132274 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:17:05.132564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:05.134172 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:17:05.134472 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:17:05.134790 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:17:05.136078 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:17:05.136797 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:17:05.137177 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:17:05.140482 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.140795 [debug] [MainThread]: On master: BEGIN
[0m20:17:05.141040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:05.142472 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:17:05.142729 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.143012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:17:05.149782 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m20:17:05.150503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b78a0a0>]}
[0m20:17:05.150803 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:05.151124 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.151361 [debug] [MainThread]: On master: BEGIN
[0m20:17:05.151721 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:17:05.151963 [debug] [MainThread]: On master: COMMIT
[0m20:17:05.152248 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.152484 [debug] [MainThread]: On master: COMMIT
[0m20:17:05.152789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:05.153033 [debug] [MainThread]: On master: Close
[0m20:17:05.153389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:17:05.153726 [info ] [MainThread]: 
[0m20:17:05.157676 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:17:05.157932 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:17:05.158276 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:05.158665 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:17:05.159042 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m20:17:05.159663 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m20:17:05.160251 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:17:05.160839 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m20:17:05.161508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m20:17:05.161946 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m20:17:05.162422 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:17:05.162856 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:17:05.163249 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:17:05.163615 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:17:05.163970 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:05.164351 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:17:05.169381 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:17:05.171359 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:17:05.173183 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.175461 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.177937 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:17:05.178181 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:17:05.178516 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:05.191353 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:17:05.196173 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:17:05.198094 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:17:05.199973 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.202090 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.203553 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.203937 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.204225 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.204589 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:17:05.204923 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.205187 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:17:05.205532 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:17:05.205839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:17:05.206143 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:17:05.206404 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:17:05.206699 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:17:05.207386 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:17:05.209130 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:05.209429 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:05.209803 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.210031 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:05.210241 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:05.211568 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.210911 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:17:05.211259 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.210510 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.212200 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:17:05.212688 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:17:05.213020 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:17:05.213813 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:17:05.214183 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:17:05.217838 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.218069 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:17:05.218286 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:17:05.220187 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.220510 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:17:05.222316 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.224102 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.224441 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:17:05.224872 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:17:05.225114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.225405 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:17:05.225866 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.226117 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.228015 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.253888 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:17:05.254953 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.256842 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.257248 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:17:05.258921 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.259264 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:17:05.259621 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:17:05.260105 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:17:05.260345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.260844 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.261111 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.267438 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:17:05.269004 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:17:05.269724 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:17:05.270451 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:17:05.271139 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:17:05.271456 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.271776 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.272089 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.272368 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.272671 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:17:05.273039 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:17:05.273358 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:17:05.273636 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:17:05.274905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:17:05.275181 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:17:05.275386 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:17:05.275620 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:17:05.278615 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m20:17:05.280516 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m20:17:05.281940 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m20:17:05.283333 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m20:17:05.285296 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:05.285672 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:05.286139 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:05.286538 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:05.286854 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m20:17:05.287138 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:17:05.287461 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m20:17:05.287779 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:17:05.289038 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:17:05.289298 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:17:05.289498 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:17:05.289742 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:17:05.290814 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:17:05.291503 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:17:05.292231 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:17:05.292923 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:17:05.293841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27f0e50>]}
[0m20:17:05.294244 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28915e0>]}
[0m20:17:05.294637 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27f0fd0>]}
[0m20:17:05.295016 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2891700>]}
[0m20:17:05.295477 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:05.295969 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:05.296471 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:05.296935 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:05.297422 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:17:05.297796 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:05.298199 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:17:05.298628 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:17:05.298980 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m20:17:05.299472 [debug] [Thread-3  ]: Began running node model.matt_demo.agent_performance
[0m20:17:05.300253 [info ] [Thread-1  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:17:05.300694 [info ] [Thread-3  ]: 6 of 6 START sql view model dev.agent_performance .............................. [RUN]
[0m20:17:05.301146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m20:17:05.301486 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.agent_performance)
[0m20:17:05.301797 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m20:17:05.302093 [debug] [Thread-3  ]: Began compiling node model.matt_demo.agent_performance
[0m20:17:05.303961 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:17:05.305527 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:17:05.306878 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m20:17:05.307088 [debug] [Thread-3  ]: Began executing node model.matt_demo.agent_performance
[0m20:17:05.318909 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:17:05.320852 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:17:05.321778 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.322086 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m20:17:05.322395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:17:05.322604 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:05.323165 [debug] [Thread-3  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:17:05.323448 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:17:05.324539 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:17:05.324865 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.325084 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m20:17:05.325430 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:17:05.325770 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:05.326180 [debug] [Thread-3  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  create view "company_dw"."dev"."agent_performance__dbt_tmp"
    
    
  as (
    with agent_performance as (
    select * 
    from "company_dw"."dev"."crm_stg_sales_pipelines"

)
  );
[0m20:17:05.326561 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 12:   );
           ^

[0m20:17:05.326829 [debug] [Thread-3  ]: On model.matt_demo.agent_performance: ROLLBACK
[0m20:17:05.327231 [debug] [Thread-3  ]: On model.matt_demo.agent_performance: Close
[0m20:17:05.328644 [debug] [Thread-3  ]: Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 12:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:17:05.329013 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1a6b80>]}
[0m20:17:05.329453 [error] [Thread-3  ]: 6 of 6 ERROR creating sql view model dev.agent_performance ..................... [[31mERROR[0m in 0.03s]
[0m20:17:05.329949 [debug] [Thread-3  ]: Finished running node model.matt_demo.agent_performance
[0m20:17:05.451362 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.125 seconds
[0m20:17:05.453500 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.453822 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:17:05.454312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.455953 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.456260 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:17:05.456644 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:05.458976 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:17:05.459286 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.459571 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:17:05.467457 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m20:17:05.469060 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:17:05.471120 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:05.471397 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:17:05.472870 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:17:05.473642 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m20:17:05.474079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d2c564-fbba-45f0-8320-1cebfdb5de3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2717ee0>]}
[0m20:17:05.474521 [info ] [Thread-1  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.17s]
[0m20:17:05.474982 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m20:17:05.475863 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.476152 [debug] [MainThread]: On master: BEGIN
[0m20:17:05.476404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:05.477925 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:17:05.478175 [debug] [MainThread]: On master: COMMIT
[0m20:17:05.478413 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:05.478621 [debug] [MainThread]: On master: COMMIT
[0m20:17:05.478892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:05.479121 [debug] [MainThread]: On master: Close
[0m20:17:05.479541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:05.479803 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:17:05.480039 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m20:17:05.480311 [debug] [MainThread]: Connection 'model.matt_demo.agent_performance' was properly closed.
[0m20:17:05.480561 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:17:05.480833 [info ] [MainThread]: 
[0m20:17:05.481167 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:17:05.481935 [debug] [MainThread]: Command end result
[0m20:17:05.511771 [info ] [MainThread]: 
[0m20:17:05.512203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:17:05.512545 [info ] [MainThread]: 
[0m20:17:05.512872 [error] [MainThread]:   Database Error in model agent_performance (models/crm_sales_data/fact/agent_performance.sql)
  syntax error at or near ")"
  LINE 12:   );
             ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/agent_performance.sql
[0m20:17:05.513225 [info ] [MainThread]: 
[0m20:17:05.513556 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:17:05.514222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84821147, "process_user_time": 2.472118, "process_kernel_time": 0.095197, "process_mem_max_rss": "129208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:17:05.514643 [debug] [MainThread]: Command `dbt run` failed at 20:17:05.514586 after 0.85 seconds
[0m20:17:05.514969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1512e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7071e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa706d100>]}
[0m20:17:05.515252 [debug] [MainThread]: Flushing usage events
[0m20:17:23.389389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbc52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c160760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c160700>]}


============================== 20:17:23.393244 | 0fa0a182-2d0d-4a47-a436-59d58ff297ab ==============================
[0m20:17:23.393244 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:17:23.393819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:23.530321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaced850>]}
[0m20:17:23.555263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c19aa30>]}
[0m20:17:23.555862 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:17:23.567003 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:17:23.682796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:17:23.683266 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:17:23.798616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ae5130>]}
[0m20:17:23.864488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d82f2b0>]}
[0m20:17:23.864842 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:17:23.865190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d82f2e0>]}
[0m20:17:23.866180 [info ] [MainThread]: 
[0m20:17:23.866639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:17:23.868902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:17:23.883792 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:17:23.884195 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:17:23.884494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:23.886917 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:17:23.887634 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:17:23.888665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:17:23.891837 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:17:23.892170 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:17:23.892476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:23.893965 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m20:17:23.894251 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:17:23.894526 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:17:23.895681 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m20:17:23.896435 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:17:23.896774 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:17:23.900107 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:23.900429 [debug] [MainThread]: On master: BEGIN
[0m20:17:23.900680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:23.902110 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:17:23.902406 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:23.902700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:17:23.909360 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m20:17:23.910137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7aca310>]}
[0m20:17:23.910449 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:23.910762 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:23.911015 [debug] [MainThread]: On master: BEGIN
[0m20:17:23.911402 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:17:23.911673 [debug] [MainThread]: On master: COMMIT
[0m20:17:23.911924 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:23.912162 [debug] [MainThread]: On master: COMMIT
[0m20:17:23.912451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:23.912692 [debug] [MainThread]: On master: Close
[0m20:17:23.913018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:17:23.913381 [info ] [MainThread]: 
[0m20:17:23.917328 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:17:23.917559 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:17:23.917780 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:23.918018 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:17:23.918409 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m20:17:23.918894 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m20:17:23.919372 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:17:23.919858 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m20:17:23.920327 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m20:17:23.920727 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m20:17:23.921092 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:17:23.921549 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:17:23.921871 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:17:23.922200 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:17:23.922547 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:23.922877 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:17:23.927061 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:17:23.928668 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:17:23.930465 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:23.932613 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:17:23.934205 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:17:23.934424 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:17:23.934604 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:23.940344 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:17:23.952028 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:17:23.953867 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:17:23.955810 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:23.957914 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:17:23.959436 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:23.959839 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:23.960107 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:23.960320 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:17:23.960589 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:23.960904 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:17:23.961220 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:17:23.961493 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:17:23.961797 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:17:23.962067 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:17:23.962388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:17:23.962889 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:17:23.964429 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:23.964679 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:23.964957 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:17:23.965188 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:23.965397 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:17:23.965670 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:23.965961 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:23.966265 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:17:23.966555 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:23.966832 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:17:23.967164 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:17:23.967615 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:17:23.968254 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:17:23.972040 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:23.972274 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:17:23.972490 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:17:23.972757 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:17:23.972965 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:17:23.974757 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:23.976677 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:23.978379 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:23.978882 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:17:23.979104 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:23.979411 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:17:23.979735 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:17:23.981933 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:23.982162 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:17:23.982689 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:23.982916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:23.983112 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:17:24.012627 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:24.014518 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:24.016198 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:24.016793 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:17:24.017022 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.017312 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:17:24.017648 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:17:24.025758 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:17:24.025982 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m20:17:24.026509 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.026791 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.026988 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:24.027744 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:17:24.028467 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:17:24.029184 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:17:24.029496 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:17:24.029816 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:24.030107 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:24.030434 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:24.030910 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:17:24.031193 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:17:24.031517 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:17:24.031964 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:17:24.032264 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m20:17:24.032532 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m20:17:24.035820 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m20:17:24.036051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:17:24.037987 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m20:17:24.039498 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m20:17:24.041463 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:17:24.042856 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m20:17:24.043315 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:17:24.043674 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:17:24.043993 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m20:17:24.044403 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:17:24.044713 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:17:24.045002 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:17:24.045528 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m20:17:24.045927 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:17:24.046313 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:17:24.046739 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:17:24.047916 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:17:24.048150 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:17:24.048811 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:17:24.049484 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:17:24.050459 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5264160>]}
[0m20:17:24.051227 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:17:24.051610 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa524a730>]}
[0m20:17:24.051981 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa524a610>]}
[0m20:17:24.052434 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:24.052923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5264ee0>]}
[0m20:17:24.053332 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:24.053832 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:24.054286 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:17:24.054710 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:17:24.055270 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:17:24.055628 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:17:24.055986 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:17:24.056396 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:17:24.056971 [debug] [Thread-4  ]: Began running node model.matt_demo.agent_performance
[0m20:17:24.057250 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:17:24.057933 [info ] [Thread-4  ]: 6 of 6 START sql view model dev.agent_performance .............................. [RUN]
[0m20:17:24.058422 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:17:24.058792 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.agent_performance)
[0m20:17:24.059111 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:17:24.059442 [debug] [Thread-4  ]: Began compiling node model.matt_demo.agent_performance
[0m20:17:24.061288 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:17:24.062843 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:17:24.063894 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:17:24.064258 [debug] [Thread-4  ]: Began executing node model.matt_demo.agent_performance
[0m20:17:24.076066 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:17:24.078085 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:17:24.079091 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.079402 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:24.079571 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:17:24.079857 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:17:24.080195 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:17:24.080492 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:17:24.082482 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:17:24.082694 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:17:24.082951 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.083194 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:24.083524 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:17:24.083851 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  create view "company_dw"."dev"."agent_performance__dbt_tmp"
    
    
  as (
    with agent_performance as (
    select * 
    from "company_dw"."dev"."crm_stg_sales_pipelines"

)

select * from agent_performance
  );
[0m20:17:24.084985 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:17:24.087097 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:24.087377 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
alter table "company_dw"."dev"."agent_performance__dbt_tmp" rename to "agent_performance"
[0m20:17:24.087848 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.088558 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:17:24.088804 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:24.089060 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:17:24.089577 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m20:17:24.091043 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."agent_performance__dbt_backup"
[0m20:17:24.091495 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:17:24.092009 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
drop view if exists "company_dw"."dev"."agent_performance__dbt_backup" cascade
[0m20:17:24.092434 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:17:24.093205 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: Close
[0m20:17:24.093621 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa521bf40>]}
[0m20:17:24.094025 [info ] [Thread-4  ]: 6 of 6 OK created sql view model dev.agent_performance ......................... [[32mCREATE VIEW[0m in 0.03s]
[0m20:17:24.094552 [debug] [Thread-4  ]: Finished running node model.matt_demo.agent_performance
[0m20:17:24.209282 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.125 seconds
[0m20:17:24.211322 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.211639 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:17:24.212141 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.214503 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.214806 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:17:24.215216 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:17:24.217620 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:17:24.217916 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.218197 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:17:24.221782 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m20:17:24.223309 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:17:24.224564 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:17:24.224866 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:17:24.226683 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:17:24.227433 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:17:24.227862 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fa0a182-2d0d-4a47-a436-59d58ff297ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5263b50>]}
[0m20:17:24.228302 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.17s]
[0m20:17:24.228769 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:17:24.229637 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:24.229902 [debug] [MainThread]: On master: BEGIN
[0m20:17:24.230111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:24.231605 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:17:24.231847 [debug] [MainThread]: On master: COMMIT
[0m20:17:24.232035 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:24.232265 [debug] [MainThread]: On master: COMMIT
[0m20:17:24.232581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:24.232808 [debug] [MainThread]: On master: Close
[0m20:17:24.233065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:24.233330 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:17:24.233530 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:17:24.233765 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:17:24.234001 [debug] [MainThread]: Connection 'model.matt_demo.agent_performance' was properly closed.
[0m20:17:24.234284 [info ] [MainThread]: 
[0m20:17:24.234602 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:17:24.235355 [debug] [MainThread]: Command end result
[0m20:17:24.262518 [info ] [MainThread]: 
[0m20:17:24.262934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:24.263257 [info ] [MainThread]: 
[0m20:17:24.263563 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:17:24.264140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9008247, "process_user_time": 2.43042, "process_kernel_time": 0.104103, "process_mem_max_rss": "131956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:17:24.264518 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:24.264469 after 0.90 seconds
[0m20:17:24.264794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbc52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d82f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad41040>]}
[0m20:17:24.265030 [debug] [MainThread]: Flushing usage events
[0m20:19:11.081163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1b82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7b3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7b3700>]}


============================== 20:19:11.085005 | 0ff269b1-75d2-48f4-b0a7-de7873b5310d ==============================
[0m20:19:11.085005 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:19:11.085571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:19:11.165796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b2a5550>]}
[0m20:19:11.189488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9ac520>]}
[0m20:19:11.190093 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:19:11.200456 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:19:11.317617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:11.318050 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:19:11.431549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980ea130>]}
[0m20:19:11.499281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af19df0>]}
[0m20:19:11.499690 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:19:11.500041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1940d0>]}
[0m20:19:11.501072 [info ] [MainThread]: 
[0m20:19:11.501637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:11.503954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:19:11.519506 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:19:11.519894 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:19:11.520216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:11.522861 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m20:19:11.523539 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:19:11.524536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:19:11.527805 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:19:11.528098 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:19:11.528408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:11.529849 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m20:19:11.530136 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:19:11.530481 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:19:11.531835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m20:19:11.532546 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:19:11.532907 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:19:11.536292 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.536573 [debug] [MainThread]: On master: BEGIN
[0m20:19:11.536844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:11.538257 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:19:11.538523 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.538828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:19:11.545983 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m20:19:11.546793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af19d60>]}
[0m20:19:11.547118 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:11.547434 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.547696 [debug] [MainThread]: On master: BEGIN
[0m20:19:11.548068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:19:11.548319 [debug] [MainThread]: On master: COMMIT
[0m20:19:11.548535 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.548764 [debug] [MainThread]: On master: COMMIT
[0m20:19:11.549048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:19:11.549279 [debug] [MainThread]: On master: Close
[0m20:19:11.549585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:11.549942 [info ] [MainThread]: 
[0m20:19:11.553874 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:19:11.554108 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:19:11.554341 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:19:11.554573 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:19:11.554979 [info ] [Thread-1  ]: 1 of 6 START sql view model dev.crm_stg_accounts ............................... [RUN]
[0m20:19:11.555453 [info ] [Thread-2  ]: 2 of 6 START sql view model dev.crm_stg_products ............................... [RUN]
[0m20:19:11.555918 [info ] [Thread-3  ]: 3 of 6 START sql view model dev.crm_stg_sales_pipelines ........................ [RUN]
[0m20:19:11.556377 [info ] [Thread-4  ]: 4 of 6 START sql view model dev.crm_stg_sales_teams ............................ [RUN]
[0m20:19:11.556845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m20:19:11.557219 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_products'
[0m20:19:11.557586 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:19:11.557977 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:19:11.558327 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:19:11.558645 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:19:11.558983 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:19:11.559299 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:19:11.563612 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:19:11.565250 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:19:11.567126 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.569204 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.571439 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:19:11.571709 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:19:11.572017 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:19:11.588497 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:19:11.588757 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:19:11.590701 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:19:11.592831 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.595165 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.596209 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.596502 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.596989 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.597205 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:19:11.597842 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.598051 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:19:11.598317 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:19:11.598612 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:19:11.598898 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:19:11.599230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:11.599497 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:19:11.599941 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:19:11.601542 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:19:11.601788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:19:11.602175 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:19:11.602402 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.602624 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:19:11.602965 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.603253 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.603572 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev"."crm_stg_products__dbt_tmp"
    
    
  as (
    with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:19:11.603889 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.604212 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:19:11.604536 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:19:11.605008 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:19:11.605903 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:19:11.606276 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:19:11.609914 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.610139 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:19:11.610362 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:19:11.612200 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.612519 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:19:11.614240 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.616041 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.616334 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:19:11.616808 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:19:11.617029 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.617297 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:19:11.617844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.619710 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.619922 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:19:11.645359 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:19:11.646448 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.646898 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:19:11.648670 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.650482 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.650860 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:19:11.651402 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:19:11.651633 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.651905 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:19:11.652460 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.652703 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.660267 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:19:11.661146 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:19:11.661369 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:19:11.662069 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:19:11.662402 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.662735 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.663458 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:19:11.663792 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.664126 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:19:11.664431 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:19:11.664792 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.665105 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:19:11.665691 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:19:11.666045 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:19:11.666332 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:19:11.666596 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m20:19:11.669844 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."crm_stg_products__dbt_backup"
[0m20:19:11.670069 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m20:19:11.671982 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."crm_stg_accounts__dbt_backup"
[0m20:19:11.673387 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_teams__dbt_backup"
[0m20:19:11.675456 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:19:11.676944 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup"
[0m20:19:11.677391 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:19:11.677801 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:19:11.678121 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev"."crm_stg_products__dbt_backup" cascade
[0m20:19:11.678486 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:19:11.678811 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev"."crm_stg_accounts__dbt_backup" cascade
[0m20:19:11.679125 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:19:11.679604 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:19:11.680042 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:19:11.680487 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:19:11.680865 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:19:11.682135 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:19:11.682359 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:19:11.683048 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:19:11.683741 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:19:11.684728 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93068280>]}
[0m20:19:11.685379 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:19:11.685789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93068f70>]}
[0m20:19:11.686170 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9314d580>]}
[0m20:19:11.686615 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev.crm_stg_products .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:19:11.687084 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9314d880>]}
[0m20:19:11.687498 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev.crm_stg_accounts .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:19:11.688026 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev.crm_stg_sales_teams ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:19:11.688465 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:19:11.688881 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev.crm_stg_sales_pipelines ................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:19:11.689345 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:19:11.689713 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:19:11.690071 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:19:11.690450 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:19:11.691074 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:19:11.691589 [debug] [Thread-1  ]: Began running node model.matt_demo.agent_performance
[0m20:19:11.691981 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:19:11.692340 [info ] [Thread-1  ]: 6 of 6 START sql table model dev.agent_performance ............................. [RUN]
[0m20:19:11.692856 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:19:11.693199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.agent_performance)
[0m20:19:11.695045 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:19:11.695368 [debug] [Thread-1  ]: Began compiling node model.matt_demo.agent_performance
[0m20:19:11.697326 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:19:11.697889 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:19:11.709821 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:19:11.710083 [debug] [Thread-1  ]: Began executing node model.matt_demo.agent_performance
[0m20:19:11.712285 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:19:11.712704 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.713010 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:19:11.713324 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:19:11.713609 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:19:11.714033 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:19:11.714315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:19:11.715446 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:19:11.715768 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.715997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:19:11.716310 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:19:11.716633 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:19:11.717070 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  
    

  create  table "company_dw"."dev"."agent_performance__dbt_tmp"
  
  
    as
  
  (
    

with agent_performance as (
    select * 
    from "company_dw"."dev"."crm_stg_sales_pipelines"

)

select * from agent_performance
  );
  
[0m20:19:11.728974 [debug] [Thread-1  ]: SQL status: SELECT 8800 in 0.012 seconds
[0m20:19:11.731022 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:19:11.731287 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
alter table "company_dw"."dev"."agent_performance__dbt_tmp" rename to "agent_performance"
[0m20:19:11.731720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.734173 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:19:11.734419 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:19:11.734640 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:19:11.736252 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:19:11.737692 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."agent_performance__dbt_backup"
[0m20:19:11.738908 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:19:11.739185 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
drop table if exists "company_dw"."dev"."agent_performance__dbt_backup" cascade
[0m20:19:11.739529 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:19:11.740190 [debug] [Thread-1  ]: On model.matt_demo.agent_performance: Close
[0m20:19:11.740569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9314da90>]}
[0m20:19:11.741001 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dev.agent_performance ........................ [[32mSELECT 8800[0m in 0.05s]
[0m20:19:11.741481 [debug] [Thread-1  ]: Finished running node model.matt_demo.agent_performance
[0m20:19:11.849263 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.132 seconds
[0m20:19:11.851472 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.851862 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:19:11.852399 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.854944 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.855275 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:19:11.855774 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:19:11.856589 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:19:11.856982 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.857280 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:19:11.861851 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m20:19:11.863486 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:19:11.863926 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:19:11.864277 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:19:11.866087 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:19:11.866886 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:19:11.867352 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ff269b1-75d2-48f4-b0a7-de7873b5310d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f90ee0>]}
[0m20:19:11.868635 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.18s]
[0m20:19:11.869177 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:19:11.870207 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.870543 [debug] [MainThread]: On master: BEGIN
[0m20:19:11.870872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:11.872881 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:19:11.873218 [debug] [MainThread]: On master: COMMIT
[0m20:19:11.873508 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:11.873798 [debug] [MainThread]: On master: COMMIT
[0m20:19:11.874152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:19:11.874418 [debug] [MainThread]: On master: Close
[0m20:19:11.874763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:11.875014 [debug] [MainThread]: Connection 'model.matt_demo.agent_performance' was properly closed.
[0m20:19:11.875233 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:19:11.875474 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:19:11.875830 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:19:11.876164 [info ] [MainThread]: 
[0m20:19:11.876575 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:19:11.877641 [debug] [MainThread]: Command end result
[0m20:19:11.907328 [info ] [MainThread]: 
[0m20:19:11.907795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:11.908096 [info ] [MainThread]: 
[0m20:19:11.908419 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:19:11.909055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8524587, "process_user_time": 2.375911, "process_kernel_time": 0.117846, "process_mem_max_rss": "129344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:19:11.909422 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:11.909376 after 0.85 seconds
[0m20:19:11.909705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1b82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d303a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9ac520>]}
[0m20:19:11.909987 [debug] [MainThread]: Flushing usage events
[0m20:22:34.779594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0b62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b651760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b651700>]}


============================== 20:22:34.783506 | bc3a9f4f-343a-4bc8-98aa-a509b76bc481 ==============================
[0m20:22:34.783506 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:22:34.784113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:22:34.868412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1907f0>]}
[0m20:22:34.892622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b84a520>]}
[0m20:22:34.893291 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:22:34.905514 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:22:35.035014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m20:22:35.035494 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_products.sql
[0m20:22:35.035776 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_pipelines.sql
[0m20:22:35.036105 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_sales_teams.sql
[0m20:22:35.036403 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:22:35.036662 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_accounts.sql
[0m20:22:35.135242 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:22:35.135834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87db4910>]}
[0m20:22:35.242865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829aa130>]}
[0m20:22:35.314914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82929c70>]}
[0m20:22:35.315296 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:22:35.315609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829cc7f0>]}
[0m20:22:35.316708 [info ] [MainThread]: 
[0m20:22:35.317276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:35.319739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:22:35.320183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:22:35.339178 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:22:35.339436 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:22:35.339767 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:22:35.340094 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:22:35.340435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:35.340739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:35.344340 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:22:35.344571 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m20:22:35.345279 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:22:35.345948 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:22:35.346763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dev_crm_sales_dbt)
[0m20:22:35.347238 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dev_crm_sales_dbt"
"
[0m20:22:35.350212 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt"
[0m20:22:35.350508 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:22:35.350786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:35.352516 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:22:35.352779 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt"
[0m20:22:35.353055 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dev_crm_sales_dbt"} */
create schema if not exists "dev_crm_sales_dbt"
[0m20:22:35.353706 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m20:22:35.354219 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt: COMMIT
[0m20:22:35.354474 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt"
[0m20:22:35.354707 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt: COMMIT
[0m20:22:35.355723 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m20:22:35.356013 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt: Close
[0m20:22:35.356971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dev_crm_sales_dbt, now list_company_dw_dev_crm_sales_dbt)
[0m20:22:35.357316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m20:22:35.360451 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:22:35.361711 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:22:35.362035 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:22:35.362337 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:22:35.362628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:35.362912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:35.364723 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:22:35.365063 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:22:35.365247 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:22:35.365529 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:22:35.365831 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:22:35.366330 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:22:35.367459 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:22:35.368137 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:22:35.368337 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m20:22:35.368744 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:22:35.369370 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:22:35.370019 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:22:35.373298 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.373579 [debug] [MainThread]: On master: BEGIN
[0m20:22:35.373834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:35.375335 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:22:35.375581 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.375869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:35.383111 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m20:22:35.383849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d08beb0>]}
[0m20:22:35.384180 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:35.384498 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.384757 [debug] [MainThread]: On master: BEGIN
[0m20:22:35.385139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:22:35.385376 [debug] [MainThread]: On master: COMMIT
[0m20:22:35.385612 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.385842 [debug] [MainThread]: On master: COMMIT
[0m20:22:35.386176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.386423 [debug] [MainThread]: On master: Close
[0m20:22:35.386746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:35.387107 [info ] [MainThread]: 
[0m20:22:35.391639 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:22:35.391878 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:22:35.392149 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:22:35.392380 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:22:35.392739 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:22:35.393214 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:22:35.393703 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:22:35.394199 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:22:35.394653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_accounts)
[0m20:22:35.395069 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m20:22:35.395483 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:22:35.395855 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:22:35.396202 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:22:35.396586 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:22:35.396897 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:22:35.397232 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:22:35.430403 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:22:35.432219 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:22:35.433957 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.435712 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.437240 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:22:35.437663 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:22:35.443835 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:22:35.454888 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:22:35.457488 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:22:35.457718 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:22:35.459479 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.461561 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.462381 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:22:35.462618 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:22:35.463005 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:22:35.463290 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.463622 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.463834 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:22:35.464129 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:22:35.464415 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:22:35.464665 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:22:35.464920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:35.465436 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:22:35.465744 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:22:35.467309 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:22:35.467650 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:22:35.467932 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:22:35.468260 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:22:35.468484 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:22:35.468709 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:22:35.469021 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:22:35.469338 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.469725 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.470061 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:22:35.470470 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:22:35.470878 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:22:35.471148 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:22:35.475019 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:22:35.475264 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:22:35.475493 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:22:35.475737 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:22:35.475943 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:22:35.478057 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.479748 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.481354 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:22:35.481833 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:22:35.482077 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:35.482368 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:22:35.482692 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:22:35.489453 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:22:35.489559 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:22:35.490337 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:35.490571 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:22:35.490764 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:35.491453 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:22:35.492185 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:22:35.492467 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:22:35.493158 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:22:35.493493 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.493806 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.494252 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:22:35.494507 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.494786 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:22:35.495099 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:22:35.495407 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:22:35.498461 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:22:35.499024 [debug] [Thread-4  ]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.499258 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.499473 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.501481 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:22:35.502938 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:22:35.504821 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:22:35.506172 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:22:35.506460 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:22:35.506850 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:22:35.507256 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:22:35.507665 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:22:35.508078 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:22:35.508282 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:35.508578 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:22:35.508889 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:22:35.510195 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:22:35.510395 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:22:35.510790 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:35.511125 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:22:35.511901 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b527520>]}
[0m20:22:35.512618 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:22:35.513332 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:22:35.514005 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:22:35.514402 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.12s]
[0m20:22:35.514884 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5276d0>]}
[0m20:22:35.515337 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5277f0>]}
[0m20:22:35.515803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b527820>]}
[0m20:22:35.516203 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:22:35.516643 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.12s]
[0m20:22:35.517186 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.12s]
[0m20:22:35.517685 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.12s]
[0m20:22:35.518125 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:22:35.518554 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:22:35.518927 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:22:35.519335 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:22:35.519655 [info ] [Thread-2  ]: 5 of 6 START sql table model dev.dim_date ...................................... [RUN]
[0m20:22:35.520477 [debug] [Thread-4  ]: Began running node model.matt_demo.agent_performance
[0m20:22:35.520968 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:22:35.521364 [info ] [Thread-4  ]: 6 of 6 START sql table model dev_crm_sales_dbt.agent_performance ............... [RUN]
[0m20:22:35.521746 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:22:35.522110 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.agent_performance)
[0m20:22:35.523899 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:22:35.524240 [debug] [Thread-4  ]: Began compiling node model.matt_demo.agent_performance
[0m20:22:35.526207 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:22:35.526706 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:22:35.538566 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:22:35.539039 [debug] [Thread-4  ]: Began executing node model.matt_demo.agent_performance
[0m20:22:35.541055 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:22:35.541621 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.541948 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:22:35.542251 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:22:35.542431 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:22:35.542718 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:22:35.543193 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:22:35.544750 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:22:35.544968 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:22:35.545222 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:22:35.545528 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.545799 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_tmp"
  
  
    as
  
  (
    

with agent_performance as (
    select * 
    from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"

)

select * from agent_performance
  );
  
[0m20:22:35.546131 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:22:35.559372 [debug] [Thread-4  ]: SQL status: SELECT 8800 in 0.013 seconds
[0m20:22:35.561476 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:22:35.561770 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
alter table "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_tmp" rename to "agent_performance"
[0m20:22:35.562206 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:35.564703 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:22:35.564954 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:22:35.565214 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:22:35.566687 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:22:35.568125 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_backup"
[0m20:22:35.569344 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:22:35.569588 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_backup" cascade
[0m20:22:35.569921 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:22:35.570620 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: Close
[0m20:22:35.571045 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d77c40>]}
[0m20:22:35.571447 [info ] [Thread-4  ]: 6 of 6 OK created sql table model dev_crm_sales_dbt.agent_performance .......... [[32mSELECT 8800[0m in 0.05s]
[0m20:22:35.571983 [debug] [Thread-4  ]: Finished running node model.matt_demo.agent_performance
[0m20:22:35.696658 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.150 seconds
[0m20:22:35.698890 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.699206 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date" rename to "dim_date__dbt_backup"
[0m20:22:35.699665 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:35.701236 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.701546 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:22:35.701944 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:22:35.704374 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:22:35.704710 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.705021 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:22:35.707551 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m20:22:35.709085 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev"."dim_date__dbt_backup"
[0m20:22:35.709474 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:22:35.709769 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev"."dim_date__dbt_backup" cascade
[0m20:22:35.711699 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:22:35.712452 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:22:35.712880 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3a9f4f-343a-4bc8-98aa-a509b76bc481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87db8700>]}
[0m20:22:35.713335 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.19s]
[0m20:22:35.713810 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:22:35.714718 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.714998 [debug] [MainThread]: On master: BEGIN
[0m20:22:35.715266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:35.716774 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:22:35.717013 [debug] [MainThread]: On master: COMMIT
[0m20:22:35.717221 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:35.717435 [debug] [MainThread]: On master: COMMIT
[0m20:22:35.717679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:35.717891 [debug] [MainThread]: On master: Close
[0m20:22:35.718196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:35.718423 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:22:35.718641 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:22:35.718868 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:22:35.719076 [debug] [MainThread]: Connection 'model.matt_demo.agent_performance' was properly closed.
[0m20:22:35.719345 [info ] [MainThread]: 
[0m20:22:35.719660 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m20:22:35.720424 [debug] [MainThread]: Command end result
[0m20:22:35.747938 [info ] [MainThread]: 
[0m20:22:35.748345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:35.748673 [info ] [MainThread]: 
[0m20:22:35.749001 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:22:35.749605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9952426, "process_user_time": 2.498757, "process_kernel_time": 0.174192, "process_mem_max_rss": "137692", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:22:35.749940 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:35.749898 after 1.00 seconds
[0m20:22:35.750243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d0b62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ff2c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c1a2a00>]}
[0m20:22:35.750506 [debug] [MainThread]: Flushing usage events
[0m20:23:54.068249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1c4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1c46d0>]}


============================== 20:23:54.071978 | 034bbafc-0c3f-4977-9118-bd6b920c2d87 ==============================
[0m20:23:54.071978 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:23:54.072603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:54.156012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a866d0>]}
[0m20:23:54.181011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3e7a90>]}
[0m20:23:54.181714 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:23:54.193596 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:23:54.319337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:54.319831 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/dim/dim_date.sql
[0m20:23:54.494310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b46130>]}
[0m20:23:54.565935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ae8910>]}
[0m20:23:54.566348 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m20:23:54.566690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b6cca0>]}
[0m20:23:54.567862 [info ] [MainThread]: 
[0m20:23:54.568394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:23:54.570784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:23:54.571227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:23:54.589735 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:23:54.589996 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:23:54.590359 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:23:54.590698 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:23:54.591026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:54.591336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:54.594346 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:23:54.594547 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m20:23:54.595240 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:23:54.595900 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:23:54.596766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dev_global_dim)
[0m20:23:54.597223 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dev_global_dim"
"
[0m20:23:54.600421 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_global_dim"
[0m20:23:54.600721 [debug] [ThreadPool]: On create_company_dw_dev_global_dim: BEGIN
[0m20:23:54.600999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:54.602626 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:23:54.602911 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_global_dim"
[0m20:23:54.603196 [debug] [ThreadPool]: On create_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dev_global_dim"} */
create schema if not exists "dev_global_dim"
[0m20:23:54.603722 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m20:23:54.604223 [debug] [ThreadPool]: On create_company_dw_dev_global_dim: COMMIT
[0m20:23:54.604506 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_global_dim"
[0m20:23:54.604778 [debug] [ThreadPool]: On create_company_dw_dev_global_dim: COMMIT
[0m20:23:54.605494 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m20:23:54.605785 [debug] [ThreadPool]: On create_company_dw_dev_global_dim: Close
[0m20:23:54.606836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dev_global_dim, now list_company_dw_dev)
[0m20:23:54.607122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:23:54.607475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m20:23:54.610616 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:23:54.611886 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:23:54.613150 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:23:54.613483 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:23:54.613781 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:23:54.614077 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:23:54.614445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:54.614736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:54.615033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:54.617120 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.617377 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.617748 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:23:54.617938 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.618208 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:23:54.618534 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:23:54.618841 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:23:54.619134 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:23:54.619663 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:23:54.620794 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m20:23:54.621595 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:23:54.621801 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m20:23:54.621988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:23:54.622346 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:23:54.622916 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:23:54.623530 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:23:54.624144 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:23:54.624459 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:23:54.627753 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.628047 [debug] [MainThread]: On master: BEGIN
[0m20:23:54.628288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:54.629833 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:23:54.630083 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.630367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:23:54.635129 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m20:23:54.635784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62df700>]}
[0m20:23:54.636093 [debug] [MainThread]: On master: ROLLBACK
[0m20:23:54.636400 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.636636 [debug] [MainThread]: On master: BEGIN
[0m20:23:54.636993 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:23:54.637230 [debug] [MainThread]: On master: COMMIT
[0m20:23:54.637491 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.637701 [debug] [MainThread]: On master: COMMIT
[0m20:23:54.637971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:23:54.638235 [debug] [MainThread]: On master: Close
[0m20:23:54.638569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:54.638881 [info ] [MainThread]: 
[0m20:23:54.643591 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:23:54.643832 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:23:54.644042 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:23:54.644277 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:23:54.644671 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:23:54.645159 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:23:54.645694 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:23:54.646207 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:23:54.646726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m20:23:54.647086 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m20:23:54.647447 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.crm_stg_sales_pipelines)
[0m20:23:54.647862 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:23:54.648189 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:23:54.648523 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:23:54.648830 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:23:54.649139 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:23:54.654514 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:23:54.656935 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:23:54.658938 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.660781 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.662428 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:23:54.662867 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:23:54.663091 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:23:54.670211 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:23:54.682377 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:23:54.684667 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.689940 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:23:54.695563 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.697278 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.697733 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.698002 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.698228 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:23:54.698651 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.698927 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:23:54.699213 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:23:54.699484 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:23:54.699769 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:23:54.700031 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:23:54.700304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:54.700794 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:23:54.702706 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.703004 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.703381 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.703607 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.703848 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:23:54.704148 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.704461 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.704850 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:23:54.705183 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.705523 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:23:54.705838 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:23:54.706317 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:23:54.707663 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:23:54.707920 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:23:54.708154 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:23:54.708450 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:23:54.712835 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.742843 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.744741 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.746504 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.746828 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:23:54.747207 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:23:54.747582 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:23:54.747921 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:23:54.748573 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.748834 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.749061 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.750818 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.751032 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:23:54.752671 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.754775 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.755060 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:23:54.756655 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.756973 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:23:54.757304 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:23:54.757737 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.757928 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:23:54.758481 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.758714 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.766233 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:23:54.767090 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:23:54.767326 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:23:54.768006 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:23:54.768324 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.768642 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.769410 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:23:54.769733 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.770009 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:23:54.770327 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:23:54.770638 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.770940 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:23:54.771550 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:23:54.772402 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:23:54.772687 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:23:54.772912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:23:54.773098 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:23:54.776084 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:23:54.777537 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:23:54.779606 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:23:54.781107 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:23:54.783727 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:23:54.784726 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:23:54.785214 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:23:54.785648 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:23:54.785952 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:23:54.786243 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:23:54.786585 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:23:54.786889 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:23:54.787739 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:23:54.788032 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:23:54.788258 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:23:54.788505 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:23:54.789722 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:23:54.790504 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:23:54.791200 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:23:54.791917 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:23:54.792846 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6274490>]}
[0m20:23:54.793255 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa621ad60>]}
[0m20:23:54.793666 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6274160>]}
[0m20:23:54.794052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62746a0>]}
[0m20:23:54.794479 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.15s]
[0m20:23:54.794988 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.15s]
[0m20:23:54.795522 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.15s]
[0m20:23:54.796048 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.15s]
[0m20:23:54.796773 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:23:54.797176 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:23:54.797738 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:23:54.798096 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:23:54.798443 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:23:54.799082 [debug] [Thread-4  ]: Began running node model.matt_demo.agent_performance
[0m20:23:54.799546 [info ] [Thread-2  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:23:54.799959 [info ] [Thread-4  ]: 6 of 6 START sql table model dev_crm_sales_dbt.agent_performance ............... [RUN]
[0m20:23:54.800349 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:23:54.800688 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.agent_performance)
[0m20:23:54.800967 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:23:54.801284 [debug] [Thread-4  ]: Began compiling node model.matt_demo.agent_performance
[0m20:23:54.803175 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:23:54.804883 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.agent_performance"
[0m20:23:54.805801 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:23:54.813548 [debug] [Thread-4  ]: Began executing node model.matt_demo.agent_performance
[0m20:23:54.817230 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:23:54.819694 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.agent_performance"
[0m20:23:54.820661 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:23:54.821007 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.821215 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:23:54.821498 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: BEGIN
[0m20:23:54.821789 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:23:54.822064 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:23:54.824029 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:23:54.824270 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:23:54.824552 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:23:54.824821 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.825168 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:23:54.825504 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_tmp"
  
  
    as
  
  (
    

with agent_performance as (
    select * 
    from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"

)

select * from agent_performance
  );
  
[0m20:23:54.838206 [debug] [Thread-4  ]: SQL status: SELECT 8800 in 0.012 seconds
[0m20:23:54.840394 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.840665 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
alter table "company_dw"."dev_crm_sales_dbt"."agent_performance" rename to "agent_performance__dbt_backup"
[0m20:23:54.841110 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.842908 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.843156 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
alter table "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_tmp" rename to "agent_performance"
[0m20:23:54.843543 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.845981 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:23:54.846285 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.846568 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: COMMIT
[0m20:23:54.848160 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:23:54.849635 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_backup"
[0m20:23:54.850963 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.agent_performance"
[0m20:23:54.851221 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.agent_performance"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."agent_performance__dbt_backup" cascade
[0m20:23:54.852422 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:23:54.853131 [debug] [Thread-4  ]: On model.matt_demo.agent_performance: Close
[0m20:23:54.853555 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f261460>]}
[0m20:23:54.854007 [info ] [Thread-4  ]: 6 of 6 OK created sql table model dev_crm_sales_dbt.agent_performance .......... [[32mSELECT 8800[0m in 0.05s]
[0m20:23:54.854507 [debug] [Thread-4  ]: Finished running node model.matt_demo.agent_performance
[0m20:23:54.954965 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.129 seconds
[0m20:23:54.956995 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:23:54.957329 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:23:54.957794 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:54.958528 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:23:54.958854 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:23:54.959159 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:23:54.963810 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m20:23:54.966100 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:23:54.966503 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:23:54.966802 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:23:54.967218 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:23:54.967977 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:23:54.968412 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034bbafc-0c3f-4977-9118-bd6b920c2d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa637efa0>]}
[0m20:23:54.968860 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.17s]
[0m20:23:54.969404 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:23:54.970288 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.970571 [debug] [MainThread]: On master: BEGIN
[0m20:23:54.970806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:54.972415 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:23:54.972658 [debug] [MainThread]: On master: COMMIT
[0m20:23:54.972906 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:54.973139 [debug] [MainThread]: On master: COMMIT
[0m20:23:54.973441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:23:54.973684 [debug] [MainThread]: On master: Close
[0m20:23:54.973971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:54.974210 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:23:54.974491 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:23:54.974734 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:23:54.974940 [debug] [MainThread]: Connection 'model.matt_demo.agent_performance' was properly closed.
[0m20:23:54.975213 [info ] [MainThread]: 
[0m20:23:54.975580 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:23:54.976314 [debug] [MainThread]: Command end result
[0m20:23:55.003337 [info ] [MainThread]: 
[0m20:23:55.003770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:55.004097 [info ] [MainThread]: 
[0m20:23:55.004432 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:23:55.005015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.96242, "process_user_time": 2.515862, "process_kernel_time": 0.124836, "process_mem_max_rss": "126260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:23:55.005366 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:55.005319 after 0.96 seconds
[0m20:23:55.005661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8aa0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ae8910>]}
[0m20:23:55.005940 [debug] [MainThread]: Flushing usage events
[0m20:38:37.675243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710e92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f685610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f6855b0>]}


============================== 20:38:37.678869 | 684a4c0f-6c30-460f-a538-4747c8d06c18 ==============================
[0m20:38:37.678869 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:38:37.679410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:38:37.759505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f47100>]}
[0m20:38:37.784466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1db8b0>]}
[0m20:38:37.785075 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:38:37.796247 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:38:37.914617 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 2 files changed.
[0m20:38:37.915071 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m20:38:37.915320 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://models/crm_sales_data/fact/team_performance.sql
[0m20:38:37.915541 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://models/crm_sales_data/fact/product_win_rates.sql
[0m20:38:37.915766 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://models/crm_sales_data/fact/agent_performance.sql
[0m20:38:37.916030 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:38:38.011873 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_kpi' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m20:38:38.058825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8900ae20>]}
[0m20:38:38.124301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f5d1c0>]}
[0m20:38:38.124642 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:38:38.124975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d4a820>]}
[0m20:38:38.126021 [info ] [MainThread]: 
[0m20:38:38.126513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:38.128868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:38:38.129339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:38:38.147138 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:38:38.147397 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:38:38.147757 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:38:38.148083 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:38:38.148427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:38.148775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:38.151573 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:38:38.151778 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:38:38.152487 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:38:38.153198 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:38:38.154479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:38:38.154813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:38:38.158000 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:38:38.159398 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:38:38.159712 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:38:38.160006 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:38:38.160327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:38.160610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:38.162278 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:38:38.162501 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:38:38.162769 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:38:38.163080 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:38:38.163409 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:38:38.163732 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:38:38.165357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:38:38.165536 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m20:38:38.166206 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:38:38.166897 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:38:38.167288 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:38:38.167558 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:38:38.170755 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.171016 [debug] [MainThread]: On master: BEGIN
[0m20:38:38.171247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:38.172963 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:38:38.173236 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.173515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:38.178741 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:38:38.179449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f0fc10>]}
[0m20:38:38.179761 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:38.180079 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.180347 [debug] [MainThread]: On master: BEGIN
[0m20:38:38.180703 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:38:38.180940 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.181157 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.181388 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.181659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:38.181884 [debug] [MainThread]: On master: Close
[0m20:38:38.182192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:38.182542 [info ] [MainThread]: 
[0m20:38:38.186632 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:38:38.186861 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:38:38.187074 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:38:38.187365 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:38:38.187623 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:38:38.188127 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:38:38.188689 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:38:38.189154 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:38:38.189640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:38:38.189988 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:38:38.190393 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:38:38.190779 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:38:38.191120 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:38:38.191467 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:38:38.191780 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:38:38.192094 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:38:38.197038 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:38:38.198776 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:38:38.200505 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.202327 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.204457 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:38:38.204696 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:38:38.204963 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:38:38.205245 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:38:38.222239 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:38:38.249436 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:38:38.251422 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.253277 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.254857 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.255215 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.255452 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.255690 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:38:38.255980 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.256181 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:38:38.256468 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:38:38.256758 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:38:38.257026 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:38:38.257294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:38:38.257533 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:38:38.257942 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:38:38.259775 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:38:38.260086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:38:38.260400 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:38:38.260620 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:38:38.260842 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.261174 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.261441 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.261730 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.262044 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:38:38.262375 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:38:38.262691 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:38:38.263026 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:38:38.264955 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:38:38.265205 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:38:38.265452 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:38:38.265696 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:38:38.269275 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.271005 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.275676 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:38:38.275075 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.275397 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:38:38.273324 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.276081 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:38:38.276335 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.276716 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:38:38.276940 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.278676 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.278863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:38:38.280666 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.280876 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:38:38.281158 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:38:38.282798 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.283187 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:38:38.285178 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.285667 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:38:38.285886 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.286294 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:38:38.286515 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.294744 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:38:38.294940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m20:38:38.295815 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:38:38.296031 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:38.296320 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.297007 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:38:38.297329 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.297999 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:38:38.298324 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:38:38.298637 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.298950 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:38:38.299217 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.299698 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:38:38.300129 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:38:38.300371 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:38:38.300562 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:38:38.303865 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:38:38.304082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m20:38:38.305689 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:38:38.305906 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m20:38:38.307983 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:38:38.309403 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:38:38.309796 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:38:38.311175 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:38:38.311475 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:38:38.312254 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:38:38.312549 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:38:38.312936 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:38:38.313359 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:38:38.313804 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:38:38.314073 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m20:38:38.314292 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:38:38.315810 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:38:38.316023 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:38:38.316242 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:38:38.316916 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:38:38.317863 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f02f10>]}
[0m20:38:38.318620 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:38:38.319310 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:38:38.319689 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f61c0a0>]}
[0m20:38:38.320109 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m20:38:38.320594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f61cfa0>]}
[0m20:38:38.320969 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f029d0>]}
[0m20:38:38.321389 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:38:38.321878 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:38:38.322296 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:38:38.322764 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m20:38:38.323221 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:38:38.323585 [debug] [Thread-4  ]: Began running node model.matt_demo.dim_date
[0m20:38:38.324002 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:38:38.324371 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:38:38.324707 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m20:38:38.325095 [info ] [Thread-4  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:38:38.325804 [info ] [Thread-2  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:38:38.326205 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.dim_date)
[0m20:38:38.326535 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.kpi)
[0m20:38:38.326810 [debug] [Thread-4  ]: Began compiling node model.matt_demo.dim_date
[0m20:38:38.327065 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m20:38:38.328934 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:38:38.330552 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:38:38.331716 [debug] [Thread-4  ]: Began executing node model.matt_demo.dim_date
[0m20:38:38.331945 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m20:38:38.342509 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:38:38.344582 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:38:38.345565 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.345869 [debug] [Thread-4  ]: On model.matt_demo.dim_date: BEGIN
[0m20:38:38.346089 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:38:38.346388 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:38:38.346683 [debug] [Thread-2  ]: On model.matt_demo.kpi: BEGIN
[0m20:38:38.347190 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:38:38.348617 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:38:38.348833 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:38:38.349095 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.349403 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:38:38.349723 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:38:38.350080 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from ref('crm_stg_sales_pipelines')
    ),
    accounts as (
        select *
        from ref('crm_stg_accounts')
    ), 
    products as (
        select * 
        from ref('crm_stg_products')
    ),
    teams as (
        select * 
        from ref('crm_stg_sales_teams')
    )
select * 
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:38:38.350713 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function ref(unknown) does not exist
LINE 17:         from ref('crm_stg_sales_pipelines')
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:38:38.351028 [debug] [Thread-2  ]: On model.matt_demo.kpi: ROLLBACK
[0m20:38:38.351509 [debug] [Thread-2  ]: On model.matt_demo.kpi: Close
[0m20:38:38.353034 [debug] [Thread-2  ]: Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  function ref(unknown) does not exist
  LINE 17:         from ref('crm_stg_sales_pipelines')
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:38:38.353444 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bddd8b0>]}
[0m20:38:38.353891 [error] [Thread-2  ]: 6 of 6 ERROR creating sql table model dev_crm_sales_dbt.kpi .................... [[31mERROR[0m in 0.03s]
[0m20:38:38.354388 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m20:38:38.483352 [debug] [Thread-4  ]: SQL status: SELECT 29220 in 0.133 seconds
[0m20:38:38.486003 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.486268 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:38:38.486682 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.488260 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.488543 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:38:38.488918 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:38:38.491274 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:38:38.491545 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.491771 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:38:38.499142 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m20:38:38.500679 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:38:38.501925 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:38:38.502216 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:38:38.504113 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:38:38.504813 [debug] [Thread-4  ]: On model.matt_demo.dim_date: Close
[0m20:38:38.505225 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '684a4c0f-6c30-460f-a538-4747c8d06c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88eb6a90>]}
[0m20:38:38.505639 [info ] [Thread-4  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.18s]
[0m20:38:38.506095 [debug] [Thread-4  ]: Finished running node model.matt_demo.dim_date
[0m20:38:38.506929 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.507205 [debug] [MainThread]: On master: BEGIN
[0m20:38:38.507470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:38.508954 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:38:38.509199 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.509445 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:38.509672 [debug] [MainThread]: On master: COMMIT
[0m20:38:38.509954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:38.510172 [debug] [MainThread]: On master: Close
[0m20:38:38.510463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:38.510693 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:38:38.510906 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:38:38.511124 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:38:38.511326 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:38:38.511626 [info ] [MainThread]: 
[0m20:38:38.511955 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:38:38.512722 [debug] [MainThread]: Command end result
[0m20:38:38.539828 [info ] [MainThread]: 
[0m20:38:38.540213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:38:38.540503 [info ] [MainThread]: 
[0m20:38:38.540841 [error] [MainThread]:   Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  function ref(unknown) does not exist
  LINE 17:         from ref('crm_stg_sales_pipelines')
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:38:38.541150 [info ] [MainThread]: 
[0m20:38:38.541473 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:38:38.542025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8920107, "process_user_time": 2.445965, "process_kernel_time": 0.112227, "process_mem_max_rss": "133020", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:38.542417 [debug] [MainThread]: Command `dbt run` failed at 20:38:38.542367 after 0.89 seconds
[0m20:38:38.542700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710e92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f5d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fedf10>]}
[0m20:38:38.542979 [debug] [MainThread]: Flushing usage events
[0m20:40:23.249790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff779942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75f2f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75f2f700>]}


============================== 20:40:23.254057 | 7d6f9c9a-1e40-440a-91a2-18c198a2fcc9 ==============================
[0m20:40:23.254057 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:40:23.254659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:23.335158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a6e550>]}
[0m20:40:23.358358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76128520>]}
[0m20:40:23.358892 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:23.369159 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:40:23.482903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:23.483367 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:40:23.599131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f52130>]}
[0m20:40:23.666389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774ac9a0>]}
[0m20:40:23.666783 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:40:23.667167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8e3c40>]}
[0m20:40:23.668173 [info ] [MainThread]: 
[0m20:40:23.668767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:23.671150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:40:23.671529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:40:23.688283 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:40:23.688513 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:40:23.688857 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:40:23.689187 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:40:23.689535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:23.689841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:23.692910 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:40:23.693121 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:40:23.693805 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:40:23.694423 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:40:23.695730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:40:23.696057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:40:23.699434 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:40:23.701065 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:40:23.701387 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:40:23.701685 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:40:23.701972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:23.702280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:23.704075 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:40:23.704265 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:40:23.704533 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:40:23.704838 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:40:23.705140 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:40:23.705463 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:40:23.707061 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:40:23.707245 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m20:40:23.707883 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:40:23.708554 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:40:23.708913 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:40:23.709243 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:40:23.712407 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:23.712677 [debug] [MainThread]: On master: BEGIN
[0m20:40:23.712938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:23.714387 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:40:23.714630 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:23.714920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:23.720162 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:40:23.720837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ad0e20>]}
[0m20:40:23.721138 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:23.721450 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:23.721694 [debug] [MainThread]: On master: BEGIN
[0m20:40:23.722066 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:40:23.722313 [debug] [MainThread]: On master: COMMIT
[0m20:40:23.722551 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:23.722766 [debug] [MainThread]: On master: COMMIT
[0m20:40:23.723074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:23.723301 [debug] [MainThread]: On master: Close
[0m20:40:23.723603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:23.723933 [info ] [MainThread]: 
[0m20:40:23.727952 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:40:23.728202 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:40:23.728421 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:40:23.728651 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:40:23.729094 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:40:23.729648 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:40:23.730158 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:40:23.730637 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:40:23.731104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:40:23.731485 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:40:23.731855 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:40:23.732248 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:40:23.732597 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:40:23.732910 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:40:23.733255 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:40:23.733611 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:40:23.737886 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:40:23.739587 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:40:23.741936 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.743694 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.745246 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:40:23.745471 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:40:23.745878 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:40:23.762594 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:40:23.762857 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:40:23.764671 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:40:23.767010 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.768948 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.769818 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.770261 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.770784 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.771071 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:40:23.771505 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:40:23.771704 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.772047 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:40:23.772336 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:40:23.772600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:23.772894 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:40:23.773177 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:40:23.773822 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:40:23.775341 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:40:23.775589 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:40:23.775885 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:40:23.776107 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.776327 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:40:23.776633 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.776904 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.777210 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:40:23.777536 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.777843 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:40:23.778171 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:40:23.778635 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:40:23.779824 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:40:23.780083 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:40:23.780292 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:40:23.780506 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:40:23.784101 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.785907 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.787629 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.789577 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.789915 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:40:23.790256 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:40:23.790591 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:40:23.790876 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:40:23.791534 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.791788 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.792053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.818905 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.819166 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:40:23.820900 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.822535 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.822885 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:40:23.824477 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.824813 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:40:23.825154 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:40:23.825613 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:40:23.825854 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.826318 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.826711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.826954 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:23.834455 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:40:23.835205 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:40:23.835922 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:40:23.836613 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:40:23.836935 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.837257 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.837573 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.837854 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.838170 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:40:23.838486 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:40:23.838800 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:40:23.839140 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:40:23.840321 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:40:23.840604 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:40:23.840815 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:40:23.840997 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:40:23.844536 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:40:23.845910 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:40:23.847303 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:40:23.848654 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:40:23.850607 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:40:23.850988 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:40:23.851412 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:40:23.851810 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:40:23.852121 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:40:23.852425 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:40:23.852738 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:40:23.853063 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:40:23.854114 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:23.854395 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:23.854596 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:23.854794 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:23.855953 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:40:23.856649 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:40:23.857327 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:40:23.858044 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:40:23.858937 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bff8ee0>]}
[0m20:40:23.859354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bff8d60>]}
[0m20:40:23.859722 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfde460>]}
[0m20:40:23.860130 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfde580>]}
[0m20:40:23.860579 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:23.861077 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:23.861587 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:23.862069 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m20:40:23.862544 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:40:23.862936 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:40:23.863310 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:40:23.863681 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:40:23.864058 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:40:23.864792 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m20:40:23.865146 [info ] [Thread-2  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:40:23.865567 [info ] [Thread-1  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:40:23.865960 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:40:23.866288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.kpi)
[0m20:40:23.866569 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:40:23.866812 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m20:40:23.868627 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:40:23.871513 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:40:23.872540 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:40:23.872867 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m20:40:23.883698 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:40:23.885679 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:40:23.886736 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:23.886951 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:40:23.887232 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:40:23.887558 [debug] [Thread-1  ]: On model.matt_demo.kpi: BEGIN
[0m20:40:23.887825 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:40:23.888121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:23.890253 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:40:23.890467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:40:23.890717 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:23.890982 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:40:23.891287 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:40:23.891653 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select *
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select * 
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:40:23.892993 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "sales_agent" specified more than once

[0m20:40:23.893357 [debug] [Thread-1  ]: On model.matt_demo.kpi: ROLLBACK
[0m20:40:23.893789 [debug] [Thread-1  ]: On model.matt_demo.kpi: Close
[0m20:40:23.895192 [debug] [Thread-1  ]: Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "sales_agent" specified more than once
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:40:23.895579 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf6bd30>]}
[0m20:40:23.896040 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model dev_crm_sales_dbt.kpi .................... [[31mERROR[0m in 0.03s]
[0m20:40:23.896536 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m20:40:24.022433 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.130 seconds
[0m20:40:24.024557 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:24.024854 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:40:24.025350 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:24.026849 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:24.027152 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:40:24.027513 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:24.029874 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:40:24.030141 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:24.030373 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:40:24.038077 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m20:40:24.040399 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:40:24.041734 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:40:24.042001 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:40:24.044170 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:40:24.044877 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:40:24.045250 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d6f9c9a-1e40-440a-91a2-18c198a2fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bff74c0>]}
[0m20:40:24.045654 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.18s]
[0m20:40:24.046147 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:40:24.046955 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:24.047267 [debug] [MainThread]: On master: BEGIN
[0m20:40:24.047508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:24.049077 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:40:24.049343 [debug] [MainThread]: On master: COMMIT
[0m20:40:24.049556 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:24.049758 [debug] [MainThread]: On master: COMMIT
[0m20:40:24.050058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:24.050307 [debug] [MainThread]: On master: Close
[0m20:40:24.050598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:24.050814 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:40:24.051033 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:40:24.051277 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:40:24.051494 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:40:24.051762 [info ] [MainThread]: 
[0m20:40:24.052101 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:40:24.052825 [debug] [MainThread]: Command end result
[0m20:40:24.078989 [info ] [MainThread]: 
[0m20:40:24.079392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:24.079707 [info ] [MainThread]: 
[0m20:40:24.080096 [error] [MainThread]:   Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "sales_agent" specified more than once
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:40:24.080401 [info ] [MainThread]: 
[0m20:40:24.080686 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:40:24.081273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8568082, "process_user_time": 2.396272, "process_kernel_time": 0.144215, "process_mem_max_rss": "130080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:24.081672 [debug] [MainThread]: Command `dbt run` failed at 20:40:24.081614 after 0.86 seconds
[0m20:40:24.081951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff779942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94647e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7652f520>]}
[0m20:40:24.082232 [debug] [MainThread]: Flushing usage events
[0m20:47:20.873565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a0b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fa6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fa65b0>]}


============================== 20:47:20.877251 | 349b3396-bbcc-4fb4-beef-8da634f66f9e ==============================
[0m20:47:20.877251 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:47:20.877758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:20.957735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97869100>]}
[0m20:47:20.981636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4afd8b0>]}
[0m20:47:20.982255 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:47:20.993572 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:47:21.213177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:21.213796 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:47:21.338655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fca130>]}
[0m20:47:21.414631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb47554c0>]}
[0m20:47:21.415032 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:47:21.415404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb195a940>]}
[0m20:47:21.416461 [info ] [MainThread]: 
[0m20:47:21.416985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:47:21.419372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:47:21.419789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:47:21.436863 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:47:21.437106 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:47:21.437461 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:47:21.437823 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:47:21.438160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:21.438471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:21.441607 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:47:21.441805 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:47:21.442536 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:47:21.443230 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:47:21.444432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:47:21.444746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:47:21.448000 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:47:21.449506 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:47:21.449819 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:47:21.450115 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:47:21.450446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:21.450742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:21.452569 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.452783 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.453097 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:47:21.453399 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:47:21.453702 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:47:21.454026 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:47:21.455620 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:47:21.455805 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m20:47:21.456528 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:47:21.457196 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:47:21.457599 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:47:21.457888 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:47:21.461125 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.461398 [debug] [MainThread]: On master: BEGIN
[0m20:47:21.461642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:21.463011 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:47:21.463255 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.463559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:21.468735 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:47:21.469482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fd4850>]}
[0m20:47:21.469824 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:21.470146 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.470394 [debug] [MainThread]: On master: BEGIN
[0m20:47:21.470755 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:47:21.471004 [debug] [MainThread]: On master: COMMIT
[0m20:47:21.471239 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.471482 [debug] [MainThread]: On master: COMMIT
[0m20:47:21.471771 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:21.471994 [debug] [MainThread]: On master: Close
[0m20:47:21.472302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:21.472659 [info ] [MainThread]: 
[0m20:47:21.476676 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:47:21.476901 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:47:21.477107 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:21.477368 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:47:21.477663 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:47:21.478135 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:47:21.478598 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:47:21.479049 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:47:21.479478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:47:21.479817 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:47:21.480179 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:47:21.480603 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:47:21.480897 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:47:21.481212 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:47:21.481535 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:21.481881 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:47:21.486154 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:47:21.487896 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:47:21.490202 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.491896 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.494500 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:47:21.494717 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:47:21.495111 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:21.509070 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:47:21.512525 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:47:21.514385 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:47:21.516743 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.518516 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.519873 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.520375 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.520575 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.520769 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:47:21.521147 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.521376 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:47:21.521648 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:47:21.521921 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:47:21.522164 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:47:21.522418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:21.522646 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:47:21.523025 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:47:21.524641 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:21.524872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.525119 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.525365 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.525560 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.525852 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.526107 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.526382 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.526676 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:47:21.527005 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:47:21.527319 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:47:21.527632 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:47:21.529357 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:47:21.529621 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:47:21.529859 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:47:21.530109 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:47:21.533806 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.535663 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.537370 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.540391 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.541002 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:47:21.541349 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:47:21.541652 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:47:21.542109 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:47:21.542869 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.543114 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.543362 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.572519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:47:21.573580 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.575305 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.576882 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.578408 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.578746 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:47:21.579068 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:47:21.579363 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:47:21.579675 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:47:21.580284 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.580516 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.580752 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.587637 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:47:21.588749 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:47:21.589475 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:47:21.590140 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:47:21.590819 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:47:21.591134 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.591458 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.591734 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.592060 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.592375 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:47:21.592742 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:47:21.593014 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:47:21.593332 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:47:21.594224 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:21.594541 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:21.594788 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:21.595018 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:21.598582 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:47:21.599932 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:47:21.601315 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:47:21.602643 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:47:21.604639 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:21.605010 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:21.605422 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:21.605814 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:21.606125 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:47:21.606407 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:47:21.606717 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:47:21.607030 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:47:21.608153 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:21.608472 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:21.608689 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:21.608883 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:21.610045 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:47:21.610759 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:47:21.611410 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:47:21.612065 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:47:21.613006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0546d0>]}
[0m20:47:21.613415 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad06ffa0>]}
[0m20:47:21.613771 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0545b0>]}
[0m20:47:21.614148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad06fe20>]}
[0m20:47:21.614602 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:21.615116 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:21.615678 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:21.616182 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:21.616686 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:47:21.617070 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:47:21.617412 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:21.617799 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:47:21.618152 [debug] [Thread-4  ]: Began running node model.matt_demo.dim_date
[0m20:47:21.618902 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m20:47:21.619233 [info ] [Thread-4  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:47:21.619653 [info ] [Thread-2  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:47:21.620130 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.dim_date)
[0m20:47:21.620473 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.kpi)
[0m20:47:21.620779 [debug] [Thread-4  ]: Began compiling node model.matt_demo.dim_date
[0m20:47:21.621087 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m20:47:21.622986 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:47:21.625840 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:47:21.627540 [debug] [Thread-4  ]: Began executing node model.matt_demo.dim_date
[0m20:47:21.627826 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m20:47:21.638225 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:47:21.640233 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:47:21.641080 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.641365 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:47:21.641559 [debug] [Thread-4  ]: On model.matt_demo.dim_date: BEGIN
[0m20:47:21.641802 [debug] [Thread-2  ]: On model.matt_demo.kpi: BEGIN
[0m20:47:21.642095 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:47:21.642343 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:47:21.644164 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.644376 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.644647 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:47:21.644924 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.645226 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            mnanager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select * 
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:47:21.645613 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:47:21.646391 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "mnanager" does not exist
LINE 36:             mnanager,
                     ^
HINT:  Perhaps you meant to reference the column "crm_stg_sales_teams.manager".

[0m20:47:21.646678 [debug] [Thread-2  ]: On model.matt_demo.kpi: ROLLBACK
[0m20:47:21.647049 [debug] [Thread-2  ]: On model.matt_demo.kpi: Close
[0m20:47:21.648479 [debug] [Thread-2  ]: Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "mnanager" does not exist
  LINE 36:             mnanager,
                       ^
  HINT:  Perhaps you meant to reference the column "crm_stg_sales_teams.manager".
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:47:21.648838 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4763280>]}
[0m20:47:21.649296 [error] [Thread-2  ]: 6 of 6 ERROR creating sql table model dev_crm_sales_dbt.kpi .................... [[31mERROR[0m in 0.03s]
[0m20:47:21.649771 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m20:47:21.774173 [debug] [Thread-4  ]: SQL status: SELECT 29220 in 0.128 seconds
[0m20:47:21.776284 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.776568 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:47:21.777021 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.778612 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.778917 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:47:21.779334 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:21.781718 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:47:21.782023 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.782316 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m20:47:21.786371 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m20:47:21.788690 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:47:21.790006 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:21.790295 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:47:21.795975 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.005 seconds
[0m20:47:21.796869 [debug] [Thread-4  ]: On model.matt_demo.dim_date: Close
[0m20:47:21.797365 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '349b3396-bbcc-4fb4-beef-8da634f66f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad170fd0>]}
[0m20:47:21.797858 [info ] [Thread-4  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.18s]
[0m20:47:21.798407 [debug] [Thread-4  ]: Finished running node model.matt_demo.dim_date
[0m20:47:21.799387 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.799673 [debug] [MainThread]: On master: BEGIN
[0m20:47:21.799939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:21.801941 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:47:21.802176 [debug] [MainThread]: On master: COMMIT
[0m20:47:21.802385 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:21.802603 [debug] [MainThread]: On master: COMMIT
[0m20:47:21.802908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:21.803154 [debug] [MainThread]: On master: Close
[0m20:47:21.803466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:21.803708 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:47:21.803933 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:47:21.804166 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:47:21.804382 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:47:21.804681 [info ] [MainThread]: 
[0m20:47:21.805027 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:47:21.805837 [debug] [MainThread]: Command end result
[0m20:47:21.833791 [info ] [MainThread]: 
[0m20:47:21.834206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:47:21.834525 [info ] [MainThread]: 
[0m20:47:21.834848 [error] [MainThread]:   Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "mnanager" does not exist
  LINE 36:             mnanager,
                       ^
  HINT:  Perhaps you meant to reference the column "crm_stg_sales_teams.manager".
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:47:21.835136 [info ] [MainThread]: 
[0m20:47:21.835445 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:47:21.836042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.98702747, "process_user_time": 2.434421, "process_kernel_time": 0.149313, "process_mem_max_rss": "128928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:47:21.836425 [debug] [MainThread]: Command `dbt run` failed at 20:47:21.836370 after 0.99 seconds
[0m20:47:21.836722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a0b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b523a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fd47c0>]}
[0m20:47:21.836990 [debug] [MainThread]: Flushing usage events
[0m20:47:31.084742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c5f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98259760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98259700>]}


============================== 20:47:31.088395 | 1cc9af87-c845-4951-877b-a0305930aace ==============================
[0m20:47:31.088395 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:47:31.088968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:31.170228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d4c850>]}
[0m20:47:31.195079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98453520>]}
[0m20:47:31.195624 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:47:31.207276 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:47:31.323567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:31.324015 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:47:31.437158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a2a130>]}
[0m20:47:31.502302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68fe880>]}
[0m20:47:31.502689 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:47:31.503024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69580a0>]}
[0m20:47:31.503989 [info ] [MainThread]: 
[0m20:47:31.504461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:47:31.506809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:47:31.507224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:47:31.523766 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:47:31.523997 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:47:31.524318 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:47:31.524633 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:47:31.524936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:31.525223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:31.530075 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m20:47:31.531053 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:47:31.531298 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m20:47:31.532547 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:47:31.533899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:47:31.534300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:47:31.538296 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:47:31.539968 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:47:31.540295 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:47:31.540593 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:47:31.540890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:31.541175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:47:31.543287 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:47:31.543477 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.543746 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:47:31.544008 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:47:31.544327 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:47:31.544609 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:47:31.546133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:47:31.546317 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m20:47:31.546993 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:47:31.547710 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:47:31.548086 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:47:31.548381 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:47:31.551699 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.551962 [debug] [MainThread]: On master: BEGIN
[0m20:47:31.552200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:47:31.553776 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:47:31.554023 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.554304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:47:31.559132 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:47:31.559819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6944910>]}
[0m20:47:31.560160 [debug] [MainThread]: On master: ROLLBACK
[0m20:47:31.560508 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.560748 [debug] [MainThread]: On master: BEGIN
[0m20:47:31.561113 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:47:31.561364 [debug] [MainThread]: On master: COMMIT
[0m20:47:31.561595 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.561823 [debug] [MainThread]: On master: COMMIT
[0m20:47:31.562110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:31.562325 [debug] [MainThread]: On master: Close
[0m20:47:31.562631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:31.562984 [info ] [MainThread]: 
[0m20:47:31.567100 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:47:31.567335 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:47:31.567571 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:31.567806 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:47:31.568188 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:47:31.568712 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:47:31.569201 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:47:31.569697 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:47:31.570142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:47:31.570507 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:47:31.570867 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:47:31.571227 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:47:31.571572 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:47:31.571875 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:47:31.572184 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:31.572533 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:47:31.576976 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:47:31.578677 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:47:31.581172 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.582963 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.584706 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:47:31.584914 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:47:31.585152 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:31.602050 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:47:31.602279 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:47:31.604220 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:47:31.606778 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.608781 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.609711 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.610081 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.610572 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.610763 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:47:31.611108 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.611320 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:47:31.611630 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:47:31.611939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:31.612209 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:47:31.612514 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:47:31.612775 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:47:31.613219 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:47:31.615102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.615384 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.615722 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.615928 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.616139 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.616459 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.616749 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.617054 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:47:31.617325 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.617617 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:47:31.617939 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:47:31.618389 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:47:31.619322 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:47:31.619643 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:47:31.619901 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:47:31.623548 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.623782 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:47:31.625551 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.627384 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.627724 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:47:31.629847 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.630181 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:47:31.630525 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:47:31.630978 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:47:31.631212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.631711 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.631929 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.658442 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.026 seconds
[0m20:47:31.659542 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.661430 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.663082 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.664794 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.665136 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:47:31.665529 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:47:31.665847 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:47:31.666135 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:47:31.666777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.667009 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.667244 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.673674 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:47:31.675540 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:47:31.676321 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:47:31.677026 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:47:31.677744 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:47:31.678078 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.678391 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.678699 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.678985 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.679306 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:47:31.679675 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:47:31.679987 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:47:31.680289 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:47:31.681964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:31.682236 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:47:31.682453 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m20:47:31.682693 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m20:47:31.686183 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:47:31.687684 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:47:31.689090 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:47:31.690439 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:47:31.692407 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:47:31.692783 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:47:31.693189 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:47:31.693602 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:47:31.693925 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:47:31.694214 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:47:31.694591 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:47:31.694904 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:47:31.696146 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:31.696412 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:31.696605 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:31.696824 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:47:31.697925 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:47:31.698635 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:47:31.699358 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:47:31.700011 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:47:31.700976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0af2d30>]}
[0m20:47:31.701384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0af2eb0>]}
[0m20:47:31.701751 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ad8550>]}
[0m20:47:31.702153 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0af2070>]}
[0m20:47:31.702631 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:31.703108 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:31.703594 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:31.704051 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m20:47:31.704583 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:47:31.704955 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:47:31.705301 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:47:31.705639 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:47:31.705977 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m20:47:31.706731 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m20:47:31.706995 [info ] [Thread-1  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:47:31.707477 [info ] [Thread-2  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:47:31.707864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m20:47:31.708205 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.kpi)
[0m20:47:31.708507 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m20:47:31.708814 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m20:47:31.710704 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:47:31.713593 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:47:31.714493 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m20:47:31.720440 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m20:47:31.725847 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:47:31.727716 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:47:31.728914 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.729528 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:47:31.729794 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m20:47:31.730092 [debug] [Thread-2  ]: On model.matt_demo.kpi: BEGIN
[0m20:47:31.730362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:31.730657 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:47:31.732660 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:47:31.732874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:47:31.733134 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:47:31.733377 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.733688 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select * 
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:47:31.734027 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:47:31.735327 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "sales_agent" specified more than once

[0m20:47:31.735636 [debug] [Thread-2  ]: On model.matt_demo.kpi: ROLLBACK
[0m20:47:31.736042 [debug] [Thread-2  ]: On model.matt_demo.kpi: Close
[0m20:47:31.737383 [debug] [Thread-2  ]: Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "sales_agent" specified more than once
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:47:31.737755 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0afd6d0>]}
[0m20:47:31.738183 [error] [Thread-2  ]: 6 of 6 ERROR creating sql table model dev_crm_sales_dbt.kpi .................... [[31mERROR[0m in 0.03s]
[0m20:47:31.738661 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m20:47:31.861760 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.127 seconds
[0m20:47:31.863857 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.864162 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:47:31.864640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.866218 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.866498 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:47:31.866866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:47:31.869229 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:47:31.869550 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.869807 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m20:47:31.874304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m20:47:31.876501 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:47:31.877711 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:47:31.877989 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:47:31.879232 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:47:31.879928 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m20:47:31.880338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cc9af87-c845-4951-877b-a0305930aace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0af0400>]}
[0m20:47:31.880752 [info ] [Thread-1  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.17s]
[0m20:47:31.881293 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m20:47:31.882128 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.882384 [debug] [MainThread]: On master: BEGIN
[0m20:47:31.882617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:47:31.884203 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:47:31.884477 [debug] [MainThread]: On master: COMMIT
[0m20:47:31.884682 [debug] [MainThread]: Using postgres connection "master"
[0m20:47:31.884864 [debug] [MainThread]: On master: COMMIT
[0m20:47:31.885149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:47:31.885420 [debug] [MainThread]: On master: Close
[0m20:47:31.885704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:31.885932 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:47:31.886153 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:47:31.886399 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:47:31.886608 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:47:31.886874 [info ] [MainThread]: 
[0m20:47:31.887171 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:47:31.887946 [debug] [MainThread]: Command end result
[0m20:47:31.914517 [info ] [MainThread]: 
[0m20:47:31.914918 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:47:31.915214 [info ] [MainThread]: 
[0m20:47:31.915555 [error] [MainThread]:   Database Error in model kpi (models/crm_sales_data/fact/kpi.sql)
  column "sales_agent" specified more than once
  compiled Code at target/run/matt_demo/models/crm_sales_data/fact/kpi.sql
[0m20:47:31.915866 [info ] [MainThread]: 
[0m20:47:31.916166 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:47:31.916763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.85844743, "process_user_time": 2.505332, "process_kernel_time": 0.13058, "process_mem_max_rss": "126648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:47:31.917094 [debug] [MainThread]: Command `dbt run` failed at 20:47:31.917051 after 0.86 seconds
[0m20:47:31.917379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c5f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995ac4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a3dd90>]}
[0m20:47:31.917695 [debug] [MainThread]: Flushing usage events
[0m20:48:25.580055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7930f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778ab760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778ab700>]}


============================== 20:48:25.583367 | 1f2c37dc-5313-4b0d-a596-8e3ee05f772a ==============================
[0m20:48:25.583367 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:48:25.583952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:48:25.662021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963e9550>]}
[0m20:48:25.685392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77aa3520>]}
[0m20:48:25.685970 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:48:25.697149 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:48:25.812654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:25.813115 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:48:25.931156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958cd130>]}
[0m20:48:26.004811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e279a0>]}
[0m20:48:26.005565 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:48:26.006448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9606c2e0>]}
[0m20:48:26.007706 [info ] [MainThread]: 
[0m20:48:26.008382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:26.010954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:48:26.011372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:48:26.028719 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:48:26.028998 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:48:26.029335 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:48:26.029650 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:48:26.029965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:26.030266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:26.032893 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:48:26.033109 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:48:26.033852 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:48:26.034516 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:48:26.035782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:48:26.036137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:48:26.039610 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:48:26.041225 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:48:26.041542 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:48:26.041857 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:48:26.042163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:26.042464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:26.044264 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:48:26.044452 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:48:26.044701 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:48:26.044994 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:48:26.045271 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:48:26.045593 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:48:26.046867 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:48:26.047079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m20:48:26.047723 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:48:26.048459 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:48:26.048813 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:48:26.049115 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:48:26.052455 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.052762 [debug] [MainThread]: On master: BEGIN
[0m20:48:26.053046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:26.054649 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:48:26.054960 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.055273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:26.061188 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m20:48:26.061974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963cb4c0>]}
[0m20:48:26.062334 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:26.062693 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.062981 [debug] [MainThread]: On master: BEGIN
[0m20:48:26.063363 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:48:26.063630 [debug] [MainThread]: On master: COMMIT
[0m20:48:26.063892 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.064178 [debug] [MainThread]: On master: COMMIT
[0m20:48:26.064500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:48:26.064775 [debug] [MainThread]: On master: Close
[0m20:48:26.065132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:26.065503 [info ] [MainThread]: 
[0m20:48:26.069600 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:48:26.069867 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:48:26.070122 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:48:26.070409 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:48:26.070725 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:48:26.071286 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:48:26.071893 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:48:26.072578 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:48:26.073142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:48:26.073531 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:48:26.073975 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:48:26.074417 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:48:26.074773 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:48:26.075108 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:48:26.075447 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:48:26.075822 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:48:26.080809 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:48:26.082739 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:48:26.085587 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.087629 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.089234 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:48:26.089536 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:48:26.089768 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:48:26.102094 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:48:26.108409 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:48:26.110426 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:48:26.112933 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.114965 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.117031 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.117260 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.117591 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.117841 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:48:26.118088 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.118427 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:48:26.118778 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:48:26.119097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:26.119430 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:48:26.119693 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:48:26.119989 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:48:26.120501 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:48:26.122247 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:48:26.122491 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:48:26.122740 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m20:48:26.123005 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m20:48:26.123213 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.123496 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.123819 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.124132 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.124465 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:48:26.124766 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:48:26.125126 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:48:26.125499 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:48:26.126767 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:48:26.127033 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:48:26.127260 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:48:26.127513 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:48:26.131441 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.133405 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.135353 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.137609 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.137922 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:48:26.138236 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:48:26.138543 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:48:26.138844 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:48:26.139442 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.139691 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.139904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:48:26.233655 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.093 seconds
[0m20:48:26.234995 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.237288 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.239422 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.241408 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.241766 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:48:26.242148 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:48:26.242509 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:48:26.242843 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:48:26.243493 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.243768 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.244009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.250625 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:48:26.252787 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:48:26.253505 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:48:26.254262 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:48:26.254982 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:48:26.255294 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.255624 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.255952 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.256260 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.256550 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:48:26.256937 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:48:26.257261 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:48:26.257562 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:48:26.258500 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:48:26.262344 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:48:26.262564 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m20:48:26.262783 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m20:48:26.263036 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m20:48:26.264892 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:48:26.266351 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:48:26.267832 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:48:26.269262 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:48:26.269623 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:48:26.270104 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:48:26.270555 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:48:26.271051 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:48:26.271517 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:48:26.271921 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:48:26.272162 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:48:26.272463 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:48:26.274222 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:48:26.274449 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:48:26.274666 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m20:48:26.275796 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e975f40>]}
[0m20:48:26.276040 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:48:26.276780 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:48:26.277541 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:48:26.277980 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.20s]
[0m20:48:26.278747 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:48:26.279154 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95a4c0>]}
[0m20:48:26.279595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e975dc0>]}
[0m20:48:26.280025 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:48:26.280424 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95a5e0>]}
[0m20:48:26.280837 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.21s]
[0m20:48:26.281340 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.21s]
[0m20:48:26.281743 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:48:26.282207 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.21s]
[0m20:48:26.282685 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:48:26.283098 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:48:26.283433 [info ] [Thread-2  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:48:26.283903 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:48:26.284556 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:48:26.285070 [debug] [Thread-3  ]: Began running node model.matt_demo.kpi
[0m20:48:26.285297 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:48:26.285672 [info ] [Thread-3  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:48:26.287923 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:48:26.288310 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.kpi)
[0m20:48:26.288803 [debug] [Thread-3  ]: Began compiling node model.matt_demo.kpi
[0m20:48:26.291810 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:48:26.292226 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:48:26.304510 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:48:26.305148 [debug] [Thread-3  ]: Began executing node model.matt_demo.kpi
[0m20:48:26.307612 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:48:26.308203 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.308547 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:48:26.308866 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:48:26.309096 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:48:26.309413 [debug] [Thread-3  ]: On model.matt_demo.kpi: BEGIN
[0m20:48:26.309932 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:48:26.311393 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m20:48:26.311618 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m20:48:26.311908 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:48:26.312212 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.312546 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:48:26.312892 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:48:26.328051 [debug] [Thread-3  ]: SQL status: SELECT 8800 in 0.015 seconds
[0m20:48:26.330289 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:48:26.330692 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m20:48:26.331226 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.333889 [debug] [Thread-3  ]: On model.matt_demo.kpi: COMMIT
[0m20:48:26.334228 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:48:26.334527 [debug] [Thread-3  ]: On model.matt_demo.kpi: COMMIT
[0m20:48:26.336202 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m20:48:26.337762 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup"
[0m20:48:26.338988 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:48:26.339257 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m20:48:26.339615 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m20:48:26.340354 [debug] [Thread-3  ]: On model.matt_demo.kpi: Close
[0m20:48:26.340758 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e975d60>]}
[0m20:48:26.341216 [info ] [Thread-3  ]: 6 of 6 OK created sql table model dev_crm_sales_dbt.kpi ........................ [[32mSELECT 8800[0m in 0.05s]
[0m20:48:26.341723 [debug] [Thread-3  ]: Finished running node model.matt_demo.kpi
[0m20:48:26.442663 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.129 seconds
[0m20:48:26.445430 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.445760 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:48:26.446314 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.447957 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.448236 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:48:26.448606 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:48:26.449408 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:48:26.449690 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.449989 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:48:26.453311 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m20:48:26.454801 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:48:26.455198 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:48:26.455480 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:48:26.456689 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:48:26.457387 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:48:26.457780 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2c37dc-5313-4b0d-a596-8e3ee05f772a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e97f730>]}
[0m20:48:26.458212 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.17s]
[0m20:48:26.458724 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:48:26.459584 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.459843 [debug] [MainThread]: On master: BEGIN
[0m20:48:26.460064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:26.461564 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:48:26.461825 [debug] [MainThread]: On master: COMMIT
[0m20:48:26.462041 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:26.462261 [debug] [MainThread]: On master: COMMIT
[0m20:48:26.462535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:48:26.462766 [debug] [MainThread]: On master: Close
[0m20:48:26.463096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:26.463338 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m20:48:26.463556 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:48:26.463779 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:48:26.463960 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:48:26.464198 [info ] [MainThread]: 
[0m20:48:26.464514 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:48:26.465297 [debug] [MainThread]: Command end result
[0m20:48:26.491879 [info ] [MainThread]: 
[0m20:48:26.492313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:26.492615 [info ] [MainThread]: 
[0m20:48:26.492908 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:48:26.493496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93905795, "process_user_time": 2.49558, "process_kernel_time": 0.102753, "process_mem_max_rss": "131880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:26.493836 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:26.493793 after 0.94 seconds
[0m20:48:26.494131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7930f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e279a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77eaa520>]}
[0m20:48:26.494443 [debug] [MainThread]: Flushing usage events
[0m20:49:58.546157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc572e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1f2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1f2700>]}


============================== 20:49:58.550318 | d53e36ff-47c5-47c1-a983-eb9ed6081c3a ==============================
[0m20:49:58.550318 [info ] [MainThread]: Running with dbt=1.8.3
[0m20:49:58.550904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:58.629374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d31550>]}
[0m20:49:58.654129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3eb520>]}
[0m20:49:58.654956 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:49:58.667253 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m20:49:58.782523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:49:58.782986 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m20:49:58.783305 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/staging/crm_stg_accounts.sql
[0m20:49:58.899449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9241fa0>]}
[0m20:49:58.967071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b48700>]}
[0m20:49:58.967514 [info ] [MainThread]: Found 6 models, 6 data tests, 4 sources, 653 macros
[0m20:49:58.967849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ba6df0>]}
[0m20:49:58.968829 [info ] [MainThread]: 
[0m20:49:58.969372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:58.971791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:49:58.972208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:49:58.989362 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:49:58.989612 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:49:58.989954 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:49:58.990276 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:49:58.990576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:58.990861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:58.994056 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m20:49:58.994312 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:49:58.995000 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:49:58.995692 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:49:58.996859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m20:49:58.997187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m20:49:59.000720 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:49:59.002086 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:49:59.002412 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m20:49:59.002685 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m20:49:59.002938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:59.003171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:59.004857 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.005075 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.005320 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m20:49:59.005636 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m20:49:59.005927 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m20:49:59.006293 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m20:49:59.008069 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m20:49:59.008248 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m20:49:59.008887 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m20:49:59.009596 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m20:49:59.009970 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m20:49:59.010249 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m20:49:59.013460 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.013727 [debug] [MainThread]: On master: BEGIN
[0m20:49:59.013971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:59.015485 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.015743 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.016045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:59.021976 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m20:49:59.022661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b488e0>]}
[0m20:49:59.022983 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:59.023293 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.023545 [debug] [MainThread]: On master: BEGIN
[0m20:49:59.023926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:49:59.024233 [debug] [MainThread]: On master: COMMIT
[0m20:49:59.024471 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.024714 [debug] [MainThread]: On master: COMMIT
[0m20:49:59.025024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:59.025258 [debug] [MainThread]: On master: Close
[0m20:49:59.025594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:59.025952 [info ] [MainThread]: 
[0m20:49:59.030050 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m20:49:59.030305 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m20:49:59.030534 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m20:49:59.030749 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m20:49:59.031108 [info ] [Thread-1  ]: 1 of 6 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m20:49:59.031578 [info ] [Thread-2  ]: 2 of 6 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m20:49:59.032100 [info ] [Thread-3  ]: 3 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m20:49:59.032541 [info ] [Thread-4  ]: 4 of 6 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m20:49:59.033033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m20:49:59.033377 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m20:49:59.033762 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m20:49:59.034117 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m20:49:59.034517 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m20:49:59.034828 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m20:49:59.035164 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m20:49:59.035444 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m20:49:59.039832 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m20:49:59.041512 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m20:49:59.043950 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.045622 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.047223 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m20:49:59.047432 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m20:49:59.047937 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m20:49:59.048139 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m20:49:59.064830 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m20:49:59.066715 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m20:49:59.069103 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.070945 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.072372 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.072725 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.072930 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.073125 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m20:49:59.073510 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.073693 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m20:49:59.074021 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m20:49:59.074332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:59.074622 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m20:49:59.074919 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:49:59.075174 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:49:59.075610 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:49:59.077421 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.077669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m20:49:59.078035 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.078251 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.078465 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m20:49:59.078770 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.079041 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.079343 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m20:49:59.079607 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.079891 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue_mm,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m20:49:59.080190 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m20:49:59.080634 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m20:49:59.081666 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:49:59.085484 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.085702 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:49:59.085918 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:49:59.086145 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:49:59.086378 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m20:49:59.088172 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.089929 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.116754 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.118248 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m20:49:59.117647 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.117954 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m20:49:59.117384 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m20:49:59.120158 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.120386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:49:59.120954 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.121169 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m20:49:59.121360 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:59.123032 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.124582 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.126392 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.126615 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:49:59.126945 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m20:49:59.127581 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m20:49:59.127938 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m20:49:59.135700 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:49:59.136253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.136488 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.136910 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.137099 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.137849 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:49:59.138592 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:49:59.139273 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:49:59.139617 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m20:49:59.139966 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.140285 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.140568 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.141074 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m20:49:59.141395 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m20:49:59.141641 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m20:49:59.141914 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m20:49:59.142539 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m20:49:59.146295 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m20:49:59.146507 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m20:49:59.148129 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m20:49:59.148350 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m20:49:59.150329 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m20:49:59.151734 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m20:49:59.152129 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m20:49:59.153475 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m20:49:59.153774 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m20:49:59.154179 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m20:49:59.154489 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m20:49:59.154863 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m20:49:59.155314 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m20:49:59.155797 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:49:59.156037 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m20:49:59.156272 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:49:59.157611 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m20:49:59.157823 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:49:59.158652 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m20:49:59.158865 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m20:49:59.159808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2313700>]}
[0m20:49:59.160536 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m20:49:59.160930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22bf340>]}
[0m20:49:59.161638 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m20:49:59.162107 [info ] [Thread-2  ]: 2 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:49:59.162584 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22bf310>]}
[0m20:49:59.163019 [info ] [Thread-1  ]: 1 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m20:49:59.163487 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22bf370>]}
[0m20:49:59.163890 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m20:49:59.164330 [info ] [Thread-3  ]: 3 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m20:49:59.164796 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m20:49:59.165216 [info ] [Thread-4  ]: 4 of 6 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m20:49:59.165685 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m20:49:59.166135 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m20:49:59.166638 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m20:49:59.167003 [info ] [Thread-2  ]: 5 of 6 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m20:49:59.167718 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m20:49:59.167990 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m20:49:59.168335 [info ] [Thread-1  ]: 6 of 6 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m20:49:59.168700 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m20:49:59.169064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.kpi)
[0m20:49:59.170936 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m20:49:59.171275 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m20:49:59.174353 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m20:49:59.174924 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m20:49:59.185836 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m20:49:59.186200 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m20:49:59.188222 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m20:49:59.188714 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.189044 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m20:49:59.189310 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:49:59.189740 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.190038 [debug] [Thread-1  ]: On model.matt_demo.kpi: BEGIN
[0m20:49:59.190299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:49:59.191206 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.191462 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.191828 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m20:49:59.192108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.192476 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.192765 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m20:49:59.209016 [debug] [Thread-1  ]: SQL status: SELECT 8800 in 0.016 seconds
[0m20:49:59.211250 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.211557 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi" rename to "kpi__dbt_backup"
[0m20:49:59.212013 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.213729 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.214061 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m20:49:59.214482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.217268 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m20:49:59.217625 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.217954 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m20:49:59.220381 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m20:49:59.222877 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup"
[0m20:49:59.224328 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m20:49:59.224628 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m20:49:59.226978 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m20:49:59.227863 [debug] [Thread-1  ]: On model.matt_demo.kpi: Close
[0m20:49:59.228382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2242070>]}
[0m20:49:59.228921 [info ] [Thread-1  ]: 6 of 6 OK created sql table model dev_crm_sales_dbt.kpi ........................ [[32mSELECT 8800[0m in 0.06s]
[0m20:49:59.229535 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m20:49:59.331526 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.139 seconds
[0m20:49:59.334089 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.334564 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m20:49:59.335278 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.337065 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.337393 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:49:59.337839 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:49:59.338627 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:49:59.338944 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.339241 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m20:49:59.344536 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m20:49:59.346198 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m20:49:59.346619 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m20:49:59.347017 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m20:49:59.348349 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m20:49:59.349134 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m20:49:59.349586 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53e36ff-47c5-47c1-a983-eb9ed6081c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22638b0>]}
[0m20:49:59.350074 [info ] [Thread-2  ]: 5 of 6 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.18s]
[0m20:49:59.350613 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m20:49:59.351537 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.351807 [debug] [MainThread]: On master: BEGIN
[0m20:49:59.352027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:59.353608 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:49:59.353850 [debug] [MainThread]: On master: COMMIT
[0m20:49:59.354108 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:59.354331 [debug] [MainThread]: On master: COMMIT
[0m20:49:59.354588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:59.354837 [debug] [MainThread]: On master: Close
[0m20:49:59.355133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:59.355347 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m20:49:59.355566 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m20:49:59.355789 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m20:49:59.356017 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m20:49:59.356311 [info ] [MainThread]: 
[0m20:49:59.356647 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:49:59.357504 [debug] [MainThread]: Command end result
[0m20:49:59.388291 [info ] [MainThread]: 
[0m20:49:59.388749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:59.389081 [info ] [MainThread]: 
[0m20:49:59.389398 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:49:59.389986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86829144, "process_user_time": 2.419729, "process_kernel_time": 0.124552, "process_mem_max_rss": "124900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:59.390413 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:59.390362 after 0.87 seconds
[0m20:49:59.390691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc572e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d93e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d31550>]}
[0m20:49:59.390964 [debug] [MainThread]: Flushing usage events
[0m22:13:26.135103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e31730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e316d0>]}


============================== 22:13:26.138865 | e937b318-f361-4781-aa71-6faff79049c9 ==============================
[0m22:13:26.138865 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:13:26.139489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:26.222289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e937b318-f361-4781-aa71-6faff79049c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97923ee0>]}
[0m22:13:26.246337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e937b318-f361-4781-aa71-6faff79049c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7999a550>]}
[0m22:13:26.247234 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:13:26.259377 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:13:26.355492 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading matt_demo: crm_sales_data/crm_sales.yml - Runtime Error
    Syntax error near line 61
    ------------------------------
    58 |     description: "Fact model with high-level kpis"
    59 |     columns:
    60 |       - name: revenue
    61 |       tests: 
    62 |         - greater_zero
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 60, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 61, column 7
[0m22:13:26.356210 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.24710129, "process_user_time": 1.988447, "process_kernel_time": 0.10597, "process_mem_max_rss": "111004", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:13:26.356657 [debug] [MainThread]: Command `dbt compile` failed at 22:13:26.356601 after 0.25 seconds
[0m22:13:26.356942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975b40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975b4160>]}
[0m22:13:26.357179 [debug] [MainThread]: Flushing usage events
[0m22:14:06.067492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7c72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc26d0>]}


============================== 22:14:06.070740 | 13ace617-81da-47e9-a5be-29d5027bfeb4 ==============================
[0m22:14:06.070740 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:06.071286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:14:06.150222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998b3ee0>]}
[0m22:14:06.175503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b92afd0>]}
[0m22:14:06.176193 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:06.187730 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:14:06.306907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:14:06.307326 [debug] [MainThread]: Partial parsing: added file: matt_demo://tests/column_greater_zero.sql
[0m22:14:06.307703 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:14:06.386360 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:06.386913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae4b340>]}
[0m22:14:06.393216 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_kpi' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:14:06.425647 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.greater_zero_crm_kpi_revenue.fea98a5ab2' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_kpi' in package '' which was not found
[0m22:14:06.466458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971be130>]}
[0m22:14:06.542788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972019a0>]}
[0m22:14:06.543174 [info ] [MainThread]: Found 6 models, 7 data tests, 4 sources, 653 macros
[0m22:14:06.543534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97204ac0>]}
[0m22:14:06.544708 [info ] [MainThread]: 
[0m22:14:06.545237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:06.547590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:14:06.547972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:14:06.565862 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:06.566124 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:06.566471 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:14:06.566778 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:14:06.567081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:06.567383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:06.569759 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:14:06.569948 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:14:06.570216 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:06.570544 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:06.570854 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:14:06.571175 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:14:06.572969 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:14:06.573159 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:14:06.573860 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:14:06.574539 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:14:06.574930 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:14:06.575195 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:14:06.578566 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:06.578878 [debug] [MainThread]: On master: BEGIN
[0m22:14:06.579119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:06.580619 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:14:06.580867 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:06.581153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:06.586448 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:14:06.587152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ace617-81da-47e9-a5be-29d5027bfeb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972018e0>]}
[0m22:14:06.587453 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:06.587768 [debug] [MainThread]: On master: Close
[0m22:14:06.588108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:06.588456 [info ] [MainThread]: 
[0m22:14:06.592368 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:14:06.592611 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:14:06.592827 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:14:06.593057 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:14:06.593419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:14:06.593768 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:14:06.594150 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:14:06.594566 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:14:06.594888 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:14:06.595201 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:14:06.595539 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:14:06.595862 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:14:06.600322 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:14:06.602591 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:14:06.604349 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:14:06.606109 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:14:06.609959 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:14:06.610192 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:14:06.610566 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:14:06.610770 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:14:06.611157 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:14:06.611606 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:14:06.612043 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:14:06.612446 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:14:06.612763 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:14:06.613107 [debug] [Thread-2  ]: Began running node test.matt_demo.column_greater_zero
[0m22:14:06.613582 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:14:06.613816 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:14:06.614217 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:14:06.614543 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.column_greater_zero)
[0m22:14:06.614853 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:14:06.615189 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:14:06.615497 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:14:06.615776 [debug] [Thread-2  ]: Began compiling node test.matt_demo.column_greater_zero
[0m22:14:06.616059 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:14:06.616314 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:14:06.618001 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:14:06.619718 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.column_greater_zero"
[0m22:14:06.655939 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:14:06.660114 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:14:06.660753 [debug] [Thread-2  ]: Began executing node test.matt_demo.column_greater_zero
[0m22:14:06.661201 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:14:06.661576 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:14:06.662127 [debug] [Thread-2  ]: Finished running node test.matt_demo.column_greater_zero
[0m22:14:06.665014 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:14:06.665683 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:14:06.665873 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:14:06.666215 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:14:06.666762 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:14:06.667251 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:14:06.667603 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.column_greater_zero, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:14:06.667954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:14:06.668321 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:14:06.668584 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m22:14:06.668843 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:14:06.669121 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:14:06.669441 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:14:06.669749 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:14:06.672927 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:14:06.675268 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:14:06.675587 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:14:06.675901 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:14:06.680382 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:14:06.680624 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:14:06.681055 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:14:06.681272 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:14:06.681726 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:14:06.682157 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:14:06.682480 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:14:06.682843 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:14:06.683250 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:14:06.683766 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:14:06.684139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:14:06.684477 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:14:06.684733 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.004 seconds
[0m22:14:06.685058 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:14:06.685288 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:14:06.687397 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:14:06.689569 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:14:06.691675 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:14:06.691988 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:14:06.693935 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:14:06.693501 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:14:06.694347 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:14:06.694733 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:14:06.695157 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:14:06.695470 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:14:06.695945 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:14:06.696470 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:14:06.696996 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:14:06.697349 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:14:06.698327 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:14:06.698932 [debug] [Thread-4  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:14:06.699198 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:14:06.699543 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:14:06.700006 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:14:06.700709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:06.700946 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:14:06.701157 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800' was properly closed.
[0m22:14:06.701382 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:14:06.701615 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:14:06.702549 [debug] [MainThread]: Command end result
[0m22:14:06.734982 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6921723, "process_user_time": 2.390525, "process_kernel_time": 0.098856, "process_mem_max_rss": "128584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:06.735381 [debug] [MainThread]: Command `dbt compile` succeeded at 22:14:06.735330 after 0.69 seconds
[0m22:14:06.735648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7c72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4da850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b969c10>]}
[0m22:14:06.735873 [debug] [MainThread]: Flushing usage events
[0m22:14:19.992921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631b02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6174f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6174f7f0>]}


============================== 22:14:19.996204 | fbfb3b6b-6a36-4273-973c-92089eece5df ==============================
[0m22:14:19.996204 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:19.996740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m crm_kpi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:20.073632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbfb3b6b-6a36-4273-973c-92089eece5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8028fa30>]}
[0m22:14:20.097459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbfb3b6b-6a36-4273-973c-92089eece5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802827f0>]}
[0m22:14:20.098024 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:20.108068 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:14:20.230349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:20.230696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:20.258728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbfb3b6b-6a36-4273-973c-92089eece5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fedc130>]}
[0m22:14:20.336235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbfb3b6b-6a36-4273-973c-92089eece5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fda5df0>]}
[0m22:14:20.336610 [info ] [MainThread]: Found 6 models, 7 data tests, 4 sources, 653 macros
[0m22:14:20.336973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfb3b6b-6a36-4273-973c-92089eece5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe95be0>]}
[0m22:14:20.337438 [warn ] [MainThread]: The selection criterion 'crm_kpi' does not match any enabled nodes
[0m22:14:20.338115 [info ] [MainThread]: 
[0m22:14:20.338471 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:14:20.339696 [debug] [MainThread]: Command end result
[0m22:14:20.365304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.39695665, "process_user_time": 2.094382, "process_kernel_time": 0.066948, "process_mem_max_rss": "117372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:20.365704 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:20.365648 after 0.40 seconds
[0m22:14:20.366001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff631b02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61cef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80241670>]}
[0m22:14:20.366286 [debug] [MainThread]: Flushing usage events
[0m22:14:47.750347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ceb12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4af910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4af8b0>]}


============================== 22:14:47.753942 | d9e44e64-8f3d-45f3-b0a7-c7228831ff42 ==============================
[0m22:14:47.753942 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:47.754470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m kpi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:47.836346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f95460>]}
[0m22:14:47.860230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9fffc40>]}
[0m22:14:47.860787 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:47.872318 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:14:47.989687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:14:47.990198 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:14:48.017168 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:48.017615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ce3700>]}
[0m22:14:48.120275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9992fd0>]}
[0m22:14:48.194838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f10c10>]}
[0m22:14:48.195184 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:14:48.195505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb993bb80>]}
[0m22:14:48.196312 [info ] [MainThread]: 
[0m22:14:48.196874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:48.197537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:14:48.214783 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:14:48.215270 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:14:48.215602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:48.218079 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m22:14:48.218786 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:14:48.221160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m22:14:48.221557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:14:48.224766 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:48.226053 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:48.226383 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:14:48.226680 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:14:48.226997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:48.227284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:48.229345 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:14:48.229558 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:14:48.229835 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:48.230153 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:48.230457 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:14:48.230785 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:14:48.232412 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:14:48.232607 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:14:48.233339 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:14:48.234006 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:14:48.234405 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:14:48.234688 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:14:48.238074 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.238360 [debug] [MainThread]: On master: BEGIN
[0m22:14:48.238605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:48.240159 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:14:48.240417 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.240705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:48.246068 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:14:48.246823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c1f520>]}
[0m22:14:48.247219 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:48.247597 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.248336 [debug] [MainThread]: On master: BEGIN
[0m22:14:48.248787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:48.249079 [debug] [MainThread]: On master: COMMIT
[0m22:14:48.249328 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.249539 [debug] [MainThread]: On master: COMMIT
[0m22:14:48.249882 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:48.250151 [debug] [MainThread]: On master: Close
[0m22:14:48.250469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:48.250865 [info ] [MainThread]: 
[0m22:14:48.254992 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:14:48.255395 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m22:14:48.255866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.kpi)
[0m22:14:48.256179 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:14:48.261414 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:14:48.263274 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:14:48.281415 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m22:14:48.282763 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.283054 [debug] [Thread-1  ]: On model.matt_demo.kpi: BEGIN
[0m22:14:48.283315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:14:48.285265 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:14:48.285523 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.285833 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
  
[0m22:14:48.303041 [debug] [Thread-1  ]: SQL status: SELECT 8800 in 0.017 seconds
[0m22:14:48.306522 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.306816 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi" rename to "kpi__dbt_backup"
[0m22:14:48.307344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:48.309010 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.309296 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m22:14:48.309663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:48.318454 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:14:48.318761 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.319037 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:14:48.321065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:14:48.324623 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup"
[0m22:14:48.326465 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:14:48.326730 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m22:14:48.328338 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:14:48.329510 [debug] [Thread-1  ]: On model.matt_demo.kpi: Close
[0m22:14:48.330347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e44e64-8f3d-45f3-b0a7-c7228831ff42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94c9d30>]}
[0m22:14:48.330767 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt.kpi ........................ [[32mSELECT 8800[0m in 0.07s]
[0m22:14:48.331234 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:14:48.332072 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.332340 [debug] [MainThread]: On master: BEGIN
[0m22:14:48.332578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:48.334210 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:14:48.334453 [debug] [MainThread]: On master: COMMIT
[0m22:14:48.334642 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:48.334822 [debug] [MainThread]: On master: COMMIT
[0m22:14:48.335101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:48.335321 [debug] [MainThread]: On master: Close
[0m22:14:48.335594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:48.335819 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m22:14:48.336049 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:14:48.336289 [info ] [MainThread]: 
[0m22:14:48.336609 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:14:48.337064 [debug] [MainThread]: Command end result
[0m22:14:48.389906 [info ] [MainThread]: 
[0m22:14:48.390341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:48.390649 [info ] [MainThread]: 
[0m22:14:48.390972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:14:48.391570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66597676, "process_user_time": 2.356523, "process_kernel_time": 0.11255, "process_mem_max_rss": "128020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:48.391964 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:48.391913 after 0.67 seconds
[0m22:14:48.392249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ceb12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dbb3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb2ebe0>]}
[0m22:14:48.392499 [debug] [MainThread]: Flushing usage events
[0m22:14:54.314312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864fc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84af9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84af97f0>]}


============================== 22:14:54.317679 | 4d32fa6e-bf62-40b7-90f2-0097ca42df8f ==============================
[0m22:14:54.317679 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:54.318213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test -m kpi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:54.393613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35eaa30>]}
[0m22:14:54.418316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35df7f0>]}
[0m22:14:54.419036 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:54.430935 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:14:54.545093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:54.545439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:54.573638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa323a130>]}
[0m22:14:54.652859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2fc8550>]}
[0m22:14:54.653257 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:14:54.653663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31f4e20>]}
[0m22:14:54.654441 [info ] [MainThread]: 
[0m22:14:54.654935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:54.657152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:14:54.657515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:14:54.674948 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:54.675193 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:54.675502 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:14:54.675815 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:14:54.676101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:54.676393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:54.678699 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:14:54.678926 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:14:54.679207 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:14:54.679507 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:14:54.679812 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:14:54.680130 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:14:54.681534 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:14:54.681718 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:14:54.682444 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:14:54.683128 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:14:54.683512 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:14:54.683788 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:14:54.687060 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.687345 [debug] [MainThread]: On master: BEGIN
[0m22:14:54.687575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:54.689106 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:14:54.689351 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.689627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:54.694855 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:14:54.695660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d32fa6e-bf62-40b7-90f2-0097ca42df8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864d1be0>]}
[0m22:14:54.696030 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:54.696384 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.696663 [debug] [MainThread]: On master: BEGIN
[0m22:14:54.697171 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:54.697473 [debug] [MainThread]: On master: COMMIT
[0m22:14:54.697749 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.698058 [debug] [MainThread]: On master: COMMIT
[0m22:14:54.698381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:54.698676 [debug] [MainThread]: On master: Close
[0m22:14:54.699079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:54.699479 [info ] [MainThread]: 
[0m22:14:54.705383 [debug] [Thread-1  ]: Began running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:14:54.705889 [info ] [Thread-1  ]: 1 of 1 START test greater_zero_kpi_revenue ..................................... [RUN]
[0m22:14:54.706483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9)
[0m22:14:54.706899 [debug] [Thread-1  ]: Began compiling node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:14:54.716108 [debug] [Thread-1  ]: Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:14:54.716667 [error] [Thread-1  ]: 1 of 1 ERROR greater_zero_kpi_revenue .......................................... [[31mERROR[0m in 0.01s]
[0m22:14:54.717365 [debug] [Thread-1  ]: Finished running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:14:54.718404 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.718725 [debug] [MainThread]: On master: BEGIN
[0m22:14:54.719078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:54.721160 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:14:54.721498 [debug] [MainThread]: On master: COMMIT
[0m22:14:54.721812 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:54.722148 [debug] [MainThread]: On master: COMMIT
[0m22:14:54.722521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:54.722838 [debug] [MainThread]: On master: Close
[0m22:14:54.723272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:54.723562 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m22:14:54.723836 [debug] [MainThread]: Connection 'test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9' was properly closed.
[0m22:14:54.724171 [info ] [MainThread]: 
[0m22:14:54.724511 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m22:14:54.725142 [debug] [MainThread]: Command end result
[0m22:14:54.761307 [info ] [MainThread]: 
[0m22:14:54.763050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:14:54.763397 [info ] [MainThread]: 
[0m22:14:54.763736 [error] [MainThread]:   Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:14:54.764058 [info ] [MainThread]: 
[0m22:14:54.764346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:14:54.764930 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.47512746, "process_user_time": 2.18019, "process_kernel_time": 0.082271, "process_mem_max_rss": "125456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:54.765294 [debug] [MainThread]: Command `dbt test` failed at 22:14:54.765247 after 0.48 seconds
[0m22:14:54.765565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864fc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35df7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2fde6a0>]}
[0m22:14:54.765866 [debug] [MainThread]: Flushing usage events
[0m22:15:25.632993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff636bc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff636bc7f0>]}


============================== 22:15:25.636353 | 014855f1-65cd-4161-855c-f8a23de484b0 ==============================
[0m22:15:25.636353 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:25.636868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -m kpi', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:25.714441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f2b8b0>]}
[0m22:15:25.737617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6390cf10>]}
[0m22:15:25.738158 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:25.748304 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:15:25.870980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:25.871483 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:15:25.966199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:25.966730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd72760>]}
[0m22:15:26.057038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa27130>]}
[0m22:15:26.136378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a792dc0>]}
[0m22:15:26.136828 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:15:26.137241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9d7190>]}
[0m22:15:26.138001 [info ] [MainThread]: 
[0m22:15:26.138471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:26.140745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:15:26.141123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:15:26.158905 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:26.159176 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:26.159519 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:15:26.159846 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:15:26.160139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:26.160469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:26.162911 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:26.163154 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:26.163471 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:26.163816 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:26.164163 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:15:26.164572 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:15:26.166237 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:15:26.166422 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:15:26.167213 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:15:26.168003 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:15:26.168455 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:15:26.168738 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:15:26.172312 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.172618 [debug] [MainThread]: On master: BEGIN
[0m22:15:26.172897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:26.174612 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:26.174902 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.175232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:26.180477 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:15:26.181250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '014855f1-65cd-4161-855c-f8a23de484b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf60bb0>]}
[0m22:15:26.181591 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:26.181940 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.182208 [debug] [MainThread]: On master: BEGIN
[0m22:15:26.182582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:26.182837 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.183078 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.183312 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.183624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:26.183868 [debug] [MainThread]: On master: Close
[0m22:15:26.184199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:26.184557 [info ] [MainThread]: 
[0m22:15:26.188524 [debug] [Thread-1  ]: Began running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:15:26.188871 [info ] [Thread-1  ]: 1 of 1 START test column_greater_zero_kpi_revenue .............................. [RUN]
[0m22:15:26.189328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8)
[0m22:15:26.189649 [debug] [Thread-1  ]: Began compiling node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:15:26.195210 [debug] [Thread-1  ]: Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:26.195617 [error] [Thread-1  ]: 1 of 1 ERROR column_greater_zero_kpi_revenue ................................... [[31mERROR[0m in 0.01s]
[0m22:15:26.196111 [debug] [Thread-1  ]: Finished running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:15:26.196968 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.197323 [debug] [MainThread]: On master: BEGIN
[0m22:15:26.197569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:26.199323 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:26.199574 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.199817 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:26.200051 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.200370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:26.200653 [debug] [MainThread]: On master: Close
[0m22:15:26.200968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:26.201247 [debug] [MainThread]: Connection 'list_company_dw_dev_global_dim' was properly closed.
[0m22:15:26.201492 [debug] [MainThread]: Connection 'test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8' was properly closed.
[0m22:15:26.201768 [info ] [MainThread]: 
[0m22:15:26.202144 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m22:15:26.202630 [debug] [MainThread]: Command end result
[0m22:15:26.259302 [info ] [MainThread]: 
[0m22:15:26.259768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:15:26.260086 [info ] [MainThread]: 
[0m22:15:26.260427 [error] [MainThread]:   Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:26.260708 [info ] [MainThread]: 
[0m22:15:26.261009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:15:26.261571 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.65309244, "process_user_time": 2.34582, "process_kernel_time": 0.083313, "process_mem_max_rss": "137344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:26.261881 [debug] [MainThread]: Command `dbt test` failed at 22:15:26.261842 after 0.65 seconds
[0m22:15:26.262207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650bf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64209a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d013fd0>]}
[0m22:15:26.262505 [debug] [MainThread]: Flushing usage events
[0m22:15:53.477065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eab32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0b17f0>]}


============================== 22:15:53.481478 | 968b3178-898c-4e3d-9e49-0c73dfd10170 ==============================
[0m22:15:53.481478 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:53.481977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test -m kpi', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:53.558885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabba0040>]}
[0m22:15:53.582384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb977f0>]}
[0m22:15:53.582906 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:53.594459 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:15:53.722325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:53.723059 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:15:53.821348 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:53.821963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab790370>]}
[0m22:15:53.973310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa889b130>]}
[0m22:15:54.056677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61c9dc0>]}
[0m22:15:54.057091 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:15:54.057466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa640a190>]}
[0m22:15:54.058330 [info ] [MainThread]: 
[0m22:15:54.058803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:54.061089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:15:54.061423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:15:54.080059 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:54.080334 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:54.080687 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:15:54.081010 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:15:54.081334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:54.081630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:54.084692 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:54.084896 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:15:54.085202 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:54.085516 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:54.085834 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:15:54.086163 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:15:54.087960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:15:54.088175 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:54.088932 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:15:54.089636 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:15:54.090053 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:15:54.090330 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:15:54.093757 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.094056 [debug] [MainThread]: On master: BEGIN
[0m22:15:54.094306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:54.095899 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:54.096177 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.096480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:54.101756 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:15:54.102455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '968b3178-898c-4e3d-9e49-0c73dfd10170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89eda30>]}
[0m22:15:54.102757 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:54.103086 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.103356 [debug] [MainThread]: On master: BEGIN
[0m22:15:54.103741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:54.103998 [debug] [MainThread]: On master: COMMIT
[0m22:15:54.104286 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.104513 [debug] [MainThread]: On master: COMMIT
[0m22:15:54.104800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:54.105040 [debug] [MainThread]: On master: Close
[0m22:15:54.105357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:54.105689 [info ] [MainThread]: 
[0m22:15:54.109708 [debug] [Thread-1  ]: Began running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:15:54.110073 [info ] [Thread-1  ]: 1 of 1 START test greater_zero_kpi_revenue ..................................... [RUN]
[0m22:15:54.110579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9)
[0m22:15:54.110906 [debug] [Thread-1  ]: Began compiling node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:15:54.116711 [debug] [Thread-1  ]: Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:54.117253 [error] [Thread-1  ]: 1 of 1 ERROR greater_zero_kpi_revenue .......................................... [[31mERROR[0m in 0.01s]
[0m22:15:54.117800 [debug] [Thread-1  ]: Finished running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:15:54.118730 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.119115 [debug] [MainThread]: On master: BEGIN
[0m22:15:54.119424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:54.121443 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:54.121726 [debug] [MainThread]: On master: COMMIT
[0m22:15:54.121980 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:54.122258 [debug] [MainThread]: On master: COMMIT
[0m22:15:54.122575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:54.122823 [debug] [MainThread]: On master: Close
[0m22:15:54.123130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:54.123377 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m22:15:54.123622 [debug] [MainThread]: Connection 'test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9' was properly closed.
[0m22:15:54.123898 [info ] [MainThread]: 
[0m22:15:54.124306 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m22:15:54.124815 [debug] [MainThread]: Command end result
[0m22:15:54.181912 [info ] [MainThread]: 
[0m22:15:54.182355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:15:54.182668 [info ] [MainThread]: 
[0m22:15:54.182993 [error] [MainThread]:   Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:15:54.183332 [info ] [MainThread]: 
[0m22:15:54.183649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:15:54.184243 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.73140657, "process_user_time": 2.43245, "process_kernel_time": 0.094679, "process_mem_max_rss": "137744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:54.184626 [debug] [MainThread]: Command `dbt test` failed at 22:15:54.184575 after 0.73 seconds
[0m22:15:54.184890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eab32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab723790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab723bb0>]}
[0m22:15:54.185118 [debug] [MainThread]: Flushing usage events
[0m22:16:03.020443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3e72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d9e2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d9e2700>]}


============================== 22:16:03.023666 | 4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1 ==============================
[0m22:16:03.023666 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:16:03.024204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:03.100777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c521850>]}
[0m22:16:03.124272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5da1da30>]}
[0m22:16:03.124858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:16:03.136434 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:16:03.254103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:03.254447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:03.282831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c124130>]}
[0m22:16:03.358707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c10d850>]}
[0m22:16:03.359094 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:16:03.359408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0dcca0>]}
[0m22:16:03.360480 [info ] [MainThread]: 
[0m22:16:03.360967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:03.363399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:16:03.363815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:16:03.380829 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:16:03.381076 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:16:03.381384 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:16:03.381719 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:16:03.382055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:03.382360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:03.384688 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:16:03.384881 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:16:03.385187 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:16:03.385480 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:16:03.385786 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:16:03.386085 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:16:03.387452 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:16:03.387630 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:16:03.388363 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:16:03.389042 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:16:03.389395 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:16:03.389691 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:16:03.393208 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:03.393471 [debug] [MainThread]: On master: BEGIN
[0m22:16:03.393709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:03.395120 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:16:03.395373 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:03.395658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:16:03.400513 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:16:03.401227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e6ec56b-0c24-4e39-af6c-b15c5dc45ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0b4070>]}
[0m22:16:03.401535 [debug] [MainThread]: On master: ROLLBACK
[0m22:16:03.401846 [debug] [MainThread]: On master: Close
[0m22:16:03.402173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:03.402530 [info ] [MainThread]: 
[0m22:16:03.406464 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:16:03.406691 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:16:03.406902 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:03.407202 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:16:03.407545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m22:16:03.407905 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:16:03.408311 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:16:03.408714 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:16:03.409072 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:16:03.409399 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:16:03.409719 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:03.410074 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:16:03.414479 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:16:03.416286 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:16:03.418021 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:16:03.419736 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:16:03.421330 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:16:03.421543 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:16:03.422071 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:03.422495 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:16:03.422814 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:16:03.423155 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:16:03.423578 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:03.423955 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:16:03.424409 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:16:03.424720 [debug] [Thread-2  ]: Began running node test.matt_demo.column_greater_zero
[0m22:16:03.425155 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:03.425448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:16:03.425751 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:03.426173 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.column_greater_zero)
[0m22:16:03.426466 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:16:03.426746 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:16:03.427029 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:16:03.427312 [debug] [Thread-2  ]: Began compiling node test.matt_demo.column_greater_zero
[0m22:16:03.427576 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:03.429755 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:16:03.430063 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:03.431665 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.column_greater_zero"
[0m22:16:03.444332 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:03.448610 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:16:03.449008 [debug] [Thread-2  ]: Began executing node test.matt_demo.column_greater_zero
[0m22:16:03.449368 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:16:03.449564 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:16:03.450866 [debug] [Thread-2  ]: Finished running node test.matt_demo.column_greater_zero
[0m22:16:03.451352 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:16:03.451671 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:03.451875 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:16:03.452211 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:03.452549 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:16:03.452954 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:03.453465 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.column_greater_zero, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:16:03.453817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:16:03.454186 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:03.455362 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:16:03.454827 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:16:03.455075 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:16:03.454501 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:03.455610 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:03.458464 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:16:03.458795 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:03.461883 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:16:03.465162 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:03.466223 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:16:03.467024 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:16:03.467247 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:16:03.467732 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:03.469030 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:03.468576 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:16:03.468279 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:16:03.469371 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:03.469947 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:03.470416 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:16:03.470807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:16:03.471148 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:03.471386 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.003 seconds
[0m22:16:03.471591 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:16:03.471864 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:03.474008 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:16:03.475995 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:03.476330 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:03.479135 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:16:03.480612 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:16:03.480850 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:03.481313 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:03.481835 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:03.482272 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:03.482534 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:16:03.482864 [debug] [Thread-2  ]: Began running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:16:03.483328 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:03.483687 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:16:03.483929 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9)
[0m22:16:03.484154 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:16:03.484700 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:03.484965 [debug] [Thread-2  ]: Began compiling node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:16:03.485907 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:03.489230 [debug] [Thread-2  ]: Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:16:03.489454 [debug] [Thread-4  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:03.489773 [debug] [Thread-2  ]: Finished running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:16:03.490045 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:16:03.490529 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:16:03.490982 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:03.491370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:03.491762 [debug] [MainThread]: Connection 'test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9' was properly closed.
[0m22:16:03.492038 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:16:03.492332 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:16:03.492572 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:16:03.492902 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:16:03.493808 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.49829987, "process_user_time": 2.212269, "process_kernel_time": 0.099869, "process_mem_max_rss": "121624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:16:03.494276 [debug] [MainThread]: Command `dbt compile` failed at 22:16:03.494205 after 0.50 seconds
[0m22:16:03.494587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3e72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0dcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc24f10>]}
[0m22:16:03.494867 [debug] [MainThread]: Flushing usage events
[0m22:17:59.340636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988d92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ed4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ed45b0>]}


============================== 22:17:59.344566 | 61ab761c-2e32-4875-a4d4-ca4fa4dad8cf ==============================
[0m22:17:59.344566 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:17:59.345101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:59.426274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98796100>]}
[0m22:17:59.450843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59dd8b0>]}
[0m22:17:59.451545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:17:59.462636 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:17:59.587821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:59.588194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:59.617958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5616130>]}
[0m22:17:59.696649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5562eb0>]}
[0m22:17:59.697059 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:17:59.697410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55cebb0>]}
[0m22:17:59.698515 [info ] [MainThread]: 
[0m22:17:59.699015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:59.701301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:17:59.701681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:17:59.719998 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:17:59.720243 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:17:59.720564 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:17:59.720886 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:17:59.721196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:59.721501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:59.724070 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:17:59.724278 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:17:59.724567 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:17:59.724886 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:17:59.725196 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:17:59.725537 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:17:59.727317 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:17:59.727509 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:17:59.728265 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:17:59.728986 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:17:59.729343 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:17:59.729638 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:17:59.733276 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:59.733548 [debug] [MainThread]: On master: BEGIN
[0m22:17:59.733790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:59.735359 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:17:59.735632 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:59.735915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:17:59.741147 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:17:59.741872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ab761c-2e32-4875-a4d4-ca4fa4dad8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a1da30>]}
[0m22:17:59.742182 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:59.742510 [debug] [MainThread]: On master: Close
[0m22:17:59.742890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:59.743241 [info ] [MainThread]: 
[0m22:17:59.747275 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:17:59.747531 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:17:59.747793 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:17:59.748080 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:17:59.748330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:17:59.748758 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:17:59.749150 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:17:59.749593 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:17:59.749926 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:17:59.750257 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:17:59.750573 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:17:59.750893 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:17:59.755314 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:17:59.757242 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:17:59.759301 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:17:59.761299 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:17:59.763096 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:17:59.763314 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:17:59.763977 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:17:59.764328 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:17:59.764706 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:17:59.764912 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:17:59.765231 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:17:59.765724 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:17:59.766082 [debug] [Thread-2  ]: Began running node test.matt_demo.column_greater_zero
[0m22:17:59.766562 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:17:59.766867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:17:59.767420 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:17:59.767671 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.column_greater_zero)
[0m22:17:59.768010 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:17:59.768369 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:17:59.768708 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:17:59.769010 [debug] [Thread-2  ]: Began compiling node test.matt_demo.column_greater_zero
[0m22:17:59.769328 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:17:59.771820 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:17:59.772141 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:17:59.774100 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.column_greater_zero"
[0m22:17:59.774436 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:17:59.787181 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:17:59.787556 [debug] [Thread-2  ]: Began executing node test.matt_demo.column_greater_zero
[0m22:17:59.787924 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:17:59.792458 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:17:59.792796 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:17:59.793243 [debug] [Thread-2  ]: Finished running node test.matt_demo.column_greater_zero
[0m22:17:59.793656 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:17:59.794061 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:17:59.794760 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:17:59.795171 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:17:59.795377 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:17:59.795939 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.column_greater_zero, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:17:59.796297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:17:59.796775 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:17:59.797064 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:17:59.797396 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:17:59.797625 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m22:17:59.797949 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:17:59.801236 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:17:59.803477 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:17:59.803833 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:17:59.804203 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:17:59.805437 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:17:59.805726 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:17:59.806074 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:17:59.806431 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:17:59.811362 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:17:59.810710 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:17:59.810954 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.004 seconds
[0m22:17:59.806900 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:17:59.811645 [debug] [Thread-1  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:17:59.812070 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:17:59.814230 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:17:59.814590 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:17:59.814981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:17:59.815287 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:17:59.816064 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:17:59.816370 [debug] [Thread-1  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:17:59.816716 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:17:59.817091 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:17:59.819420 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:17:59.819797 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:17:59.820025 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m22:17:59.822555 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:17:59.823470 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:17:59.823721 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:17:59.824065 [debug] [Thread-1  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:17:59.824675 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:17:59.825016 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:17:59.825340 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:17:59.825774 [debug] [Thread-1  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:17:59.826116 [debug] [Thread-3  ]: Began running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:17:59.826731 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:17:59.827200 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471, now test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9)
[0m22:17:59.827774 [debug] [Thread-3  ]: Began compiling node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:17:59.830071 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.004 seconds
[0m22:17:59.831345 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:17:59.832188 [debug] [Thread-3  ]: Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:17:59.832421 [debug] [Thread-4  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:17:59.832806 [debug] [Thread-3  ]: Finished running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:17:59.833120 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:17:59.833697 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:17:59.834163 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:17:59.834545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:59.834881 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:17:59.835112 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800' was properly closed.
[0m22:17:59.835320 [debug] [MainThread]: Connection 'test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9' was properly closed.
[0m22:17:59.835531 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:17:59.835841 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:17:59.836443 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5209894, "process_user_time": 2.189726, "process_kernel_time": 0.11953, "process_mem_max_rss": "124420", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:59.836867 [debug] [MainThread]: Command `dbt compile` failed at 22:17:59.836815 after 0.52 seconds
[0m22:17:59.837161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988d92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50fff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55cea60>]}
[0m22:17:59.837437 [debug] [MainThread]: Flushing usage events
[0m22:21:01.712378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9448e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9448e700>]}


============================== 22:21:01.716282 | 0f2c2e77-643e-4190-8b27-664846edf78b ==============================
[0m22:21:01.716282 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:21:01.716897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:01.807759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f7e7f0>]}
[0m22:21:01.834682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94687520>]}
[0m22:21:01.835605 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:01.848375 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:21:01.993222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:01.993973 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:21:02.095179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:21:02.095765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b347c0>]}
[0m22:21:02.183928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad83a130>]}
[0m22:21:02.264325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0adfc10>]}
[0m22:21:02.264744 [info ] [MainThread]: Found 6 models, 8 data tests, 4 sources, 653 macros
[0m22:21:02.265111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944b5bb0>]}
[0m22:21:02.266359 [info ] [MainThread]: 
[0m22:21:02.266858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:02.269217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:21:02.269579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:21:02.287132 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:02.287385 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:02.287697 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:21:02.288012 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:21:02.288308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:02.288598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:02.291829 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:21:02.292041 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:21:02.292343 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:02.292670 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:02.292977 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:21:02.293373 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:21:02.295271 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:21:02.295454 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:21:02.296136 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:21:02.296844 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:21:02.297264 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:21:02.297537 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:21:02.301166 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:02.301473 [debug] [MainThread]: On master: BEGIN
[0m22:21:02.301736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:02.303235 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:21:02.303536 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:02.303845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:02.309235 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:21:02.309901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2c2e77-643e-4190-8b27-664846edf78b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e68eb0>]}
[0m22:21:02.310278 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:02.310665 [debug] [MainThread]: On master: Close
[0m22:21:02.311031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:02.311438 [info ] [MainThread]: 
[0m22:21:02.315811 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:21:02.316058 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:21:02.316291 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:02.316522 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:21:02.316861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:21:02.317242 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:21:02.317649 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:21:02.318030 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:21:02.318429 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:21:02.318754 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:21:02.319074 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:02.319447 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:21:02.323715 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:21:02.325375 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:21:02.327342 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:21:02.329035 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:21:02.331434 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:21:02.331678 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:21:02.332011 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:02.332463 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:21:02.332691 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:21:02.333107 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:21:02.333546 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:02.333878 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:21:02.334347 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:21:02.334672 [debug] [Thread-2  ]: Began running node test.matt_demo.column_greater_zero
[0m22:21:02.335202 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:02.335447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:21:02.335828 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:02.336273 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.column_greater_zero)
[0m22:21:02.336703 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:21:02.337035 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:21:02.337367 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:21:02.337675 [debug] [Thread-2  ]: Began compiling node test.matt_demo.column_greater_zero
[0m22:21:02.337984 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:02.340286 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:21:02.340608 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:02.367880 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.column_greater_zero"
[0m22:21:02.379228 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:02.383638 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:21:02.384039 [debug] [Thread-2  ]: Began executing node test.matt_demo.column_greater_zero
[0m22:21:02.384393 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:21:02.384592 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:21:02.385327 [debug] [Thread-2  ]: Finished running node test.matt_demo.column_greater_zero
[0m22:21:02.386071 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:21:02.386494 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:21:02.386687 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:02.387050 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:02.387446 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:21:02.388271 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:02.388781 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.column_greater_zero, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:21:02.389332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:21:02.389891 [debug] [Thread-4  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:02.390257 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m22:21:02.390528 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:02.391145 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:21:02.391656 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:21:02.392017 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:02.396102 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:21:02.398206 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:21:02.398614 [debug] [Thread-4  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:02.398983 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:02.403045 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:02.403429 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:02.403836 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:21:02.404056 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:21:02.404552 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:02.404882 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:21:02.405420 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:21:02.405864 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:02.406470 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:02.406883 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:21:02.407243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:21:02.407490 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.004 seconds
[0m22:21:02.407847 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:02.408081 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:21:02.408371 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:02.410491 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:02.412843 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:21:02.413198 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:02.415275 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:21:02.416617 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:02.417119 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:02.417493 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:02.417903 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:21:02.418130 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:02.418608 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:02.419001 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:21:02.419363 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:02.419715 [debug] [Thread-2  ]: Began running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:02.420248 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:02.420512 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:21:02.420923 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8)
[0m22:21:02.422073 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:02.422406 [debug] [Thread-2  ]: Began compiling node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:02.426183 [debug] [Thread-4  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:02.426561 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:21:02.427030 [debug] [Thread-4  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:21:02.427431 [debug] [Thread-2  ]: Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:02.427909 [debug] [Thread-4  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:02.428368 [debug] [Thread-2  ]: Finished running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:02.428949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:02.429268 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:21:02.429540 [debug] [MainThread]: Connection 'test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8' was properly closed.
[0m22:21:02.429779 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:21:02.429991 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:21:02.430295 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:02.430933 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.7469987, "process_user_time": 2.51156, "process_kernel_time": 0.148099, "process_mem_max_rss": "139064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:02.431331 [debug] [MainThread]: Command `dbt compile` failed at 22:21:02.431276 after 0.75 seconds
[0m22:21:02.431629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e932e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7ed370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccc8a30>]}
[0m22:21:02.431905 [debug] [MainThread]: Flushing usage events
[0m22:21:18.270305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829be2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fb8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fb86d0>]}


============================== 22:21:18.273683 | d0325b1f-d926-4537-b083-ceac0d44dda5 ==============================
[0m22:21:18.273683 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:21:18.274245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:21:18.350237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9faaaee0>]}
[0m22:21:18.373237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b22550>]}
[0m22:21:18.373889 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:18.386059 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:21:18.505491 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:21:18.505910 [debug] [MainThread]: Partial parsing: added file: matt_demo://macros/column_greater_zero.sql
[0m22:21:18.506159 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://tests/column_greater_zero.sql
[0m22:21:18.555333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f669130>]}
[0m22:21:18.623534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8653a0>]}
[0m22:21:18.623885 [info ] [MainThread]: Found 6 models, 7 data tests, 4 sources, 654 macros
[0m22:21:18.624257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f69ae20>]}
[0m22:21:18.625288 [info ] [MainThread]: 
[0m22:21:18.625756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:18.628090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:21:18.628592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:21:18.645829 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:18.646089 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:18.646403 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:21:18.646704 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:21:18.647036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:18.647323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:18.649740 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:21:18.649936 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:21:18.650198 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:18.650518 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:18.650811 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:21:18.651140 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:21:18.652545 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:21:18.652740 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:21:18.653449 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:21:18.654174 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:21:18.654558 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:21:18.654851 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:21:18.658222 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:18.658523 [debug] [MainThread]: On master: BEGIN
[0m22:21:18.658773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:18.660269 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:21:18.660540 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:18.660841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:18.665756 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:21:18.666529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0325b1f-d926-4537-b083-ceac0d44dda5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9aa910>]}
[0m22:21:18.666842 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:18.667159 [debug] [MainThread]: On master: Close
[0m22:21:18.667517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:18.667867 [info ] [MainThread]: 
[0m22:21:18.671790 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:21:18.672028 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:21:18.672241 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:18.672537 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:21:18.672832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:21:18.673202 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:21:18.673599 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:21:18.673987 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:21:18.674314 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:21:18.674657 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:21:18.674972 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:18.675297 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:21:18.679587 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:21:18.681717 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:21:18.683525 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:21:18.685225 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:21:18.686761 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:21:18.687002 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:21:18.687347 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:18.687703 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:21:18.688034 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:21:18.688416 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:21:18.688886 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:18.689217 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:21:18.689746 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:21:18.690455 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:18.690666 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:18.690890 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:21:18.691217 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:18.691604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:21:18.691927 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:21:18.692191 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:21:18.692502 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:21:18.692797 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:18.693076 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:18.694771 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:21:18.695100 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:18.708024 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:18.712150 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:21:18.715448 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:21:18.715813 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:21:18.716209 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:21:18.716905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:21:18.717234 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:18.717618 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:21:18.717815 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:18.718477 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:18.718799 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m22:21:18.719289 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:18.719630 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:18.719987 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:21:18.720200 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:21:18.720458 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:18.720763 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:21:18.721043 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m22:21:18.721296 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:18.721711 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:21:18.722014 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:18.724276 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:21:18.724612 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:18.724913 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:18.728932 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:18.732091 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:21:18.732559 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m22:21:18.732786 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m22:21:18.732998 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:21:18.733805 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m22:21:18.735990 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:18.736337 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:18.736555 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:21:18.736956 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:18.738497 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:18.739295 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:18.740815 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m22:21:18.741533 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:21:18.741978 [debug] [Thread-4  ]: Began running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:18.742312 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:21:18.742682 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:18.742991 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:18.743334 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8)
[0m22:21:18.743729 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:21:18.743952 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:18.746345 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:21:18.747417 [debug] [Thread-4  ]: Began compiling node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:18.747916 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:18.751281 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:21:18.751793 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:18.753152 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:18.753591 [debug] [Thread-4  ]: Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:18.754067 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:18.754698 [debug] [Thread-4  ]: Finished running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:18.755071 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:18.755696 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:21:18.756032 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:21:18.756467 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:18.756900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:18.760419 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:21:18.760699 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:21:18.760950 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:21:18.761189 [debug] [MainThread]: Connection 'test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8' was properly closed.
[0m22:21:18.761521 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:18.762154 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5172211, "process_user_time": 2.233778, "process_kernel_time": 0.084775, "process_mem_max_rss": "124016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:18.762600 [debug] [MainThread]: Command `dbt compile` failed at 22:21:18.762545 after 0.52 seconds
[0m22:21:18.762909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829be2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e96c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f677dc0>]}
[0m22:21:18.763191 [debug] [MainThread]: Flushing usage events
[0m22:21:35.090738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acef2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792ea730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792ea6d0>]}


============================== 22:21:35.094021 | 2095b2f5-1cf1-4aab-bc44-3ed3ec75350f ==============================
[0m22:21:35.094021 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:21:35.094605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:35.171250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ddbee0>]}
[0m22:21:35.196174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e53fd0>]}
[0m22:21:35.196855 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:35.209168 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:21:35.329257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:35.329724 [debug] [MainThread]: Partial parsing: updated file: matt_demo://macros/column_greater_zero.sql
[0m22:21:35.379096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9799de80>]}
[0m22:21:35.447099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979d5a60>]}
[0m22:21:35.447441 [info ] [MainThread]: Found 6 models, 7 data tests, 4 sources, 654 macros
[0m22:21:35.447754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa93040>]}
[0m22:21:35.448813 [info ] [MainThread]: 
[0m22:21:35.449258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:35.451516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:21:35.451940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:21:35.469136 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:35.469390 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:35.469709 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:21:35.470012 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:21:35.470322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:35.470647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:35.472987 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:21:35.473174 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:21:35.473465 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:35.473791 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:35.474110 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:21:35.474430 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:21:35.475812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:21:35.476007 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:21:35.476705 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:21:35.477455 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:21:35.477887 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:21:35.478240 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:21:35.481584 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:35.481869 [debug] [MainThread]: On master: BEGIN
[0m22:21:35.482108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:35.483638 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:21:35.483882 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:35.484165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:35.488926 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m22:21:35.489615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2095b2f5-1cf1-4aab-bc44-3ed3ec75350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b39190>]}
[0m22:21:35.489931 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:35.490262 [debug] [MainThread]: On master: Close
[0m22:21:35.490653 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:35.491015 [info ] [MainThread]: 
[0m22:21:35.494937 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:21:35.495171 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:21:35.495431 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:35.495712 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:21:35.495990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:21:35.496385 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:21:35.496790 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:21:35.497165 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:21:35.497554 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:21:35.497869 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:21:35.498187 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:35.498517 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:21:35.502729 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:21:35.504830 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:21:35.506624 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:21:35.508370 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:21:35.509929 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:21:35.510158 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:21:35.510466 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:35.510795 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:21:35.511180 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:21:35.511597 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:21:35.512028 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:35.512439 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:21:35.512781 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:21:35.513528 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:35.513748 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:35.513986 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:35.514430 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:21:35.514738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:21:35.515062 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:21:35.515357 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:21:35.515640 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:21:35.515897 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:35.516167 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:35.516417 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:35.518087 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:21:35.531431 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:35.535551 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:21:35.538610 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:21:35.539256 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:21:35.539915 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:21:35.540432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:21:35.540766 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:35.541153 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:21:35.541387 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:35.542045 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:35.542442 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m22:21:35.542939 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:35.543312 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:35.543619 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:21:35.543858 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:21:35.544173 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:35.544491 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:21:35.544793 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:35.545090 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m22:21:35.545467 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:21:35.548472 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:35.546048 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:35.548200 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:21:35.545745 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:35.550435 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:21:35.555030 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:35.555277 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.005 seconds
[0m22:21:35.555772 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m22:21:35.555980 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:21:35.557995 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:35.558287 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:35.558662 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m22:21:35.558965 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:21:35.559582 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:35.559950 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:35.560162 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:35.560766 [debug] [Thread-4  ]: Began running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:35.561134 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:21:35.561475 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:21:35.561810 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8)
[0m22:21:35.562140 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:35.562374 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:21:35.562963 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:21:35.563212 [debug] [Thread-4  ]: Began compiling node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:35.565398 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:21:35.565745 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:35.566246 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:35.569144 [debug] [Thread-4  ]: Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:35.569662 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:35.570129 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:35.570510 [debug] [Thread-4  ]: Finished running node test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8
[0m22:21:35.571121 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:35.573159 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.002 seconds
[0m22:21:35.574100 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:35.574729 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:35.575009 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:21:35.575319 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:21:35.575738 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:35.576044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:35.576410 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:21:35.576668 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:21:35.576885 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:21:35.577091 [debug] [MainThread]: Connection 'test.matt_demo.column_greater_zero_kpi_revenue.21485b3be8' was properly closed.
[0m22:21:35.577396 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test column_greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_column_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:35.577977 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5125854, "process_user_time": 2.227986, "process_kernel_time": 0.093545, "process_mem_max_rss": "129268", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:35.578386 [debug] [MainThread]: Command `dbt compile` failed at 22:21:35.578321 after 0.51 seconds
[0m22:21:35.578710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acef2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974d0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979dd2b0>]}
[0m22:21:35.578984 [debug] [MainThread]: Flushing usage events
[0m22:21:48.710711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac142e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8920f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8920f6d0>]}


============================== 22:21:48.714161 | 68b8f50c-76d3-4de1-9c8f-8f11e64d3880 ==============================
[0m22:21:48.714161 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:21:48.714732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:21:48.793290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89432c10>]}
[0m22:21:48.817193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8927ebb0>]}
[0m22:21:48.817743 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:21:48.828921 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:21:48.947081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:48.947620 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m22:21:49.040718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:21:49.041253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2aee3d0>]}
[0m22:21:49.126366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa055c130>]}
[0m22:21:49.192822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7cc6430>]}
[0m22:21:49.193208 [info ] [MainThread]: Found 6 models, 7 data tests, 4 sources, 654 macros
[0m22:21:49.193522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c92400>]}
[0m22:21:49.194597 [info ] [MainThread]: 
[0m22:21:49.195072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:49.197198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:21:49.197596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:21:49.214086 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:49.214339 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:49.214634 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:21:49.214974 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:21:49.215266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:49.215562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:49.217896 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:21:49.218098 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:21:49.218359 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:21:49.218657 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:21:49.219003 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:21:49.219326 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:21:49.220672 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:21:49.220858 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:21:49.221572 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:21:49.222314 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:21:49.222709 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:21:49.223003 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:21:49.226301 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:49.226574 [debug] [MainThread]: On master: BEGIN
[0m22:21:49.226826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:49.228566 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:21:49.228838 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:49.229182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:49.234207 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m22:21:49.234872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68b8f50c-76d3-4de1-9c8f-8f11e64d3880', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29ff940>]}
[0m22:21:49.235188 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:49.235492 [debug] [MainThread]: On master: Close
[0m22:21:49.235820 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:49.236212 [info ] [MainThread]: 
[0m22:21:49.240113 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:21:49.240348 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:21:49.240570 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:49.240787 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:21:49.241116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:21:49.241515 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:21:49.241909 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:21:49.242336 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:21:49.242671 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:21:49.242994 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:21:49.243327 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:49.243647 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:21:49.248401 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:21:49.250194 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:21:49.251950 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:21:49.253597 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:21:49.255206 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:21:49.255457 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:21:49.255697 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:49.256085 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:21:49.256248 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:21:49.256665 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:21:49.257103 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:21:49.257429 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:21:49.257917 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:21:49.258534 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:49.258746 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:49.258985 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:21:49.259330 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:49.259719 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:21:49.260032 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:21:49.260293 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:21:49.260598 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:21:49.260897 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:49.261269 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:49.262985 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:21:49.263302 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:49.310053 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:49.314687 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:21:49.318341 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:21:49.318754 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:21:49.319225 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:21:49.319991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:21:49.320388 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:49.320823 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:21:49.321060 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:49.321775 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:21:49.322155 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m22:21:49.322652 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:21:49.323008 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:49.323426 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.kpi)
[0m22:21:49.323668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:21:49.323996 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:49.324323 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:21:49.324631 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m22:21:49.324940 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:49.325280 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:21:49.325558 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:49.328161 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:21:49.328530 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:49.328866 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:49.333397 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:49.336598 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:21:49.337031 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m22:21:49.337268 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:21:49.337502 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m22:21:49.338237 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m22:21:49.338531 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:21:49.338884 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:49.340910 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:21:49.341326 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:49.342100 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:21:49.342703 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:21:49.343096 [debug] [Thread-4  ]: Began running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:21:49.343499 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:49.343721 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:49.343952 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m22:21:49.344267 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9)
[0m22:21:49.344584 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:21:49.346976 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:21:49.347327 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:49.347662 [debug] [Thread-4  ]: Began compiling node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:21:49.348164 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:21:49.348475 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:21:49.348814 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:49.351573 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:21:49.352591 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:21:49.353149 [debug] [Thread-4  ]: Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
  'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:49.353971 [debug] [Thread-4  ]: Finished running node test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9
[0m22:21:49.354748 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:21:49.355772 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:21:49.356515 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:49.356807 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:21:49.357163 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:21:49.357606 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:21:49.357955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:49.358298 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:21:49.358532 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:21:49.358748 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:21:49.358983 [debug] [MainThread]: Connection 'test.matt_demo.greater_zero_kpi_revenue.96d7f7e0b9' was properly closed.
[0m22:21:49.359314 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test greater_zero_kpi_revenue (models/crm_sales_data/crm_sales.yml)
    'test_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:21:49.359992 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.67458725, "process_user_time": 2.436424, "process_kernel_time": 0.095882, "process_mem_max_rss": "129316", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:21:49.360452 [debug] [MainThread]: Command `dbt compile` failed at 22:21:49.360385 after 0.68 seconds
[0m22:21:49.360797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac142e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0222ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0222fa0>]}
[0m22:21:49.361109 [debug] [MainThread]: Flushing usage events
[0m02:40:17.303709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0208b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b020850>]}


============================== 02:40:17.307497 | dcb41ed8-e959-4637-9308-1a3ff4179fe9 ==============================
[0m02:40:17.307497 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:40:17.307996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m qoq_kpi', 'send_anonymous_usage_stats': 'True'}
[0m02:40:17.386460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b54400>]}
[0m02:40:17.409468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb86f70>]}
[0m02:40:17.410014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:40:17.420822 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:40:17.546795 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m02:40:17.547213 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/final/kpi.sql
[0m02:40:17.547510 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:17.547771 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://models/crm_sales_data/fact/kpi.sql
[0m02:40:17.647097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:40:17.647636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b1e0d0>]}
[0m02:40:17.737791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923b5130>]}
[0m02:40:17.806094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92336cd0>]}
[0m02:40:17.806457 [info ] [MainThread]: Found 7 models, 7 data tests, 4 sources, 654 macros
[0m02:40:17.806862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923d7c40>]}
[0m02:40:17.807769 [info ] [MainThread]: 
[0m02:40:17.808213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:17.808863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m02:40:17.826643 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m02:40:17.827018 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m02:40:17.827310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:17.830568 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m02:40:17.831306 [debug] [ThreadPool]: On list_company_dw: Close
[0m02:40:17.831818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dev)
[0m02:40:17.832211 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dev"
"
[0m02:40:17.835267 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m02:40:17.835608 [debug] [ThreadPool]: On create_company_dw_dev: BEGIN
[0m02:40:17.835924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:17.837364 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m02:40:17.837682 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m02:40:17.837999 [debug] [ThreadPool]: On create_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dev"} */
create schema if not exists "dev"
[0m02:40:17.838637 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m02:40:17.839178 [debug] [ThreadPool]: On create_company_dw_dev: COMMIT
[0m02:40:17.839469 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev"
[0m02:40:17.839738 [debug] [ThreadPool]: On create_company_dw_dev: COMMIT
[0m02:40:17.841112 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m02:40:17.841388 [debug] [ThreadPool]: On create_company_dw_dev: Close
[0m02:40:17.843784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dev, now list_company_dw_dev)
[0m02:40:17.844199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m02:40:17.844571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m02:40:17.847540 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:17.849170 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:17.850452 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:17.850774 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m02:40:17.851040 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m02:40:17.851301 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m02:40:17.851605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:17.851862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:17.852107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:17.853790 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.854031 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.854271 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.854483 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:17.854792 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:17.855057 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:17.855359 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m02:40:17.855653 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m02:40:17.855946 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m02:40:17.857805 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m02:40:17.858000 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m02:40:17.858174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m02:40:17.858859 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m02:40:17.859572 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m02:40:17.860243 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m02:40:17.860649 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m02:40:17.860927 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m02:40:17.861224 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m02:40:17.864917 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.865205 [debug] [MainThread]: On master: BEGIN
[0m02:40:17.865450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:17.867149 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.867406 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.867690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:40:17.873417 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m02:40:17.874168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bbff40>]}
[0m02:40:17.874513 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:17.874857 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.875087 [debug] [MainThread]: On master: BEGIN
[0m02:40:17.875456 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:40:17.875693 [debug] [MainThread]: On master: COMMIT
[0m02:40:17.875937 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.876170 [debug] [MainThread]: On master: COMMIT
[0m02:40:17.876478 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:17.876716 [debug] [MainThread]: On master: Close
[0m02:40:17.877053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:40:17.877397 [info ] [MainThread]: 
[0m02:40:17.881600 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m02:40:17.881996 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.qoq_kpi ........................................ [RUN]
[0m02:40:17.882523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.qoq_kpi)
[0m02:40:17.882861 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m02:40:17.887059 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m02:40:17.888492 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m02:40:17.933211 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m02:40:17.934667 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:17.934968 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m02:40:17.935250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:40:17.937447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.937760 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:17.938027 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  create view "company_dw"."dev"."qoq_kpi__dbt_tmp"
    
    
  as (
    WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', your_date_column) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."kpi"
    GROUP BY
        date_trunc('quarter', your_date_column)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
[0m02:40:17.938580 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "your_date_column" does not exist
LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                      ^

[0m02:40:17.938837 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: ROLLBACK
[0m02:40:17.939182 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m02:40:17.940366 [debug] [Thread-1  ]: Database Error in model qoq_kpi (models/crm_sales_data/final/qoq_kpi.sql)
  column "your_date_column" does not exist
  LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:17.941265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb41ed8-e959-4637-9308-1a3ff4179fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b216970>]}
[0m02:40:17.941675 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev.qoq_kpi ............................... [[31mERROR[0m in 0.06s]
[0m02:40:17.942139 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m02:40:17.942972 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.943263 [debug] [MainThread]: On master: BEGIN
[0m02:40:17.943499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:17.945225 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:40:17.945534 [debug] [MainThread]: On master: COMMIT
[0m02:40:17.945822 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:17.946174 [debug] [MainThread]: On master: COMMIT
[0m02:40:17.946570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:17.946824 [debug] [MainThread]: On master: Close
[0m02:40:17.947154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:17.947437 [debug] [MainThread]: Connection 'list_company_dw_dev' was properly closed.
[0m02:40:17.947703 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m02:40:17.947945 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m02:40:17.948172 [info ] [MainThread]: 
[0m02:40:17.948505 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m02:40:17.948992 [debug] [MainThread]: Command end result
[0m02:40:17.975929 [info ] [MainThread]: 
[0m02:40:17.976346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:40:17.976692 [info ] [MainThread]: 
[0m02:40:17.977027 [error] [MainThread]:   Database Error in model qoq_kpi (models/crm_sales_data/final/qoq_kpi.sql)
  column "your_date_column" does not exist
  LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:17.977312 [info ] [MainThread]: 
[0m02:40:17.977618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:40:17.978195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7001926, "process_user_time": 2.317602, "process_kernel_time": 0.107305, "process_mem_max_rss": "136064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:40:17.978566 [debug] [MainThread]: Command `dbt run` failed at 02:40:17.978505 after 0.70 seconds
[0m02:40:17.978856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c36f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996f2c70>]}
[0m02:40:17.979152 [debug] [MainThread]: Flushing usage events
[0m02:40:42.133372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915f02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8e850>]}


============================== 02:40:42.136674 | a0f4a207-e53f-4e4f-b26b-da372e5025e4 ==============================
[0m02:40:42.136674 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:40:42.137179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m qoq_kpi', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:40:42.211700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6c4400>]}
[0m02:40:42.234500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906f5f70>]}
[0m02:40:42.235020 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:40:42.244952 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:40:42.360571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:40:42.360985 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:42.468899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9515130>]}
[0m02:40:42.535741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94f4a30>]}
[0m02:40:42.536105 [info ] [MainThread]: Found 7 models, 7 data tests, 4 sources, 654 macros
[0m02:40:42.536445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9530d30>]}
[0m02:40:42.537158 [info ] [MainThread]: 
[0m02:40:42.537624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:42.538186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m02:40:42.553025 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m02:40:42.553411 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m02:40:42.553700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:42.556065 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m02:40:42.556803 [debug] [ThreadPool]: On list_company_dw: Close
[0m02:40:42.559260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev)
[0m02:40:42.559669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m02:40:42.563592 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:42.563917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m02:40:42.565612 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:42.565930 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m02:40:42.567151 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:42.567461 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m02:40:42.567762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:42.568048 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m02:40:42.568330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:42.568794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:42.570191 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:42.570568 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:42.570747 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:42.570926 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:42.571228 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:42.571485 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:42.571799 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m02:40:42.572137 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m02:40:42.572448 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m02:40:42.573798 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m02:40:42.574019 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:40:42.574194 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m02:40:42.574901 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m02:40:42.575580 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m02:40:42.576262 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m02:40:42.576641 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m02:40:42.576937 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m02:40:42.577284 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m02:40:42.580890 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.581168 [debug] [MainThread]: On master: BEGIN
[0m02:40:42.581382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:42.582755 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:40:42.583006 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.583299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:40:42.588032 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m02:40:42.588683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2b3f10>]}
[0m02:40:42.589012 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:42.589322 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.589571 [debug] [MainThread]: On master: BEGIN
[0m02:40:42.589932 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:40:42.590239 [debug] [MainThread]: On master: COMMIT
[0m02:40:42.590498 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.590705 [debug] [MainThread]: On master: COMMIT
[0m02:40:42.590998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:42.591234 [debug] [MainThread]: On master: Close
[0m02:40:42.591529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:40:42.591864 [info ] [MainThread]: 
[0m02:40:42.595729 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m02:40:42.596147 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.qoq_kpi ........................................ [RUN]
[0m02:40:42.596590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.qoq_kpi)
[0m02:40:42.596889 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m02:40:42.600989 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m02:40:42.602083 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m02:40:42.618899 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m02:40:42.619868 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:42.620148 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m02:40:42.620427 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:40:42.622105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m02:40:42.622369 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:42.622617 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  create view "company_dw"."dev"."qoq_kpi__dbt_tmp"
    
    
  as (
    WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', your_date_column) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
[0m02:40:42.623068 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "your_date_column" does not exist
LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                      ^

[0m02:40:42.623324 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: ROLLBACK
[0m02:40:42.623698 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m02:40:42.624732 [debug] [Thread-1  ]: Database Error in model qoq_kpi (models/crm_sales_data/final/qoq_kpi.sql)
  column "your_date_column" does not exist
  LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:42.625624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f4a207-e53f-4e4f-b26b-da372e5025e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c1b280>]}
[0m02:40:42.626019 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev.qoq_kpi ............................... [[31mERROR[0m in 0.03s]
[0m02:40:42.626480 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m02:40:42.627274 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.627532 [debug] [MainThread]: On master: BEGIN
[0m02:40:42.627757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:42.629039 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:40:42.629313 [debug] [MainThread]: On master: COMMIT
[0m02:40:42.629549 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:42.629769 [debug] [MainThread]: On master: COMMIT
[0m02:40:42.630046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:42.630287 [debug] [MainThread]: On master: Close
[0m02:40:42.630565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:42.630814 [debug] [MainThread]: Connection 'list_company_dw_dev' was properly closed.
[0m02:40:42.631114 [debug] [MainThread]: Connection 'list_company_dw_dev_global_dim' was properly closed.
[0m02:40:42.631429 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m02:40:42.631715 [info ] [MainThread]: 
[0m02:40:42.632068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m02:40:42.632609 [debug] [MainThread]: Command end result
[0m02:40:42.658401 [info ] [MainThread]: 
[0m02:40:42.658802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:40:42.659131 [info ] [MainThread]: 
[0m02:40:42.659501 [error] [MainThread]:   Database Error in model qoq_kpi (models/crm_sales_data/final/qoq_kpi.sql)
  column "your_date_column" does not exist
  LINE 9:         date_trunc('quarter', your_date_column) AS quarter,
                                        ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:42.659777 [info ] [MainThread]: 
[0m02:40:42.660079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:40:42.660627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.55043864, "process_user_time": 2.204706, "process_kernel_time": 0.085065, "process_mem_max_rss": "126280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:40:42.660959 [debug] [MainThread]: Command `dbt run` failed at 02:40:42.660917 after 0.55 seconds
[0m02:40:42.661245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915f02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906f5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ede4c0>]}
[0m02:40:42.661500 [debug] [MainThread]: Flushing usage events
[0m02:40:56.442465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980c67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980c6790>]}


============================== 02:40:56.445966 | 181ed947-0b85-44c4-9a2b-13f78ee27f26 ==============================
[0m02:40:56.445966 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:40:56.446512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m qoq_kpi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:40:56.523764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99985100>]}
[0m02:40:56.546208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bc9430>]}
[0m02:40:56.546702 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:40:56.557005 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:40:56.676187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:40:56.676621 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/qoq_kpi.sql
[0m02:40:56.791485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a4c130>]}
[0m02:40:56.867312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a2b7f0>]}
[0m02:40:56.867892 [info ] [MainThread]: Found 7 models, 7 data tests, 4 sources, 654 macros
[0m02:40:56.868354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1a67cd0>]}
[0m02:40:56.869480 [info ] [MainThread]: 
[0m02:40:56.870164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:56.870820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m02:40:56.888554 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m02:40:56.889035 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m02:40:56.889431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:56.893039 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m02:40:56.893793 [debug] [ThreadPool]: On list_company_dw: Close
[0m02:40:56.896432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m02:40:56.896813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m02:40:56.900060 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:56.900299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m02:40:56.901851 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:56.902187 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m02:40:56.903530 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:56.903834 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m02:40:56.904167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:56.904474 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m02:40:56.904796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:56.905282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:56.906756 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m02:40:56.907189 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:56.907371 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:40:56.907542 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:40:56.907855 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:40:56.908202 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m02:40:56.908483 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m02:40:56.908836 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m02:40:56.909294 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m02:40:56.910368 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m02:40:56.910629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:40:56.911303 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m02:40:56.911487 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m02:40:56.912223 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m02:40:56.912619 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m02:40:56.913209 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m02:40:56.913645 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m02:40:56.914575 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m02:40:56.917822 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.918130 [debug] [MainThread]: On master: BEGIN
[0m02:40:56.918389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:56.920042 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:40:56.920330 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.920635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:40:56.925719 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m02:40:56.926427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19b8c40>]}
[0m02:40:56.926770 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:56.927142 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.927425 [debug] [MainThread]: On master: BEGIN
[0m02:40:56.927797 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:40:56.928055 [debug] [MainThread]: On master: COMMIT
[0m02:40:56.928310 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.928571 [debug] [MainThread]: On master: COMMIT
[0m02:40:56.928891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:56.929260 [debug] [MainThread]: On master: Close
[0m02:40:56.929595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:40:56.929954 [info ] [MainThread]: 
[0m02:40:56.934071 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m02:40:56.934542 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.qoq_kpi ........................................ [RUN]
[0m02:40:56.935025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.matt_demo.qoq_kpi)
[0m02:40:56.935379 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m02:40:56.940181 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m02:40:56.941364 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m02:40:56.959409 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m02:40:56.960529 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:56.960821 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m02:40:56.961091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:40:56.963003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m02:40:56.963273 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:56.963545 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  create view "company_dw"."dev"."qoq_kpi__dbt_tmp"
    
    
  as (
    WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
[0m02:40:56.965722 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m02:40:56.969284 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:56.969601 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m02:40:56.970050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:40:56.977542 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m02:40:56.977856 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:56.978144 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m02:40:56.978656 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m02:40:56.981998 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev"."qoq_kpi__dbt_backup"
[0m02:40:56.984034 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:40:56.984296 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop view if exists "company_dw"."dev"."qoq_kpi__dbt_backup" cascade
[0m02:40:56.984736 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m02:40:56.986022 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m02:40:56.986879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181ed947-0b85-44c4-9a2b-13f78ee27f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9d7f70>]}
[0m02:40:56.987303 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.qoq_kpi ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m02:40:56.987774 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m02:40:56.988643 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.988927 [debug] [MainThread]: On master: BEGIN
[0m02:40:56.989164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:56.990794 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:40:56.991034 [debug] [MainThread]: On master: COMMIT
[0m02:40:56.991273 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:56.991523 [debug] [MainThread]: On master: COMMIT
[0m02:40:56.991815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:56.992034 [debug] [MainThread]: On master: Close
[0m02:40:56.992307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:56.992530 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m02:40:56.992750 [debug] [MainThread]: Connection 'list_company_dw_dev_global_dim' was properly closed.
[0m02:40:56.992985 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m02:40:56.993241 [info ] [MainThread]: 
[0m02:40:56.993551 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m02:40:56.994199 [debug] [MainThread]: Command end result
[0m02:40:57.074868 [info ] [MainThread]: 
[0m02:40:57.076274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:40:57.076928 [info ] [MainThread]: 
[0m02:40:57.077474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:40:57.078366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.660912, "process_user_time": 2.298958, "process_kernel_time": 0.102613, "process_mem_max_rss": "129864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:40:57.079100 [debug] [MainThread]: Command `dbt run` succeeded at 02:40:57.079031 after 0.66 seconds
[0m02:40:57.079543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997cdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99985100>]}
[0m02:40:57.080028 [debug] [MainThread]: Flushing usage events
[0m02:42:27.489702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892db2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8787a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8787a7f0>]}


============================== 02:42:27.494032 | cd01859e-ea3d-48e8-98a5-dcf42b8ab545 ==============================
[0m02:42:27.494032 [info ] [MainThread]: Running with dbt=1.8.3
[0m02:42:27.494589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m qoq_kpi', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:42:27.574675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6390c70>]}
[0m02:42:27.598902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e236d0>]}
[0m02:42:27.599631 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m02:42:27.610655 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m02:42:27.733880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:42:27.734324 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/qoq_kpi.sql
[0m02:42:27.845812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dbe130>]}
[0m02:42:27.914515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0df6190>]}
[0m02:42:27.914919 [info ] [MainThread]: Found 7 models, 7 data tests, 4 sources, 654 macros
[0m02:42:27.915208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f3c820>]}
[0m02:42:27.916021 [info ] [MainThread]: 
[0m02:42:27.916545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:42:27.917228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m02:42:27.934249 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m02:42:27.934673 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m02:42:27.934982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:27.937835 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m02:42:27.938562 [debug] [ThreadPool]: On list_company_dw: Close
[0m02:42:27.941075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m02:42:27.941454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m02:42:27.944637 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:42:27.946209 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:42:27.946525 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m02:42:27.946815 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m02:42:27.947099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:27.947383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:27.949184 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:42:27.949519 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m02:42:27.949736 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m02:42:27.950053 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m02:42:27.950386 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m02:42:27.950869 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m02:42:27.952060 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m02:42:27.952384 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m02:42:27.952938 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m02:42:27.953624 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m02:42:27.953994 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m02:42:27.954300 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m02:42:27.957614 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:27.957916 [debug] [MainThread]: On master: BEGIN
[0m02:42:27.958185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:27.959632 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:42:27.959882 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:27.960162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:42:27.965415 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m02:42:27.966200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f66640>]}
[0m02:42:27.966547 [debug] [MainThread]: On master: ROLLBACK
[0m02:42:27.966870 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:27.967110 [debug] [MainThread]: On master: BEGIN
[0m02:42:27.967500 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:42:27.967742 [debug] [MainThread]: On master: COMMIT
[0m02:42:27.967971 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:27.968199 [debug] [MainThread]: On master: COMMIT
[0m02:42:27.968507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:27.968767 [debug] [MainThread]: On master: Close
[0m02:42:27.969080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:42:27.969448 [info ] [MainThread]: 
[0m02:42:27.973379 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m02:42:27.973798 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt.qoq_kpi ......................... [RUN]
[0m02:42:27.974262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.qoq_kpi)
[0m02:42:27.974622 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m02:42:27.978942 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m02:42:27.979989 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m02:42:27.998307 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m02:42:27.999316 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:42:27.999614 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m02:42:27.999874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:28.001630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m02:42:28.001908 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:42:28.002185 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp"
  
  
    as
  
  (
    


WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
  
[0m02:42:28.006011 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.004 seconds
[0m02:42:28.009323 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:42:28.009579 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m02:42:28.009926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:28.018355 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m02:42:28.018630 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:42:28.018902 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m02:42:28.019635 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m02:42:28.022620 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup"
[0m02:42:28.024695 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m02:42:28.024929 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup" cascade
[0m02:42:28.025276 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m02:42:28.026455 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m02:42:28.027280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd01859e-ea3d-48e8-98a5-dcf42b8ab545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0922a60>]}
[0m02:42:28.027733 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt.qoq_kpi .................... [[32mSELECT 5[0m in 0.05s]
[0m02:42:28.028208 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m02:42:28.029016 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:28.029286 [debug] [MainThread]: On master: BEGIN
[0m02:42:28.029526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:28.031020 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:42:28.031267 [debug] [MainThread]: On master: COMMIT
[0m02:42:28.031520 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:28.031756 [debug] [MainThread]: On master: COMMIT
[0m02:42:28.032058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:28.032294 [debug] [MainThread]: On master: Close
[0m02:42:28.032619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:28.032867 [debug] [MainThread]: Connection 'list_company_dw_dev_global_dim' was properly closed.
[0m02:42:28.033123 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m02:42:28.033398 [info ] [MainThread]: 
[0m02:42:28.033737 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m02:42:28.034193 [debug] [MainThread]: Command end result
[0m02:42:28.060199 [info ] [MainThread]: 
[0m02:42:28.060619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:28.060893 [info ] [MainThread]: 
[0m02:42:28.061206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:42:28.061816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5967027, "process_user_time": 2.275031, "process_kernel_time": 0.121551, "process_mem_max_rss": "129768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:42:28.062146 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:28.062106 after 0.60 seconds
[0m02:42:28.062395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892db2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8841ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e236d0>]}
[0m02:42:28.062672 [debug] [MainThread]: Flushing usage events
[0m03:12:18.603152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb072e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e0a3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e0a36a0>]}


============================== 03:12:18.606810 | 51a1990a-5c20-46f1-ab71-f9bf2a09d486 ==============================
[0m03:12:18.606810 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:12:18.607370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:12:18.686185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbe18b0>]}
[0m03:12:18.709525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e2c7eb0>]}
[0m03:12:18.710084 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:12:18.721242 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:12:18.844014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m03:12:18.844428 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/intermediary/crm_int_kpi.sql
[0m03:12:18.844687 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/qoq_kpi.sql
[0m03:12:18.844936 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/kpi.sql
[0m03:12:18.954273 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:12:18.954938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbb8c70>]}
[0m03:12:19.043667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8747b130>]}
[0m03:12:19.113263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874f50d0>]}
[0m03:12:19.113611 [info ] [MainThread]: Found 8 models, 7 data tests, 4 sources, 654 macros
[0m03:12:19.113989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f77cdf0>]}
[0m03:12:19.115008 [info ] [MainThread]: 
[0m03:12:19.115514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:19.117952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m03:12:19.118335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m03:12:19.136489 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m03:12:19.136751 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m03:12:19.137112 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:12:19.137459 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:12:19.137762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:19.138062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:19.141283 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m03:12:19.141488 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m03:12:19.142217 [debug] [ThreadPool]: On list_company_dw: Close
[0m03:12:19.142841 [debug] [ThreadPool]: On list_company_dw: Close
[0m03:12:19.144194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m03:12:19.144519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m03:12:19.147734 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:12:19.149261 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:12:19.149574 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m03:12:19.149894 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m03:12:19.150233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:19.150516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:19.152510 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.152707 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.152999 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:12:19.153303 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:12:19.153598 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m03:12:19.153951 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m03:12:19.155745 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m03:12:19.155932 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m03:12:19.156671 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m03:12:19.157325 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m03:12:19.157728 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m03:12:19.158050 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m03:12:19.161422 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.161696 [debug] [MainThread]: On master: BEGIN
[0m03:12:19.161922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:19.163355 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:12:19.163601 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.163882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:12:19.169600 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m03:12:19.170334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e0693d0>]}
[0m03:12:19.170654 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:19.170984 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.171237 [debug] [MainThread]: On master: BEGIN
[0m03:12:19.171602 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:12:19.171854 [debug] [MainThread]: On master: COMMIT
[0m03:12:19.172104 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.172327 [debug] [MainThread]: On master: COMMIT
[0m03:12:19.172631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:12:19.172876 [debug] [MainThread]: On master: Close
[0m03:12:19.173211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:12:19.173581 [info ] [MainThread]: 
[0m03:12:19.177773 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m03:12:19.178012 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m03:12:19.178237 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m03:12:19.178463 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m03:12:19.178818 [info ] [Thread-1  ]: 1 of 8 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m03:12:19.179348 [info ] [Thread-2  ]: 2 of 8 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m03:12:19.179797 [info ] [Thread-3  ]: 3 of 8 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m03:12:19.180284 [info ] [Thread-4  ]: 4 of 8 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m03:12:19.180731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m03:12:19.181112 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m03:12:19.181496 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m03:12:19.181860 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m03:12:19.182197 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m03:12:19.182574 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m03:12:19.182879 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m03:12:19.183209 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m03:12:19.187471 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m03:12:19.189211 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m03:12:19.191521 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.220644 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.223639 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m03:12:19.223888 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m03:12:19.224199 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m03:12:19.224499 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m03:12:19.240896 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.242711 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m03:12:19.244547 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m03:12:19.246669 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.249221 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.249466 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.249900 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.250143 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m03:12:19.250421 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.250610 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m03:12:19.250894 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m03:12:19.251197 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:12:19.251450 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m03:12:19.251716 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:19.251961 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:12:19.252391 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:12:19.254208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.254433 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m03:12:19.254652 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.255693 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.255119 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.255428 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.254846 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m03:12:19.255944 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m03:12:19.256251 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue_mm,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m03:12:19.256583 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m03:12:19.256860 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.257555 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m03:12:19.258893 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m03:12:19.259181 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m03:12:19.259431 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m03:12:19.259671 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m03:12:19.263319 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.265094 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.266854 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.268615 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.268930 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m03:12:19.269225 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m03:12:19.269519 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m03:12:19.269845 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m03:12:19.270840 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.271084 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.271306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.273015 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.273230 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:12:19.274814 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.276364 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.276677 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m03:12:19.278277 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.278565 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m03:12:19.278882 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m03:12:19.279465 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m03:12:19.279682 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.280099 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.280490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.280724 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.288140 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m03:12:19.288786 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m03:12:19.289480 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m03:12:19.290150 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m03:12:19.290462 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.290746 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.291052 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.291394 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.291700 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m03:12:19.291984 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m03:12:19.292291 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m03:12:19.292593 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m03:12:19.293530 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m03:12:19.293775 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m03:12:19.293961 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m03:12:19.294198 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m03:12:19.297671 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m03:12:19.299058 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m03:12:19.300418 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m03:12:19.301822 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m03:12:19.303847 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m03:12:19.304252 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m03:12:19.304664 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m03:12:19.305033 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m03:12:19.305341 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m03:12:19.305654 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m03:12:19.305966 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m03:12:19.306256 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m03:12:19.307308 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:19.307802 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:19.308095 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:19.309252 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m03:12:19.309470 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m03:12:19.310168 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m03:12:19.310838 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m03:12:19.311791 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dfff520>]}
[0m03:12:19.312418 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m03:12:19.312808 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6df99100>]}
[0m03:12:19.313209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6df99b50>]}
[0m03:12:19.313693 [info ] [Thread-4  ]: 4 of 8 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.13s]
[0m03:12:19.314183 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6df99cd0>]}
[0m03:12:19.314608 [info ] [Thread-3  ]: 3 of 8 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.13s]
[0m03:12:19.315097 [info ] [Thread-1  ]: 1 of 8 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.13s]
[0m03:12:19.315564 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m03:12:19.315982 [info ] [Thread-2  ]: 2 of 8 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.13s]
[0m03:12:19.316429 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m03:12:19.316809 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m03:12:19.317183 [debug] [Thread-4  ]: Began running node model.matt_demo.dim_date
[0m03:12:19.317592 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m03:12:19.318350 [info ] [Thread-4  ]: 5 of 8 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m03:12:19.318938 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_int_kpi
[0m03:12:19.319285 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.dim_date)
[0m03:12:19.319655 [info ] [Thread-3  ]: 6 of 8 START sql view model dev_crm_sales_dbt.crm_int_kpi ...................... [RUN]
[0m03:12:19.320092 [debug] [Thread-4  ]: Began compiling node model.matt_demo.dim_date
[0m03:12:19.320450 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.crm_int_kpi)
[0m03:12:19.322384 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m03:12:19.322699 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m03:12:19.325679 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m03:12:19.326135 [debug] [Thread-4  ]: Began executing node model.matt_demo.dim_date
[0m03:12:19.337029 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m03:12:19.337365 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_int_kpi
[0m03:12:19.339348 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_int_kpi"
[0m03:12:19.339782 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.340257 [debug] [Thread-4  ]: On model.matt_demo.dim_date: BEGIN
[0m03:12:19.340522 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m03:12:19.340707 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:12:19.340966 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: BEGIN
[0m03:12:19.341407 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:12:19.342862 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.343083 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.343402 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.343680 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m03:12:19.344018 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m03:12:19.344369 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_tmp"
    
    
  as (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
[0m03:12:19.346098 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m03:12:19.348125 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m03:12:19.348425 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_tmp" rename to "crm_int_kpi"
[0m03:12:19.348948 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.349701 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m03:12:19.349982 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m03:12:19.350271 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m03:12:19.350928 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m03:12:19.352447 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_backup"
[0m03:12:19.352840 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m03:12:19.353116 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_backup" cascade
[0m03:12:19.353500 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.000 seconds
[0m03:12:19.354193 [debug] [Thread-3  ]: On model.matt_demo.crm_int_kpi: Close
[0m03:12:19.354573 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6df997f0>]}
[0m03:12:19.354991 [info ] [Thread-3  ]: 6 of 8 OK created sql view model dev_crm_sales_dbt.crm_int_kpi ................. [[32mCREATE VIEW[0m in 0.03s]
[0m03:12:19.355472 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_int_kpi
[0m03:12:19.355917 [debug] [Thread-2  ]: Began running node model.matt_demo.kpi
[0m03:12:19.356163 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m03:12:19.356513 [info ] [Thread-2  ]: 7 of 8 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m03:12:19.356925 [info ] [Thread-1  ]: 8 of 8 START sql table model dev_crm_sales_dbt.qoq_kpi ......................... [RUN]
[0m03:12:19.357341 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.kpi)
[0m03:12:19.357667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.qoq_kpi)
[0m03:12:19.358002 [debug] [Thread-2  ]: Began compiling node model.matt_demo.kpi
[0m03:12:19.358303 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m03:12:19.360805 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m03:12:19.362518 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m03:12:19.363721 [debug] [Thread-2  ]: Began executing node model.matt_demo.kpi
[0m03:12:19.364016 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m03:12:19.365847 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m03:12:19.367749 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m03:12:19.368569 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.368937 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.369200 [debug] [Thread-2  ]: On model.matt_demo.kpi: BEGIN
[0m03:12:19.369487 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m03:12:19.369747 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:12:19.370015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:12:19.371896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.372110 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.372403 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.372658 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.372953 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp"
  
  
    as
  
  (
    


WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."crm_int_kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
  
[0m03:12:19.373244 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "company_dw"."dev_crm_sales_dbt"."crm_int_kpi"
  );
  
[0m03:12:19.381082 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.007 seconds
[0m03:12:19.383396 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.383731 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."qoq_kpi" rename to "qoq_kpi__dbt_backup"
[0m03:12:19.384237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.386764 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.387077 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m03:12:19.387566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.390386 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m03:12:19.390747 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.391047 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m03:12:19.391367 [debug] [Thread-2  ]: SQL status: SELECT 8800 in 0.018 seconds
[0m03:12:19.394140 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.394358 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m03:12:19.394655 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi" rename to "kpi__dbt_backup"
[0m03:12:19.396223 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup"
[0m03:12:19.397713 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m03:12:19.397929 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:19.398205 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup" cascade
[0m03:12:19.399836 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.400268 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m03:12:19.400715 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.400959 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m03:12:19.401788 [debug] [Thread-2  ]: On model.matt_demo.kpi: COMMIT
[0m03:12:19.402515 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m03:12:19.402781 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.403209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0b5f70>]}
[0m03:12:19.403494 [debug] [Thread-2  ]: On model.matt_demo.kpi: COMMIT
[0m03:12:19.403918 [info ] [Thread-1  ]: 8 of 8 OK created sql table model dev_crm_sales_dbt.qoq_kpi .................... [[32mSELECT 5[0m in 0.05s]
[0m03:12:19.404560 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m03:12:19.404798 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m03:12:19.406459 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup"
[0m03:12:19.406805 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.kpi"
[0m03:12:19.407055 [debug] [Thread-2  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m03:12:19.408195 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m03:12:19.408872 [debug] [Thread-2  ]: On model.matt_demo.kpi: Close
[0m03:12:19.409239 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c81b550>]}
[0m03:12:19.409677 [info ] [Thread-2  ]: 7 of 8 OK created sql table model dev_crm_sales_dbt.kpi ........................ [[32mSELECT 8800[0m in 0.05s]
[0m03:12:19.410145 [debug] [Thread-2  ]: Finished running node model.matt_demo.kpi
[0m03:12:19.483860 [debug] [Thread-4  ]: SQL status: SELECT 29220 in 0.139 seconds
[0m03:12:19.486630 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.487006 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m03:12:19.487524 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.489117 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.489437 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m03:12:19.489834 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:19.490592 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m03:12:19.490885 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.491195 [debug] [Thread-4  ]: On model.matt_demo.dim_date: COMMIT
[0m03:12:19.495668 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m03:12:19.497239 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m03:12:19.497719 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.dim_date"
[0m03:12:19.498025 [debug] [Thread-4  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m03:12:19.499699 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m03:12:19.500464 [debug] [Thread-4  ]: On model.matt_demo.dim_date: Close
[0m03:12:19.500920 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a1990a-5c20-46f1-ab71-f9bf2a09d486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c708f40>]}
[0m03:12:19.501398 [info ] [Thread-4  ]: 5 of 8 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.18s]
[0m03:12:19.501915 [debug] [Thread-4  ]: Finished running node model.matt_demo.dim_date
[0m03:12:19.502840 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.503136 [debug] [MainThread]: On master: BEGIN
[0m03:12:19.503364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:19.505002 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:12:19.505274 [debug] [MainThread]: On master: COMMIT
[0m03:12:19.505518 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:19.505734 [debug] [MainThread]: On master: COMMIT
[0m03:12:19.506021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:12:19.506240 [debug] [MainThread]: On master: Close
[0m03:12:19.506519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:19.506728 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m03:12:19.506949 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m03:12:19.507199 [debug] [MainThread]: Connection 'model.matt_demo.crm_int_kpi' was properly closed.
[0m03:12:19.507437 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m03:12:19.507740 [info ] [MainThread]: 
[0m03:12:19.508087 [info ] [MainThread]: Finished running 5 view models, 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m03:12:19.509034 [debug] [MainThread]: Command end result
[0m03:12:19.537957 [info ] [MainThread]: 
[0m03:12:19.538378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:19.538750 [info ] [MainThread]: 
[0m03:12:19.539055 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m03:12:19.539707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9611647, "process_user_time": 2.500823, "process_kernel_time": 0.131463, "process_mem_max_rss": "135272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:12:19.540055 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:19.540013 after 0.96 seconds
[0m03:12:19.540348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fb072e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ec4ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc43910>]}
[0m03:12:19.540630 [debug] [MainThread]: Flushing usage events
[0m03:13:11.547896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63ca92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62245760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62245700>]}


============================== 03:13:11.551255 | 41d2e282-dd1d-4e07-9605-8ea6b1f04269 ==============================
[0m03:13:11.551255 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:13:11.551858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:13:11.629765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d82550>]}
[0m03:13:11.654092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6243e520>]}
[0m03:13:11.654834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:13:11.666960 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:13:11.787674 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m03:13:11.788191 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/crm_sales.yml
[0m03:13:11.788467 [debug] [MainThread]: Partial parsing: deleted file: matt_demo://macros/column_greater_zero.sql
[0m03:13:11.955111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff797c1f40>]}
[0m03:13:12.031042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff794cf040>]}
[0m03:13:12.031487 [info ] [MainThread]: Found 8 models, 6 data tests, 4 sources, 653 macros
[0m03:13:12.031867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff797048b0>]}
[0m03:13:12.032914 [info ] [MainThread]: 
[0m03:13:12.033384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:12.035682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m03:13:12.036078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m03:13:12.055382 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:13:12.055659 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:13:12.055970 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m03:13:12.056286 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m03:13:12.056579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:12.056871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:12.059372 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m03:13:12.059597 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m03:13:12.059866 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:13:12.060178 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:13:12.060473 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m03:13:12.060800 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m03:13:12.062507 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m03:13:12.062715 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m03:13:12.063450 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m03:13:12.064159 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m03:13:12.064530 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m03:13:12.064813 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m03:13:12.068385 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.068687 [debug] [MainThread]: On master: BEGIN
[0m03:13:12.068933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:12.070430 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:13:12.070679 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.070969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:13:12.076796 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m03:13:12.077801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41d2e282-dd1d-4e07-9605-8ea6b1f04269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff794bd280>]}
[0m03:13:12.078101 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:12.078407 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.078648 [debug] [MainThread]: On master: BEGIN
[0m03:13:12.079012 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:13:12.079314 [debug] [MainThread]: On master: COMMIT
[0m03:13:12.079578 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.079816 [debug] [MainThread]: On master: COMMIT
[0m03:13:12.080127 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:13:12.080370 [debug] [MainThread]: On master: Close
[0m03:13:12.080695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:13:12.081062 [info ] [MainThread]: 
[0m03:13:12.085413 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m03:13:12.085681 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m03:13:12.085952 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m03:13:12.086173 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m03:13:12.086484 [info ] [Thread-1  ]: 1 of 6 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m03:13:12.086933 [info ] [Thread-2  ]: 2 of 6 START test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams ........ [RUN]
[0m03:13:12.087395 [info ] [Thread-3  ]: 3 of 6 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m03:13:12.087841 [info ] [Thread-4  ]: 4 of 6 START test not_null_crm_stg_sales_teams_sales_agent ..................... [RUN]
[0m03:13:12.088312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m03:13:12.088690 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m03:13:12.089116 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m03:13:12.089609 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800'
[0m03:13:12.089977 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m03:13:12.090268 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m03:13:12.090605 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m03:13:12.090951 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m03:13:12.105843 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m03:13:12.108945 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m03:13:12.138619 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m03:13:12.140962 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m03:13:12.141380 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m03:13:12.141707 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m03:13:12.142532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:12.144902 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m03:13:12.145374 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m03:13:12.145793 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m03:13:12.153797 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m03:13:12.154050 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m03:13:12.154249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m03:13:12.155667 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m03:13:12.156546 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m03:13:12.157414 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m03:13:12.157879 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m03:13:12.159137 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m03:13:12.158647 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m03:13:12.158870 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m03:13:12.158238 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m03:13:12.159374 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m03:13:12.159628 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: BEGIN
[0m03:13:12.160346 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m03:13:12.161971 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m03:13:12.162717 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m03:13:12.163054 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m03:13:12.162446 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:13:12.163577 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m03:13:12.164013 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_agent
from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is null



      
    ) dbt_internal_test
[0m03:13:12.164377 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.004 seconds
[0m03:13:12.164667 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m03:13:12.164890 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.005 seconds
[0m03:13:12.167258 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m03:13:12.167511 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m03:13:12.169675 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m03:13:12.170932 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m03:13:12.172469 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: ROLLBACK
[0m03:13:12.172902 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m03:13:12.173127 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m03:13:12.173834 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: Close
[0m03:13:12.174206 [info ] [Thread-3  ]: 3 of 6 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.09s]
[0m03:13:12.174692 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m03:13:12.177021 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m03:13:12.177529 [info ] [Thread-4  ]: 4 of 6 PASS not_null_crm_stg_sales_teams_sales_agent ........................... [[32mPASS[0m in 0.09s]
[0m03:13:12.178153 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m03:13:12.179555 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m03:13:12.180152 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m03:13:12.180492 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m03:13:12.180855 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m03:13:12.181565 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m03:13:12.182079 [info ] [Thread-3  ]: 5 of 6 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m03:13:12.182431 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m03:13:12.182757 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE manager = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE regional_office = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE team_name = 'NaN'
    

      
    ) dbt_internal_test
[0m03:13:12.183122 [info ] [Thread-4  ]: 6 of 6 START test unique_crm_stg_sales_teams_sales_agent ....................... [RUN]
[0m03:13:12.183609 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m03:13:12.183953 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m03:13:12.184429 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m03:13:12.184774 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.000 seconds
[0m03:13:12.184978 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m03:13:12.185389 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m03:13:12.186326 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m03:13:12.189835 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m03:13:12.190075 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m03:13:12.192132 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m03:13:12.192534 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m03:13:12.193901 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m03:13:12.194475 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m03:13:12.194847 [info ] [Thread-2  ]: 2 of 6 PASS no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams .............. [[32mPASS[0m in 0.11s]
[0m03:13:12.195357 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m03:13:12.195591 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m03:13:12.196983 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m03:13:12.197373 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m03:13:12.197774 [info ] [Thread-1  ]: 1 of 6 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.11s]
[0m03:13:12.199287 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m03:13:12.200107 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m03:13:12.200485 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m03:13:12.201202 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m03:13:12.201711 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m03:13:12.201524 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m03:13:12.202156 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: BEGIN
[0m03:13:12.202480 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m03:13:12.203542 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m03:13:12.203835 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m03:13:12.204032 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m03:13:12.204519 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m03:13:12.204761 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_agent as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is not null
group by sales_agent
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:12.204243 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:12.205488 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.000 seconds
[0m03:13:12.206478 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: ROLLBACK
[0m03:13:12.206850 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: Close
[0m03:13:12.207264 [info ] [Thread-4  ]: 6 of 6 PASS unique_crm_stg_sales_teams_sales_agent ............................. [[32mPASS[0m in 0.02s]
[0m03:13:12.207588 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m03:13:12.208803 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m03:13:12.207958 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m03:13:12.209121 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m03:13:12.209618 [info ] [Thread-3  ]: 5 of 6 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.03s]
[0m03:13:12.210081 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m03:13:12.210925 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.211186 [debug] [MainThread]: On master: BEGIN
[0m03:13:12.211436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:12.213027 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:13:12.213260 [debug] [MainThread]: On master: COMMIT
[0m03:13:12.213532 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:12.213765 [debug] [MainThread]: On master: COMMIT
[0m03:13:12.214059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:13:12.214330 [debug] [MainThread]: On master: Close
[0m03:13:12.214657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:12.214896 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m03:13:12.215109 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m03:13:12.215323 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m03:13:12.215569 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m03:13:12.215865 [info ] [MainThread]: 
[0m03:13:12.216177 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m03:13:12.216937 [debug] [MainThread]: Command end result
[0m03:13:12.243784 [info ] [MainThread]: 
[0m03:13:12.244183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:12.244506 [info ] [MainThread]: 
[0m03:13:12.244816 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m03:13:12.245425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7227551, "process_user_time": 2.402335, "process_kernel_time": 0.110475, "process_mem_max_rss": "139340", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:13:12.245792 [debug] [MainThread]: Command `dbt test` succeeded at 03:13:12.245744 after 0.72 seconds
[0m03:13:12.246072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63ca92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff623a69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff639b97c0>]}
[0m03:13:12.246356 [debug] [MainThread]: Flushing usage events
[0m03:32:38.889640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c93e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af3b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af3b8b0>]}


============================== 03:32:38.896981 | 08e7e641-07d4-4a8b-8ad1-9289481da5f8 ==============================
[0m03:32:38.896981 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:32:38.897557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m product_win_rate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:32:38.981317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08e7e641-07d4-4a8b-8ad1-9289481da5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a23460>]}
[0m03:32:39.006037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08e7e641-07d4-4a8b-8ad1-9289481da5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a8bc40>]}
[0m03:32:39.006709 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:32:39.018285 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:32:39.143612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:32:39.143998 [debug] [MainThread]: Partial parsing: added file: matt_demo://models/crm_sales_data/final/product_win_rates.sql
[0m03:32:39.261968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08e7e641-07d4-4a8b-8ad1-9289481da5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96870130>]}
[0m03:32:39.330131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08e7e641-07d4-4a8b-8ad1-9289481da5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f23f70>]}
[0m03:32:39.330527 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m03:32:39.330845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e7e641-07d4-4a8b-8ad1-9289481da5f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9992e850>]}
[0m03:32:39.331377 [warn ] [MainThread]: The selection criterion 'product_win_rate' does not match any enabled nodes
[0m03:32:39.332118 [info ] [MainThread]: 
[0m03:32:39.332539 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:32:39.332997 [debug] [MainThread]: Command end result
[0m03:32:39.357935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49465632, "process_user_time": 2.206, "process_kernel_time": 0.112203, "process_mem_max_rss": "123868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:32:39.358411 [debug] [MainThread]: Command `dbt run` succeeded at 03:32:39.358358 after 0.50 seconds
[0m03:32:39.358681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c93e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b56b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7badf040>]}
[0m03:32:39.358922 [debug] [MainThread]: Flushing usage events
[0m03:32:46.086647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff759332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f30850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73f307f0>]}


============================== 03:32:46.089947 | a930b62f-97c1-48f6-b4f5-b1678dc328d3 ==============================
[0m03:32:46.089947 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:32:46.090491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m product_win_rates', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:32:46.166453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a21040>]}
[0m03:32:46.190597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a177f0>]}
[0m03:32:46.191112 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:32:46.201555 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:32:46.325643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:32:46.325988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:32:46.352804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925f2ee0>]}
[0m03:32:46.427067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92616f70>]}
[0m03:32:46.427449 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m03:32:46.427791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926586d0>]}
[0m03:32:46.428770 [info ] [MainThread]: 
[0m03:32:46.429368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:32:46.430018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m03:32:46.449451 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m03:32:46.449926 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:32:46.450313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:46.453133 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m03:32:46.453958 [debug] [ThreadPool]: On list_company_dw: Close
[0m03:32:46.456736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m03:32:46.457088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m03:32:46.460689 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:32:46.462407 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:32:46.462772 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m03:32:46.463096 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m03:32:46.463436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:32:46.463774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:32:46.465921 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:32:46.466120 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:32:46.466397 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:32:46.466734 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:32:46.467025 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m03:32:46.467383 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m03:32:46.469120 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m03:32:46.469346 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m03:32:46.470152 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m03:32:46.470882 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m03:32:46.471245 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m03:32:46.471530 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m03:32:46.475321 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.475652 [debug] [MainThread]: On master: BEGIN
[0m03:32:46.475920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:32:46.477461 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:32:46.477747 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.478072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:32:46.484465 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m03:32:46.485580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75908be0>]}
[0m03:32:46.485920 [debug] [MainThread]: On master: ROLLBACK
[0m03:32:46.486268 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.486584 [debug] [MainThread]: On master: BEGIN
[0m03:32:46.486953 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:32:46.487218 [debug] [MainThread]: On master: COMMIT
[0m03:32:46.487495 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.487755 [debug] [MainThread]: On master: COMMIT
[0m03:32:46.488072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:32:46.488347 [debug] [MainThread]: On master: Close
[0m03:32:46.488717 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:32:46.489080 [info ] [MainThread]: 
[0m03:32:46.493239 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m03:32:46.493769 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt.product_win_rates ............... [RUN]
[0m03:32:46.494229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.product_win_rates)
[0m03:32:46.494574 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m03:32:46.499414 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m03:32:46.500611 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m03:32:46.521507 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.product_win_rates"
[0m03:32:46.522660 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:32:46.522958 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: BEGIN
[0m03:32:46.523239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:32:46.525426 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:32:46.525733 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:32:46.526008 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_tmp"
  
  
    as
  
  (
    

WITH win_counts AS (
    SELECT product_name AS product_name,
        sum(case
                when deal_stage = 'Won' then 1
                else 0
            end) AS won_deals,
        sum(case
                when (deal_stage != 'NaN'
                        and deal_stage is not null) then 1
                else 0
            end) AS all_deals
    FROM
    (SELECT *
    FROM "company_dw"."dev_crm_sales_dbt"."crm_int_kpi" a
    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table
    GROUP BY product_name
    ORDER BY won_deals DESC )
select *,
    sum(won_deals) / sum(all_deals) as product_win_rate
from win_counts
  );
  
[0m03:32:46.526995 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "win_counts.product_name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 31: select *,
                ^

[0m03:32:46.527296 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: ROLLBACK
[0m03:32:46.527684 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: Close
[0m03:32:46.528960 [debug] [Thread-1  ]: Database Error in model product_win_rates (models/crm_sales_data/final/product_win_rates.sql)
  column "win_counts.product_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 31: select *,
                  ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/product_win_rates.sql
[0m03:32:46.529860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a930b62f-97c1-48f6-b4f5-b1678dc328d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74acdcd0>]}
[0m03:32:46.530262 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_crm_sales_dbt.product_win_rates ...... [[31mERROR[0m in 0.04s]
[0m03:32:46.530781 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m03:32:46.531670 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.531953 [debug] [MainThread]: On master: BEGIN
[0m03:32:46.532175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:32:46.533830 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:32:46.534107 [debug] [MainThread]: On master: COMMIT
[0m03:32:46.534358 [debug] [MainThread]: Using postgres connection "master"
[0m03:32:46.534642 [debug] [MainThread]: On master: COMMIT
[0m03:32:46.534961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:32:46.535213 [debug] [MainThread]: On master: Close
[0m03:32:46.535542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:32:46.535800 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m03:32:46.536053 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m03:32:46.536358 [info ] [MainThread]: 
[0m03:32:46.536734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m03:32:46.537244 [debug] [MainThread]: Command end result
[0m03:32:46.566214 [info ] [MainThread]: 
[0m03:32:46.566687 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:32:46.566993 [info ] [MainThread]: 
[0m03:32:46.567321 [error] [MainThread]:   Database Error in model product_win_rates (models/crm_sales_data/final/product_win_rates.sql)
  column "win_counts.product_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 31: select *,
                  ^
  compiled Code at target/run/matt_demo/models/crm_sales_data/final/product_win_rates.sql
[0m03:32:46.567653 [info ] [MainThread]: 
[0m03:32:46.567961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:32:46.568556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50679225, "process_user_time": 2.176489, "process_kernel_time": 0.08298, "process_mem_max_rss": "127248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:32:46.568946 [debug] [MainThread]: Command `dbt run` failed at 03:32:46.568890 after 0.51 seconds
[0m03:32:46.569263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff759332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a21040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927e3340>]}
[0m03:32:46.569565 [debug] [MainThread]: Flushing usage events
[0m03:33:36.956769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fd22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965cf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965cf7f0>]}


============================== 03:33:36.960114 | 12ac38c7-ad6b-44c0-9ae6-49aa2ee45844 ==============================
[0m03:33:36.960114 [info ] [MainThread]: Running with dbt=1.8.3
[0m03:33:36.960643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m product_win_rates', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:33:37.035930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5099c70>]}
[0m03:33:37.059969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bb3940>]}
[0m03:33:37.060648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:33:37.071510 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m03:33:37.189573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:33:37.189994 [debug] [MainThread]: Partial parsing: updated file: matt_demo://models/crm_sales_data/final/product_win_rates.sql
[0m03:33:37.305839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb01130>]}
[0m03:33:37.372110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafaa6d00>]}
[0m03:33:37.372535 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m03:33:37.372916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c90220>]}
[0m03:33:37.373683 [info ] [MainThread]: 
[0m03:33:37.374132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:33:37.374750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m03:33:37.390162 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m03:33:37.390551 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m03:33:37.390843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:33:37.393243 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m03:33:37.393959 [debug] [ThreadPool]: On list_company_dw: Close
[0m03:33:37.396562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m03:33:37.396918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m03:33:37.400125 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:33:37.401643 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:33:37.401949 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m03:33:37.402248 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m03:33:37.402551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:33:37.402834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:33:37.404571 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:33:37.404797 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m03:33:37.405072 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m03:33:37.405373 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m03:33:37.405696 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m03:33:37.406023 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m03:33:37.407303 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m03:33:37.407510 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m03:33:37.408270 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m03:33:37.408980 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m03:33:37.409413 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m03:33:37.409682 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m03:33:37.413101 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.413367 [debug] [MainThread]: On master: BEGIN
[0m03:33:37.413576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:33:37.414961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:33:37.415216 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.415494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:33:37.420984 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m03:33:37.421989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fa76a0>]}
[0m03:33:37.422286 [debug] [MainThread]: On master: ROLLBACK
[0m03:33:37.422620 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.422878 [debug] [MainThread]: On master: BEGIN
[0m03:33:37.423243 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:33:37.423493 [debug] [MainThread]: On master: COMMIT
[0m03:33:37.423707 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.423930 [debug] [MainThread]: On master: COMMIT
[0m03:33:37.424224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:33:37.424475 [debug] [MainThread]: On master: Close
[0m03:33:37.424801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:33:37.425220 [info ] [MainThread]: 
[0m03:33:37.429157 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m03:33:37.429569 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt.product_win_rates ............... [RUN]
[0m03:33:37.430017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.product_win_rates)
[0m03:33:37.430326 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m03:33:37.434619 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m03:33:37.435632 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m03:33:37.454418 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.product_win_rates"
[0m03:33:37.455370 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:33:37.455643 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: BEGIN
[0m03:33:37.455875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:33:37.457595 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m03:33:37.457869 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:33:37.458162 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_tmp"
  
  
    as
  
  (
    

WITH win_counts AS (
    SELECT product_name AS product_name,
        sum(case
                when deal_stage = 'Won' then 1
                else 0
            end) AS won_deals,
        sum(case
                when (deal_stage != 'NaN'
                        and deal_stage is not null) then 1
                else 0
            end) AS all_deals
    FROM
    (SELECT *
    FROM "company_dw"."dev_crm_sales_dbt"."crm_int_kpi" a
    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table
    GROUP BY product_name
    ORDER BY won_deals DESC )
select product_name,
        sum(won_deals) as won_deals,
        sum(all_deals) as all_deals,
    sum(won_deals) / sum(all_deals) as product_win_rate
from win_counts
group by product_name
  );
  
[0m03:33:37.473458 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.015 seconds
[0m03:33:37.477020 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:33:37.477274 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_tmp" rename to "product_win_rates"
[0m03:33:37.477725 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:33:37.485835 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m03:33:37.486134 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:33:37.486407 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m03:33:37.486948 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m03:33:37.490001 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_backup"
[0m03:33:37.491890 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m03:33:37.492147 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_backup" cascade
[0m03:33:37.492520 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m03:33:37.493707 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: Close
[0m03:33:37.494568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12ac38c7-ad6b-44c0-9ae6-49aa2ee45844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf659be0>]}
[0m03:33:37.494969 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt.product_win_rates .......... [[32mSELECT 7[0m in 0.06s]
[0m03:33:37.495459 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m03:33:37.496257 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.496535 [debug] [MainThread]: On master: BEGIN
[0m03:33:37.496808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:33:37.498383 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:33:37.498628 [debug] [MainThread]: On master: COMMIT
[0m03:33:37.498861 [debug] [MainThread]: Using postgres connection "master"
[0m03:33:37.499081 [debug] [MainThread]: On master: COMMIT
[0m03:33:37.499393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:33:37.499651 [debug] [MainThread]: On master: Close
[0m03:33:37.499954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:33:37.500203 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m03:33:37.500444 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt' was properly closed.
[0m03:33:37.500733 [info ] [MainThread]: 
[0m03:33:37.501075 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m03:33:37.501568 [debug] [MainThread]: Command end result
[0m03:33:37.527396 [info ] [MainThread]: 
[0m03:33:37.527810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:33:37.528111 [info ] [MainThread]: 
[0m03:33:37.528423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:33:37.528992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59703034, "process_user_time": 2.317334, "process_kernel_time": 0.080358, "process_mem_max_rss": "125940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:33:37.529325 [debug] [MainThread]: Command `dbt run` succeeded at 03:33:37.529284 after 0.60 seconds
[0m03:33:37.529663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fd22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97174c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafaa6d00>]}
[0m03:33:37.529948 [debug] [MainThread]: Flushing usage events
[0m22:00:55.464008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff796e6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff796e6730>]}


============================== 22:00:55.468773 | 1eae53f6-96dd-4c24-852c-7b1870961884 ==============================
[0m22:00:55.468773 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:00:55.469315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:00:55.598764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981e15e0>]}
[0m22:00:55.621664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9818bd00>]}
[0m22:00:55.622541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:00:55.635378 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:00:55.726002 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:00:55.726627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a292310>]}
[0m22:00:56.392182 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:00:56.392822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e0c340>]}
[0m22:00:56.399850 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:00:56.400804 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:00:56.492671 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:00:56.493327 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:00:56.493781 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:00:56.494202 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:00:56.494646 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:00:56.495040 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:00:56.495496 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:00:56.495910 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:00:56.552917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f64130>]}
[0m22:00:56.636116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908fc3d0>]}
[0m22:00:56.636559 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:00:56.636939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f25970>]}
[0m22:00:56.637996 [info ] [MainThread]: 
[0m22:00:56.638471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:56.640849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:00:56.641787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:00:56.664158 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:00:56.664411 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:00:56.664724 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:00:56.665021 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:00:56.665301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:56.665547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:56.668429 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:00:56.668636 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:00:56.668901 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:00:56.669153 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:00:56.669419 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:00:56.669711 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:00:56.672952 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m22:00:56.673153 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:00:56.673939 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:00:56.674661 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:00:56.675077 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:00:56.675331 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:00:56.679066 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.679369 [debug] [MainThread]: On master: BEGIN
[0m22:00:56.679622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:56.681147 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:00:56.681515 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.681847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:56.689355 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m22:00:56.690452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eae53f6-96dd-4c24-852c-7b1870961884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908d6910>]}
[0m22:00:56.690785 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:56.691114 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.691363 [debug] [MainThread]: On master: BEGIN
[0m22:00:56.691664 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:00:56.691890 [debug] [MainThread]: On master: COMMIT
[0m22:00:56.692107 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.692326 [debug] [MainThread]: On master: COMMIT
[0m22:00:56.692591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:56.692823 [debug] [MainThread]: On master: Close
[0m22:00:56.693145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:56.693520 [info ] [MainThread]: 
[0m22:00:56.698753 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:00:56.699007 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:00:56.699270 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:00:56.699568 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:00:56.699801 [info ] [Thread-1  ]: 1 of 6 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m22:00:56.700243 [info ] [Thread-2  ]: 2 of 6 START test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams ........ [RUN]
[0m22:00:56.700651 [info ] [Thread-3  ]: 3 of 6 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m22:00:56.701010 [info ] [Thread-4  ]: 4 of 6 START test not_null_crm_stg_sales_teams_sales_agent ..................... [RUN]
[0m22:00:56.701495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:00:56.701827 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:00:56.702209 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d'
[0m22:00:56.702569 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800'
[0m22:00:56.702869 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:00:56.703163 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:00:56.703462 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:00:56.703752 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:00:56.714801 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:00:56.717976 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:00:56.723096 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:00:56.726213 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:00:56.726638 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:00:56.727015 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:00:56.727908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:56.728485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:00:56.729193 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:00:56.729430 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:00:56.737656 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:00:56.737972 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m22:00:56.738232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m22:00:56.740002 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:00:56.740572 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:00:56.741007 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:00:56.741504 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:00:56.741807 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:00:56.742258 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:00:56.742489 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:00:56.742795 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m22:00:56.743373 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: BEGIN
[0m22:00:56.743697 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:00:56.744017 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:00:56.746290 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m22:00:56.746551 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:00:56.746879 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:00:56.747257 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:00:56.747598 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_agent
from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is null



      
    ) dbt_internal_test
[0m22:00:56.747953 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m22:00:56.748861 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m22:00:56.751611 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: ROLLBACK
[0m22:00:56.751882 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.009 seconds
[0m22:00:56.752125 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.009 seconds
[0m22:00:56.752525 [debug] [Thread-4  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: Close
[0m22:00:56.754709 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:00:56.755925 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:00:56.756179 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.007 seconds
[0m22:00:56.756636 [info ] [Thread-4  ]: 4 of 6 PASS not_null_crm_stg_sales_teams_sales_agent ........................... [[32mPASS[0m in 0.05s]
[0m22:00:56.758035 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m22:00:56.758543 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:00:56.758881 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:00:56.759110 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:00:56.759481 [debug] [Thread-3  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m22:00:56.761003 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:00:56.761389 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:00:56.797686 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:00:56.798315 [info ] [Thread-3  ]: 3 of 6 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.10s]
[0m22:00:56.799136 [info ] [Thread-4  ]: 5 of 6 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m22:00:56.799959 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:00:56.800429 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:00:56.800905 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:00:56.801154 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:00:56.801524 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE manager = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE regional_office = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" WHERE team_name = 'NaN'
    

      
    ) dbt_internal_test
[0m22:00:56.801926 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:00:56.802277 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:00:56.802603 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m22:00:56.803129 [info ] [Thread-3  ]: 6 of 6 START test unique_crm_stg_sales_teams_sales_agent ....................... [RUN]
[0m22:00:56.807311 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:00:56.807698 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.005 seconds
[0m22:00:56.808327 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:00:56.811045 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:00:56.811721 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:00:56.812097 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:00:56.812367 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m22:00:56.812762 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:00:56.815614 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:00:56.817788 [debug] [Thread-4  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:00:56.818964 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:00:56.819532 [info ] [Thread-2  ]: 2 of 6 PASS no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams .............. [[32mPASS[0m in 0.12s]
[0m22:00:56.820524 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:00:56.820893 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:00:56.821126 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:00:56.821482 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:00:56.821942 [info ] [Thread-1  ]: 1 of 6 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.12s]
[0m22:00:56.824066 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:00:56.824496 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m22:00:56.824941 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:00:56.825488 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m22:00:56.825944 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:00:56.826457 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: BEGIN
[0m22:00:56.826745 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:00:56.827887 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m22:00:56.828243 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m22:00:56.828465 [debug] [Thread-4  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:00:56.828769 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:00:56.829055 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:56.829362 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_agent as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is not null
group by sales_agent
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:56.830278 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.000 seconds
[0m22:00:56.831240 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: ROLLBACK
[0m22:00:56.831667 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: Close
[0m22:00:56.832013 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:00:56.832474 [info ] [Thread-3  ]: 6 of 6 PASS unique_crm_stg_sales_teams_sales_agent ............................. [[32mPASS[0m in 0.02s]
[0m22:00:56.833487 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m22:00:56.833960 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:00:56.834415 [debug] [Thread-4  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m22:00:56.835047 [info ] [Thread-4  ]: 5 of 6 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.03s]
[0m22:00:56.835501 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:00:56.836407 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.836683 [debug] [MainThread]: On master: BEGIN
[0m22:00:56.836962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:56.838906 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:00:56.839229 [debug] [MainThread]: On master: COMMIT
[0m22:00:56.839570 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:56.839892 [debug] [MainThread]: On master: COMMIT
[0m22:00:56.840287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:56.840635 [debug] [MainThread]: On master: Close
[0m22:00:56.841028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:56.841385 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:00:56.841661 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:00:56.841966 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:00:56.842304 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m22:00:56.842707 [info ] [MainThread]: 
[0m22:00:56.843098 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m22:00:56.844083 [debug] [MainThread]: Command end result
[0m22:00:56.878909 [info ] [MainThread]: 
[0m22:00:56.879378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:56.879720 [info ] [MainThread]: 
[0m22:00:56.880051 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:00:56.880736 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4442452, "process_user_time": 3.035235, "process_kernel_time": 0.459338, "process_mem_max_rss": "138284", "process_out_blocks": "912", "process_in_blocks": "0"}
[0m22:00:56.881125 [debug] [MainThread]: Command `dbt test` succeeded at 22:00:56.881079 after 1.44 seconds
[0m22:00:56.881456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5542b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aaa2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981e56a0>]}
[0m22:00:56.881756 [debug] [MainThread]: Flushing usage events
[0m22:01:27.931511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8853b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ad7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ad7700>]}


============================== 22:01:27.934840 | cc44a55b-cc8a-4da5-9058-e8f1c04c7113 ==============================
[0m22:01:27.934840 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:01:27.935416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:28.012592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56172b0>]}
[0m22:01:28.036631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ccf520>]}
[0m22:01:28.037342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:01:28.053325 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:01:28.181837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:01:28.182148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:01:28.206508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5265fd0>]}
[0m22:01:28.274832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51fee20>]}
[0m22:01:28.275225 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:01:28.275560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54c8e20>]}
[0m22:01:28.276636 [info ] [MainThread]: 
[0m22:01:28.277126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:01:28.279570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:01:28.279979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:01:28.298958 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:01:28.299216 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:01:28.299527 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:01:28.299881 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:01:28.300206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:28.300498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:28.303694 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m22:01:28.303898 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:01:28.304585 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:01:28.305232 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:01:28.306686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_global_dim)
[0m22:01:28.307088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt)
[0m22:01:28.310846 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:01:28.312187 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:01:28.312510 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:01:28.312824 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:01:28.313143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:28.313433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:28.315714 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.315949 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.316247 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:01:28.316553 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:01:28.316869 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:01:28.317203 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:01:28.318629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:01:28.318838 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m22:01:28.319515 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:01:28.320217 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:01:28.320562 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:01:28.320849 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:01:28.324386 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.324699 [debug] [MainThread]: On master: BEGIN
[0m22:01:28.324995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:28.326631 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:01:28.326875 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.327119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:01:28.332962 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m22:01:28.333978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881bfb50>]}
[0m22:01:28.334274 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:28.334581 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.334840 [debug] [MainThread]: On master: BEGIN
[0m22:01:28.335177 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:01:28.335392 [debug] [MainThread]: On master: COMMIT
[0m22:01:28.335589 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.335783 [debug] [MainThread]: On master: COMMIT
[0m22:01:28.336044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:28.336259 [debug] [MainThread]: On master: Close
[0m22:01:28.336558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:28.336893 [info ] [MainThread]: 
[0m22:01:28.341300 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:01:28.341563 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:01:28.341844 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:01:28.342238 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:01:28.342631 [info ] [Thread-1  ]: 1 of 9 START sql view model dev_crm_sales_dbt.crm_stg_accounts ................. [RUN]
[0m22:01:28.343267 [info ] [Thread-2  ]: 2 of 9 START sql view model dev_crm_sales_dbt.crm_stg_products ................. [RUN]
[0m22:01:28.343834 [info ] [Thread-3  ]: 3 of 9 START sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines .......... [RUN]
[0m22:01:28.344300 [info ] [Thread-4  ]: 4 of 9 START sql view model dev_crm_sales_dbt.crm_stg_sales_teams .............. [RUN]
[0m22:01:28.344820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:01:28.345262 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:01:28.345641 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:01:28.346093 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:01:28.346425 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:01:28.346762 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:01:28.347090 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:01:28.347413 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:01:28.351959 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:01:28.354330 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:01:28.356159 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.358192 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.362606 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:01:28.363073 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:01:28.369345 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:01:28.375076 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:01:28.382197 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m22:01:28.385119 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m22:01:28.387083 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.389007 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.390286 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.390635 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.390885 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m22:01:28.391126 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.391438 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.391693 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m22:01:28.392031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:28.392301 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m22:01:28.392589 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m22:01:28.392880 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:01:28.393349 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:01:28.393681 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m22:01:28.395142 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.395598 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.395857 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.396119 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.396366 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.396650 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.396980 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.397303 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue_mm,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m22:01:28.397611 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.397934 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m22:01:28.398297 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m22:01:28.398791 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m22:01:28.406164 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:01:28.406421 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:01:28.406702 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:01:28.410380 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.410624 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.012 seconds
[0m22:01:28.412393 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.414544 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.414929 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products" rename to "crm_stg_products__dbt_backup"
[0m22:01:28.416734 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.417058 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams" rename to "crm_stg_sales_teams__dbt_backup"
[0m22:01:28.417377 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines" rename to "crm_stg_sales_pipelines__dbt_backup"
[0m22:01:28.417811 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts" rename to "crm_stg_accounts__dbt_backup"
[0m22:01:28.418132 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.418527 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.418761 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.420615 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.420828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:01:28.422451 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.424238 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.424556 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m22:01:28.426552 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.426870 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m22:01:28.427194 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m22:01:28.427644 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m22:01:28.427867 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.428339 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.428586 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.435119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:01:28.436500 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:01:28.437230 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:01:28.437957 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:01:28.438653 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:01:28.439000 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.439311 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.439616 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.439952 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.440263 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:01:28.440570 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:01:28.440896 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:01:28.441202 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:01:28.442578 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m22:01:28.442866 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:01:28.443055 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m22:01:28.443302 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m22:01:28.446227 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m22:01:28.447692 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m22:01:28.449150 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m22:01:28.450599 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m22:01:28.452638 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:01:28.453075 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:01:28.453803 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:01:28.454206 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:01:28.454538 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m22:01:28.454864 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m22:01:28.455182 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m22:01:28.455500 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m22:01:28.457948 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m22:01:28.459338 [debug] [Thread-2  ]: On model.matt_demo.crm_stg_products: Close
[0m22:01:28.459564 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.003 seconds
[0m22:01:28.459792 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m22:01:28.460040 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.004 seconds
[0m22:01:28.460910 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51feee0>]}
[0m22:01:28.461639 [debug] [Thread-4  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m22:01:28.462354 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m22:01:28.463079 [debug] [Thread-3  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m22:01:28.463508 [info ] [Thread-2  ]: 2 of 9 OK created sql view model dev_crm_sales_dbt.crm_stg_products ............ [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:28.463996 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e62610>]}
[0m22:01:28.464402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e97820>]}
[0m22:01:28.464821 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e624f0>]}
[0m22:01:28.465236 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:01:28.465630 [info ] [Thread-4  ]: 4 of 9 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_teams ......... [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:28.466126 [info ] [Thread-1  ]: 1 of 9 OK created sql view model dev_crm_sales_dbt.crm_stg_accounts ............ [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:28.466617 [info ] [Thread-3  ]: 3 of 9 OK created sql view model dev_crm_sales_dbt.crm_stg_sales_pipelines ..... [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:28.467043 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:01:28.467474 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:01:28.467854 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:01:28.468275 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:01:28.468646 [info ] [Thread-2  ]: 5 of 9 START sql table model dev_global_dim.dim_date ........................... [RUN]
[0m22:01:28.469684 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:01:28.470052 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:01:28.470412 [info ] [Thread-4  ]: 6 of 9 START sql view model dev_crm_sales_dbt.crm_int_kpi ...................... [RUN]
[0m22:01:28.470837 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:01:28.471179 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now model.matt_demo.crm_int_kpi)
[0m22:01:28.503506 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:01:28.503974 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:01:28.506561 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:01:28.507138 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:01:28.518374 [debug] [Thread-2  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m22:01:28.519062 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:01:28.521170 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.crm_int_kpi"
[0m22:01:28.521653 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.521970 [debug] [Thread-2  ]: On model.matt_demo.dim_date: BEGIN
[0m22:01:28.522224 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:01:28.522502 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:01:28.522776 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: BEGIN
[0m22:01:28.523213 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m22:01:28.524786 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m22:01:28.524997 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m22:01:28.525269 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:01:28.525543 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.525859 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */

  create view "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_tmp"
    
    
  as (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
[0m22:01:28.526237 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dev_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m22:01:28.528935 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:01:28.531752 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:01:28.532120 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_tmp" rename to "crm_int_kpi"
[0m22:01:28.532735 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.533452 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:01:28.533763 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:01:28.534158 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:01:28.535351 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m22:01:28.537120 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_backup"
[0m22:01:28.537718 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:01:28.538081 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
drop view if exists "company_dw"."dev_crm_sales_dbt"."crm_int_kpi__dbt_backup" cascade
[0m22:01:28.538695 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:01:28.539699 [debug] [Thread-4  ]: On model.matt_demo.crm_int_kpi: Close
[0m22:01:28.540285 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c7e8e0>]}
[0m22:01:28.540902 [info ] [Thread-4  ]: 6 of 9 OK created sql view model dev_crm_sales_dbt.crm_int_kpi ................. [[32mCREATE VIEW[0m in 0.07s]
[0m22:01:28.541435 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:01:28.542052 [debug] [Thread-3  ]: Began running node model.matt_demo.kpi
[0m22:01:28.542374 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m22:01:28.542743 [debug] [Thread-4  ]: Began running node model.matt_demo.qoq_kpi
[0m22:01:28.543197 [info ] [Thread-3  ]: 7 of 9 START sql table model dev_crm_sales_dbt.kpi ............................. [RUN]
[0m22:01:28.543778 [info ] [Thread-1  ]: 8 of 9 START sql table model dev_crm_sales_dbt.product_win_rates ............... [RUN]
[0m22:01:28.544312 [info ] [Thread-4  ]: 9 of 9 START sql table model dev_crm_sales_dbt.qoq_kpi ......................... [RUN]
[0m22:01:28.544887 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now model.matt_demo.kpi)
[0m22:01:28.545257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.product_win_rates)
[0m22:01:28.545629 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_int_kpi, now model.matt_demo.qoq_kpi)
[0m22:01:28.545957 [debug] [Thread-3  ]: Began compiling node model.matt_demo.kpi
[0m22:01:28.546292 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:01:28.546612 [debug] [Thread-4  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:01:28.548941 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:01:28.550900 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:01:28.552825 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:01:28.554063 [debug] [Thread-3  ]: Began executing node model.matt_demo.kpi
[0m22:01:28.554277 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m22:01:28.557209 [debug] [Thread-3  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m22:01:28.557519 [debug] [Thread-4  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:01:28.559583 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.product_win_rates"
[0m22:01:28.562135 [debug] [Thread-4  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m22:01:28.562681 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.563097 [debug] [Thread-3  ]: On model.matt_demo.kpi: BEGIN
[0m22:01:28.563319 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.563636 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m22:01:28.563891 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.564183 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: BEGIN
[0m22:01:28.564725 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m22:01:28.565255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:01:28.565638 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m22:01:28.566952 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.567412 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.567874 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.568111 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "company_dw"."dev_crm_sales_dbt"."crm_int_kpi"
  );
  
[0m22:01:28.568341 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m22:01:28.568666 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.569176 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.569590 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_tmp"
  
  
    as
  
  (
    

WITH win_counts AS (
    SELECT product_name AS product_name,
        sum(case
                when deal_stage = 'Won' then 1
                else 0
            end) AS won_deals,
        sum(case
                when (deal_stage != 'NaN'
                        and deal_stage is not null) then 1
                else 0
            end) AS all_deals
    FROM
    (SELECT *
    FROM "company_dw"."dev_crm_sales_dbt"."crm_int_kpi" a
    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table
    GROUP BY product_name
    ORDER BY won_deals DESC )
select product_name,
        sum(won_deals) as won_deals,
        sum(all_deals) as all_deals,
    sum(won_deals) / sum(all_deals) as product_win_rate
from win_counts
group by product_name
  );
  
[0m22:01:28.570081 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp"
  
  
    as
  
  (
    


WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt"."crm_int_kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
  
[0m22:01:28.579917 [debug] [Thread-4  ]: SQL status: SELECT 5 in 0.009 seconds
[0m22:01:28.582465 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.582858 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."qoq_kpi" rename to "qoq_kpi__dbt_backup"
[0m22:01:28.583377 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.585379 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.585687 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m22:01:28.586154 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.589085 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:01:28.589314 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.019 seconds
[0m22:01:28.589576 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.592142 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.592439 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:01:28.592774 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt"."product_win_rates" rename to "product_win_rates__dbt_backup"
[0m22:01:28.593377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.595314 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.595662 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_tmp" rename to "product_win_rates"
[0m22:01:28.596281 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m22:01:28.596507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:28.598057 [debug] [Thread-4  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup"
[0m22:01:28.598938 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:01:28.600389 [debug] [Thread-4  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:01:28.600750 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.601063 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."qoq_kpi__dbt_backup" cascade
[0m22:01:28.601384 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:01:28.603617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:01:28.605460 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_backup"
[0m22:01:28.605692 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.004 seconds
[0m22:01:28.606150 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:01:28.606925 [debug] [Thread-4  ]: On model.matt_demo.qoq_kpi: Close
[0m22:01:28.607242 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."product_win_rates__dbt_backup" cascade
[0m22:01:28.607688 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f0fc70>]}
[0m22:01:28.608287 [info ] [Thread-4  ]: 9 of 9 OK created sql table model dev_crm_sales_dbt.qoq_kpi .................... [[32mSELECT 5[0m in 0.06s]
[0m22:01:28.608908 [debug] [Thread-4  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:01:28.609344 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:01:28.610180 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: Close
[0m22:01:28.610586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c3a340>]}
[0m22:01:28.611052 [info ] [Thread-1  ]: 8 of 9 OK created sql table model dev_crm_sales_dbt.product_win_rates .......... [[32mSELECT 7[0m in 0.07s]
[0m22:01:28.611536 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m22:01:28.612485 [debug] [Thread-3  ]: SQL status: SELECT 8800 in 0.043 seconds
[0m22:01:28.614370 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.614671 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi" rename to "kpi__dbt_backup"
[0m22:01:28.615148 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.617560 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.617852 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m22:01:28.618256 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.619054 [debug] [Thread-3  ]: On model.matt_demo.kpi: COMMIT
[0m22:01:28.619346 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.619635 [debug] [Thread-3  ]: On model.matt_demo.kpi: COMMIT
[0m22:01:28.622015 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m22:01:28.623534 [debug] [Thread-3  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup"
[0m22:01:28.623930 [debug] [Thread-3  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:01:28.624221 [debug] [Thread-3  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m22:01:28.626554 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:01:28.627277 [debug] [Thread-3  ]: On model.matt_demo.kpi: Close
[0m22:01:28.627705 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f0fdf0>]}
[0m22:01:28.628182 [info ] [Thread-3  ]: 7 of 9 OK created sql table model dev_crm_sales_dbt.kpi ........................ [[32mSELECT 8800[0m in 0.08s]
[0m22:01:28.628656 [debug] [Thread-3  ]: Finished running node model.matt_demo.kpi
[0m22:01:28.722982 [debug] [Thread-2  ]: SQL status: SELECT 29220 in 0.196 seconds
[0m22:01:28.725112 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.725362 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date" rename to "dim_date__dbt_backup"
[0m22:01:28.725844 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.727388 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.727686 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dev_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m22:01:28.728051 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:28.728853 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m22:01:28.729118 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.729360 [debug] [Thread-2  ]: On model.matt_demo.dim_date: COMMIT
[0m22:01:28.797396 [debug] [Thread-2  ]: SQL status: COMMIT in 0.068 seconds
[0m22:01:28.799283 [debug] [Thread-2  ]: Applying DROP to: "company_dw"."dev_global_dim"."dim_date__dbt_backup"
[0m22:01:28.799708 [debug] [Thread-2  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:01:28.799992 [debug] [Thread-2  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dev_global_dim"."dim_date__dbt_backup" cascade
[0m22:01:28.804852 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.005 seconds
[0m22:01:28.805665 [debug] [Thread-2  ]: On model.matt_demo.dim_date: Close
[0m22:01:28.806150 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc44a55b-cc8a-4da5-9058-e8f1c04c7113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b8fa90>]}
[0m22:01:28.806670 [info ] [Thread-2  ]: 5 of 9 OK created sql table model dev_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.34s]
[0m22:01:28.807190 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:01:28.808157 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.808417 [debug] [MainThread]: On master: BEGIN
[0m22:01:28.808646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:28.810419 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:01:28.810705 [debug] [MainThread]: On master: COMMIT
[0m22:01:28.810996 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:28.811233 [debug] [MainThread]: On master: COMMIT
[0m22:01:28.811522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:28.811773 [debug] [MainThread]: On master: Close
[0m22:01:28.812079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:28.812340 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m22:01:28.812596 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:01:28.812845 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:01:28.813063 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:01:28.813364 [info ] [MainThread]: 
[0m22:01:28.813715 [info ] [MainThread]: Finished running 5 view models, 4 table models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m22:01:28.814685 [debug] [MainThread]: Command end result
[0m22:01:28.864229 [info ] [MainThread]: 
[0m22:01:28.864872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:01:28.865316 [info ] [MainThread]: 
[0m22:01:28.865726 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:01:28.866651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.96113336, "process_user_time": 2.415202, "process_kernel_time": 0.128178, "process_mem_max_rss": "129504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:28.867219 [debug] [MainThread]: Command `dbt run` succeeded at 22:01:28.867157 after 0.96 seconds
[0m22:01:28.867585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8853b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87627a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b60970>]}
[0m22:01:28.867961 [debug] [MainThread]: Flushing usage events
[0m22:03:00.744470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ace22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff692dd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff692dd6d0>]}


============================== 22:03:00.748497 | 651da82f-b65c-481f-95aa-37d0a2aa29c6 ==============================
[0m22:03:00.748497 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:03:00.749060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:03:00.834795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dcdee0>]}
[0m22:03:00.858106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69e46550>]}
[0m22:03:00.858720 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:03:00.872060 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:03:01.010845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:01.011224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:01.035852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a1efa0>]}
[0m22:03:01.118332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87963a60>]}
[0m22:03:01.118848 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:03:01.119840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ce1820>]}
[0m22:03:01.122899 [info ] [MainThread]: 
[0m22:03:01.127697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:03:01.134659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:03:01.135594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:03:01.193860 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:03:01.194299 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:03:01.194955 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:03:01.195400 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:03:01.195929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:01.197539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:01.204352 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:03:01.206462 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:03:01.207094 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:03:01.207941 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m22:03:01.208739 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:03:01.210374 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:03:01.210687 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:03:01.212979 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:03:01.213204 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:03:01.213896 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:03:01.214580 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:03:01.216469 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:03:01.220771 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:01.221309 [debug] [MainThread]: On master: BEGIN
[0m22:03:01.221642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:01.223645 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:03:01.223986 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:01.225576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:03:01.234986 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m22:03:01.237749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651da82f-b65c-481f-95aa-37d0a2aa29c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9b6a60>]}
[0m22:03:01.238239 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:01.240727 [debug] [MainThread]: On master: Close
[0m22:03:01.241185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:01.241846 [info ] [MainThread]: 
[0m22:03:01.247588 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:03:01.247932 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:03:01.248248 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:03:01.248573 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:03:01.248890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m22:03:01.249291 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:03:01.249719 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:03:01.250120 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:03:01.250463 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:03:01.250779 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:03:01.251100 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:03:01.251415 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:03:01.256038 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:03:01.257881 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:03:01.260012 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:03:01.262537 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:03:01.264601 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:03:01.264907 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:03:01.265132 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:03:01.265585 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:03:01.265851 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:03:01.266283 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:03:01.266739 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:03:01.267122 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:03:01.267671 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:03:01.268420 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:03:01.268657 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:03:01.268922 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:03:01.269283 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:03:01.269714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:03:01.270061 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:03:01.270439 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:03:01.270784 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:03:01.271084 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:03:01.271418 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:03:01.273833 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:03:01.274338 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:03:01.288575 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:03:01.292942 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:03:01.297167 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:03:01.297623 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:03:01.298171 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:03:01.299453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:01.299917 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:03:01.300460 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:03:01.300714 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:03:01.301380 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:03:01.302391 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:03:01.302685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:03:01.303154 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:03:01.303511 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:03:01.303872 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.crm_int_kpi)
[0m22:03:01.304204 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:03:01.304637 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:03:01.305056 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:03:01.305404 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:03:01.305775 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:03:01.306143 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:03:01.306474 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:03:01.308786 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:03:01.312539 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:03:01.316319 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:03:01.316624 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.007 seconds
[0m22:03:01.319285 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:03:01.319759 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:03:01.320096 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:03:01.322245 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:03:01.322825 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:03:01.323358 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:03:01.323670 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:03:01.324418 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:03:01.324639 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:03:01.325252 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:03:01.325624 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_int_kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:03:01.325994 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:03:01.326255 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:03:01.326594 [debug] [Thread-4  ]: Began running node model.matt_demo.kpi
[0m22:03:01.326908 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:03:01.327311 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:03:01.327551 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:03:01.327889 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now model.matt_demo.kpi)
[0m22:03:01.331274 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:03:01.331910 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:03:01.332854 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:03:01.336244 [debug] [Thread-4  ]: Began compiling node model.matt_demo.kpi
[0m22:03:01.336948 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m22:03:01.337432 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:03:01.339448 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:03:01.339859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471, now model.matt_demo.product_win_rates)
[0m22:03:01.340102 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:03:01.340555 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:03:01.341049 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:03:01.342023 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:03:01.342311 [debug] [Thread-4  ]: Began executing node model.matt_demo.kpi
[0m22:03:01.342576 [debug] [Thread-2  ]: Began running node model.matt_demo.qoq_kpi
[0m22:03:01.344429 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:03:01.345074 [debug] [Thread-4  ]: Finished running node model.matt_demo.kpi
[0m22:03:01.345419 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d, now model.matt_demo.qoq_kpi)
[0m22:03:01.345642 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:03:01.346480 [debug] [Thread-2  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:03:01.346676 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m22:03:01.347000 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:03:01.349026 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:03:01.349583 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m22:03:01.350020 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:03:01.350788 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:03:01.351080 [debug] [Thread-2  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:03:01.351611 [debug] [Thread-2  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:03:01.352381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:01.352648 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:03:01.352875 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:03:01.353082 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:03:01.353265 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:03:01.354314 [debug] [MainThread]: Command end result
[0m22:03:01.382459 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.66331786, "process_user_time": 2.266217, "process_kernel_time": 0.155909, "process_mem_max_rss": "126164", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:03:01.382874 [debug] [MainThread]: Command `dbt compile` succeeded at 22:03:01.382827 after 0.66 seconds
[0m22:03:01.383176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ace22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69e84c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dcdee0>]}
[0m22:03:01.383467 [debug] [MainThread]: Flushing usage events
[0m22:04:42.686395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aeea550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68dda6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68dda670>]}


============================== 22:04:42.690058 | 4de33a95-d9d8-4f10-bfde-60acf3f10657 ==============================
[0m22:04:42.690058 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:04:42.690503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:04:42.799962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68fb6760>]}
[0m22:04:42.841242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a40a4f0>]}
[0m22:04:42.842612 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:42.860794 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:04:42.971122 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:04:42.971701 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m22:04:42.972081 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:04:42.972475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a40dc70>]}
[0m22:04:43.658000 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:04:43.658605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87793a60>]}
[0m22:04:43.665859 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:04:43.666805 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:04:43.762002 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:04:43.762592 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:04:43.763021 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:04:43.763401 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:04:43.763772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:04:43.764167 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:04:43.764646 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:04:43.765077 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:04:43.845004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863af130>]}
[0m22:04:43.854841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863f22e0>]}
[0m22:04:43.855344 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:04:43.855742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863af2e0>]}
[0m22:04:43.856647 [info ] [MainThread]: 
[0m22:04:43.857134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:43.857756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:04:43.891464 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:04:43.891956 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:04:43.892306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:43.896811 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m22:04:43.898314 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:04:43.899039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:04:43.899535 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dev_crm_sales_dbt_crm_sales_dbt"
"
[0m22:04:43.902725 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.903004 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:04:43.903238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:43.905070 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:43.905395 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.905764 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
create schema if not exists "dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.906911 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:04:43.907548 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt_crm_sales_dbt: COMMIT
[0m22:04:43.907880 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.908188 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt_crm_sales_dbt: COMMIT
[0m22:04:43.910680 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m22:04:43.911003 [debug] [ThreadPool]: On create_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:04:43.916636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:04:43.917276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:04:43.921025 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:43.923225 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.923639 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:04:43.923983 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:04:43.924300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:43.924630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:43.926949 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:43.927165 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:04:43.927518 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:43.927962 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:43.928324 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:04:43.928720 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:04:43.930879 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:04:43.931112 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:04:43.931949 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:04:43.932770 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:04:43.933213 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:04:43.933498 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:04:43.937117 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:43.937508 [debug] [MainThread]: On master: BEGIN
[0m22:04:43.937823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:43.939755 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:04:43.940047 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:43.940403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:43.946996 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m22:04:43.948039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862e0640>]}
[0m22:04:43.948426 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:43.948868 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:43.949164 [debug] [MainThread]: On master: BEGIN
[0m22:04:43.949584 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:04:43.949917 [debug] [MainThread]: On master: COMMIT
[0m22:04:43.950213 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:43.950482 [debug] [MainThread]: On master: COMMIT
[0m22:04:43.950860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:43.951172 [debug] [MainThread]: On master: Close
[0m22:04:43.951578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:43.951982 [info ] [MainThread]: 
[0m22:04:43.957115 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m22:04:43.957598 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_products ... [RUN]
[0m22:04:43.958030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:04:43.958410 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:04:43.962877 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:04:43.964108 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:04:43.980687 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m22:04:43.982517 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:04:43.982882 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m22:04:43.983203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:43.985186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:04:43.985490 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:04:43.985784 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m22:04:43.987612 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:04:43.991527 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:04:43.991864 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m22:04:43.992340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:04:43.999366 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:04:43.999729 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:04:44.000064 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:04:44.002191 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:04:44.005588 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m22:04:44.007739 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:04:44.008046 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m22:04:44.008496 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:04:44.009721 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m22:04:44.010624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de33a95-d9d8-4f10-bfde-60acf3f10657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f66c70>]}
[0m22:04:44.011122 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_products  [[32mCREATE VIEW[0m in 0.05s]
[0m22:04:44.011674 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:04:44.012663 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:44.012977 [debug] [MainThread]: On master: BEGIN
[0m22:04:44.013283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:44.015084 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:04:44.015381 [debug] [MainThread]: On master: COMMIT
[0m22:04:44.015688 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:44.015981 [debug] [MainThread]: On master: COMMIT
[0m22:04:44.016315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:44.016592 [debug] [MainThread]: On master: Close
[0m22:04:44.016973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:44.017268 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:04:44.017548 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m22:04:44.017860 [info ] [MainThread]: 
[0m22:04:44.018211 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m22:04:44.018698 [debug] [MainThread]: Command end result
[0m22:04:44.018968 [info ] [MainThread]: 
[0m22:04:44.019338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:44.019666 [info ] [MainThread]: 
[0m22:04:44.020013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:44.020923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3595586, "process_user_time": 3.012503, "process_kernel_time": 0.252388, "process_mem_max_rss": "133984", "process_out_blocks": "1080", "process_in_blocks": "0"}
[0m22:04:44.021476 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:44.021409 after 1.36 seconds
[0m22:04:44.021939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aeea550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68e62bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68fb6760>]}
[0m22:04:44.022269 [debug] [MainThread]: Flushing usage events
[0m22:04:46.553725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d66730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d666d0>]}


============================== 22:04:46.556953 | 6b4e38d0-1d03-41b2-82e2-95e013768b0a ==============================
[0m22:04:46.556953 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:04:46.557492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:04:46.638755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d8da90>]}
[0m22:04:46.661748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96921f40>]}
[0m22:04:46.662328 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:46.672518 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:04:46.796486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:46.796881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:46.821792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9655eee0>]}
[0m22:04:46.827234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9681f8e0>]}
[0m22:04:46.827605 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:04:46.828011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966d6100>]}
[0m22:04:46.828856 [info ] [MainThread]: 
[0m22:04:46.829298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:46.829889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:04:46.847641 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:04:46.848100 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:04:46.848520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:46.851003 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:04:46.851879 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:04:46.854837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:04:46.855240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:04:46.859192 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:46.860656 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:46.860993 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:04:46.861313 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:04:46.861607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:46.861922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:46.863663 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:46.863861 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:46.864124 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:46.864392 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:46.864669 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:04:46.865031 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:04:46.866502 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:04:46.866742 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:04:46.867431 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:04:46.868091 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:04:46.868492 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:04:46.868824 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:04:46.872093 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.872499 [debug] [MainThread]: On master: BEGIN
[0m22:04:46.872929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:46.874969 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:04:46.875347 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.875725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:46.882705 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m22:04:46.883645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96821190>]}
[0m22:04:46.883996 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:46.884326 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.884591 [debug] [MainThread]: On master: BEGIN
[0m22:04:46.884940 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:04:46.885203 [debug] [MainThread]: On master: COMMIT
[0m22:04:46.885432 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.885655 [debug] [MainThread]: On master: COMMIT
[0m22:04:46.885932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:46.886187 [debug] [MainThread]: On master: Close
[0m22:04:46.886531 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:46.886828 [info ] [MainThread]: 
[0m22:04:46.891068 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:04:46.891545 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_accounts ... [RUN]
[0m22:04:46.891962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:04:46.892275 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:04:46.898372 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:04:46.904828 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:04:46.934099 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m22:04:46.939676 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:04:46.940525 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m22:04:46.941466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:46.944706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m22:04:46.945586 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:04:46.946123 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue_mm,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m22:04:46.948191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:04:46.953310 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:04:46.953868 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m22:04:46.954961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:04:46.965654 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:04:46.966173 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:04:46.966468 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:04:46.972986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m22:04:46.976985 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m22:04:46.979513 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:04:46.979983 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m22:04:46.980575 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:04:46.982011 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m22:04:46.983067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b4e38d0-1d03-41b2-82e2-95e013768b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff961bbf70>]}
[0m22:04:46.983646 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_accounts  [[32mCREATE VIEW[0m in 0.09s]
[0m22:04:46.984222 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:04:46.985158 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.985510 [debug] [MainThread]: On master: BEGIN
[0m22:04:46.985843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:46.988765 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:04:46.989309 [debug] [MainThread]: On master: COMMIT
[0m22:04:46.989701 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:46.990044 [debug] [MainThread]: On master: COMMIT
[0m22:04:46.990501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:46.990887 [debug] [MainThread]: On master: Close
[0m22:04:46.991559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:46.992095 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m22:04:46.992397 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:04:46.993030 [info ] [MainThread]: 
[0m22:04:46.994048 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m22:04:46.995797 [debug] [MainThread]: Command end result
[0m22:04:46.996438 [info ] [MainThread]: 
[0m22:04:46.997064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:46.997641 [info ] [MainThread]: 
[0m22:04:46.998054 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:46.998873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.46952483, "process_user_time": 2.218218, "process_kernel_time": 0.08186, "process_mem_max_rss": "129564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:46.999699 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:46.999570 after 0.47 seconds
[0m22:04:47.000234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77d97160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9681f190>]}
[0m22:04:47.000861 [debug] [MainThread]: Flushing usage events
[0m22:04:50.555984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b79790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b79730>]}


============================== 22:04:50.559222 | 376aba5b-73eb-466c-803b-e693c1dff318 ==============================
[0m22:04:50.559222 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:04:50.559763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:50.635609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c15dc0>]}
[0m22:04:50.659449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ba0e50>]}
[0m22:04:50.659992 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:50.670008 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:04:50.792102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:50.792526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:50.818792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb120fee0>]}
[0m22:04:50.825717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34db8e0>]}
[0m22:04:50.826139 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:04:50.826558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3391190>]}
[0m22:04:50.827453 [info ] [MainThread]: 
[0m22:04:50.827856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:50.828440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:04:50.846010 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:04:50.846411 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:04:50.846727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:50.849198 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:04:50.849932 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:04:50.852514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:04:50.852906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:04:50.856045 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:50.857273 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:50.857586 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:04:50.857905 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:04:50.858215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:50.858533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:50.860311 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:50.860499 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:50.860786 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:50.861118 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:50.861426 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:04:50.861781 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:04:50.863063 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:04:50.863272 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.001 seconds
[0m22:04:50.863949 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:04:50.864681 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:04:50.865069 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:04:50.865347 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:04:50.868410 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.868693 [debug] [MainThread]: On master: BEGIN
[0m22:04:50.868918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:50.870358 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:04:50.870623 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.870893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:50.877404 [debug] [MainThread]: SQL status: SELECT 10 in 0.006 seconds
[0m22:04:50.878180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34da160>]}
[0m22:04:50.878483 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:50.878804 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.879044 [debug] [MainThread]: On master: BEGIN
[0m22:04:50.879393 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:04:50.879638 [debug] [MainThread]: On master: COMMIT
[0m22:04:50.879882 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.880100 [debug] [MainThread]: On master: COMMIT
[0m22:04:50.880405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:50.880653 [debug] [MainThread]: On master: Close
[0m22:04:50.881004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:50.881275 [info ] [MainThread]: 
[0m22:04:50.885355 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:04:50.885771 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_pipelines  [RUN]
[0m22:04:50.886180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_sales_pipelines)
[0m22:04:50.886492 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:04:50.890916 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.891931 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:04:50.909627 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.911223 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.911543 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m22:04:50.911900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:50.913711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:04:50.914015 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.914314 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m22:04:50.915742 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:04:50.918921 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.919223 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m22:04:50.919653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:04:50.926412 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:04:50.926787 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.927106 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:04:50.927777 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m22:04:50.930773 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m22:04:50.932786 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:04:50.933075 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m22:04:50.933451 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:04:50.934647 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m22:04:50.935479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376aba5b-73eb-466c-803b-e693c1dff318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0def8e0>]}
[0m22:04:50.935932 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_pipelines  [[32mCREATE VIEW[0m in 0.05s]
[0m22:04:50.936390 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:04:50.937181 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.937476 [debug] [MainThread]: On master: BEGIN
[0m22:04:50.937755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:50.939300 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:04:50.939578 [debug] [MainThread]: On master: COMMIT
[0m22:04:50.939882 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:50.940158 [debug] [MainThread]: On master: COMMIT
[0m22:04:50.940517 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:50.940800 [debug] [MainThread]: On master: Close
[0m22:04:50.941133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:50.941417 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:04:50.941708 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m22:04:50.941986 [info ] [MainThread]: 
[0m22:04:50.942317 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m22:04:50.942781 [debug] [MainThread]: Command end result
[0m22:04:50.943049 [info ] [MainThread]: 
[0m22:04:50.943408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:50.943765 [info ] [MainThread]: 
[0m22:04:50.944090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:50.944655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41354975, "process_user_time": 2.133879, "process_kernel_time": 0.077358, "process_mem_max_rss": "123684", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:50.945046 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:50.945007 after 0.41 seconds
[0m22:04:50.945354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966bd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ba0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34db0d0>]}
[0m22:04:50.945693 [debug] [MainThread]: Flushing usage events
[0m22:04:54.508576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aa0e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6900a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6900a6d0>]}


============================== 22:04:54.513864 | 822c8ac5-bec1-4ccf-a1e1-b078eaba7177 ==============================
[0m22:04:54.513864 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:04:54.514400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:04:54.595558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69031a90>]}
[0m22:04:54.619868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a6cf40>]}
[0m22:04:54.620590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:54.630912 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:04:54.753066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:54.753448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:54.778158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85721ee0>]}
[0m22:04:54.784288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856c18e0>]}
[0m22:04:54.784671 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:04:54.785007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878c5100>]}
[0m22:04:54.785839 [info ] [MainThread]: 
[0m22:04:54.786280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:54.786863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:04:54.803777 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:04:54.804165 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:04:54.804462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:54.806824 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:04:54.807499 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:04:54.809949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:04:54.810348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:04:54.813391 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:54.814678 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:54.814996 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:04:54.815297 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:04:54.815601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:54.815903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:54.817620 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:54.817822 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:04:54.818109 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:04:54.818430 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:04:54.818756 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:04:54.819112 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:04:54.820369 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:04:54.820601 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m22:04:54.821266 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:04:54.821958 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:04:54.822361 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:04:54.822653 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:04:54.825784 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.826104 [debug] [MainThread]: On master: BEGIN
[0m22:04:54.826398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:54.827883 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:04:54.828481 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.829011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:54.837163 [debug] [MainThread]: SQL status: SELECT 11 in 0.008 seconds
[0m22:04:54.838109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9e36a0>]}
[0m22:04:54.838461 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:54.838848 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.839150 [debug] [MainThread]: On master: BEGIN
[0m22:04:54.839602 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:04:54.839880 [debug] [MainThread]: On master: COMMIT
[0m22:04:54.840158 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.840428 [debug] [MainThread]: On master: COMMIT
[0m22:04:54.840832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:54.841180 [debug] [MainThread]: On master: Close
[0m22:04:54.841631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:54.841942 [info ] [MainThread]: 
[0m22:04:54.845908 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:04:54.846303 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_teams  [RUN]
[0m22:04:54.846681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_sales_teams)
[0m22:04:54.846981 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:04:54.851415 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.852773 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:04:54.870573 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.872168 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.872505 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m22:04:54.872811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:54.874815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:04:54.875130 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.875400 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m22:04:54.876443 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:04:54.879728 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.880040 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m22:04:54.880496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:04:54.887408 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:04:54.887746 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.888074 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:04:54.891571 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m22:04:54.894507 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m22:04:54.896504 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:04:54.896795 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m22:04:54.897170 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:04:54.898358 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m22:04:54.899199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822c8ac5-bec1-4ccf-a1e1-b078eaba7177', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852a7b50>]}
[0m22:04:54.899637 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_teams  [[32mCREATE VIEW[0m in 0.05s]
[0m22:04:54.900107 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:04:54.900907 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.901190 [debug] [MainThread]: On master: BEGIN
[0m22:04:54.901456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:54.902965 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:04:54.903263 [debug] [MainThread]: On master: COMMIT
[0m22:04:54.903539 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:54.903835 [debug] [MainThread]: On master: COMMIT
[0m22:04:54.904170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:04:54.904452 [debug] [MainThread]: On master: Close
[0m22:04:54.904788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:54.905341 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:04:54.905625 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m22:04:54.905923 [info ] [MainThread]: 
[0m22:04:54.906258 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:04:54.906720 [debug] [MainThread]: Command end result
[0m22:04:54.906984 [info ] [MainThread]: 
[0m22:04:54.907338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:54.907692 [info ] [MainThread]: 
[0m22:04:54.908030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:04:54.908665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43258542, "process_user_time": 1.960683, "process_kernel_time": 0.084983, "process_mem_max_rss": "118792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:54.909069 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:54.909028 after 0.43 seconds
[0m22:04:54.909374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aa0e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6903b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856c1190>]}
[0m22:04:54.909692 [debug] [MainThread]: Flushing usage events
[0m22:04:58.169328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec6a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfb1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfb1730>]}


============================== 22:04:58.172610 | d2f7eea1-28f6-4950-b6ab-5acfc12e2d05 ==============================
[0m22:04:58.172610 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:04:58.173155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:04:58.247886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f7eea1-28f6-4950-b6ab-5acfc12e2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d04d310>]}
[0m22:04:58.271869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f7eea1-28f6-4950-b6ab-5acfc12e2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfd81f0>]}
[0m22:04:58.272437 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:04:58.282333 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:04:58.402223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:58.402609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:58.427440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f7eea1-28f6-4950-b6ab-5acfc12e2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7b4ee0>]}
[0m22:04:58.437519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f7eea1-28f6-4950-b6ab-5acfc12e2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab65c970>]}
[0m22:04:58.437938 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:04:58.438351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f7eea1-28f6-4950-b6ab-5acfc12e2d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab92a220>]}
[0m22:04:58.439120 [info ] [MainThread]: 
[0m22:04:58.439527 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:04:58.440529 [debug] [MainThread]: Command end result
[0m22:04:58.441031 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2958356, "process_user_time": 2.041372, "process_kernel_time": 0.075192, "process_mem_max_rss": "121484", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:58.441424 [debug] [MainThread]: Command `dbt test` succeeded at 22:04:58.441380 after 0.30 seconds
[0m22:04:58.441753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec6a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfd81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab92a4f0>]}
[0m22:04:58.442065 [debug] [MainThread]: Flushing usage events
[0m22:05:00.525929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fd312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e18f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e18f6d0>]}


============================== 22:05:00.530583 | 2bebd769-edb3-47c9-bc10-ff554ff4034b ==============================
[0m22:05:00.530583 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:00.531543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:00.627348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bebd769-edb3-47c9-bc10-ff554ff4034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e1b55e0>]}
[0m22:05:00.651642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bebd769-edb3-47c9-bc10-ff554ff4034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc3df40>]}
[0m22:05:00.652350 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:00.662920 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:00.787088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:00.787471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:00.813058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bebd769-edb3-47c9-bc10-ff554ff4034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c87bee0>]}
[0m22:05:00.822704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bebd769-edb3-47c9-bc10-ff554ff4034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c777c70>]}
[0m22:05:00.823106 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:00.823498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bebd769-edb3-47c9-bc10-ff554ff4034b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9f4190>]}
[0m22:05:00.824322 [info ] [MainThread]: 
[0m22:05:00.824690 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:05:00.825707 [debug] [MainThread]: Command end result
[0m22:05:00.826215 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.33958557, "process_user_time": 2.091852, "process_kernel_time": 0.070263, "process_mem_max_rss": "115352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:00.826619 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:00.826573 after 0.34 seconds
[0m22:05:00.826943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fd312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8af460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc3df40>]}
[0m22:05:00.827255 [debug] [MainThread]: Flushing usage events
[0m22:05:04.714995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a372e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65ef3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65ef36d0>]}


============================== 22:05:04.721913 | 97c80189-c445-4511-933c-2cf9c7e2e5aa ==============================
[0m22:05:04.721913 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:04.722398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:04.805457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f195e0>]}
[0m22:05:04.829659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84957f40>]}
[0m22:05:04.830170 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:04.840734 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:04.954604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:04.954934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:04.980580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84591ee0>]}
[0m22:05:04.990989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8448dc70>]}
[0m22:05:04.991343 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:04.991741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8470b190>]}
[0m22:05:04.992633 [info ] [MainThread]: 
[0m22:05:04.993040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:04.995259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:05:04.995579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:05:05.020238 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:05.020514 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:05.020901 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:05.021238 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:05.021568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:05.021870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:05.026043 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:05:05.026391 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:05.026726 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:05.026940 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:05:05.027379 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:05.027722 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:05.029531 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:05:05.029751 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m22:05:05.030452 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:05.031144 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:05.031542 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:05.031858 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:05.035454 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.035761 [debug] [MainThread]: On master: BEGIN
[0m22:05:05.036078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:05.037729 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:05.038008 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.038270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:05.046106 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m22:05:05.046928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97c80189-c445-4511-933c-2cf9c7e2e5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a0d6a0>]}
[0m22:05:05.047232 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:05.047543 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.047802 [debug] [MainThread]: On master: BEGIN
[0m22:05:05.048151 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:05.048421 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.048663 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.048870 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.049145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:05.049379 [debug] [MainThread]: On master: Close
[0m22:05:05.049693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:05.049966 [info ] [MainThread]: 
[0m22:05:05.054452 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:05.054722 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:05.054939 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:05.055273 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m22:05:05.055693 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m22:05:05.056155 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m22:05:05.056605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:05:05.057028 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_global_dim, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:05:05.057417 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m22:05:05.057742 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:05.058068 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:05.058382 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:05.072859 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:05.077005 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:05:05.080022 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:05:05.080359 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:05:05.081247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:05.081922 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:05.082163 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:05.090212 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:05:05.090475 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:05:05.091814 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:05:05.092272 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:05.093356 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:05:05.093672 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:05:05.094102 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m22:05:05.094441 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:05:05.094814 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:05:05.095187 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m22:05:05.095809 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:05.097476 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:05:05.097732 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:05.098051 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:05:05.098354 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:05:05.098673 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:05.098929 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.004 seconds
[0m22:05:05.099196 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m22:05:05.101654 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:05.102856 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:05.103101 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m22:05:05.103366 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m22:05:05.104818 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:05.107253 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m22:05:05.108145 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m22:05:05.108890 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m22:05:05.109317 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:05.109575 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m22:05:05.109939 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.05s]
[0m22:05:05.110307 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m22:05:05.110798 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.05s]
[0m22:05:05.111222 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:05.111777 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:05.114168 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m22:05:05.115050 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:05:05.115378 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:05:05.115774 [info ] [Thread-1  ]: 1 of 3 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.06s]
[0m22:05:05.116297 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:05.117134 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.117416 [debug] [MainThread]: On master: BEGIN
[0m22:05:05.117656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:05.119297 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:05.119596 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.119866 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.120174 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.120485 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:05.120771 [debug] [MainThread]: On master: Close
[0m22:05:05.121091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:05.121335 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:05:05.121586 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m22:05:05.121821 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m22:05:05.122090 [info ] [MainThread]: 
[0m22:05:05.122471 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:05:05.123030 [debug] [MainThread]: Command end result
[0m22:05:05.123290 [info ] [MainThread]: 
[0m22:05:05.123580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:05.123832 [info ] [MainThread]: 
[0m22:05:05.124165 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:05:05.124772 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4393678, "process_user_time": 2.140054, "process_kernel_time": 0.186405, "process_mem_max_rss": "122140", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:05.125164 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:05.125123 after 0.44 seconds
[0m22:05:05.125486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a372e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8448dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84957f40>]}
[0m22:05:05.125896 [debug] [MainThread]: Flushing usage events
[0m22:05:08.240414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e31b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7d87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7d8790>]}


============================== 22:05:08.243729 | 58289046-2944-4a5b-a858-8d1bae8407dc ==============================
[0m22:05:08.243729 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:08.244356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_int_kpi', 'send_anonymous_usage_stats': 'True'}
[0m22:05:08.319408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1888b0>]}
[0m22:05:08.343166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c98c190>]}
[0m22:05:08.343850 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:08.355084 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:08.524645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:08.525237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:08.554136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae76ee0>]}
[0m22:05:08.564244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b13a8e0>]}
[0m22:05:08.564874 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:08.565481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afef160>]}
[0m22:05:08.566770 [info ] [MainThread]: 
[0m22:05:08.567398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:08.568211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:05:08.588236 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:05:08.588731 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:05:08.589151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:08.592295 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:05:08.593058 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:05:08.595727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:05:08.596050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:05:08.599314 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:08.600588 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:08.600960 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:08.601264 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:08.601589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:08.601882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:08.603886 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:08.604093 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:08.604410 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:08.604766 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:08.605087 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:08.605439 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:08.606790 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:05:08.607018 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m22:05:08.607711 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:08.608421 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:08.608820 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:08.609116 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:08.612351 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.612712 [debug] [MainThread]: On master: BEGIN
[0m22:05:08.613009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:08.614899 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:08.615263 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.615623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:08.622986 [debug] [MainThread]: SQL status: SELECT 12 in 0.007 seconds
[0m22:05:08.623899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac25e80>]}
[0m22:05:08.624326 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:08.624713 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.625010 [debug] [MainThread]: On master: BEGIN
[0m22:05:08.625416 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:08.625695 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.625969 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.626233 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.626575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:08.626872 [debug] [MainThread]: On master: Close
[0m22:05:08.627246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:08.627678 [info ] [MainThread]: 
[0m22:05:08.631803 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:05:08.632225 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_int_kpi ........ [RUN]
[0m22:05:08.632645 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_int_kpi)
[0m22:05:08.632949 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:05:08.637815 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:05:08.638984 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:05:08.659302 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_int_kpi"
[0m22:05:08.660479 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:05:08.660832 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: BEGIN
[0m22:05:08.661134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:08.663165 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:08.663509 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:05:08.663831 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_tmp"
    
    
  as (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
[0m22:05:08.665887 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:05:08.669146 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:05:08.669489 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_tmp" rename to "crm_int_kpi"
[0m22:05:08.670046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:05:08.677179 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:05:08.677531 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:05:08.677928 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:05:08.679221 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:05:08.682537 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_backup"
[0m22:05:08.684871 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:05:08.685194 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_backup" cascade
[0m22:05:08.685667 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:05:08.686931 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: Close
[0m22:05:08.687910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58289046-2944-4a5b-a858-8d1bae8407dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa6fd00>]}
[0m22:05:08.688390 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_int_kpi ... [[32mCREATE VIEW[0m in 0.05s]
[0m22:05:08.688944 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:05:08.689735 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.690037 [debug] [MainThread]: On master: BEGIN
[0m22:05:08.690322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:08.692046 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:08.692347 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.692638 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.692914 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.693257 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:08.693534 [debug] [MainThread]: On master: Close
[0m22:05:08.693899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:08.694213 [debug] [MainThread]: Connection 'model.matt_demo.crm_int_kpi' was properly closed.
[0m22:05:08.694557 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:05:08.694856 [info ] [MainThread]: 
[0m22:05:08.695236 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:05:08.695762 [debug] [MainThread]: Command end result
[0m22:05:08.696038 [info ] [MainThread]: 
[0m22:05:08.696405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:08.696729 [info ] [MainThread]: 
[0m22:05:08.697047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:05:08.697622 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48225626, "process_user_time": 2.209485, "process_kernel_time": 0.077191, "process_mem_max_rss": "120596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:08.698021 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:08.697980 after 0.48 seconds
[0m22:05:08.698339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e31b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c98c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b13a880>]}
[0m22:05:08.698657 [debug] [MainThread]: Flushing usage events
[0m22:05:10.573715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd2f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b32b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b32b6a0>]}


============================== 22:05:10.578262 | ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03 ==============================
[0m22:05:10.578262 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:10.580583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:05:10.691643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c697b20>]}
[0m22:05:10.717512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99de7d60>]}
[0m22:05:10.718264 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:10.728687 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:10.854639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:10.855042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:10.880417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a6df70>]}
[0m22:05:10.890669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9989b370>]}
[0m22:05:10.891056 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:10.891432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99be6160>]}
[0m22:05:10.892263 [info ] [MainThread]: 
[0m22:05:10.892716 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:10.894931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:05:10.895310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:05:10.914631 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:10.914876 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:10.915192 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:10.915501 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:10.915816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:10.916106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:10.918467 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:10.918694 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:05:10.919004 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:10.919348 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:10.919671 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:10.920011 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:10.921318 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:05:10.921525 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:05:10.922184 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:10.922963 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:10.923356 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:10.923669 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:10.927011 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:10.927326 [debug] [MainThread]: On master: BEGIN
[0m22:05:10.927603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:10.929131 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:10.929417 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:10.929761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:10.937364 [debug] [MainThread]: SQL status: SELECT 16 in 0.007 seconds
[0m22:05:10.938513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba11c9e4-3b5e-4ffe-a7bc-2c2857fd1b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9988f1c0>]}
[0m22:05:10.938924 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:10.939281 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:10.939571 [debug] [MainThread]: On master: BEGIN
[0m22:05:10.939976 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:10.940260 [debug] [MainThread]: On master: COMMIT
[0m22:05:10.940591 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:10.940869 [debug] [MainThread]: On master: COMMIT
[0m22:05:10.941217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:10.941488 [debug] [MainThread]: On master: Close
[0m22:05:10.941875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:10.942232 [info ] [MainThread]: 
[0m22:05:10.946412 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:10.946649 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:10.946861 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:10.947207 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams ........ [RUN]
[0m22:05:10.947641 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_teams_sales_agent ..................... [RUN]
[0m22:05:10.948040 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_teams_sales_agent ....................... [RUN]
[0m22:05:10.948495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:05:10.948883 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_global_dim, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:05:10.949255 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d'
[0m22:05:10.949591 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:10.949911 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:10.950226 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:10.965093 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:10.969187 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:05:10.972233 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:05:10.972606 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:05:10.973343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:10.974039 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:10.974408 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:10.982251 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:05:10.982536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:05:10.983952 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:05:10.984532 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:10.985384 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:05:10.985870 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:05:10.986211 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:05:10.986530 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: BEGIN
[0m22:05:10.986899 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: BEGIN
[0m22:05:10.987223 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:05:10.987539 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:10.989078 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:05:10.989445 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:10.991474 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:10.991738 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m22:05:10.992090 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:05:10.992635 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:05:10.992997 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_agent as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is not null
group by sales_agent
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:10.993341 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:10.993575 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_agent
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is null



      
    ) dbt_internal_test
[0m22:05:10.995283 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:10.995511 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:05:10.996556 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m22:05:10.999209 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: ROLLBACK
[0m22:05:11.000115 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: ROLLBACK
[0m22:05:11.000523 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:11.001007 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: Close
[0m22:05:11.001349 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: Close
[0m22:05:11.001629 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE manager = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE regional_office = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE team_name = 'NaN'
    

      
    ) dbt_internal_test
[0m22:05:11.002178 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_teams_sales_agent ............................. [[32mPASS[0m in 0.05s]
[0m22:05:11.002666 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_teams_sales_agent ........................... [[32mPASS[0m in 0.05s]
[0m22:05:11.003727 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:11.003990 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m22:05:11.004362 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:11.005377 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:05:11.005893 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:05:11.006308 [info ] [Thread-1  ]: 1 of 3 PASS no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams .............. [[32mPASS[0m in 0.06s]
[0m22:05:11.006709 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:11.007521 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:11.007811 [debug] [MainThread]: On master: BEGIN
[0m22:05:11.008101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:11.009842 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:11.010161 [debug] [MainThread]: On master: COMMIT
[0m22:05:11.010398 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:11.010655 [debug] [MainThread]: On master: COMMIT
[0m22:05:11.010952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:11.011196 [debug] [MainThread]: On master: Close
[0m22:05:11.011496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:11.011767 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:05:11.012009 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800' was properly closed.
[0m22:05:11.012238 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:05:11.012493 [info ] [MainThread]: 
[0m22:05:11.012791 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:05:11.013313 [debug] [MainThread]: Command end result
[0m22:05:11.013606 [info ] [MainThread]: 
[0m22:05:11.013959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:11.014291 [info ] [MainThread]: 
[0m22:05:11.014568 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:05:11.015106 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.47624996, "process_user_time": 2.202312, "process_kernel_time": 0.078906, "process_mem_max_rss": "124136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:11.015469 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:11.015427 after 0.48 seconds
[0m22:05:11.015809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd2f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99de7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9989b1f0>]}
[0m22:05:11.016130 [debug] [MainThread]: Flushing usage events
[0m22:05:14.628872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff630612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6165e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6165e6d0>]}


============================== 22:05:14.633019 | 9dbd16a9-b34a-44a1-87ec-5e30d1b722d5 ==============================
[0m22:05:14.633019 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:14.633629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models qoq_kpi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:14.735595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61685a90>]}
[0m22:05:14.766931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80080f40>]}
[0m22:05:14.767845 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:14.785812 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:14.913133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:14.913505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:14.939489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd5dee0>]}
[0m22:05:14.945384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fcfc8e0>]}
[0m22:05:14.945834 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:14.946358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fed5100>]}
[0m22:05:14.947388 [info ] [MainThread]: 
[0m22:05:14.947886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:14.948534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:05:14.966958 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:05:14.967352 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:05:14.967689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:14.970124 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:05:14.970843 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:05:14.973390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:05:14.973779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:05:14.976891 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:14.978153 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:14.978488 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:14.978799 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:14.979098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:14.979382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:14.981078 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.981279 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:14.981598 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:14.981919 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:14.982240 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:14.982574 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:14.983850 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:05:14.984058 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:05:14.984751 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:14.985479 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:14.985904 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:14.986182 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:14.989373 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.989709 [debug] [MainThread]: On master: BEGIN
[0m22:05:14.990003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:14.991479 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:05:14.991781 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:14.992118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:14.999643 [debug] [MainThread]: SQL status: SELECT 16 in 0.007 seconds
[0m22:05:15.000822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff630376a0>]}
[0m22:05:15.001163 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:15.001512 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:15.001836 [debug] [MainThread]: On master: BEGIN
[0m22:05:15.002261 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:15.002538 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.002829 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:15.003102 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.003446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:15.003738 [debug] [MainThread]: On master: Close
[0m22:05:15.004144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:15.004596 [info ] [MainThread]: 
[0m22:05:15.008517 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m22:05:15.008941 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.qoq_kpi ........... [RUN]
[0m22:05:15.009358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.qoq_kpi)
[0m22:05:15.009671 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:05:15.014033 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:05:15.015076 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:05:15.034638 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m22:05:15.035713 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:05:15.036052 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m22:05:15.036351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:15.038080 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:15.038374 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:05:15.038702 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_tmp"
  
  
    as
  
  (
    


WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
  
[0m22:05:15.045259 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.006 seconds
[0m22:05:15.048515 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:05:15.048883 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m22:05:15.049309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:05:15.057514 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:05:15.057869 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:05:15.058171 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:05:15.059155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:05:15.062272 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_backup"
[0m22:05:15.064276 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:05:15.064581 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_backup" cascade
[0m22:05:15.064962 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m22:05:15.066137 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m22:05:15.067044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbd16a9-b34a-44a1-87ec-5e30d1b722d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8c1eb0>]}
[0m22:05:15.067500 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.qoq_kpi ...... [[32mSELECT 5[0m in 0.06s]
[0m22:05:15.068028 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:05:15.068841 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:15.069152 [debug] [MainThread]: On master: BEGIN
[0m22:05:15.069426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:15.070994 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:15.071288 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.071598 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:15.071872 [debug] [MainThread]: On master: COMMIT
[0m22:05:15.072212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:15.072535 [debug] [MainThread]: On master: Close
[0m22:05:15.072904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:15.073191 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:05:15.073481 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:05:15.073844 [info ] [MainThread]: 
[0m22:05:15.074198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:05:15.074669 [debug] [MainThread]: Command end result
[0m22:05:15.074932 [info ] [MainThread]: 
[0m22:05:15.075297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:15.075629 [info ] [MainThread]: 
[0m22:05:15.075968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:05:15.076523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47259617, "process_user_time": 2.188835, "process_kernel_time": 0.086507, "process_mem_max_rss": "119364", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:15.076937 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:15.076894 after 0.47 seconds
[0m22:05:15.077254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff630612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6168f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fcfc190>]}
[0m22:05:15.077572 [debug] [MainThread]: Flushing usage events
[0m22:05:18.133703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf8b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b445790>]}


============================== 22:05:18.137060 | a1615c4b-75e3-4eb0-b5ea-14e84660a133 ==============================
[0m22:05:18.137060 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:18.137627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_int_kpi', 'send_anonymous_usage_stats': 'True'}
[0m22:05:18.252622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1615c4b-75e3-4eb0-b5ea-14e84660a133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdf78b0>]}
[0m22:05:18.286574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1615c4b-75e3-4eb0-b5ea-14e84660a133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5fb190>]}
[0m22:05:18.287408 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:18.301957 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:18.435226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:18.435627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:18.461849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1615c4b-75e3-4eb0-b5ea-14e84660a133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97addee0>]}
[0m22:05:18.473124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1615c4b-75e3-4eb0-b5ea-14e84660a133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979d9c70>]}
[0m22:05:18.473576 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:18.473970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1615c4b-75e3-4eb0-b5ea-14e84660a133', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c5d1f0>]}
[0m22:05:18.474785 [info ] [MainThread]: 
[0m22:05:18.475150 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:05:18.476222 [debug] [MainThread]: Command end result
[0m22:05:18.476756 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.36740938, "process_user_time": 2.068215, "process_kernel_time": 0.087009, "process_mem_max_rss": "112484", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:18.477154 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:18.477105 after 0.37 seconds
[0m22:05:18.477491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf8b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b11460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5fb190>]}
[0m22:05:18.477821 [debug] [MainThread]: Flushing usage events
[0m22:05:20.599857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8308e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8308e700>]}


============================== 22:05:20.603775 | 0472fdab-580c-4490-b3cd-975fbca045ca ==============================
[0m22:05:20.603775 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:20.604327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models product_win_rates', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:20.681606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c22ac0>]}
[0m22:05:20.705887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844c83a0>]}
[0m22:05:20.706572 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:20.718175 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:20.890706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:20.891162 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:20.917889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f772fd0>]}
[0m22:05:20.925128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a3e910>]}
[0m22:05:20.925563 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:20.925962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18f40d0>]}
[0m22:05:20.926858 [info ] [MainThread]: 
[0m22:05:20.927282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:20.927902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:05:20.946013 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:05:20.946450 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:05:20.946793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:20.949447 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:05:20.950262 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:05:20.952827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:05:20.953222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:05:20.956415 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:20.957800 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:20.958150 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:20.958461 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:20.958807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:20.959097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:20.961083 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:20.961276 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:20.961558 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:20.961888 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:20.962209 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:20.962585 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:20.963852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:05:20.964060 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m22:05:20.964728 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:20.965502 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:20.965906 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:20.966192 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:20.969422 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:20.969775 [debug] [MainThread]: On master: BEGIN
[0m22:05:20.970065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:20.971487 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:05:20.971767 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:20.972080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:20.980228 [debug] [MainThread]: SQL status: SELECT 16 in 0.008 seconds
[0m22:05:20.981498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c06be0>]}
[0m22:05:20.981943 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:20.982343 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:20.982640 [debug] [MainThread]: On master: BEGIN
[0m22:05:20.983069 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:20.983341 [debug] [MainThread]: On master: COMMIT
[0m22:05:20.983637 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:20.983933 [debug] [MainThread]: On master: COMMIT
[0m22:05:20.984291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:20.984587 [debug] [MainThread]: On master: Close
[0m22:05:20.984967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:20.985284 [info ] [MainThread]: 
[0m22:05:20.989216 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m22:05:20.989630 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.product_win_rates . [RUN]
[0m22:05:20.990026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.product_win_rates)
[0m22:05:20.990357 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:05:20.994876 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:05:20.996808 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m22:05:21.019819 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.product_win_rates"
[0m22:05:21.021047 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:05:21.021383 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: BEGIN
[0m22:05:21.021723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:21.023600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:21.023904 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:05:21.024185 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_tmp"
  
  
    as
  
  (
    

WITH win_counts AS (
    SELECT product_name AS product_name,
        sum(case
                when deal_stage = 'Won' then 1
                else 0
            end) AS won_deals,
        sum(case
                when (deal_stage != 'NaN'
                        and deal_stage is not null) then 1
                else 0
            end) AS all_deals
    FROM
    (SELECT *
    FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi" a
    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table
    GROUP BY product_name
    ORDER BY won_deals DESC )
select product_name,
        sum(won_deals) as won_deals,
        sum(all_deals) as all_deals,
    sum(won_deals) / sum(all_deals) as product_win_rate
from win_counts
group by product_name
  );
  
[0m22:05:21.039099 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.015 seconds
[0m22:05:21.042584 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:05:21.042938 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_tmp" rename to "product_win_rates"
[0m22:05:21.043437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:05:21.051755 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:05:21.052130 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:05:21.052466 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:05:21.053391 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:05:21.056529 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_backup"
[0m22:05:21.058619 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:05:21.058931 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_backup" cascade
[0m22:05:21.059328 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m22:05:21.060541 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: Close
[0m22:05:21.061394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0472fdab-580c-4490-b3cd-975fbca045ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f36cfd0>]}
[0m22:05:21.061860 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.product_win_rates  [[32mSELECT 7[0m in 0.07s]
[0m22:05:21.062322 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m22:05:21.063206 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:21.063525 [debug] [MainThread]: On master: BEGIN
[0m22:05:21.063821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:21.065480 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:21.065789 [debug] [MainThread]: On master: COMMIT
[0m22:05:21.066064 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:21.066360 [debug] [MainThread]: On master: COMMIT
[0m22:05:21.066757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:21.067029 [debug] [MainThread]: On master: Close
[0m22:05:21.067366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:21.067678 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:05:21.067952 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:05:21.068234 [info ] [MainThread]: 
[0m22:05:21.068580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:05:21.069053 [debug] [MainThread]: Command end result
[0m22:05:21.069331 [info ] [MainThread]: 
[0m22:05:21.069670 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:21.069987 [info ] [MainThread]: 
[0m22:05:21.070349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:05:21.070919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49673563, "process_user_time": 2.188247, "process_kernel_time": 0.09488, "process_mem_max_rss": "129008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:21.071398 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:21.071331 after 0.50 seconds
[0m22:05:21.071714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8362e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18f4460>]}
[0m22:05:21.072027 [debug] [MainThread]: Flushing usage events
[0m22:05:24.777941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650722e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6360f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6360f6d0>]}


============================== 22:05:24.781487 | f77048c9-e5b7-4904-bdef-c80ddc07b9c5 ==============================
[0m22:05:24.781487 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:24.782134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models kpi', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:24.863073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63637a90>]}
[0m22:05:24.886677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820c0f40>]}
[0m22:05:24.887231 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:24.897535 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:25.049931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:25.052129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:25.084390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d9fee0>]}
[0m22:05:25.092606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d3e8e0>]}
[0m22:05:25.093240 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:25.093696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f15100>]}
[0m22:05:25.094809 [info ] [MainThread]: 
[0m22:05:25.095415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:25.096675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:05:25.122691 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:05:25.123193 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:05:25.123510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.126789 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:05:25.127873 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:05:25.130558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:05:25.130933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:05:25.134368 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:25.135740 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:25.136081 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:05:25.136427 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:05:25.136753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:25.137047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:25.139208 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:25.139481 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:05:25.141408 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:05:25.142546 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:05:25.142960 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:05:25.143361 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:05:25.145396 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:05:25.145690 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m22:05:25.146554 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:05:25.147436 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:05:25.147929 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:05:25.148291 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:05:25.152621 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.153105 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.153452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:25.155793 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:25.156153 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.156545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:25.165947 [debug] [MainThread]: SQL status: SELECT 16 in 0.009 seconds
[0m22:05:25.167454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650486a0>]}
[0m22:05:25.167903 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:25.168319 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.168614 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.169062 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:05:25.169387 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.169697 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.169968 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.170331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:25.170631 [debug] [MainThread]: On master: Close
[0m22:05:25.171048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:25.171372 [info ] [MainThread]: 
[0m22:05:25.175626 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:05:25.176107 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.kpi ............... [RUN]
[0m22:05:25.176524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.kpi)
[0m22:05:25.176842 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:05:25.181341 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:05:25.182455 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:05:25.202773 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m22:05:25.204032 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:05:25.204375 [debug] [Thread-1  ]: On model.matt_demo.kpi: BEGIN
[0m22:05:25.204724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:25.206765 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:05:25.207073 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:05:25.207350 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi"
  );
  
[0m22:05:25.224259 [debug] [Thread-1  ]: SQL status: SELECT 8800 in 0.017 seconds
[0m22:05:25.227880 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:05:25.228324 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m22:05:25.228924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:05:25.237790 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:05:25.238167 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:05:25.238543 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:05:25.264171 [debug] [Thread-1  ]: SQL status: COMMIT in 0.025 seconds
[0m22:05:25.267858 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_backup"
[0m22:05:25.270271 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:05:25.270631 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m22:05:25.271107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m22:05:25.272526 [debug] [Thread-1  ]: On model.matt_demo.kpi: Close
[0m22:05:25.273472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f77048c9-e5b7-4904-bdef-c80ddc07b9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818fe7f0>]}
[0m22:05:25.273945 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.kpi .......... [[32mSELECT 8800[0m in 0.10s]
[0m22:05:25.274426 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:05:25.275371 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.275649 [debug] [MainThread]: On master: BEGIN
[0m22:05:25.275911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:25.277870 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:25.278221 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.278535 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:25.278809 [debug] [MainThread]: On master: COMMIT
[0m22:05:25.279156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:25.279474 [debug] [MainThread]: On master: Close
[0m22:05:25.279964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:25.280286 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:05:25.280570 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:05:25.280956 [info ] [MainThread]: 
[0m22:05:25.281347 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m22:05:25.281845 [debug] [MainThread]: Command end result
[0m22:05:25.282123 [info ] [MainThread]: 
[0m22:05:25.282489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:25.282790 [info ] [MainThread]: 
[0m22:05:25.283126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:05:25.283798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5315587, "process_user_time": 2.236731, "process_kernel_time": 0.133581, "process_mem_max_rss": "117980", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:25.284247 [debug] [MainThread]: Command `dbt run` succeeded at 22:05:25.284195 after 0.53 seconds
[0m22:05:25.284608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650722e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63641160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f15490>]}
[0m22:05:25.284964 [debug] [MainThread]: Flushing usage events
[0m22:05:28.344270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff642f32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff628ef700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff628ef6a0>]}


============================== 22:05:28.347708 | a76d6cfb-22e3-42c7-9f62-6636aeb1b084 ==============================
[0m22:05:28.347708 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:28.348303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models qoq_kpi', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:28.426802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a76d6cfb-22e3-42c7-9f62-6636aeb1b084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff641b0100>]}
[0m22:05:28.450676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a76d6cfb-22e3-42c7-9f62-6636aeb1b084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62b17af0>]}
[0m22:05:28.451263 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:28.461542 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:28.586842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:28.587222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:28.624505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a76d6cfb-22e3-42c7-9f62-6636aeb1b084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80feffa0>]}
[0m22:05:28.641444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a76d6cfb-22e3-42c7-9f62-6636aeb1b084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e6bd60>]}
[0m22:05:28.642405 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:28.643007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76d6cfb-22e3-42c7-9f62-6636aeb1b084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811681f0>]}
[0m22:05:28.644136 [info ] [MainThread]: 
[0m22:05:28.645349 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:05:28.647630 [debug] [MainThread]: Command end result
[0m22:05:28.648464 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.33089244, "process_user_time": 2.137973, "process_kernel_time": 0.085038, "process_mem_max_rss": "125652", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:28.649757 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:28.649680 after 0.33 seconds
[0m22:05:28.650164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff642f32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81168430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81168460>]}
[0m22:05:28.650586 [debug] [MainThread]: Flushing usage events
[0m22:05:30.697556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff698dd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67c2d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67c2d6a0>]}


============================== 22:05:30.702679 | ff1fbcbb-7988-4897-bf27-20eda8460bd2 ==============================
[0m22:05:30.702679 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:30.703914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models product_win_rates', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:30.809570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff1fbcbb-7988-4897-bf27-20eda8460bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691e4b20>]}
[0m22:05:30.836145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff1fbcbb-7988-4897-bf27-20eda8460bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86845d60>]}
[0m22:05:30.836930 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:30.848164 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:30.974826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:30.975232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:31.001149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff1fbcbb-7988-4897-bf27-20eda8460bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86427f70>]}
[0m22:05:31.012059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff1fbcbb-7988-4897-bf27-20eda8460bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862c5e50>]}
[0m22:05:31.012530 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:31.012916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff1fbcbb-7988-4897-bf27-20eda8460bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865a1160>]}
[0m22:05:31.013708 [info ] [MainThread]: 
[0m22:05:31.014102 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:05:31.015139 [debug] [MainThread]: Command end result
[0m22:05:31.015667 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3530092, "process_user_time": 2.115508, "process_kernel_time": 0.078314, "process_mem_max_rss": "118596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:31.016058 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:31.016010 after 0.35 seconds
[0m22:05:31.016392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff698dd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86845d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865a1430>]}
[0m22:05:31.016693 [debug] [MainThread]: Flushing usage events
[0m22:05:34.818539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70a522e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efef700>]}


============================== 22:05:34.821965 | 83d3e969-38da-4e8b-af8a-fb59b30c27f3 ==============================
[0m22:05:34.821965 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:34.822455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models kpi', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:34.902965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83d3e969-38da-4e8b-af8a-fb59b30c27f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db84ac0>]}
[0m22:05:34.926656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83d3e969-38da-4e8b-af8a-fb59b30c27f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702ea3a0>]}
[0m22:05:34.927213 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:34.937069 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:05:35.047207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:05:35.047575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:05:35.073118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83d3e969-38da-4e8b-af8a-fb59b30c27f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d77ffd0>]}
[0m22:05:35.083110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83d3e969-38da-4e8b-af8a-fb59b30c27f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5fbd90>]}
[0m22:05:35.083589 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:35.083967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83d3e969-38da-4e8b-af8a-fb59b30c27f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8f8160>]}
[0m22:05:35.084970 [info ] [MainThread]: 
[0m22:05:35.085326 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:05:35.086624 [debug] [MainThread]: Command end result
[0m22:05:35.087246 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2944425, "process_user_time": 2.11349, "process_kernel_time": 0.093034, "process_mem_max_rss": "114368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:35.087755 [debug] [MainThread]: Command `dbt test` succeeded at 22:05:35.087691 after 0.29 seconds
[0m22:05:35.088118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70a522e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7b3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702ea3a0>]}
[0m22:05:35.088461 [debug] [MainThread]: Flushing usage events
[0m22:05:38.262690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963e72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949e3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949e38e0>]}


============================== 22:05:38.266459 | 590d0912-93b4-428e-b8cb-092198c45c3a ==============================
[0m22:05:38.266459 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:05:38.267005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:05:38.346232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34de400>]}
[0m22:05:38.371109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34eae20>]}
[0m22:05:38.371737 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:05:38.381586 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:05:38.464585 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:05:38.465133 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m22:05:38.465501 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:05:38.465873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95589fa0>]}
[0m22:05:39.181664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:05:39.182689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a7dfa0>]}
[0m22:05:39.194064 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:05:39.195512 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:05:39.307910 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:05:39.308519 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:05:39.308940 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:05:39.309337 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:05:39.309702 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:05:39.310070 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:05:39.310453 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:05:39.310814 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:05:39.368713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb025f130>]}
[0m22:05:39.376877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02a68e0>]}
[0m22:05:39.377273 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:05:39.377565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02a69a0>]}
[0m22:05:39.378641 [info ] [MainThread]: 
[0m22:05:39.379064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:39.381693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:05:39.382043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:05:39.402068 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:05:39.402346 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:05:39.402728 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:05:39.403093 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:05:39.403428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.403749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.406332 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:05:39.406545 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:05:39.406826 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:05:39.407091 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:05:39.407359 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:05:39.407676 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:05:39.409305 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m22:05:39.409514 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m22:05:39.410212 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:05:39.411078 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:05:39.411596 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:05:39.411887 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:05:39.415683 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:39.416089 [debug] [MainThread]: On master: BEGIN
[0m22:05:39.416368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:39.418214 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:05:39.418523 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:39.418847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:39.427996 [debug] [MainThread]: SQL status: SELECT 16 in 0.009 seconds
[0m22:05:39.429162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590d0912-93b4-428e-b8cb-092198c45c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0232dc0>]}
[0m22:05:39.429509 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:39.429871 [debug] [MainThread]: On master: Close
[0m22:05:39.430243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:39.430632 [info ] [MainThread]: 
[0m22:05:39.434530 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:05:39.434787 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:05:39.435415 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:05:39.435646 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:05:39.435988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:05:39.436362 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_products)
[0m22:05:39.436763 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:05:39.437179 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:05:39.437562 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:05:39.437894 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:05:39.438286 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:05:39.438624 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:05:39.443006 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:05:39.444752 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:05:39.446741 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:05:39.448844 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:05:39.450416 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:05:39.450796 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:05:39.451021 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:05:39.451483 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:05:39.451717 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:05:39.452226 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:05:39.452746 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:05:39.453086 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:05:39.453587 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:05:39.454166 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:39.454432 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:39.454805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:05:39.455146 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:39.455569 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:05:39.455905 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:05:39.456219 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:05:39.456547 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:05:39.456877 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:39.457217 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:39.459360 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:05:39.459708 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:39.469536 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:39.473950 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:05:39.477536 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:05:39.477958 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:05:39.478335 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:05:39.479705 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:05:39.480077 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:39.480491 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:05:39.480793 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:39.481367 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:05:39.481736 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:05:39.482225 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:05:39.482617 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:39.482880 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m22:05:39.483193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.crm_int_kpi)
[0m22:05:39.483529 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:39.483853 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:05:39.484173 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:39.484473 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:05:39.484793 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:05:39.485097 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:39.485413 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:05:39.487709 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:05:39.488033 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:39.491696 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:39.494418 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:05:39.494804 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:05:39.495141 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:05:39.495425 [debug] [Thread-3  ]: SQL status: SELECT 9 in 0.003 seconds
[0m22:05:39.495777 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:39.496261 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:05:39.496575 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:39.498583 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:05:39.499167 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:39.499778 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:05:39.500327 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m22:05:39.500710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_int_kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:05:39.501066 [debug] [Thread-4  ]: Began running node model.matt_demo.kpi
[0m22:05:39.501402 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:39.501615 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:39.501923 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:39.502243 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now model.matt_demo.kpi)
[0m22:05:39.502559 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:05:39.502877 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:05:39.505149 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:05:39.505482 [debug] [Thread-4  ]: Began compiling node model.matt_demo.kpi
[0m22:05:39.505868 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:05:39.508070 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:05:39.508533 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:39.508919 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:05:39.509194 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.003 seconds
[0m22:05:39.509737 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:05:39.510088 [debug] [Thread-3  ]: Began running node model.matt_demo.product_win_rates
[0m22:05:39.510411 [debug] [Thread-4  ]: Began executing node model.matt_demo.kpi
[0m22:05:39.511283 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:05:39.511646 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m22:05:39.511992 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471, now model.matt_demo.product_win_rates)
[0m22:05:39.512442 [debug] [Thread-4  ]: Finished running node model.matt_demo.kpi
[0m22:05:39.512964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d, now model.matt_demo.qoq_kpi)
[0m22:05:39.513310 [debug] [Thread-3  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:05:39.513594 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:39.514033 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:05:39.516474 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:05:39.516790 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:05:39.518691 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:05:39.519290 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:05:39.519581 [debug] [Thread-3  ]: Began executing node model.matt_demo.product_win_rates
[0m22:05:39.520053 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:05:39.520343 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:05:39.520715 [debug] [Thread-3  ]: Finished running node model.matt_demo.product_win_rates
[0m22:05:39.521343 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:05:39.522144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:39.522407 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:05:39.522662 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:05:39.522935 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:05:39.523164 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:05:39.524235 [debug] [MainThread]: Command end result
[0m22:05:39.634536 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:05:39.635223 [info ] [MainThread]: Building catalog
[0m22:05:39.638116 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m22:05:39.646583 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:05:39.647631 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m22:05:39.649043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:39.652391 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:05:39.652929 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:05:39.653736 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_teams')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_pipelines')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('qoq_kpi')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_accounts')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('kpi')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_teams')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_pipeline')) or (upper(sch.nspname) = upper('dev_global_dim') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('product_win_rates')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_int_kpi')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:05:39.656855 [debug] [ThreadPool]: SQL status: SELECT 115 in 0.003 seconds
[0m22:05:39.664804 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m22:05:39.667444 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m22:05:39.714914 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m22:05:39.715752 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.4797843, "process_user_time": 3.207388, "process_kernel_time": 0.111152, "process_mem_max_rss": "206780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:05:39.716303 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:05:39.716219 after 1.48 seconds
[0m22:05:39.716647 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:05:39.716963 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m22:05:39.717331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963e72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e6ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9f5d60>]}
[0m22:05:39.717649 [debug] [MainThread]: Flushing usage events
[0m22:14:49.715871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b1d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901156a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90115640>]}


============================== 22:14:49.719480 | 2c3f1122-715e-4d4b-a342-1a496da72259 ==============================
[0m22:14:49.719480 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:49.720040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:14:49.777178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3f1122-715e-4d4b-a342-1a496da72259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901b36a0>]}
[0m22:14:49.962380 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v4g2byc0'
[0m22:14:49.963340 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:14:50.872281 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:14:50.873551 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:14:50.985294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:14:50.988036 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:14:51.639160 [info ] [MainThread]: Installed from version 0.8.6
[0m22:14:51.639685 [info ] [MainThread]: Updated version available: 1.2.0
[0m22:14:51.640053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c3f1122-715e-4d4b-a342-1a496da72259', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8690a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8694c0>]}
[0m22:14:51.640384 [info ] [MainThread]: 
[0m22:14:51.640694 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:14:51.641653 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.9513774, "process_user_time": 1.974761, "process_kernel_time": 0.209334, "process_mem_max_rss": "205044", "process_out_blocks": "216", "process_in_blocks": "0"}
[0m22:14:51.642114 [debug] [MainThread]: Command `dbt deps` succeeded at 22:14:51.642051 after 1.95 seconds
[0m22:14:51.642423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b1d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9151ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91626940>]}
[0m22:14:51.642763 [debug] [MainThread]: Flushing usage events
[0m22:14:54.735566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f82760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f82700>]}


============================== 22:14:54.739112 | aaa728aa-9ee5-4718-bd18-3adacf97734e ==============================
[0m22:14:54.739112 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:54.739670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m22:14:54.853860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a8d430>]}
[0m22:14:54.886997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83509640>]}
[0m22:14:54.887779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:54.901953 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:14:54.991719 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:14:54.992274 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m22:14:54.992641 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:14:54.993043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b0ceb0>]}
[0m22:14:55.723807 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:14:55.724427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15f22e0>]}
[0m22:14:55.731701 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:14:55.732666 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:14:55.825044 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:14:55.825625 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:14:55.826086 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:14:55.826481 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:14:55.826882 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:14:55.827291 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:14:55.827660 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:14:55.828017 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:14:55.883235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c775130>]}
[0m22:14:55.889642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7fa280>]}
[0m22:14:55.890056 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:14:55.890419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7752e0>]}
[0m22:14:55.891283 [info ] [MainThread]: 
[0m22:14:55.891727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:14:55.892341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:14:55.912282 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:14:55.912702 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:14:55.913028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:55.918146 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m22:14:55.918918 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:14:55.919478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_dim_global_dim)
[0m22:14:55.919943 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "dim_global_dim"
"
[0m22:14:55.923056 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dim_global_dim"
[0m22:14:55.923360 [debug] [ThreadPool]: On create_company_dw_dim_global_dim: BEGIN
[0m22:14:55.923640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:55.925364 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:14:55.925659 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dim_global_dim"
[0m22:14:55.925934 [debug] [ThreadPool]: On create_company_dw_dim_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "create_company_dw_dim_global_dim"} */
create schema if not exists "dim_global_dim"
[0m22:14:55.926689 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m22:14:55.927214 [debug] [ThreadPool]: On create_company_dw_dim_global_dim: COMMIT
[0m22:14:55.927488 [debug] [ThreadPool]: Using postgres connection "create_company_dw_dim_global_dim"
[0m22:14:55.927773 [debug] [ThreadPool]: On create_company_dw_dim_global_dim: COMMIT
[0m22:14:55.929163 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:14:55.929467 [debug] [ThreadPool]: On create_company_dw_dim_global_dim: Close
[0m22:14:55.931999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_dim_global_dim, now list_company_dw_dim_crm_sales_dbt)
[0m22:14:55.932441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dim_global_dim'
[0m22:14:55.935671 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim_crm_sales_dbt"
[0m22:14:55.937366 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim_global_dim"
[0m22:14:55.937649 [debug] [ThreadPool]: On list_company_dw_dim_crm_sales_dbt: BEGIN
[0m22:14:55.937925 [debug] [ThreadPool]: On list_company_dw_dim_global_dim: BEGIN
[0m22:14:55.938233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:55.938525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:55.940523 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:14:55.940735 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:14:55.941027 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim_global_dim"
[0m22:14:55.941344 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dim_crm_sales_dbt"
[0m22:14:55.941649 [debug] [ThreadPool]: On list_company_dw_dim_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dim_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim_global_dim'
  
[0m22:14:55.941969 [debug] [ThreadPool]: On list_company_dw_dim_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dim_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dim_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dim_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dim_crm_sales_dbt'
  
[0m22:14:55.943949 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:14:55.944154 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:14:55.944811 [debug] [ThreadPool]: On list_company_dw_dim_crm_sales_dbt: ROLLBACK
[0m22:14:55.945454 [debug] [ThreadPool]: On list_company_dw_dim_global_dim: ROLLBACK
[0m22:14:55.945869 [debug] [ThreadPool]: On list_company_dw_dim_crm_sales_dbt: Close
[0m22:14:55.946163 [debug] [ThreadPool]: On list_company_dw_dim_global_dim: Close
[0m22:14:55.949224 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:55.949540 [debug] [MainThread]: On master: BEGIN
[0m22:14:55.949843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:14:55.951583 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:14:55.951877 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:55.952181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:14:55.957882 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:14:55.958686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8495cee0>]}
[0m22:14:55.959090 [debug] [MainThread]: On master: ROLLBACK
[0m22:14:55.959479 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:55.959779 [debug] [MainThread]: On master: BEGIN
[0m22:14:55.960194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:14:55.960481 [debug] [MainThread]: On master: COMMIT
[0m22:14:55.960760 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:55.961039 [debug] [MainThread]: On master: COMMIT
[0m22:14:55.961385 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:55.961680 [debug] [MainThread]: On master: Close
[0m22:14:55.962077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:55.962479 [info ] [MainThread]: 
[0m22:14:55.966526 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:14:55.966971 [info ] [Thread-1  ]: 1 of 1 START sql table model dim_global_dim.dim_date ........................... [RUN]
[0m22:14:55.967365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dim_global_dim, now model.matt_demo.dim_date)
[0m22:14:55.967683 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:14:55.972017 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:14:55.974133 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:14:55.993218 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.dim_date"
[0m22:14:56.007060 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:14:56.007395 [debug] [Thread-1  ]: On model.matt_demo.dim_date: BEGIN
[0m22:14:56.007659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:14:56.009667 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:14:56.009983 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:14:56.010322 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */

  
    

  create  table "company_dw"."dim_global_dim"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m22:14:56.248991 [debug] [Thread-1  ]: SQL status: SELECT 29220 in 0.238 seconds
[0m22:14:56.254763 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:14:56.255133 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
alter table "company_dw"."dim_global_dim"."dim_date__dbt_tmp" rename to "dim_date"
[0m22:14:56.255692 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:14:56.264322 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m22:14:56.264738 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:14:56.265100 [debug] [Thread-1  ]: On model.matt_demo.dim_date: COMMIT
[0m22:14:56.310443 [debug] [Thread-1  ]: SQL status: COMMIT in 0.045 seconds
[0m22:14:56.314309 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dim_global_dim"."dim_date__dbt_backup"
[0m22:14:56.317740 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.dim_date"
[0m22:14:56.318340 [debug] [Thread-1  ]: On model.matt_demo.dim_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.dim_date"} */
drop table if exists "company_dw"."dim_global_dim"."dim_date__dbt_backup" cascade
[0m22:14:56.319196 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m22:14:56.320909 [debug] [Thread-1  ]: On model.matt_demo.dim_date: Close
[0m22:14:56.322484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaa728aa-9ee5-4718-bd18-3adacf97734e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f22c70>]}
[0m22:14:56.323352 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dim_global_dim.dim_date ...................... [[32mSELECT 29220[0m in 0.35s]
[0m22:14:56.324110 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:14:56.325443 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.325867 [debug] [MainThread]: On master: BEGIN
[0m22:14:56.326198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:14:56.329097 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:14:56.329405 [debug] [MainThread]: On master: COMMIT
[0m22:14:56.329702 [debug] [MainThread]: Using postgres connection "master"
[0m22:14:56.329993 [debug] [MainThread]: On master: COMMIT
[0m22:14:56.330356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:14:56.330648 [debug] [MainThread]: On master: Close
[0m22:14:56.331005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:56.331303 [debug] [MainThread]: Connection 'list_company_dw_dim_crm_sales_dbt' was properly closed.
[0m22:14:56.331622 [debug] [MainThread]: Connection 'model.matt_demo.dim_date' was properly closed.
[0m22:14:56.331977 [info ] [MainThread]: 
[0m22:14:56.332310 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m22:14:56.332839 [debug] [MainThread]: Command end result
[0m22:14:56.333131 [info ] [MainThread]: 
[0m22:14:56.333488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:56.333850 [info ] [MainThread]: 
[0m22:14:56.334221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:14:56.335111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6242595, "process_user_time": 2.983635, "process_kernel_time": 0.141981, "process_mem_max_rss": "132700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:56.335647 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:56.335582 after 1.62 seconds
[0m22:14:56.335996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849862e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f48250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f658b0>]}
[0m22:14:56.336309 [debug] [MainThread]: Flushing usage events
[0m22:14:58.699866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6221d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60818730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608186d0>]}


============================== 22:14:58.704786 | 68ea485b-8530-44d0-946e-3069bb4f41e8 ==============================
[0m22:14:58.704786 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:14:58.705407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:58.798224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68ea485b-8530-44d0-946e-3069bb4f41e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608405e0>]}
[0m22:14:58.830369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68ea485b-8530-44d0-946e-3069bb4f41e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f23af40>]}
[0m22:14:58.831388 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:14:58.848790 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:14:58.983795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:14:58.984179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:14:59.014855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68ea485b-8530-44d0-946e-3069bb4f41e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ceeeee0>]}
[0m22:14:59.033284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68ea485b-8530-44d0-946e-3069bb4f41e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd69c70>]}
[0m22:14:59.034258 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:14:59.034829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68ea485b-8530-44d0-946e-3069bb4f41e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f097190>]}
[0m22:14:59.036174 [info ] [MainThread]: 
[0m22:14:59.036680 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:14:59.038191 [debug] [MainThread]: Command end result
[0m22:14:59.038980 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3755795, "process_user_time": 2.099421, "process_kernel_time": 0.086193, "process_mem_max_rss": "115448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:59.039563 [debug] [MainThread]: Command `dbt test` succeeded at 22:14:59.039483 after 0.38 seconds
[0m22:14:59.040600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6221d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf23460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f23af40>]}
[0m22:14:59.041099 [debug] [MainThread]: Flushing usage events
[0m22:15:01.542556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b162e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851129d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85112970>]}


============================== 22:15:01.550339 | 9a2c8e80-baee-4e30-8bee-b2963f1a890e ==============================
[0m22:15:01.550339 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:01.551571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:01.663426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3bfb130>]}
[0m22:15:01.689363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3bfb460>]}
[0m22:15:01.690060 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:01.701056 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:15:01.788901 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:15:01.789471 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m22:15:01.789858 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:15:01.790282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85cb0970>]}
[0m22:15:02.531066 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:02.531663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38e20d0>]}
[0m22:15:02.538993 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:15:02.539886 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:15:02.631836 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:02.632391 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:02.632799 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:02.633183 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:02.633567 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:02.633949 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:02.634359 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:02.634758 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:02.689240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa098e130>]}
[0m22:15:02.696046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09d59a0>]}
[0m22:15:02.696441 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:02.696752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09d5a60>]}
[0m22:15:02.697788 [info ] [MainThread]: 
[0m22:15:02.698246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:02.701176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:15:02.701561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:15:02.720776 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:02.721328 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:02.722028 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:15:02.722623 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:15:02.723338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:02.724016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:02.727276 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:02.727581 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:15:02.728032 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:15:02.728465 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:15:02.728853 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:15:02.730619 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:15:02.732923 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:15:02.734182 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:15:02.734454 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:02.734984 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:15:02.735715 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:15:02.736920 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:15:02.741874 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:02.742388 [debug] [MainThread]: On master: BEGIN
[0m22:15:02.742816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:02.745388 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:15:02.745853 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:02.746881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:02.755056 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m22:15:02.756903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2c8e80-baee-4e30-8bee-b2963f1a890e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09617c0>]}
[0m22:15:02.757492 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:02.758074 [debug] [MainThread]: On master: Close
[0m22:15:02.758948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:02.760031 [info ] [MainThread]: 
[0m22:15:02.766567 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:15:02.766919 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:15:02.767174 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:02.767463 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:15:02.768410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m22:15:02.769010 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:15:02.769582 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:15:02.770266 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:15:02.770998 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:15:02.771476 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:15:02.771889 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:02.772264 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:15:02.778222 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:15:02.782038 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:15:02.785405 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:02.789090 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:15:02.791062 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:15:02.791515 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:15:02.791823 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:02.792047 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:15:02.792557 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:15:02.793134 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:15:02.793639 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:02.794165 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:15:02.794563 [debug] [Thread-1  ]: Began running node model.matt_demo.dim_date
[0m22:15:02.795416 [debug] [Thread-2  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:02.795679 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:02.795940 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:02.796433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now model.matt_demo.dim_date)
[0m22:15:02.796884 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:15:02.797245 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:15:02.797647 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:15:02.797988 [debug] [Thread-1  ]: Began compiling node model.matt_demo.dim_date
[0m22:15:02.798290 [debug] [Thread-2  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:02.798631 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:02.798956 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:02.802052 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:15:02.834310 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:02.850880 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:15:02.916004 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:15:02.967386 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:15:02.968595 [debug] [Thread-1  ]: Began executing node model.matt_demo.dim_date
[0m22:15:02.969311 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:15:02.969847 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:02.970518 [debug] [Thread-1  ]: Finished running node model.matt_demo.dim_date
[0m22:15:02.970903 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:02.971807 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:02.972473 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:15:02.973307 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:02.973821 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:02.974317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.crm_int_kpi)
[0m22:15:02.974579 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m22:15:02.974974 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:02.975362 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:15:02.975706 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:15:02.976031 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:02.976413 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:15:02.977085 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:02.983530 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:15:02.984644 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:15:02.985837 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:02.992934 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:02.996694 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:15:02.997186 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:15:02.997619 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:15:02.997919 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.004 seconds
[0m22:15:02.998756 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:15:02.999103 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:15:02.999428 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:03.001409 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:03.001832 [debug] [Thread-1  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:03.002718 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:03.003368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_int_kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:15:03.003854 [debug] [Thread-4  ]: Began running node model.matt_demo.kpi
[0m22:15:03.004280 [debug] [Thread-2  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:03.004506 [debug] [Thread-1  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:03.004758 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m22:15:03.005530 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now model.matt_demo.kpi)
[0m22:15:03.006011 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:15:03.009355 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:15:03.009840 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:03.010190 [debug] [Thread-4  ]: Began compiling node model.matt_demo.kpi
[0m22:15:03.010757 [debug] [Thread-2  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:15:03.011106 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:15:03.013412 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:15:03.013722 [debug] [Thread-1  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:03.014321 [debug] [Thread-2  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:03.015228 [debug] [Thread-1  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:03.015629 [debug] [Thread-2  ]: Began running node model.matt_demo.product_win_rates
[0m22:15:03.016002 [debug] [Thread-4  ]: Began executing node model.matt_demo.kpi
[0m22:15:03.016238 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m22:15:03.016610 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471, now model.matt_demo.product_win_rates)
[0m22:15:03.017101 [debug] [Thread-4  ]: Finished running node model.matt_demo.kpi
[0m22:15:03.017348 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m22:15:03.017697 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d, now model.matt_demo.qoq_kpi)
[0m22:15:03.018001 [debug] [Thread-2  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:15:03.018966 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:03.019274 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:15:03.021996 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:15:03.026121 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:15:03.027034 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:03.027755 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:15:03.028138 [debug] [Thread-2  ]: Began executing node model.matt_demo.product_win_rates
[0m22:15:03.028664 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:15:03.028972 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:15:03.029451 [debug] [Thread-2  ]: Finished running node model.matt_demo.product_win_rates
[0m22:15:03.030187 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:03.030863 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:15:03.032287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:03.032582 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:15:03.032831 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:15:03.033086 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:15:03.033330 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:15:03.034592 [debug] [MainThread]: Command end result
[0m22:15:03.147526 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:15:03.148105 [info ] [MainThread]: Building catalog
[0m22:15:03.153243 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m22:15:03.161186 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:15:03.161674 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m22:15:03.162073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:03.166961 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:15:03.167485 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:15:03.168058 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('kpi')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_pipeline')) or (upper(sch.nspname) = upper('dev_global_dim') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('qoq_kpi')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_int_kpi')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_accounts')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_teams')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_teams')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_pipelines')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('product_win_rates')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:15:03.171856 [debug] [ThreadPool]: SQL status: SELECT 74 in 0.003 seconds
[0m22:15:03.178384 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m22:15:03.179301 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m22:15:03.372674 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m22:15:03.374581 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.8744915, "process_user_time": 3.284003, "process_kernel_time": 0.143847, "process_mem_max_rss": "206864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:03.375203 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:15:03.375140 after 1.88 seconds
[0m22:15:03.375675 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:15:03.375981 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m22:15:03.376357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b162e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c114220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09619a0>]}
[0m22:15:03.376890 [debug] [MainThread]: Flushing usage events
[0m22:15:14.808434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff610fa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f44c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f44c6a0>]}


============================== 22:15:14.812112 | e4934095-5914-4bc5-bbea-296d0f6d7eea ==============================
[0m22:15:14.812112 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:14.812715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_accounts', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:14.894378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60f58100>]}
[0m22:15:14.917467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f65eaf0>]}
[0m22:15:14.918050 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:14.928977 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:15.017041 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:15:15.017590 [debug] [MainThread]: previous checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, current checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456
[0m22:15:15.017958 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:15:15.018358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff600f6970>]}
[0m22:15:15.666401 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:15.666964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd36790>]}
[0m22:15:15.673876 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:15:15.674706 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:15:15.763514 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:15.764080 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:15.764457 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:15.764837 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:15:15.765204 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:15.765578 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:15.765938 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:15.766285 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:15:15.820751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789dd130>]}
[0m22:15:15.827190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a1bd90>]}
[0m22:15:15.827557 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:15.827933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789dd2e0>]}
[0m22:15:15.828773 [info ] [MainThread]: 
[0m22:15:15.829182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:15.829773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:15.847670 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:15.848101 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:15.848420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:15.852226 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m22:15:15.852972 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:15.855734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:15:15.856101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:15.859340 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:15.860562 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:15.860901 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:15.861219 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:15.861555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:15.861878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:15.863789 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:15.863984 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:15.864277 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:15.864589 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:15.864954 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:15.865272 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:15.867051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:15.867259 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.001 seconds
[0m22:15:15.867983 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:15.868700 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:15.869102 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:15.869391 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:15.872910 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.873247 [debug] [MainThread]: On master: BEGIN
[0m22:15:15.873537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:15.875111 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:15.875398 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.875730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:15.881581 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:15:15.882278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a1ba60>]}
[0m22:15:15.882664 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:15.883028 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.883304 [debug] [MainThread]: On master: BEGIN
[0m22:15:15.883709 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:15.883998 [debug] [MainThread]: On master: COMMIT
[0m22:15:15.884284 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.884570 [debug] [MainThread]: On master: COMMIT
[0m22:15:15.884943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:15.885230 [debug] [MainThread]: On master: Close
[0m22:15:15.885618 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:15.885955 [info ] [MainThread]: 
[0m22:15:15.890066 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:15:15.890499 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_accounts ... [RUN]
[0m22:15:15.890928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_accounts)
[0m22:15:15.891246 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:15:15.895659 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:15:15.896717 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:15:15.913507 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_accounts"
[0m22:15:15.914663 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:15:15.914984 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: BEGIN
[0m22:15:15.915293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:15.917168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:15.917490 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:15:15.917808 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_tmp"
    
    
  as (
    

with raw_accounts as (
    select
        substring(md5(account || sector || year_established || office_location) for 16) as account_id,
        account::text as account_name,
        sector::text as industry,
        year_established::int,
        revenue::float as annual_revenue_mm,
        employees::int as num_employees,
        office_location::text as headquarters,
        subsidiary_of::text as parent_company
    from 
        "company_dw"."crm_sales_data"."accounts"
)

select * from raw_accounts
  );
[0m22:15:15.919702 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:15:15.922891 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:15:15.923278 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_tmp" rename to "crm_stg_accounts"
[0m22:15:15.923790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:15.930685 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:15:15.931016 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:15:15.931331 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: COMMIT
[0m22:15:15.932538 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:15:15.936192 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_backup"
[0m22:15:15.938151 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_accounts"
[0m22:15:15.938453 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_accounts"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts__dbt_backup" cascade
[0m22:15:15.938885 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:15.940125 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_accounts: Close
[0m22:15:15.940998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4934095-5914-4bc5-bbea-296d0f6d7eea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7858a430>]}
[0m22:15:15.941445 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_accounts  [[32mCREATE VIEW[0m in 0.05s]
[0m22:15:15.941857 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:15:15.942692 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.943003 [debug] [MainThread]: On master: BEGIN
[0m22:15:15.943290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:15.944968 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:15.945252 [debug] [MainThread]: On master: COMMIT
[0m22:15:15.945517 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:15.945813 [debug] [MainThread]: On master: COMMIT
[0m22:15:15.946153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:15.946425 [debug] [MainThread]: On master: Close
[0m22:15:15.946761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:15.947049 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:15.947352 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_accounts' was properly closed.
[0m22:15:15.947646 [info ] [MainThread]: 
[0m22:15:15.948007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:15.948517 [debug] [MainThread]: Command end result
[0m22:15:15.948804 [info ] [MainThread]: 
[0m22:15:15.949177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:15.949497 [info ] [MainThread]: 
[0m22:15:15.949854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:15.950469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1680489, "process_user_time": 2.78403, "process_kernel_time": 0.117009, "process_mem_max_rss": "125860", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:15.950870 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:15.950826 after 1.17 seconds
[0m22:15:15.951180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff610fa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e06cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789dd850>]}
[0m22:15:15.951487 [debug] [MainThread]: Flushing usage events
[0m22:15:18.478059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71fc2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71fc26d0>]}


============================== 22:15:18.481446 | f39c216a-21ba-411e-b7c7-ddcacdf53c39 ==============================
[0m22:15:18.481446 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:18.482103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:18.560601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b570d0>]}
[0m22:15:18.583609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ae3e50>]}
[0m22:15:18.584165 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:18.594703 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:18.724207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:18.724626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:18.749212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906aefa0>]}
[0m22:15:18.754672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909729d0>]}
[0m22:15:18.755059 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:18.755470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908240a0>]}
[0m22:15:18.756298 [info ] [MainThread]: 
[0m22:15:18.756730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:18.757343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:18.775434 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:18.775835 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:18.776132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:18.778934 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:18.779647 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:18.782193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:15:18.782577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:15:18.785693 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:18.786930 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:18.787246 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:18.787551 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:18.787850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:18.788148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:18.789951 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:18.790181 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:18.790457 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:18.790776 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:18.791098 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:18.791420 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:18.792915 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:18.793107 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.001 seconds
[0m22:15:18.793776 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:18.794443 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:18.794830 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:18.795102 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:18.798388 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.798666 [debug] [MainThread]: On master: BEGIN
[0m22:15:18.798880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:18.800359 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:18.800658 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.800975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:18.807565 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m22:15:18.808241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9045ef40>]}
[0m22:15:18.808587 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:18.808977 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.809255 [debug] [MainThread]: On master: BEGIN
[0m22:15:18.809679 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:18.809962 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.810243 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.810554 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.810910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:18.811182 [debug] [MainThread]: On master: Close
[0m22:15:18.811551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:18.811982 [info ] [MainThread]: 
[0m22:15:18.816101 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_products
[0m22:15:18.816506 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_products ... [RUN]
[0m22:15:18.816927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:15:18.817246 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:15:18.821466 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:15:18.822558 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:15:18.840053 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_products"
[0m22:15:18.843787 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:15:18.844102 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: BEGIN
[0m22:15:18.844405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:18.846430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:18.846784 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:15:18.847095 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_tmp"
    
    
  as (
    

with raw_products as (
    select
        substring(md5(product || series) for 16) as product_id,
        product::text as product_name,
        series::text as product_series,
        sales_price::float as suggested_retail_price
    from 
        "company_dw"."crm_sales_data"."products"
)

select * from raw_products
  );
[0m22:15:18.848262 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:15:18.851268 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:15:18.851569 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_tmp" rename to "crm_stg_products"
[0m22:15:18.851959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:18.858627 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:15:18.858965 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:15:18.859280 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: COMMIT
[0m22:15:18.860574 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:15:18.863440 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_backup"
[0m22:15:18.865584 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_products"
[0m22:15:18.865896 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_products"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products__dbt_backup" cascade
[0m22:15:18.866271 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:18.867446 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_products: Close
[0m22:15:18.868272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39c216a-21ba-411e-b7c7-ddcacdf53c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902a5ca0>]}
[0m22:15:18.868746 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_products  [[32mCREATE VIEW[0m in 0.05s]
[0m22:15:18.869193 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:15:18.869979 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.870234 [debug] [MainThread]: On master: BEGIN
[0m22:15:18.870424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:18.871910 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:18.872202 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.872486 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:18.872780 [debug] [MainThread]: On master: COMMIT
[0m22:15:18.873165 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:18.873464 [debug] [MainThread]: On master: Close
[0m22:15:18.873810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:18.874095 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_products' was properly closed.
[0m22:15:18.874383 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:18.874669 [info ] [MainThread]: 
[0m22:15:18.875028 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:18.875505 [debug] [MainThread]: Command end result
[0m22:15:18.875791 [info ] [MainThread]: 
[0m22:15:18.876145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:18.876465 [info ] [MainThread]: 
[0m22:15:18.876842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:18.877371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4257307, "process_user_time": 2.112853, "process_kernel_time": 0.084233, "process_mem_max_rss": "118988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:18.877782 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:18.877734 after 0.43 seconds
[0m22:15:18.878102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73b642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b1e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90972190>]}
[0m22:15:18.878409 [debug] [MainThread]: Flushing usage events
[0m22:15:20.612133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7572e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d2a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d2a6d0>]}


============================== 22:15:20.615507 | 1fe35f7a-4730-408e-869f-07bb925edb7c ==============================
[0m22:15:20.615507 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:20.616083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_teams', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:20.691860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d51a90>]}
[0m22:15:20.714996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9278bf40>]}
[0m22:15:20.715532 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:20.725459 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:20.849744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:20.850124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:20.875146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9246bee0>]}
[0m22:15:20.882195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9240a8e0>]}
[0m22:15:20.882587 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:20.883003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925e5100>]}
[0m22:15:20.883909 [info ] [MainThread]: 
[0m22:15:20.884357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:20.884943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:20.902898 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:20.903320 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:20.903636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.907014 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:20.908275 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:20.912142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:15:20.912596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:20.916477 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:20.917804 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:20.918121 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:20.918467 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:20.918767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:20.919110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.921002 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:20.921195 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:20.921470 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:20.921831 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:20.922161 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:20.922507 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:20.924193 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:20.924438 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m22:15:20.925473 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:20.926384 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:20.926846 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:20.927118 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:20.930877 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:20.931346 [debug] [MainThread]: On master: BEGIN
[0m22:15:20.931727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:20.934044 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:20.934462 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:20.934924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:20.943139 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m22:15:20.943983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff757046a0>]}
[0m22:15:20.944360 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:20.944799 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:20.945089 [debug] [MainThread]: On master: BEGIN
[0m22:15:20.945512 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:20.945823 [debug] [MainThread]: On master: COMMIT
[0m22:15:20.946140 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:20.946424 [debug] [MainThread]: On master: COMMIT
[0m22:15:20.946773 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:20.947088 [debug] [MainThread]: On master: Close
[0m22:15:20.947483 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:20.947848 [info ] [MainThread]: 
[0m22:15:20.951878 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:15:20.952300 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_teams  [RUN]
[0m22:15:20.952709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_sales_teams)
[0m22:15:20.953023 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:15:20.957366 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.958414 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:15:20.975579 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.976657 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.976986 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: BEGIN
[0m22:15:20.977290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:20.979077 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:20.979360 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.979634 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp"
    
    
  as (
    

with raw_sales_teams as (
    select
        sales_agent::text,
        manager::text,
        regional_office::text,
        manager::text || cast(' | ' as text) || regional_office::text as team_name
    from 
        "company_dw"."crm_sales_data"."sales_teams"
)

select * from raw_sales_teams
  );
[0m22:15:20.980640 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:15:20.983834 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.984135 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_tmp" rename to "crm_stg_sales_teams"
[0m22:15:20.984541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:20.991592 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:15:20.991958 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.992257 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: COMMIT
[0m22:15:20.992913 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m22:15:20.995856 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup"
[0m22:15:20.997862 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_teams"
[0m22:15:20.998143 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_teams"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams__dbt_backup" cascade
[0m22:15:20.998482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:20.999662 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_teams: Close
[0m22:15:21.000468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fe35f7a-4730-408e-869f-07bb925edb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fc9eb0>]}
[0m22:15:21.000889 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_teams  [[32mCREATE VIEW[0m in 0.05s]
[0m22:15:21.001335 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:15:21.002117 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:21.002421 [debug] [MainThread]: On master: BEGIN
[0m22:15:21.002699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:21.004302 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:21.004590 [debug] [MainThread]: On master: COMMIT
[0m22:15:21.004898 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:21.005192 [debug] [MainThread]: On master: COMMIT
[0m22:15:21.005525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:21.005828 [debug] [MainThread]: On master: Close
[0m22:15:21.006171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:21.006461 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:21.006739 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_teams' was properly closed.
[0m22:15:21.007040 [info ] [MainThread]: 
[0m22:15:21.007389 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:21.007838 [debug] [MainThread]: Command end result
[0m22:15:21.008102 [info ] [MainThread]: 
[0m22:15:21.008457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:21.008813 [info ] [MainThread]: 
[0m22:15:21.009187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:21.009789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42216614, "process_user_time": 2.107198, "process_kernel_time": 0.077728, "process_mem_max_rss": "122644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:21.010176 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:21.010134 after 0.42 seconds
[0m22:15:21.010488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7572e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73d5b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9240a190>]}
[0m22:15:21.010852 [debug] [MainThread]: Flushing usage events
[0m22:15:24.631127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ae72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ffa3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ffa3700>]}


============================== 22:15:24.634418 | 8093024c-c9c0-40c7-b54e-18d2c5d8835a ==============================
[0m22:15:24.634418 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:24.635010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_stg_sales_pipelines', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:24.710631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eaf3430>]}
[0m22:15:24.733947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70528640>]}
[0m22:15:24.734502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:24.748498 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:24.877249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:24.877626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:24.903222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e641eb0>]}
[0m22:15:24.908718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9038e0>]}
[0m22:15:24.909115 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:24.909464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7b7160>]}
[0m22:15:24.910332 [info ] [MainThread]: 
[0m22:15:24.910803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:24.911393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:24.929249 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:24.929669 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:24.930019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:24.932598 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:24.933293 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:24.935810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:15:24.936221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:24.939328 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:24.940567 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:24.940888 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:24.941184 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:24.941478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:24.941806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:24.943540 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:24.943745 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:24.944076 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:24.944394 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:24.944737 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:24.945113 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:24.946406 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:24.946611 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.001 seconds
[0m22:15:24.947290 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:24.948034 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:24.948467 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:24.948764 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:24.952072 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:24.952514 [debug] [MainThread]: On master: BEGIN
[0m22:15:24.952891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:24.955217 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:24.955509 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:24.955843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:24.962184 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m22:15:24.962938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e904130>]}
[0m22:15:24.963299 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:24.963651 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:24.963945 [debug] [MainThread]: On master: BEGIN
[0m22:15:24.964341 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:24.964616 [debug] [MainThread]: On master: COMMIT
[0m22:15:24.964892 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:24.965180 [debug] [MainThread]: On master: COMMIT
[0m22:15:24.965516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:24.965789 [debug] [MainThread]: On master: Close
[0m22:15:24.966154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:24.966465 [info ] [MainThread]: 
[0m22:15:24.970331 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:24.970731 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_pipelines  [RUN]
[0m22:15:24.971146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_stg_sales_pipelines)
[0m22:15:24.971446 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:24.975701 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:24.976708 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:24.994348 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:24.995675 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:24.996017 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: BEGIN
[0m22:15:24.996314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:24.998074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:24.998384 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:24.998722 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp"
    
    
  as (
    

with raw_sales_pipeline as (
    select
        opportunity_id::text,
        case when sales_agent = 'NaN' then 'Unknown' else sales_agent::text end as sales_agent,
        case when product = 'NaN' then 'Unknown' else product::text end as product_name,
        case when account = 'NaN' then 'Unknown' else account::text end as company_name,
        case when deal_stage = 'NaN' then 'Unknown' else deal_stage::text end as deal_stage,
        case when engage_date = 'NaN' then null else engage_date::timestamp end as ts_engage_date,
        case when close_date = 'NaN' then null else close_date::timestamp end as ts_close_date,
        case when engage_date = 'NaN' then null
             when((close_date = 'NaN' or close_date is null) and (engage_date != 'NaN' and engage_date is not null))
                then age(current_date, engage_date::timestamp)
                else age(close_date::timestamp, engage_date::timestamp) end as deal_age,
        case when close_value = 'NaN' then 0 else close_value::float end as revenue
    from 
        "company_dw"."crm_sales_data"."sales_pipeline"
)

select * from raw_sales_pipeline
  );
[0m22:15:25.000096 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:15:25.003164 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:25.003479 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_tmp" rename to "crm_stg_sales_pipelines"
[0m22:15:25.003937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:25.010796 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:15:25.011171 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:25.011496 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: COMMIT
[0m22:15:25.012590 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:15:25.015616 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup"
[0m22:15:25.017591 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_stg_sales_pipelines"
[0m22:15:25.017876 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_stg_sales_pipelines"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines__dbt_backup" cascade
[0m22:15:25.018230 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:25.019394 [debug] [Thread-1  ]: On model.matt_demo.crm_stg_sales_pipelines: Close
[0m22:15:25.020277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8093024c-c9c0-40c7-b54e-18d2c5d8835a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e239790>]}
[0m22:15:25.020715 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_stg_sales_pipelines  [[32mCREATE VIEW[0m in 0.05s]
[0m22:15:25.021221 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:15:25.022029 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:25.022308 [debug] [MainThread]: On master: BEGIN
[0m22:15:25.022539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:25.024269 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:25.024573 [debug] [MainThread]: On master: COMMIT
[0m22:15:25.024865 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:25.025172 [debug] [MainThread]: On master: COMMIT
[0m22:15:25.025522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:25.025797 [debug] [MainThread]: On master: Close
[0m22:15:25.026145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:25.026434 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:25.026729 [debug] [MainThread]: Connection 'model.matt_demo.crm_stg_sales_pipelines' was properly closed.
[0m22:15:25.027071 [info ] [MainThread]: 
[0m22:15:25.027411 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:25.027875 [debug] [MainThread]: Command end result
[0m22:15:25.028145 [info ] [MainThread]: 
[0m22:15:25.028500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:25.028842 [info ] [MainThread]: 
[0m22:15:25.029165 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:25.029713 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42297584, "process_user_time": 2.108601, "process_kernel_time": 0.063469, "process_mem_max_rss": "120484", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:25.030115 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:25.030075 after 0.42 seconds
[0m22:15:25.030426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71ae72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e945d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e903190>]}
[0m22:15:25.030732 [debug] [MainThread]: Flushing usage events
[0m22:15:28.428165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba482e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ea5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ea5730>]}


============================== 22:15:28.431544 | 7d80d9a8-0e5f-4957-a21a-f7931234b13f ==============================
[0m22:15:28.431544 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:28.432072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_accounts', 'send_anonymous_usage_stats': 'True'}
[0m22:15:28.506533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d80d9a8-0e5f-4957-a21a-f7931234b13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f41310>]}
[0m22:15:28.530538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d80d9a8-0e5f-4957-a21a-f7931234b13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ecc1f0>]}
[0m22:15:28.531099 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:28.541433 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:28.662942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:28.663315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:28.687922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d80d9a8-0e5f-4957-a21a-f7931234b13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8592ee0>]}
[0m22:15:28.699258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d80d9a8-0e5f-4957-a21a-f7931234b13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa843a970>]}
[0m22:15:28.699707 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:28.700091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d80d9a8-0e5f-4957-a21a-f7931234b13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa870b220>]}
[0m22:15:28.700899 [info ] [MainThread]: 
[0m22:15:28.701256 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:28.702268 [debug] [MainThread]: Command end result
[0m22:15:28.702748 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29991376, "process_user_time": 1.960612, "process_kernel_time": 0.075215, "process_mem_max_rss": "117776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:28.703161 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:28.703116 after 0.30 seconds
[0m22:15:28.703480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba482e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ecc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa870b4f0>]}
[0m22:15:28.703867 [debug] [MainThread]: Flushing usage events
[0m22:15:30.631526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff637037f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63703790>]}


============================== 22:15:30.634805 | f95b35a7-0cc9-46ea-9e16-2a72e539cde1 ==============================
[0m22:15:30.634805 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:30.635373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:30.710736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f95b35a7-0cc9-46ea-9e16-2a72e539cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650b38b0>]}
[0m22:15:30.733714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f95b35a7-0cc9-46ea-9e16-2a72e539cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff638b7190>]}
[0m22:15:30.734266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:30.744902 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:30.862230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:30.862599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:30.888254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f95b35a7-0cc9-46ea-9e16-2a72e539cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81defee0>]}
[0m22:15:30.898778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f95b35a7-0cc9-46ea-9e16-2a72e539cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cebc70>]}
[0m22:15:30.899182 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:30.899613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f95b35a7-0cc9-46ea-9e16-2a72e539cde1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f6c1f0>]}
[0m22:15:30.900502 [info ] [MainThread]: 
[0m22:15:30.900928 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:30.902054 [debug] [MainThread]: Command end result
[0m22:15:30.902581 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29594278, "process_user_time": 2.00709, "process_kernel_time": 0.073966, "process_mem_max_rss": "116548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:30.902987 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:30.902931 after 0.30 seconds
[0m22:15:30.903284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff652a62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e23460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff638b7190>]}
[0m22:15:30.903553 [debug] [MainThread]: Flushing usage events
[0m22:15:32.626657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dac760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dac700>]}


============================== 22:15:32.629945 | a80b291c-5421-471a-8f84-9750939a6969 ==============================
[0m22:15:32.629945 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:32.630467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_teams', 'send_anonymous_usage_stats': 'True'}
[0m22:15:32.704125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88f4ac0>]}
[0m22:15:32.727933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0a63a0>]}
[0m22:15:32.728502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:32.738772 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:32.863595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:32.863999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:32.888564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84eefd0>]}
[0m22:15:32.898420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb836ad90>]}
[0m22:15:32.898840 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:32.899236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8668160>]}
[0m22:15:32.900066 [info ] [MainThread]: 
[0m22:15:32.900497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:32.902723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:32.903136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:15:32.921803 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:32.922043 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:32.922361 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:32.922694 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:32.923029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:32.923326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:32.925592 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:32.925804 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:32.926087 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:32.926397 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:32.926724 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:32.927079 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:32.928428 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:32.928671 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m22:15:32.929330 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:32.930080 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:32.930472 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:32.930757 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:32.934280 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:32.934590 [debug] [MainThread]: On master: BEGIN
[0m22:15:32.934899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:32.936393 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:32.936675 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:32.937004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:32.943957 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m22:15:32.944708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80b291c-5421-471a-8f84-9750939a6969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88ffe20>]}
[0m22:15:32.945068 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:32.945416 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:32.945693 [debug] [MainThread]: On master: BEGIN
[0m22:15:32.946108 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:32.946386 [debug] [MainThread]: On master: COMMIT
[0m22:15:32.946654 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:32.946949 [debug] [MainThread]: On master: COMMIT
[0m22:15:32.947280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:32.947564 [debug] [MainThread]: On master: Close
[0m22:15:32.947922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:32.948288 [info ] [MainThread]: 
[0m22:15:32.952429 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:32.952680 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:32.952912 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:32.953249 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams ........ [RUN]
[0m22:15:32.953668 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_teams_sales_agent ..................... [RUN]
[0m22:15:32.954075 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_teams_sales_agent ....................... [RUN]
[0m22:15:32.954531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:15:32.954893 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_global_dim, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:15:32.955269 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d'
[0m22:15:32.955596 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:32.955906 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:32.956218 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:32.970570 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:32.974629 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:15:32.977691 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:15:32.978106 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:15:32.978854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:32.980687 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:32.980922 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:32.988744 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:15:32.989015 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m22:15:32.990286 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:15:32.990894 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:32.991866 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:15:32.992273 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:15:32.992675 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:15:32.993017 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: BEGIN
[0m22:15:32.993578 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: BEGIN
[0m22:15:33.001740 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:15:33.002240 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.010 seconds
[0m22:15:33.003087 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:15:33.006233 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:33.006772 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m22:15:33.007521 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:15:33.007980 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_agent
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is null



      
    ) dbt_internal_test
[0m22:15:33.008254 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m22:15:33.008519 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:33.008884 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:15:33.010401 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:33.010628 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:33.010935 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sales_agent as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
where sales_agent is not null
group by sales_agent
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:33.013330 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: ROLLBACK
[0m22:15:33.013830 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:15:33.014114 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.000 seconds
[0m22:15:33.014390 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800: Close
[0m22:15:33.014633 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE manager = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE regional_office = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams" WHERE team_name = 'NaN'
    

      
    ) dbt_internal_test
[0m22:15:33.015417 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: ROLLBACK
[0m22:15:33.015868 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_teams_sales_agent ........................... [[32mPASS[0m in 0.06s]
[0m22:15:33.016661 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m22:15:33.017018 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d: Close
[0m22:15:33.017330 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:15:33.018101 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:15:33.018521 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_teams_sales_agent ............................. [[32mPASS[0m in 0.06s]
[0m22:15:33.019199 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:15:33.019521 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:15:33.019987 [info ] [Thread-1  ]: 1 of 3 PASS no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams .............. [[32mPASS[0m in 0.07s]
[0m22:15:33.020560 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:15:33.021368 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:33.021658 [debug] [MainThread]: On master: BEGIN
[0m22:15:33.021905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:33.023446 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:33.023730 [debug] [MainThread]: On master: COMMIT
[0m22:15:33.023990 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:33.024215 [debug] [MainThread]: On master: COMMIT
[0m22:15:33.024505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:33.024747 [debug] [MainThread]: On master: Close
[0m22:15:33.025088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:33.025383 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:15:33.025627 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800' was properly closed.
[0m22:15:33.025861 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d' was properly closed.
[0m22:15:33.026152 [info ] [MainThread]: 
[0m22:15:33.026443 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:15:33.027000 [debug] [MainThread]: Command end result
[0m22:15:33.027262 [info ] [MainThread]: 
[0m22:15:33.027568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:33.027838 [info ] [MainThread]: 
[0m22:15:33.028124 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:33.028632 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42669088, "process_user_time": 2.06939, "process_kernel_time": 0.064105, "process_mem_max_rss": "124160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:33.029033 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:33.028985 after 0.43 seconds
[0m22:15:33.029351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7b02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb836ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0a63a0>]}
[0m22:15:33.029691 [debug] [MainThread]: Flushing usage events
[0m22:15:36.326954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774802e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7593c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7593c6a0>]}


============================== 22:15:36.330286 | e1d76d28-bbf9-4657-b1c2-f2862d884ca0 ==============================
[0m22:15:36.330286 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:36.330856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_stg_sales_pipelines', 'send_anonymous_usage_stats': 'True'}
[0m22:15:36.405731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7733d100>]}
[0m22:15:36.429652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b64af0>]}
[0m22:15:36.430230 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:36.440271 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:36.563230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:36.563614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:36.588529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fdbfa0>]}
[0m22:15:36.598244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ed7d60>]}
[0m22:15:36.598668 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:36.599052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941591f0>]}
[0m22:15:36.599931 [info ] [MainThread]: 
[0m22:15:36.600379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:36.602625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:36.602980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:15:36.621569 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:36.621832 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:36.622181 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:36.622511 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:36.622824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:36.623133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:36.625547 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:36.625780 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:36.626067 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:36.626370 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:36.626680 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:36.627024 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:36.628306 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:36.628510 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m22:15:36.629166 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:36.629919 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:36.630335 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:36.630631 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:36.634146 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.634488 [debug] [MainThread]: On master: BEGIN
[0m22:15:36.634794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:36.636338 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:36.636615 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.636971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:36.643543 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m22:15:36.644243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d76d28-bbf9-4657-b1c2-f2862d884ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94447970>]}
[0m22:15:36.644621 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:36.645024 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.645309 [debug] [MainThread]: On master: BEGIN
[0m22:15:36.645709 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:36.646004 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.646286 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.646561 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.646909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:36.647194 [debug] [MainThread]: On master: Close
[0m22:15:36.647572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:36.647914 [info ] [MainThread]: 
[0m22:15:36.652241 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:36.652473 [debug] [Thread-2  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:36.652694 [debug] [Thread-3  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:36.653126 [info ] [Thread-1  ]: 1 of 3 START test no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines  [RUN]
[0m22:15:36.653575 [info ] [Thread-2  ]: 2 of 3 START test not_null_crm_stg_sales_pipelines_opportunity_id .............. [RUN]
[0m22:15:36.653971 [info ] [Thread-3  ]: 3 of 3 START test unique_crm_stg_sales_pipelines_opportunity_id ................ [RUN]
[0m22:15:36.654462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:15:36.654824 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_global_dim, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:15:36.655210 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d'
[0m22:15:36.655550 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:36.655879 [debug] [Thread-2  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:36.656192 [debug] [Thread-3  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:36.671009 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:36.675142 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:15:36.678230 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:15:36.678607 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:15:36.679464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:36.680133 [debug] [Thread-2  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:36.680376 [debug] [Thread-3  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:36.688290 [debug] [Thread-2  ]: Writing runtime sql for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:15:36.688535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m22:15:36.689832 [debug] [Thread-3  ]: Writing runtime sql for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:15:36.690396 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:36.692043 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:15:36.692416 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:15:36.692711 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:15:36.693072 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: BEGIN
[0m22:15:36.693422 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: BEGIN
[0m22:15:36.693709 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:15:36.694025 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:15:36.695640 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:36.695867 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:36.696100 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:36.696396 [debug] [Thread-2  ]: Using postgres connection "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:15:36.696699 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:15:36.698859 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:36.699207 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select opportunity_id
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is null



      
    ) dbt_internal_test
[0m22:15:36.699535 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    opportunity_id as unique_field,
    count(*) as n_records

from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
where opportunity_id is not null
group by opportunity_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:36.700232 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:36.701759 [debug] [Thread-1  ]: Writing runtime sql for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:36.702004 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:36.702411 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m22:15:36.704928 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: ROLLBACK
[0m22:15:36.705363 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:15:36.706065 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: ROLLBACK
[0m22:15:36.706462 [debug] [Thread-2  ]: On test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d: Close
[0m22:15:36.706709 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    
    

    
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
            
            
        
    
        
    
        
    
        
    
        
    

    
    
        
        SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE opportunity_id = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE sales_agent = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE product_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE company_name = 'NaN' UNION ALL SELECT * FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines" WHERE deal_stage = 'NaN'
    

      
    ) dbt_internal_test
[0m22:15:36.707134 [debug] [Thread-3  ]: On test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d: Close
[0m22:15:36.707502 [info ] [Thread-2  ]: 2 of 3 PASS not_null_crm_stg_sales_pipelines_opportunity_id .................... [[32mPASS[0m in 0.05s]
[0m22:15:36.708114 [info ] [Thread-3  ]: 3 of 3 PASS unique_crm_stg_sales_pipelines_opportunity_id ...................... [[32mPASS[0m in 0.05s]
[0m22:15:36.708576 [debug] [Thread-2  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:15:36.708959 [debug] [Thread-3  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:15:36.710348 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m22:15:36.711106 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:15:36.711423 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:15:36.711822 [info ] [Thread-1  ]: 1 of 3 PASS no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines ...... [[32mPASS[0m in 0.06s]
[0m22:15:36.712223 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:15:36.713015 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.713320 [debug] [MainThread]: On master: BEGIN
[0m22:15:36.713589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:36.715230 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:36.715528 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.715774 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:36.716036 [debug] [MainThread]: On master: COMMIT
[0m22:15:36.716347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:36.716604 [debug] [MainThread]: On master: Close
[0m22:15:36.716919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:36.717204 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471' was properly closed.
[0m22:15:36.717468 [debug] [MainThread]: Connection 'test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d' was properly closed.
[0m22:15:36.717712 [debug] [MainThread]: Connection 'test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d' was properly closed.
[0m22:15:36.717979 [info ] [MainThread]: 
[0m22:15:36.718286 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:36.718830 [debug] [MainThread]: Command end result
[0m22:15:36.719077 [info ] [MainThread]: 
[0m22:15:36.719373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:36.719632 [info ] [MainThread]: 
[0m22:15:36.719914 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:36.720488 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4204692, "process_user_time": 2.101382, "process_kernel_time": 0.076195, "process_mem_max_rss": "126448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:36.720931 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:36.720888 after 0.42 seconds
[0m22:15:36.721282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774802e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ed7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b64af0>]}
[0m22:15:36.721609 [debug] [MainThread]: Flushing usage events
[0m22:15:38.415013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cfbf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b47b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b47b730>]}


============================== 22:15:38.418365 | fd589905-7a5c-4f4e-95a3-4b083f87b4d2 ==============================
[0m22:15:38.418365 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:38.418909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models crm_int_kpi', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:38.495225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b516dc0>]}
[0m22:15:38.518160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b4a3e50>]}
[0m22:15:38.518675 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:38.528686 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:38.650160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:38.650531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:38.675376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b1aee0>]}
[0m22:15:38.680846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ddb8e0>]}
[0m22:15:38.681216 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:38.681609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c94190>]}
[0m22:15:38.682427 [info ] [MainThread]: 
[0m22:15:38.682876 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:38.683433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:38.702124 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:38.702605 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:38.702924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:38.705370 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m22:15:38.706161 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:38.708664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:15:38.709121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:38.712455 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:38.713700 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:38.714079 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:38.714416 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:38.714746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:38.715106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:38.716898 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:38.717148 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:38.717442 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:38.717772 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:38.718109 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:38.718513 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:38.719835 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:38.720046 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m22:15:38.720712 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:38.721484 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:38.721879 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:38.722157 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:38.725578 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.725896 [debug] [MainThread]: On master: BEGIN
[0m22:15:38.726174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:38.727792 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:38.728077 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.728390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:38.735233 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m22:15:38.735989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f4fee0>]}
[0m22:15:38.736336 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:38.736694 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.736994 [debug] [MainThread]: On master: BEGIN
[0m22:15:38.737405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:38.737699 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.737977 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.738240 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.738548 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:38.738885 [debug] [MainThread]: On master: Close
[0m22:15:38.739249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:38.739559 [info ] [MainThread]: 
[0m22:15:38.743398 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:15:38.743806 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_int_kpi ........ [RUN]
[0m22:15:38.744164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.crm_int_kpi)
[0m22:15:38.744526 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:15:38.749471 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:15:38.750812 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:15:38.769055 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.crm_int_kpi"
[0m22:15:38.770257 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:15:38.770559 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: BEGIN
[0m22:15:38.770857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:38.772766 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:38.773083 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:15:38.773402 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */

  create view "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_tmp"
    
    
  as (
    

with 
    pipelines as (
        select * 
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_pipelines"
    ),
    accounts as (
        select 
            account_name,
            industry, 
            num_employees, 
            annual_revenue_mm
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_accounts"
    ), 
    products as (
        select 
             product_name,
             suggested_retail_price
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_products"
    ),
    teams as (
        select 
            sales_agent,
            manager,
            team_name,
            regional_office 
        from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_stg_sales_teams"
    )
select 
    p.*,
    industry,
    num_employees,
    annual_revenue_mm,
    suggested_retail_price,
    manager,
    team_name,
    regional_office
from pipelines p
left join accounts a on p.company_name = a.account_name 
left join products pr on p.product_name = pr.product_name 
left join teams t on p.sales_agent = t.sales_agent
  );
[0m22:15:38.774973 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m22:15:38.778098 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:15:38.778392 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_tmp" rename to "crm_int_kpi"
[0m22:15:38.778839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:38.785863 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:15:38.786230 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:15:38.786552 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: COMMIT
[0m22:15:38.787817 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:15:38.790889 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_backup"
[0m22:15:38.792839 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.crm_int_kpi"
[0m22:15:38.793123 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.crm_int_kpi"} */
drop view if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi__dbt_backup" cascade
[0m22:15:38.793478 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m22:15:38.794656 [debug] [Thread-1  ]: On model.matt_demo.crm_int_kpi: Close
[0m22:15:38.795476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd589905-7a5c-4f4e-95a3-4b083f87b4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897127f0>]}
[0m22:15:38.795960 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_crm_sales_dbt_crm_sales_dbt.crm_int_kpi ... [[32mCREATE VIEW[0m in 0.05s]
[0m22:15:38.796416 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:15:38.797197 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.797487 [debug] [MainThread]: On master: BEGIN
[0m22:15:38.797772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:38.799311 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:38.799613 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.799901 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:38.800183 [debug] [MainThread]: On master: COMMIT
[0m22:15:38.800529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:38.800802 [debug] [MainThread]: On master: Close
[0m22:15:38.801140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:38.801426 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:38.801712 [debug] [MainThread]: Connection 'model.matt_demo.crm_int_kpi' was properly closed.
[0m22:15:38.802013 [info ] [MainThread]: 
[0m22:15:38.802359 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:15:38.802844 [debug] [MainThread]: Command end result
[0m22:15:38.803142 [info ] [MainThread]: 
[0m22:15:38.803496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:38.803804 [info ] [MainThread]: 
[0m22:15:38.804137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:38.804708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41392684, "process_user_time": 2.103412, "process_kernel_time": 0.066296, "process_mem_max_rss": "126956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:38.805115 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:38.805072 after 0.41 seconds
[0m22:15:38.805424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cfbf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b4a3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c944f0>]}
[0m22:15:38.805721 [debug] [MainThread]: Flushing usage events
[0m22:15:40.969496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd1d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd1d700>]}


============================== 22:15:40.972858 | 462683b8-88ee-4f9d-b23e-99a125de6537 ==============================
[0m22:15:40.972858 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:40.973372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models crm_int_kpi', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:41.052788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '462683b8-88ee-4f9d-b23e-99a125de6537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e864ac0>]}
[0m22:15:41.076427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '462683b8-88ee-4f9d-b23e-99a125de6537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811583a0>]}
[0m22:15:41.077045 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:41.087052 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:41.208882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:41.209247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:41.234736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '462683b8-88ee-4f9d-b23e-99a125de6537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3bcfd0>]}
[0m22:15:41.244703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '462683b8-88ee-4f9d-b23e-99a125de6537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2b8d90>]}
[0m22:15:41.245183 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:41.245658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '462683b8-88ee-4f9d-b23e-99a125de6537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e535160>]}
[0m22:15:41.246535 [info ] [MainThread]: 
[0m22:15:41.246913 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:41.247966 [debug] [MainThread]: Command end result
[0m22:15:41.248477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.30318236, "process_user_time": 1.990047, "process_kernel_time": 0.065198, "process_mem_max_rss": "115648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:41.248866 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:41.248821 after 0.30 seconds
[0m22:15:41.249205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3f0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811583a0>]}
[0m22:15:41.249469 [debug] [MainThread]: Flushing usage events
[0m22:15:44.754716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718392e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdd7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdd7700>]}


============================== 22:15:44.758498 | fb0082c3-d443-4669-8fbd-f13d9114d342 ==============================
[0m22:15:44.758498 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:44.759111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models kpi', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:44.846037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e976430>]}
[0m22:15:44.872179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7035d640>]}
[0m22:15:44.873043 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:44.886105 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:45.028410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:45.028852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:45.056218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e566eb0>]}
[0m22:15:45.063160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5088e0>]}
[0m22:15:45.063703 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:45.064180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6e3160>]}
[0m22:15:45.065275 [info ] [MainThread]: 
[0m22:15:45.065807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:45.066518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:45.087941 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:45.088492 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:45.088842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:45.091939 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m22:15:45.092794 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:45.095958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:15:45.096485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:15:45.100159 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:45.101967 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:45.102429 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:45.102822 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:45.103142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:45.103490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:45.105904 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:45.106132 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:15:45.106466 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:45.106838 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:45.107217 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:45.107609 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:45.109307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:45.109547 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:15:45.110444 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:45.111416 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:45.111962 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:45.112280 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:45.116177 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.116620 [debug] [MainThread]: On master: BEGIN
[0m22:15:45.116945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:45.119246 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:45.119683 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.120081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:45.127950 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m22:15:45.129355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e507130>]}
[0m22:15:45.129792 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:45.130240 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.130539 [debug] [MainThread]: On master: BEGIN
[0m22:15:45.131033 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:45.131342 [debug] [MainThread]: On master: COMMIT
[0m22:15:45.131645 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.131974 [debug] [MainThread]: On master: COMMIT
[0m22:15:45.132379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:45.132691 [debug] [MainThread]: On master: Close
[0m22:15:45.133158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:45.133574 [info ] [MainThread]: 
[0m22:15:45.138042 [debug] [Thread-1  ]: Began running node model.matt_demo.kpi
[0m22:15:45.138559 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.kpi ............... [RUN]
[0m22:15:45.138978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.kpi)
[0m22:15:45.139306 [debug] [Thread-1  ]: Began compiling node model.matt_demo.kpi
[0m22:15:45.144457 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:15:45.146549 [debug] [Thread-1  ]: Began executing node model.matt_demo.kpi
[0m22:15:45.168091 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.kpi"
[0m22:15:45.169436 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.169803 [debug] [Thread-1  ]: On model.matt_demo.kpi: BEGIN
[0m22:15:45.170145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:45.172093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:45.172396 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.172715 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_tmp"
  
  
    as
  
  (
    

select * 
from "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi"
  );
  
[0m22:15:45.209422 [debug] [Thread-1  ]: SQL status: SELECT 8800 in 0.036 seconds
[0m22:15:45.212963 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.213264 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi" rename to "kpi__dbt_backup"
[0m22:15:45.213721 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:45.215287 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.215597 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_tmp" rename to "kpi"
[0m22:15:45.215994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:45.224988 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:15:45.225344 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.225662 [debug] [Thread-1  ]: On model.matt_demo.kpi: COMMIT
[0m22:15:45.245320 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m22:15:45.249060 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_backup"
[0m22:15:45.251026 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.kpi"
[0m22:15:45.251336 [debug] [Thread-1  ]: On model.matt_demo.kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."kpi__dbt_backup" cascade
[0m22:15:45.253149 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:15:45.254427 [debug] [Thread-1  ]: On model.matt_demo.kpi: Close
[0m22:15:45.255384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb0082c3-d443-4669-8fbd-f13d9114d342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c4700>]}
[0m22:15:45.255860 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.kpi .......... [[32mSELECT 8800[0m in 0.12s]
[0m22:15:45.256309 [debug] [Thread-1  ]: Finished running node model.matt_demo.kpi
[0m22:15:45.257133 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.257417 [debug] [MainThread]: On master: BEGIN
[0m22:15:45.257659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:45.259307 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:45.259601 [debug] [MainThread]: On master: COMMIT
[0m22:15:45.259858 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:45.260097 [debug] [MainThread]: On master: COMMIT
[0m22:15:45.260386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:45.260661 [debug] [MainThread]: On master: Close
[0m22:15:45.260983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:45.261217 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:15:45.261434 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:45.261699 [info ] [MainThread]: 
[0m22:15:45.262018 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m22:15:45.262427 [debug] [MainThread]: Command end result
[0m22:15:45.262706 [info ] [MainThread]: 
[0m22:15:45.263064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:45.263359 [info ] [MainThread]: 
[0m22:15:45.263673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:45.264222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5387151, "process_user_time": 2.191995, "process_kernel_time": 0.090828, "process_mem_max_rss": "118924", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:45.264618 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:45.264569 after 0.54 seconds
[0m22:15:45.264918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff718392e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7c8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e508190>]}
[0m22:15:45.265189 [debug] [MainThread]: Flushing usage events
[0m22:15:48.479456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713d1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713d16a0>]}


============================== 22:15:48.482771 | aaf4c462-ca6a-4f0f-a643-45b48fbee082 ==============================
[0m22:15:48.482771 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:48.483351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models product_win_rates', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:48.560500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ede100>]}
[0m22:15:48.584173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715e4af0>]}
[0m22:15:48.584727 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:48.594698 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:48.716941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:48.717308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:48.742859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbcafa0>]}
[0m22:15:48.749460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe8e9d0>]}
[0m22:15:48.749848 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:48.750258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd40160>]}
[0m22:15:48.751139 [info ] [MainThread]: 
[0m22:15:48.751591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:48.752174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:48.770436 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:48.770828 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:48.771141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:48.773580 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m22:15:48.774299 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:48.776836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_crm_sales_dbt)
[0m22:15:48.777258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_global_dim'
[0m22:15:48.780325 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:48.781604 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:48.781926 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:48.782229 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:48.782525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:48.782879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:48.784534 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:48.784756 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:48.785039 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:48.785332 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:48.785664 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:48.786028 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:48.787382 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:48.787586 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m22:15:48.788211 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:48.788927 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:48.789315 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:48.789621 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:48.793085 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.793398 [debug] [MainThread]: On master: BEGIN
[0m22:15:48.793680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:48.795283 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:48.795575 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.795898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:48.803282 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m22:15:48.804346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f979e20>]}
[0m22:15:48.804702 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:48.805085 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.805358 [debug] [MainThread]: On master: BEGIN
[0m22:15:48.805768 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:48.806052 [debug] [MainThread]: On master: COMMIT
[0m22:15:48.806317 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.806576 [debug] [MainThread]: On master: COMMIT
[0m22:15:48.806907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:48.807178 [debug] [MainThread]: On master: Close
[0m22:15:48.807535 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:48.807833 [info ] [MainThread]: 
[0m22:15:48.811729 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m22:15:48.812153 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.product_win_rates . [RUN]
[0m22:15:48.812543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.product_win_rates)
[0m22:15:48.812854 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:15:48.817072 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:15:48.818116 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m22:15:48.837646 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.product_win_rates"
[0m22:15:48.839107 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.839452 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: BEGIN
[0m22:15:48.839743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:48.841400 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:48.841714 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.842018 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_tmp"
  
  
    as
  
  (
    

WITH win_counts AS (
    SELECT product_name AS product_name,
        sum(case
                when deal_stage = 'Won' then 1
                else 0
            end) AS won_deals,
        sum(case
                when (deal_stage != 'NaN'
                        and deal_stage is not null) then 1
                else 0
            end) AS all_deals
    FROM
    (SELECT *
    FROM "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi" a
    LEFT JOIN dev_global_dim.dim_date b ON a.ts_close_date = b.date_actual) AS virtual_table
    GROUP BY product_name
    ORDER BY won_deals DESC )
select product_name,
        sum(won_deals) as won_deals,
        sum(all_deals) as all_deals,
    sum(won_deals) / sum(all_deals) as product_win_rate
from win_counts
group by product_name
  );
  
[0m22:15:48.856064 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.014 seconds
[0m22:15:48.859512 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.859830 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates" rename to "product_win_rates__dbt_backup"
[0m22:15:48.860318 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:48.861917 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.862230 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_tmp" rename to "product_win_rates"
[0m22:15:48.862613 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:48.871430 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:15:48.871818 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.872138 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: COMMIT
[0m22:15:48.872878 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m22:15:48.876297 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_backup"
[0m22:15:48.878212 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.product_win_rates"
[0m22:15:48.878510 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.product_win_rates"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."product_win_rates__dbt_backup" cascade
[0m22:15:48.879504 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:15:48.880729 [debug] [Thread-1  ]: On model.matt_demo.product_win_rates: Close
[0m22:15:48.881561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf4c462-ca6a-4f0f-a643-45b48fbee082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7c47f0>]}
[0m22:15:48.882002 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.product_win_rates  [[32mSELECT 7[0m in 0.07s]
[0m22:15:48.882481 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m22:15:48.883258 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.883555 [debug] [MainThread]: On master: BEGIN
[0m22:15:48.883803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:48.885317 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:48.885573 [debug] [MainThread]: On master: COMMIT
[0m22:15:48.885830 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:48.886061 [debug] [MainThread]: On master: COMMIT
[0m22:15:48.886328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:48.886561 [debug] [MainThread]: On master: Close
[0m22:15:48.886861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:48.887110 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:15:48.887331 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:48.887577 [info ] [MainThread]: 
[0m22:15:48.887844 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m22:15:48.888237 [debug] [MainThread]: Command end result
[0m22:15:48.888469 [info ] [MainThread]: 
[0m22:15:48.888761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:48.889034 [info ] [MainThread]: 
[0m22:15:48.889336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:48.889846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43527654, "process_user_time": 2.098881, "process_kernel_time": 0.081266, "process_mem_max_rss": "126896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:48.890214 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:48.890171 after 0.44 seconds
[0m22:15:48.890499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fff3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ede100>]}
[0m22:15:48.890772 [debug] [MainThread]: Flushing usage events
[0m22:15:50.686904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b074700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0746a0>]}


============================== 22:15:50.690152 | c9c3db9b-44ca-47d2-a452-d641eb6dec38 ==============================
[0m22:15:50.690152 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:50.690671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models qoq_kpi', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:50.766712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c934100>]}
[0m22:15:50.790895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b29baf0>]}
[0m22:15:50.791447 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:50.801432 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:50.923396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:50.923784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:50.951113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9773fa0>]}
[0m22:15:50.956998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97129d0>]}
[0m22:15:50.957391 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:50.957744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98e9160>]}
[0m22:15:50.958642 [info ] [MainThread]: 
[0m22:15:50.959119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:50.959788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m22:15:50.980196 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m22:15:50.980579 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:15:50.980858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:50.983105 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m22:15:50.983831 [debug] [ThreadPool]: On list_company_dw: Close
[0m22:15:50.986409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_dev_crm_sales_dbt_global_dim)
[0m22:15:50.986799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt_crm_sales_dbt'
[0m22:15:50.989860 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:50.991103 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:50.991417 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: BEGIN
[0m22:15:50.991725 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: BEGIN
[0m22:15:50.992037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:50.992327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:50.994090 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:50.994291 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:15:50.994608 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"
[0m22:15:50.995009 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt_global_dim"
[0m22:15:50.995345 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_crm_sales_dbt'
  
[0m22:15:50.995686 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt_global_dim'
  
[0m22:15:50.997042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m22:15:50.997250 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m22:15:50.997883 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: ROLLBACK
[0m22:15:50.998616 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: ROLLBACK
[0m22:15:50.999044 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_global_dim: Close
[0m22:15:50.999385 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt_crm_sales_dbt: Close
[0m22:15:51.002733 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.003037 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.003318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:51.004816 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:51.005130 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.005444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:51.012527 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m22:15:51.013547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca4d670>]}
[0m22:15:51.013885 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:51.014228 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.014518 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.014998 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:15:51.015274 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.015540 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.015813 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.016145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:51.016427 [debug] [MainThread]: On master: Close
[0m22:15:51.016805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:51.017109 [info ] [MainThread]: 
[0m22:15:51.020920 [debug] [Thread-1  ]: Began running node model.matt_demo.qoq_kpi
[0m22:15:51.021315 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_crm_sales_dbt_crm_sales_dbt.qoq_kpi ........... [RUN]
[0m22:15:51.021707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt_crm_sales_dbt, now model.matt_demo.qoq_kpi)
[0m22:15:51.022029 [debug] [Thread-1  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:15:51.026314 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:15:51.028005 [debug] [Thread-1  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:15:51.047757 [debug] [Thread-1  ]: Writing runtime sql for node "model.matt_demo.qoq_kpi"
[0m22:15:51.049010 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.049337 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: BEGIN
[0m22:15:51.049664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:15:51.051542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m22:15:51.051840 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.052123 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */

  
    

  create  table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_tmp"
  
  
    as
  
  (
    


WITH quarterly_revenue AS (
    SELECT
        date_trunc('quarter', ts_close_date) AS quarter,
        SUM(revenue) AS total_revenue
    FROM
        "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."crm_int_kpi"
    GROUP BY
        date_trunc('quarter', ts_close_date)
    ORDER BY
        quarter
),
quarterly_growth AS (
    SELECT
        quarter,
        total_revenue,
        LAG(total_revenue) OVER (ORDER BY quarter) AS previous_quarter_revenue,
        CASE
            WHEN LAG(total_revenue) OVER (ORDER BY quarter) IS NULL THEN NULL
            ELSE (total_revenue - LAG(total_revenue) OVER (ORDER BY quarter)) / LAG(total_revenue) OVER (ORDER BY quarter) * 100
        END AS quarter_over_quarter_growth
    FROM
        quarterly_revenue
)
SELECT
    quarter,
    total_revenue,
    previous_quarter_revenue,
    quarter_over_quarter_growth
FROM
    quarterly_growth
  );
  
[0m22:15:51.058467 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.006 seconds
[0m22:15:51.061937 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.062341 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi" rename to "qoq_kpi__dbt_backup"
[0m22:15:51.062828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:51.064406 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.064717 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
alter table "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_tmp" rename to "qoq_kpi"
[0m22:15:51.065143 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:15:51.074452 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:15:51.074843 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.075191 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: COMMIT
[0m22:15:51.076035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m22:15:51.080021 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_backup"
[0m22:15:51.082375 [debug] [Thread-1  ]: Using postgres connection "model.matt_demo.qoq_kpi"
[0m22:15:51.082717 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "model.matt_demo.qoq_kpi"} */
drop table if exists "company_dw"."dev_crm_sales_dbt_crm_sales_dbt"."qoq_kpi__dbt_backup" cascade
[0m22:15:51.083580 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:15:51.084976 [debug] [Thread-1  ]: On model.matt_demo.qoq_kpi: Close
[0m22:15:51.085935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9c3db9b-44ca-47d2-a452-d641eb6dec38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb92d97f0>]}
[0m22:15:51.086412 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_crm_sales_dbt_crm_sales_dbt.qoq_kpi ...... [[32mSELECT 5[0m in 0.06s]
[0m22:15:51.086897 [debug] [Thread-1  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:15:51.087777 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.088052 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.088292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:51.089871 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:15:51.090170 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.090406 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.090636 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.090961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:51.091253 [debug] [MainThread]: On master: Close
[0m22:15:51.091568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:51.091818 [debug] [MainThread]: Connection 'list_company_dw_dev_crm_sales_dbt_global_dim' was properly closed.
[0m22:15:51.092045 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:15:51.092292 [info ] [MainThread]: 
[0m22:15:51.092601 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m22:15:51.093024 [debug] [MainThread]: Command end result
[0m22:15:51.093305 [info ] [MainThread]: 
[0m22:15:51.093615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:51.093880 [info ] [MainThread]: 
[0m22:15:51.094145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:15:51.094644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43174165, "process_user_time": 2.061229, "process_kernel_time": 0.065911, "process_mem_max_rss": "118124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:51.095034 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:51.094991 after 0.43 seconds
[0m22:15:51.095350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9af8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c934100>]}
[0m22:15:51.095651 [debug] [MainThread]: Flushing usage events
[0m22:15:54.716744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669fc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f98670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64f98610>]}


============================== 22:15:54.720086 | 057f99db-c28b-41b9-b6fe-d4eb829b361d ==============================
[0m22:15:54.720086 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:54.720600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models kpi', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:54.795288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '057f99db-c28b-41b9-b6fe-d4eb829b361d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650234c0>]}
[0m22:15:54.819118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '057f99db-c28b-41b9-b6fe-d4eb829b361d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64fc18b0>]}
[0m22:15:54.819683 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:54.829497 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:54.950236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:54.950613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:54.975471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '057f99db-c28b-41b9-b6fe-d4eb829b361d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83729ee0>]}
[0m22:15:54.985130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '057f99db-c28b-41b9-b6fe-d4eb829b361d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83551250>]}
[0m22:15:54.985499 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:54.985887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '057f99db-c28b-41b9-b6fe-d4eb829b361d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838a2070>]}
[0m22:15:54.986677 [info ] [MainThread]: 
[0m22:15:54.987033 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:54.988027 [debug] [MainThread]: Command end result
[0m22:15:54.988551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29703933, "process_user_time": 2.002117, "process_kernel_time": 0.056284, "process_mem_max_rss": "115256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:54.988998 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:54.988949 after 0.30 seconds
[0m22:15:54.989311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669fc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83768d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650234c0>]}
[0m22:15:54.989612 [debug] [MainThread]: Flushing usage events
[0m22:15:56.680268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969fe2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d4d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d4d700>]}


============================== 22:15:56.683534 | d05ef82b-d2b0-4bad-b034-a9a10085e357 ==============================
[0m22:15:56.683534 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:56.684095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models product_win_rates', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:56.759054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05ef82b-d2b0-4bad-b034-a9a10085e357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39f9c70>]}
[0m22:15:56.782846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd05ef82b-d2b0-4bad-b034-a9a10085e357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952c1640>]}
[0m22:15:56.783395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:56.793259 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:56.915194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:56.915586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:56.940983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd05ef82b-d2b0-4bad-b034-a9a10085e357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3547eb0>]}
[0m22:15:56.950687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd05ef82b-d2b0-4bad-b034-a9a10085e357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb33ef9a0>]}
[0m22:15:56.951079 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:56.951484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd05ef82b-d2b0-4bad-b034-a9a10085e357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36c01f0>]}
[0m22:15:56.952260 [info ] [MainThread]: 
[0m22:15:56.952606 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:56.953688 [debug] [MainThread]: Command end result
[0m22:15:56.954170 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.29808128, "process_user_time": 2.001793, "process_kernel_time": 0.070184, "process_mem_max_rss": "119548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:56.954559 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:56.954515 after 0.30 seconds
[0m22:15:56.954885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969fe2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb357b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36c04f0>]}
[0m22:15:56.955208 [debug] [MainThread]: Flushing usage events
[0m22:15:58.694057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c5a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72255760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72255700>]}


============================== 22:15:58.697314 | 8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49 ==============================
[0m22:15:58.697314 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:15:58.697827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models qoq_kpi', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:15:58.773665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d5cac0>]}
[0m22:15:58.796706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735513a0>]}
[0m22:15:58.797256 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:15:58.807167 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m22:15:58.927854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:58.928211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:58.959342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90956fd0>]}
[0m22:15:58.972659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907d2d90>]}
[0m22:15:58.973293 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:15:58.973633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bea2ed2-a9c5-4fc1-b9b8-d7595eb0ef49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ad0160>]}
[0m22:15:58.974543 [info ] [MainThread]: 
[0m22:15:58.974896 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:15:58.975965 [debug] [MainThread]: Command end result
[0m22:15:58.976538 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.30685037, "process_user_time": 2.00846, "process_kernel_time": 0.057955, "process_mem_max_rss": "113644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:58.976958 [debug] [MainThread]: Command `dbt test` succeeded at 22:15:58.976909 after 0.31 seconds
[0m22:15:58.977262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73c5a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9098a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff735513a0>]}
[0m22:15:58.977535 [debug] [MainThread]: Flushing usage events
[0m22:16:01.590797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff708552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee53970>]}


============================== 22:16:01.594521 | a31792aa-347d-4022-af15-8c18c8174e28 ==============================
[0m22:16:01.594521 [info ] [MainThread]: Running with dbt=1.8.3
[0m22:16:01.595070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:16:01.674060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d93b130>]}
[0m22:16:01.697766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d93b460>]}
[0m22:16:01.698325 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:16:01.708904 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m22:16:01.791586 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:16:01.792161 [debug] [MainThread]: previous checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, current checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6
[0m22:16:01.792502 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:16:01.792918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f9f0970>]}
[0m22:16:02.445318 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:16:02.445993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7a00d0>]}
[0m22:16:02.453094 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_accounts' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:16:02.454020 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'crm_stg_sales_products' in the 'models' section of file 'models/crm_sales_data/crm_sales.yml'
[0m22:16:02.583118 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_accounts_account_id.0f93a43f3d' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:16:02.584070 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_accounts_account_id.79cb54f197' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:16:02.584715 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:16:02.585247 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_accounts_crm_stg_sales_accounts.d0ceb61845' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_accounts' in package '' which was not found
[0m22:16:02.585728 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.unique_crm_stg_sales_products_product_id.3af229bd86' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:16:02.586180 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.not_null_crm_stg_sales_products_product_id.14c97f12b7' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:16:02.586596 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:16:02.587428 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.matt_demo.no_nan_values_crm_stg_sales_products_crm_stg_sales_products.59f69c31e3' (models/crm_sales_data/crm_sales.yml) depends on a node named 'crm_stg_sales_products' in package '' which was not found
[0m22:16:02.662797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8828b130>]}
[0m22:16:02.672742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882d29a0>]}
[0m22:16:02.673203 [info ] [MainThread]: Found 9 models, 6 data tests, 4 sources, 653 macros
[0m22:16:02.673631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882d2a60>]}
[0m22:16:02.675081 [info ] [MainThread]: 
[0m22:16:02.675601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:02.679720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_global_dim'
[0m22:16:02.680249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev_crm_sales_dbt'
[0m22:16:02.706324 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:16:02.706678 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:16:02.707109 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: BEGIN
[0m22:16:02.707501 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: BEGIN
[0m22:16:02.707865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:02.708222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:02.713460 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:16:02.713931 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_crm_sales_dbt"
[0m22:16:02.714282 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_crm_sales_dbt"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_crm_sales_dbt'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_crm_sales_dbt'
  
[0m22:16:02.714739 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:16:02.715201 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev_global_dim"
[0m22:16:02.715614 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "list_company_dw_dev_global_dim"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_global_dim'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_global_dim'
  
[0m22:16:02.716636 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:16:02.717687 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: ROLLBACK
[0m22:16:02.717900 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m22:16:02.718389 [debug] [ThreadPool]: On list_company_dw_dev_crm_sales_dbt: Close
[0m22:16:02.719150 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: ROLLBACK
[0m22:16:02.720766 [debug] [ThreadPool]: On list_company_dw_dev_global_dim: Close
[0m22:16:02.724390 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:02.724843 [debug] [MainThread]: On master: BEGIN
[0m22:16:02.725153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:02.727497 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:16:02.727901 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:02.728276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:16:02.736622 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m22:16:02.737603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a31792aa-347d-4022-af15-8c18c8174e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882607c0>]}
[0m22:16:02.738080 [debug] [MainThread]: On master: ROLLBACK
[0m22:16:02.738500 [debug] [MainThread]: On master: Close
[0m22:16:02.738992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:02.739422 [info ] [MainThread]: 
[0m22:16:02.744252 [debug] [Thread-1  ]: Began running node model.matt_demo.crm_stg_accounts
[0m22:16:02.744538 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_stg_products
[0m22:16:02.744796 [debug] [Thread-3  ]: Began running node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:02.745513 [debug] [Thread-4  ]: Began running node model.matt_demo.crm_stg_sales_teams
[0m22:16:02.745829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_global_dim, now model.matt_demo.crm_stg_accounts)
[0m22:16:02.746266 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_company_dw_dev_crm_sales_dbt, now model.matt_demo.crm_stg_products)
[0m22:16:02.746765 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_pipelines'
[0m22:16:02.747251 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.matt_demo.crm_stg_sales_teams'
[0m22:16:02.747669 [debug] [Thread-1  ]: Began compiling node model.matt_demo.crm_stg_accounts
[0m22:16:02.748039 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_stg_products
[0m22:16:02.748383 [debug] [Thread-3  ]: Began compiling node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:02.748737 [debug] [Thread-4  ]: Began compiling node model.matt_demo.crm_stg_sales_teams
[0m22:16:02.753678 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.crm_stg_accounts"
[0m22:16:02.755753 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_stg_products"
[0m22:16:02.757679 [debug] [Thread-3  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_pipelines"
[0m22:16:02.759612 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.crm_stg_sales_teams"
[0m22:16:02.761750 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_stg_products
[0m22:16:02.762063 [debug] [Thread-1  ]: Began executing node model.matt_demo.crm_stg_accounts
[0m22:16:02.762540 [debug] [Thread-3  ]: Began executing node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:02.763084 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_stg_products
[0m22:16:02.763336 [debug] [Thread-4  ]: Began executing node model.matt_demo.crm_stg_sales_teams
[0m22:16:02.763840 [debug] [Thread-1  ]: Finished running node model.matt_demo.crm_stg_accounts
[0m22:16:02.764328 [debug] [Thread-3  ]: Finished running node model.matt_demo.crm_stg_sales_pipelines
[0m22:16:02.764714 [debug] [Thread-2  ]: Began running node model.matt_demo.dim_date
[0m22:16:02.765206 [debug] [Thread-4  ]: Finished running node model.matt_demo.crm_stg_sales_teams
[0m22:16:02.765952 [debug] [Thread-1  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:02.766196 [debug] [Thread-3  ]: Began running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:02.766445 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_products, now model.matt_demo.dim_date)
[0m22:16:02.766827 [debug] [Thread-4  ]: Began running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:02.767260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_accounts, now test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471)
[0m22:16:02.767603 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_pipelines, now test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d)
[0m22:16:02.767939 [debug] [Thread-2  ]: Began compiling node model.matt_demo.dim_date
[0m22:16:02.768279 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_stg_sales_teams, now test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d)
[0m22:16:02.768587 [debug] [Thread-1  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:02.768933 [debug] [Thread-3  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:02.771148 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.dim_date"
[0m22:16:02.771519 [debug] [Thread-4  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:02.781563 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:02.786030 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d"
[0m22:16:02.789583 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d"
[0m22:16:02.790004 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: BEGIN
[0m22:16:02.790354 [debug] [Thread-2  ]: Began executing node model.matt_demo.dim_date
[0m22:16:02.791164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:16:02.791608 [debug] [Thread-3  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:02.792042 [debug] [Thread-2  ]: Finished running node model.matt_demo.dim_date
[0m22:16:02.792378 [debug] [Thread-4  ]: Began executing node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:02.793064 [debug] [Thread-3  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d
[0m22:16:02.793552 [debug] [Thread-2  ]: Began running node model.matt_demo.crm_int_kpi
[0m22:16:02.794132 [debug] [Thread-4  ]: Finished running node test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d
[0m22:16:02.794526 [debug] [Thread-3  ]: Began running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:02.794823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:16:02.795166 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.dim_date, now model.matt_demo.crm_int_kpi)
[0m22:16:02.795527 [debug] [Thread-4  ]: Began running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:02.795879 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_pipelines_opportunity_id.1edb2a347d, now test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267)
[0m22:16:02.796186 [debug] [Thread-1  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:02.796480 [debug] [Thread-2  ]: Began compiling node model.matt_demo.crm_int_kpi
[0m22:16:02.796804 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_pipelines_opportunity_id.395ec5b99d, now test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800)
[0m22:16:02.797114 [debug] [Thread-3  ]: Began compiling node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:02.797445 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_pipelines'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:16:02.799906 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.crm_int_kpi"
[0m22:16:02.800226 [debug] [Thread-4  ]: Began compiling node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:02.804230 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:02.807053 [debug] [Thread-4  ]: Writing injected SQL for node "test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800"
[0m22:16:02.807463 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: BEGIN
[0m22:16:02.807762 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m22:16:02.808020 [debug] [Thread-2  ]: Began executing node model.matt_demo.crm_int_kpi
[0m22:16:02.808543 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m22:16:02.810329 [debug] [Thread-1  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471"
[0m22:16:02.810690 [debug] [Thread-4  ]: Began executing node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:02.811101 [debug] [Thread-2  ]: Finished running node model.matt_demo.crm_int_kpi
[0m22:16:02.811969 [debug] [Thread-4  ]: Finished running node test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800
[0m22:16:02.812380 [debug] [Thread-2  ]: Began running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:02.812869 [debug] [Thread-1  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:02.813177 [debug] [Thread-4  ]: Began running node model.matt_demo.kpi
[0m22:16:02.813591 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m22:16:02.813855 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.matt_demo.crm_int_kpi, now test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d)
[0m22:16:02.814205 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: ROLLBACK
[0m22:16:02.814565 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.matt_demo.not_null_crm_stg_sales_teams_sales_agent.9ea31b2800, now model.matt_demo.kpi)
[0m22:16:02.814889 [debug] [Thread-3  ]: Using postgres connection "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:02.815219 [debug] [Thread-2  ]: Began compiling node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:02.815606 [debug] [Thread-1  ]: On test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471: Close
[0m22:16:02.815834 [debug] [Thread-4  ]: Began compiling node model.matt_demo.kpi
[0m22:16:02.816173 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "node_id": "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "company_dw".INFORMATION_SCHEMA.columns
      where table_name = 'crm_stg_sales_teams'
        
        and table_schema = 'dev_crm_sales_dbt'
        
      order by ordinal_position

  
[0m22:16:02.818954 [debug] [Thread-2  ]: Writing injected SQL for node "test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d"
[0m22:16:02.819570 [debug] [Thread-1  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471
[0m22:16:02.821409 [debug] [Thread-4  ]: Writing injected SQL for node "model.matt_demo.kpi"
[0m22:16:02.822148 [debug] [Thread-1  ]: Began running node model.matt_demo.product_win_rates
[0m22:16:02.822703 [debug] [Thread-2  ]: Began executing node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:02.822975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.matt_demo.no_nan_values_crm_stg_sales_pipelines_crm_stg_sales_pipelines.fb05c27471, now model.matt_demo.product_win_rates)
[0m22:16:02.823486 [debug] [Thread-2  ]: Finished running node test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d
[0m22:16:02.823831 [debug] [Thread-4  ]: Began executing node model.matt_demo.kpi
[0m22:16:02.824054 [debug] [Thread-1  ]: Began compiling node model.matt_demo.product_win_rates
[0m22:16:02.824364 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m22:16:02.824604 [debug] [Thread-2  ]: Began running node model.matt_demo.qoq_kpi
[0m22:16:02.825087 [debug] [Thread-4  ]: Finished running node model.matt_demo.kpi
[0m22:16:02.827665 [debug] [Thread-1  ]: Writing injected SQL for node "model.matt_demo.product_win_rates"
[0m22:16:02.828498 [debug] [Thread-3  ]: Writing injected SQL for node "test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267"
[0m22:16:02.828873 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.matt_demo.unique_crm_stg_sales_teams_sales_agent.f384cde25d, now model.matt_demo.qoq_kpi)
[0m22:16:02.829761 [debug] [Thread-2  ]: Began compiling node model.matt_demo.qoq_kpi
[0m22:16:02.830084 [debug] [Thread-1  ]: Began executing node model.matt_demo.product_win_rates
[0m22:16:02.831839 [debug] [Thread-2  ]: Writing injected SQL for node "model.matt_demo.qoq_kpi"
[0m22:16:02.832074 [debug] [Thread-3  ]: Began executing node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:02.832502 [debug] [Thread-1  ]: Finished running node model.matt_demo.product_win_rates
[0m22:16:02.832996 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: ROLLBACK
[0m22:16:02.833410 [debug] [Thread-2  ]: Began executing node model.matt_demo.qoq_kpi
[0m22:16:02.834078 [debug] [Thread-2  ]: Finished running node model.matt_demo.qoq_kpi
[0m22:16:02.834313 [debug] [Thread-3  ]: On test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267: Close
[0m22:16:02.834992 [debug] [Thread-3  ]: Finished running node test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267
[0m22:16:02.835837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:02.836106 [debug] [MainThread]: Connection 'model.matt_demo.product_win_rates' was properly closed.
[0m22:16:02.836309 [debug] [MainThread]: Connection 'model.matt_demo.qoq_kpi' was properly closed.
[0m22:16:02.836554 [debug] [MainThread]: Connection 'test.matt_demo.no_nan_values_crm_stg_sales_teams_crm_stg_sales_teams.abdde71267' was properly closed.
[0m22:16:02.836803 [debug] [MainThread]: Connection 'model.matt_demo.kpi' was properly closed.
[0m22:16:02.837952 [debug] [MainThread]: Command end result
[0m22:16:02.946414 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:16:02.946812 [info ] [MainThread]: Building catalog
[0m22:16:02.948910 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m22:16:02.953464 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:16:02.953815 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m22:16:02.954057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:02.956407 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m22:16:02.956719 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:16:02.957069 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "matt_demo", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('accounts')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_teams')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_teams')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('kpi')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('product_win_rates')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('sales_pipeline')) or (upper(sch.nspname) = upper('crm_sales_data') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_products')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_sales_pipelines')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('qoq_kpi')) or (upper(sch.nspname) = upper('dev_global_dim') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_int_kpi')) or (upper(sch.nspname) = upper('dev_crm_sales_dbt') and
           upper(tbl.relname) = upper('crm_stg_accounts')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:16:02.959286 [debug] [ThreadPool]: SQL status: SELECT 74 in 0.002 seconds
[0m22:16:02.963495 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m22:16:02.964003 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m22:16:02.997812 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m22:16:02.998566 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.4355031, "process_user_time": 3.068279, "process_kernel_time": 0.105387, "process_mem_max_rss": "206848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:16:02.999032 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:16:02.998971 after 1.44 seconds
[0m22:16:02.999291 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:16:02.999485 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m22:16:02.999707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff708552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6edfae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e46dc0>]}
[0m22:16:03.000000 [debug] [MainThread]: Flushing usage events
